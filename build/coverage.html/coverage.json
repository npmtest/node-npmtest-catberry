{"/home/travis/build/npmtest/node-npmtest-catberry/test.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/test.js","s":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":1,"9":2,"10":2,"11":1,"12":1,"13":1,"14":1,"15":2,"16":2,"17":2,"18":2,"19":1,"20":1,"21":2,"22":2,"23":2,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":1,"38":1,"39":2,"40":2,"41":1,"42":2,"43":2,"44":1,"45":2,"46":2,"47":1,"48":2,"49":2,"50":1,"51":1,"52":1,"53":1,"54":1},"b":{"1":[2,1,1,1],"2":[1,1,1,1],"3":[1,1],"4":[1,1],"5":[1,1],"6":[1,1],"7":[1,1],"8":[1,1],"9":[1,1],"10":[1,1,1],"11":[1,1],"12":[1,1],"13":[1,1],"14":[1,1],"15":[1,1],"16":[1,1],"17":[1,1]},"f":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":1,"7":1,"8":1,"9":2,"10":2,"11":2,"12":2,"13":1},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":1},"end":{"line":12,"column":13}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":5},"end":{"line":19,"column":17}}},"3":{"name":"(anonymous_3)","line":23,"loc":{"start":{"line":23,"column":24},"end":{"line":23,"column":36}}},"4":{"name":"(anonymous_4)","line":61,"loc":{"start":{"line":61,"column":5},"end":{"line":61,"column":17}}},"5":{"name":"(anonymous_5)","line":82,"loc":{"start":{"line":82,"column":5},"end":{"line":82,"column":17}}},"6":{"name":"(anonymous_6)","line":91,"loc":{"start":{"line":91,"column":77},"end":{"line":94,"column":10}}},"7":{"name":"(anonymous_7)","line":112,"loc":{"start":{"line":112,"column":83},"end":{"line":115,"column":10}},"skip":true},"8":{"name":"(anonymous_8)","line":123,"loc":{"start":{"line":123,"column":77},"end":{"line":126,"column":10}},"skip":true},"9":{"name":"(anonymous_9)","line":139,"loc":{"start":{"line":139,"column":12},"end":{"line":139,"column":40}},"skip":true},"10":{"name":"(anonymous_10)","line":147,"loc":{"start":{"line":147,"column":77},"end":{"line":150,"column":10}},"skip":true},"11":{"name":"(anonymous_11)","line":158,"loc":{"start":{"line":158,"column":83},"end":{"line":161,"column":10}},"skip":true},"12":{"name":"(anonymous_12)","line":169,"loc":{"start":{"line":169,"column":79},"end":{"line":172,"column":10}},"skip":true},"13":{"name":"(anonymous_13)","line":180,"loc":{"start":{"line":180,"column":75},"end":{"line":183,"column":10}},"skip":true}},"statementMap":{"1":{"start":{"line":12,"column":0},"end":{"line":195,"column":5}},"2":{"start":{"line":14,"column":4},"end":{"line":14,"column":14}},"3":{"start":{"line":19,"column":4},"end":{"line":56,"column":9}},"4":{"start":{"line":21,"column":8},"end":{"line":21,"column":19}},"5":{"start":{"line":23,"column":8},"end":{"line":35,"column":13}},"6":{"start":{"line":24,"column":12},"end":{"line":34,"column":13}},"7":{"start":{"line":25,"column":16},"end":{"line":28,"column":30}},"8":{"start":{"line":30,"column":16},"end":{"line":33,"column":27}},"9":{"start":{"line":37,"column":8},"end":{"line":39,"column":21}},"10":{"start":{"line":40,"column":8},"end":{"line":53,"column":9}},"11":{"start":{"line":43,"column":12},"end":{"line":46,"column":14}},"12":{"start":{"line":47,"column":12},"end":{"line":47,"column":18}},"13":{"start":{"line":50,"column":12},"end":{"line":51,"column":33}},"14":{"start":{"line":52,"column":12},"end":{"line":52,"column":18}},"15":{"start":{"line":55,"column":8},"end":{"line":55,"column":35}},"16":{"start":{"line":61,"column":4},"end":{"line":63,"column":9}},"17":{"start":{"line":62,"column":8},"end":{"line":62,"column":15}},"18":{"start":{"line":64,"column":4},"end":{"line":77,"column":5}},"19":{"start":{"line":70,"column":8},"end":{"line":70,"column":14}},"20":{"start":{"line":76,"column":8},"end":{"line":76,"column":14}},"21":{"start":{"line":82,"column":4},"end":{"line":84,"column":9}},"22":{"start":{"line":83,"column":8},"end":{"line":83,"column":15}},"23":{"start":{"line":85,"column":4},"end":{"line":194,"column":5}},"24":{"start":{"line":91,"column":8},"end":{"line":99,"column":10}},"25":{"start":{"line":98,"column":12},"end":{"line":98,"column":35}},"26":{"start":{"line":102,"column":8},"end":{"line":104,"column":63}},"27":{"start":{"line":105,"column":8},"end":{"line":105,"column":14}},"28":{"start":{"line":112,"column":8},"end":{"line":121,"column":10},"skip":true},"29":{"start":{"line":119,"column":12},"end":{"line":119,"column":55},"skip":true},"30":{"start":{"line":120,"column":12},"end":{"line":120,"column":48},"skip":true},"31":{"start":{"line":123,"column":8},"end":{"line":136,"column":10},"skip":true},"32":{"start":{"line":130,"column":12},"end":{"line":130,"column":76},"skip":true},"33":{"start":{"line":131,"column":12},"end":{"line":131,"column":73},"skip":true},"34":{"start":{"line":132,"column":12},"end":{"line":132,"column":74},"skip":true},"35":{"start":{"line":133,"column":12},"end":{"line":133,"column":79},"skip":true},"36":{"start":{"line":134,"column":12},"end":{"line":134,"column":25},"skip":true},"37":{"start":{"line":135,"column":12},"end":{"line":135,"column":45},"skip":true},"38":{"start":{"line":138,"column":8},"end":{"line":145,"column":14},"skip":true},"39":{"start":{"line":143,"column":16},"end":{"line":143,"column":29},"skip":true},"40":{"start":{"line":144,"column":16},"end":{"line":144,"column":55},"skip":true},"41":{"start":{"line":147,"column":8},"end":{"line":156,"column":10},"skip":true},"42":{"start":{"line":154,"column":12},"end":{"line":154,"column":25},"skip":true},"43":{"start":{"line":155,"column":12},"end":{"line":155,"column":45},"skip":true},"44":{"start":{"line":158,"column":8},"end":{"line":167,"column":10},"skip":true},"45":{"start":{"line":165,"column":12},"end":{"line":165,"column":25},"skip":true},"46":{"start":{"line":166,"column":12},"end":{"line":166,"column":48},"skip":true},"47":{"start":{"line":169,"column":8},"end":{"line":178,"column":10},"skip":true},"48":{"start":{"line":176,"column":12},"end":{"line":176,"column":25},"skip":true},"49":{"start":{"line":177,"column":12},"end":{"line":177,"column":46},"skip":true},"50":{"start":{"line":180,"column":8},"end":{"line":189,"column":10},"skip":true},"51":{"start":{"line":187,"column":12},"end":{"line":187,"column":94},"skip":true},"52":{"start":{"line":188,"column":12},"end":{"line":188,"column":48},"skip":true},"53":{"start":{"line":192,"column":8},"end":{"line":192,"column":35},"skip":true},"54":{"start":{"line":193,"column":8},"end":{"line":193,"column":14},"skip":true}},"branchMap":{"1":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":23},"end":{"line":25,"column":62}},{"start":{"line":26,"column":20},"end":{"line":26,"column":70}},{"start":{"line":27,"column":20},"end":{"line":27,"column":71}},{"start":{"line":28,"column":20},"end":{"line":28,"column":29}}]},"2":{"line":30,"type":"binary-expr","locations":[{"start":{"line":30,"column":23},"end":{"line":30,"column":37}},{"start":{"line":31,"column":20},"end":{"line":31,"column":61}},{"start":{"line":32,"column":20},"end":{"line":32,"column":70}},{"start":{"line":33,"column":20},"end":{"line":33,"column":26}}]},"3":{"line":37,"type":"cond-expr","locations":[{"start":{"line":38,"column":14},"end":{"line":38,"column":20}},{"start":{"line":39,"column":14},"end":{"line":39,"column":20}}]},"4":{"line":40,"type":"switch","locations":[{"start":{"line":42,"column":8},"end":{"line":47,"column":18}},{"start":{"line":49,"column":8},"end":{"line":52,"column":18}}]},"5":{"line":44,"type":"binary-expr","locations":[{"start":{"line":44,"column":16},"end":{"line":44,"column":44}},{"start":{"line":44,"column":48},"end":{"line":44,"column":66}}]},"6":{"line":50,"type":"binary-expr","locations":[{"start":{"line":50,"column":21},"end":{"line":50,"column":49}},{"start":{"line":50,"column":53},"end":{"line":50,"column":72}}]},"7":{"line":64,"type":"switch","locations":[{"start":{"line":69,"column":4},"end":{"line":70,"column":14}},{"start":{"line":75,"column":4},"end":{"line":76,"column":14}}]},"8":{"line":85,"type":"switch","locations":[{"start":{"line":90,"column":4},"end":{"line":105,"column":14}},{"start":{"line":111,"column":4},"end":{"line":193,"column":14},"skip":true}]},"9":{"line":91,"type":"binary-expr","locations":[{"start":{"line":91,"column":42},"end":{"line":91,"column":73}},{"start":{"line":91,"column":77},"end":{"line":99,"column":9}}]},"10":{"line":102,"type":"binary-expr","locations":[{"start":{"line":102,"column":18},"end":{"line":102,"column":32}},{"start":{"line":103,"column":12},"end":{"line":103,"column":53}},{"start":{"line":104,"column":12},"end":{"line":104,"column":61}}]},"11":{"line":112,"type":"binary-expr","locations":[{"start":{"line":112,"column":45},"end":{"line":112,"column":79},"skip":true},{"start":{"line":112,"column":83},"end":{"line":121,"column":9},"skip":true}]},"12":{"line":123,"type":"binary-expr","locations":[{"start":{"line":123,"column":42},"end":{"line":123,"column":73},"skip":true},{"start":{"line":123,"column":77},"end":{"line":136,"column":9},"skip":true}]},"13":{"line":138,"type":"binary-expr","locations":[{"start":{"line":138,"column":48},"end":{"line":138,"column":85},"skip":true},{"start":{"line":139,"column":12},"end":{"line":145,"column":13},"skip":true}]},"14":{"line":147,"type":"binary-expr","locations":[{"start":{"line":147,"column":42},"end":{"line":147,"column":73},"skip":true},{"start":{"line":147,"column":77},"end":{"line":156,"column":9},"skip":true}]},"15":{"line":158,"type":"binary-expr","locations":[{"start":{"line":158,"column":45},"end":{"line":158,"column":79},"skip":true},{"start":{"line":158,"column":83},"end":{"line":167,"column":9},"skip":true}]},"16":{"line":169,"type":"binary-expr","locations":[{"start":{"line":169,"column":43},"end":{"line":169,"column":75},"skip":true},{"start":{"line":169,"column":79},"end":{"line":178,"column":9},"skip":true}]},"17":{"line":180,"type":"binary-expr","locations":[{"start":{"line":180,"column":41},"end":{"line":180,"column":71},"skip":true},{"start":{"line":180,"column":75},"end":{"line":189,"column":9},"skip":true}]}},"code":["/* istanbul instrument in package npmtest_catberry */","/*jslint","    bitwise: true,","    browser: true,","    maxerr: 8,","    maxlen: 96,","    node: true,","    nomen: true,","    regexp: true,","    stupid: true","*/","(function () {","    'use strict';","    var local;","","","","    // run shared js-env code - init-before","    (function () {","        // init local","        local = {};","        // init modeJs","        local.modeJs = (function () {","            try {","                return typeof navigator.userAgent === 'string' &&","                    typeof document.querySelector('body') === 'object' &&","                    typeof XMLHttpRequest.prototype.open === 'function' &&","                    'browser';","            } catch (errorCaughtBrowser) {","                return module.exports &&","                    typeof process.versions.node === 'string' &&","                    typeof require('http').createServer === 'function' &&","                    'node';","            }","        }());","        // init global","        local.global = local.modeJs === 'browser'","            ? window","            : global;","        switch (local.modeJs) {","        // re-init local from window.local","        case 'browser':","            local = local.global.utility2.objectSetDefault(","                local.global.utility2_rollup || local.global.local,","                local.global.utility2","            );","            break;","        // re-init local from example.js","        case 'node':","            local = (local.global.utility2_rollup || require('utility2'))","                .requireReadme();","            break;","        }","        // export local","        local.global.local = local;","    }());","","","","    // run shared js-env code - function","    (function () {","        return;","    }());","    switch (local.modeJs) {","","","","    // run browser js-env code - function","    case 'browser':","        break;","","","","    // run node js-env code - function","    case 'node':","        break;","    }","","","","    // run shared js-env code - init-after","    (function () {","        return;","    }());","    switch (local.modeJs) {","","","","    // run browser js-env code - init-after","    case 'browser':","        local.testCase_browser_nullCase = local.testCase_browser_nullCase || function (","            options,","            onError","        ) {","        /*","         * this function will test browsers's null-case handling-behavior-behavior","         */","            onError(null, options);","        };","","        // run tests","        local.nop(local.modeTest &&","            document.querySelector('#testRunButton1') &&","            document.querySelector('#testRunButton1').click());","        break;","","","","    // run node js-env code - init-after","    /* istanbul ignore next */","    case 'node':","        local.testCase_buildApidoc_default = local.testCase_buildApidoc_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildApidoc's default handling-behavior-behavior","         */","            options = { modulePathList: module.paths };","            local.buildApidoc(options, onError);","        };","","        local.testCase_buildApp_default = local.testCase_buildApp_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildApp's default handling-behavior-behavior","         */","            local.testCase_buildReadme_default(options, local.onErrorThrow);","            local.testCase_buildLib_default(options, local.onErrorThrow);","            local.testCase_buildTest_default(options, local.onErrorThrow);","            local.testCase_buildCustomOrg_default(options, local.onErrorThrow);","            options = [];","            local.buildApp(options, onError);","        };","","        local.testCase_buildCustomOrg_default = local.testCase_buildCustomOrg_default ||","            function (options, onError) {","            /*","             * this function will test buildCustomOrg's default handling-behavior","             */","                options = {};","                local.buildCustomOrg(options, onError);","            };","","        local.testCase_buildLib_default = local.testCase_buildLib_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildLib's default handling-behavior","         */","            options = {};","            local.buildLib(options, onError);","        };","","        local.testCase_buildReadme_default = local.testCase_buildReadme_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildReadme's default handling-behavior-behavior","         */","            options = {};","            local.buildReadme(options, onError);","        };","","        local.testCase_buildTest_default = local.testCase_buildTest_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildTest's default handling-behavior","         */","            options = {};","            local.buildTest(options, onError);","        };","","        local.testCase_webpage_default = local.testCase_webpage_default || function (","            options,","            onError","        ) {","        /*","         * this function will test webpage's default handling-behavior","         */","            options = { modeCoverageMerge: true, url: local.serverLocalHost + '?modeTest=1' };","            local.browserTest(options, onError);","        };","","        // run test-server","        local.testRunServer(local);","        break;","    }","}());",""],"l":{"12":2,"14":2,"19":2,"21":2,"23":2,"24":2,"25":2,"30":1,"37":2,"40":2,"43":1,"47":1,"50":1,"52":1,"55":2,"61":2,"62":2,"64":2,"70":1,"76":1,"82":2,"83":2,"85":2,"91":1,"98":1,"102":1,"105":1,"112":1,"119":1,"120":1,"123":1,"130":1,"131":1,"132":1,"133":1,"134":1,"135":1,"138":1,"143":2,"144":2,"147":1,"154":2,"155":2,"158":1,"165":2,"166":2,"169":1,"176":2,"177":2,"180":1,"187":1,"188":1,"192":1,"193":1}},"/home/travis/build/npmtest/node-npmtest-catberry/lib.npmtest_catberry.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/lib.npmtest_catberry.js","s":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":1,"9":2,"10":2,"11":2,"12":2,"13":1,"14":1,"15":1,"16":1},"b":{"1":[2,1,1,1],"2":[1,1,1,1],"3":[1,1],"4":[2,2],"5":[1,1]},"f":{"1":2,"2":2,"3":2},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":1},"end":{"line":12,"column":13}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":5},"end":{"line":19,"column":17}}},"3":{"name":"(anonymous_3)","line":23,"loc":{"start":{"line":23,"column":24},"end":{"line":23,"column":36}}}},"statementMap":{"1":{"start":{"line":12,"column":0},"end":{"line":53,"column":5}},"2":{"start":{"line":14,"column":4},"end":{"line":14,"column":14}},"3":{"start":{"line":19,"column":4},"end":{"line":52,"column":9}},"4":{"start":{"line":21,"column":8},"end":{"line":21,"column":19}},"5":{"start":{"line":23,"column":8},"end":{"line":35,"column":13}},"6":{"start":{"line":24,"column":12},"end":{"line":34,"column":13}},"7":{"start":{"line":25,"column":16},"end":{"line":28,"column":30}},"8":{"start":{"line":30,"column":16},"end":{"line":33,"column":27}},"9":{"start":{"line":37,"column":8},"end":{"line":39,"column":21}},"10":{"start":{"line":41,"column":8},"end":{"line":41,"column":54}},"11":{"start":{"line":43,"column":8},"end":{"line":43,"column":53}},"12":{"start":{"line":45,"column":8},"end":{"line":51,"column":9}},"13":{"start":{"line":46,"column":12},"end":{"line":46,"column":59}},"14":{"start":{"line":48,"column":12},"end":{"line":48,"column":35}},"15":{"start":{"line":49,"column":12},"end":{"line":49,"column":49}},"16":{"start":{"line":50,"column":12},"end":{"line":50,"column":43}}},"branchMap":{"1":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":23},"end":{"line":25,"column":62}},{"start":{"line":26,"column":20},"end":{"line":26,"column":70}},{"start":{"line":27,"column":20},"end":{"line":27,"column":71}},{"start":{"line":28,"column":20},"end":{"line":28,"column":29}}]},"2":{"line":30,"type":"binary-expr","locations":[{"start":{"line":30,"column":23},"end":{"line":30,"column":37}},{"start":{"line":31,"column":20},"end":{"line":31,"column":61}},{"start":{"line":32,"column":20},"end":{"line":32,"column":70}},{"start":{"line":33,"column":20},"end":{"line":33,"column":26}}]},"3":{"line":37,"type":"cond-expr","locations":[{"start":{"line":38,"column":14},"end":{"line":38,"column":20}},{"start":{"line":39,"column":14},"end":{"line":39,"column":20}}]},"4":{"line":41,"type":"binary-expr","locations":[{"start":{"line":41,"column":16},"end":{"line":41,"column":44}},{"start":{"line":41,"column":48},"end":{"line":41,"column":53}}]},"5":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":8},"end":{"line":45,"column":8}},{"start":{"line":45,"column":8},"end":{"line":45,"column":8}}]}},"code":["/* istanbul instrument in package npmtest_catberry */","/*jslint","    bitwise: true,","    browser: true,","    maxerr: 8,","    maxlen: 96,","    node: true,","    nomen: true,","    regexp: true,","    stupid: true","*/","(function () {","    'use strict';","    var local;","","","","    // run shared js-env code - init-before","    (function () {","        // init local","        local = {};","        // init modeJs","        local.modeJs = (function () {","            try {","                return typeof navigator.userAgent === 'string' &&","                    typeof document.querySelector('body') === 'object' &&","                    typeof XMLHttpRequest.prototype.open === 'function' &&","                    'browser';","            } catch (errorCaughtBrowser) {","                return module.exports &&","                    typeof process.versions.node === 'string' &&","                    typeof require('http').createServer === 'function' &&","                    'node';","            }","        }());","        // init global","        local.global = local.modeJs === 'browser'","            ? window","            : global;","        // init utility2_rollup","        local = local.global.utility2_rollup || local;","        // init lib","        local.local = local.npmtest_catberry = local;","        // init exports","        if (local.modeJs === 'browser') {","            local.global.utility2_npmtest_catberry = local;","        } else {","            module.exports = local;","            module.exports.__dirname = __dirname;","            module.exports.module = module;","        }","    }());","}());",""],"l":{"12":2,"14":2,"19":2,"21":2,"23":2,"24":2,"25":2,"30":1,"37":2,"41":2,"43":2,"45":2,"46":1,"48":1,"49":1,"50":1}},"/home/travis/build/npmtest/node-npmtest-catberry/example.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/example.js","s":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":1,"9":2,"10":2,"11":2,"12":2,"13":1,"14":2,"15":2,"16":2,"17":2,"18":2,"19":0,"20":2,"21":1,"22":1,"23":1,"24":1,"25":1,"26":0,"27":0,"28":1,"29":1,"30":2,"31":0,"32":0,"33":0,"34":1,"35":2,"36":2,"37":3,"38":3,"39":3,"40":3,"41":0,"42":3,"43":3,"44":3,"45":1,"46":3,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1,"53":1,"54":1,"55":1,"56":1,"57":0,"58":1,"59":6,"60":6,"61":1,"62":2,"63":0,"64":2,"65":1,"66":1,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0},"b":{"1":[2,1,1,1],"2":[1,1,1,1],"3":[1,1],"4":[2,2],"5":[1,1],"6":[1,1],"7":[2,0],"8":[2,1,1,1,1,1],"9":[0,2,0],"10":[1,1],"11":[2,1,1],"12":[1,0],"13":[0,2],"14":[2,0,0,0,0,0,0],"15":[0,3],"16":[3,0],"17":[1,1],"18":[0,1],"19":[1,2,0,2],"20":[1,0],"21":[1,1],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0]},"f":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":3,"8":3,"9":3,"10":1,"11":6,"12":0},"fnMap":{"1":{"name":"(anonymous_1)","line":26,"loc":{"start":{"line":26,"column":1},"end":{"line":26,"column":13}}},"2":{"name":"(anonymous_2)","line":33,"loc":{"start":{"line":33,"column":5},"end":{"line":33,"column":17}}},"3":{"name":"(anonymous_3)","line":37,"loc":{"start":{"line":37,"column":24},"end":{"line":37,"column":36}}},"4":{"name":"(anonymous_4)","line":69,"loc":{"start":{"line":69,"column":31},"end":{"line":69,"column":48}},"skip":true},"5":{"name":"(anonymous_5)","line":78,"loc":{"start":{"line":78,"column":26},"end":{"line":78,"column":45}},"skip":true},"6":{"name":"(anonymous_6)","line":123,"loc":{"start":{"line":123,"column":33},"end":{"line":123,"column":48}},"skip":true},"7":{"name":"(anonymous_7)","line":125,"loc":{"start":{"line":125,"column":27},"end":{"line":125,"column":39}},"skip":true},"8":{"name":"(anonymous_8)","line":133,"loc":{"start":{"line":133,"column":59},"end":{"line":133,"column":74}},"skip":true},"9":{"name":"(anonymous_9)","line":143,"loc":{"start":{"line":143,"column":45},"end":{"line":143,"column":62}},"skip":true},"10":{"name":"(anonymous_10)","line":144,"loc":{"start":{"line":144,"column":73},"end":{"line":144,"column":92}},"skip":true},"11":{"name":"(anonymous_11)","line":272,"loc":{"start":{"line":272,"column":51},"end":{"line":272,"column":77}},"skip":true},"12":{"name":"(anonymous_12)","line":315,"loc":{"start":{"line":315,"column":32},"end":{"line":315,"column":61}},"skip":true}},"statementMap":{"1":{"start":{"line":26,"column":0},"end":{"line":326,"column":5}},"2":{"start":{"line":28,"column":4},"end":{"line":28,"column":14}},"3":{"start":{"line":33,"column":4},"end":{"line":60,"column":9}},"4":{"start":{"line":35,"column":8},"end":{"line":35,"column":19}},"5":{"start":{"line":37,"column":8},"end":{"line":49,"column":13}},"6":{"start":{"line":38,"column":12},"end":{"line":48,"column":13}},"7":{"start":{"line":39,"column":16},"end":{"line":42,"column":30}},"8":{"start":{"line":44,"column":16},"end":{"line":47,"column":27}},"9":{"start":{"line":51,"column":8},"end":{"line":53,"column":21}},"10":{"start":{"line":55,"column":8},"end":{"line":57,"column":45}},"11":{"start":{"line":59,"column":8},"end":{"line":59,"column":35}},"12":{"start":{"line":61,"column":4},"end":{"line":325,"column":5}},"13":{"start":{"line":69,"column":8},"end":{"line":121,"column":10},"skip":true},"14":{"start":{"line":70,"column":12},"end":{"line":88,"column":13},"skip":true},"15":{"start":{"line":76,"column":16},"end":{"line":87,"column":19},"skip":true},"16":{"start":{"line":79,"column":20},"end":{"line":86,"column":21},"skip":true},"17":{"start":{"line":82,"column":24},"end":{"line":82,"column":43},"skip":true},"18":{"start":{"line":83,"column":24},"end":{"line":83,"column":30},"skip":true},"19":{"start":{"line":85,"column":24},"end":{"line":85,"column":49},"skip":true},"20":{"start":{"line":89,"column":12},"end":{"line":107,"column":13},"skip":true},"21":{"start":{"line":92,"column":16},"end":{"line":102,"column":17},"skip":true},"22":{"start":{"line":93,"column":20},"end":{"line":93,"column":86},"skip":true},"23":{"start":{"line":94,"column":20},"end":{"line":95,"column":45},"skip":true},"24":{"start":{"line":96,"column":20},"end":{"line":96,"column":42},"skip":true},"25":{"start":{"line":97,"column":20},"end":{"line":97,"column":48},"skip":true},"26":{"start":{"line":100,"column":20},"end":{"line":100,"column":85},"skip":true},"27":{"start":{"line":101,"column":20},"end":{"line":101,"column":96},"skip":true},"28":{"start":{"line":103,"column":16},"end":{"line":103,"column":22},"skip":true},"29":{"start":{"line":106,"column":16},"end":{"line":106,"column":22},"skip":true},"30":{"start":{"line":108,"column":12},"end":{"line":120,"column":13},"skip":true},"31":{"start":{"line":114,"column":16},"end":{"line":119,"column":17},"skip":true},"32":{"start":{"line":116,"column":20},"end":{"line":116,"column":78},"skip":true},"33":{"start":{"line":118,"column":20},"end":{"line":118,"column":47},"skip":true},"34":{"start":{"line":123,"column":8},"end":{"line":141,"column":11},"skip":true},"35":{"start":{"line":124,"column":12},"end":{"line":124,"column":54},"skip":true},"36":{"start":{"line":125,"column":12},"end":{"line":140,"column":14},"skip":true},"37":{"start":{"line":126,"column":16},"end":{"line":126,"column":28},"skip":true},"38":{"start":{"line":127,"column":16},"end":{"line":127,"column":69},"skip":true},"39":{"start":{"line":128,"column":16},"end":{"line":128,"column":75},"skip":true},"40":{"start":{"line":129,"column":16},"end":{"line":131,"column":17},"skip":true},"41":{"start":{"line":130,"column":20},"end":{"line":130,"column":27},"skip":true},"42":{"start":{"line":133,"column":16},"end":{"line":137,"column":36},"skip":true},"43":{"start":{"line":134,"column":20},"end":{"line":136,"column":55},"skip":true},"44":{"start":{"line":139,"column":16},"end":{"line":139,"column":57},"skip":true},"45":{"start":{"line":143,"column":8},"end":{"line":147,"column":11},"skip":true},"46":{"start":{"line":144,"column":12},"end":{"line":146,"column":15},"skip":true},"47":{"start":{"line":145,"column":16},"end":{"line":145,"column":70},"skip":true},"48":{"start":{"line":149,"column":8},"end":{"line":149,"column":31},"skip":true},"49":{"start":{"line":150,"column":8},"end":{"line":150,"column":14},"skip":true},"50":{"start":{"line":158,"column":8},"end":{"line":158,"column":31},"skip":true},"51":{"start":{"line":160,"column":8},"end":{"line":160,"column":33},"skip":true},"52":{"start":{"line":161,"column":8},"end":{"line":161,"column":37},"skip":true},"53":{"start":{"line":162,"column":8},"end":{"line":162,"column":35},"skip":true},"54":{"start":{"line":164,"column":8},"end":{"line":164,"column":50},"skip":true},"55":{"start":{"line":166,"column":8},"end":{"line":256,"column":2},"skip":true},"56":{"start":{"line":258,"column":8},"end":{"line":286,"column":9},"skip":true},"57":{"start":{"line":259,"column":12},"end":{"line":269,"column":14},"skip":true},"58":{"start":{"line":271,"column":12},"end":{"line":285,"column":19},"skip":true},"59":{"start":{"line":274,"column":20},"end":{"line":274,"column":35},"skip":true},"60":{"start":{"line":275,"column":20},"end":{"line":284,"column":21},"skip":true},"61":{"start":{"line":277,"column":24},"end":{"line":277,"column":64},"skip":true},"62":{"start":{"line":279,"column":24},"end":{"line":279,"column":40},"skip":true},"63":{"start":{"line":281,"column":24},"end":{"line":281,"column":40},"skip":true},"64":{"start":{"line":283,"column":24},"end":{"line":283,"column":39},"skip":true},"65":{"start":{"line":288,"column":8},"end":{"line":290,"column":9},"skip":true},"66":{"start":{"line":289,"column":12},"end":{"line":289,"column":18},"skip":true},"67":{"start":{"line":291,"column":8},"end":{"line":293,"column":54},"skip":true},"68":{"start":{"line":296,"column":8},"end":{"line":301,"column":37},"skip":true},"69":{"start":{"line":303,"column":8},"end":{"line":303,"column":82},"skip":true},"70":{"start":{"line":306,"column":8},"end":{"line":308,"column":9},"skip":true},"71":{"start":{"line":307,"column":12},"end":{"line":307,"column":82},"skip":true},"72":{"start":{"line":310,"column":8},"end":{"line":312,"column":9},"skip":true},"73":{"start":{"line":311,"column":12},"end":{"line":311,"column":18},"skip":true},"74":{"start":{"line":313,"column":8},"end":{"line":313,"column":54},"skip":true},"75":{"start":{"line":314,"column":8},"end":{"line":314,"column":69},"skip":true},"76":{"start":{"line":315,"column":8},"end":{"line":323,"column":36},"skip":true},"77":{"start":{"line":316,"column":12},"end":{"line":316,"column":61},"skip":true},"78":{"start":{"line":317,"column":12},"end":{"line":320,"column":13},"skip":true},"79":{"start":{"line":318,"column":16},"end":{"line":318,"column":75},"skip":true},"80":{"start":{"line":319,"column":16},"end":{"line":319,"column":23},"skip":true},"81":{"start":{"line":321,"column":12},"end":{"line":321,"column":38},"skip":true},"82":{"start":{"line":322,"column":12},"end":{"line":322,"column":27},"skip":true},"83":{"start":{"line":324,"column":8},"end":{"line":324,"column":14},"skip":true}},"branchMap":{"1":{"line":39,"type":"binary-expr","locations":[{"start":{"line":39,"column":23},"end":{"line":39,"column":62}},{"start":{"line":40,"column":20},"end":{"line":40,"column":70}},{"start":{"line":41,"column":20},"end":{"line":41,"column":71}},{"start":{"line":42,"column":20},"end":{"line":42,"column":29}}]},"2":{"line":44,"type":"binary-expr","locations":[{"start":{"line":44,"column":23},"end":{"line":44,"column":37}},{"start":{"line":45,"column":20},"end":{"line":45,"column":61}},{"start":{"line":46,"column":20},"end":{"line":46,"column":70}},{"start":{"line":47,"column":20},"end":{"line":47,"column":26}}]},"3":{"line":51,"type":"cond-expr","locations":[{"start":{"line":52,"column":14},"end":{"line":52,"column":20}},{"start":{"line":53,"column":14},"end":{"line":53,"column":20}}]},"4":{"line":55,"type":"binary-expr","locations":[{"start":{"line":55,"column":16},"end":{"line":55,"column":44}},{"start":{"line":55,"column":49},"end":{"line":57,"column":43}}]},"5":{"line":55,"type":"cond-expr","locations":[{"start":{"line":56,"column":14},"end":{"line":56,"column":52}},{"start":{"line":57,"column":14},"end":{"line":57,"column":43}}]},"6":{"line":61,"type":"switch","locations":[{"start":{"line":68,"column":4},"end":{"line":150,"column":14},"skip":true},{"start":{"line":156,"column":4},"end":{"line":324,"column":14},"skip":true}]},"7":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":12},"end":{"line":70,"column":12},"skip":true},{"start":{"line":70,"column":12},"end":{"line":70,"column":12},"skip":true}]},"8":{"line":70,"type":"binary-expr","locations":[{"start":{"line":70,"column":16},"end":{"line":70,"column":22},"skip":true},{"start":{"line":70,"column":27},"end":{"line":70,"column":32},"skip":true},{"start":{"line":71,"column":20},"end":{"line":71,"column":39},"skip":true},{"start":{"line":72,"column":20},"end":{"line":72,"column":49},"skip":true},{"start":{"line":73,"column":20},"end":{"line":73,"column":58},"skip":true},{"start":{"line":74,"column":20},"end":{"line":74,"column":69},"skip":true}]},"9":{"line":79,"type":"switch","locations":[{"start":{"line":80,"column":20},"end":{"line":80,"column":33},"skip":true},{"start":{"line":81,"column":20},"end":{"line":83,"column":30},"skip":true},{"start":{"line":84,"column":20},"end":{"line":85,"column":49},"skip":true}]},"10":{"line":89,"type":"switch","locations":[{"start":{"line":90,"column":12},"end":{"line":103,"column":22},"skip":true},{"start":{"line":105,"column":12},"end":{"line":106,"column":22},"skip":true}]},"11":{"line":89,"type":"binary-expr","locations":[{"start":{"line":89,"column":20},"end":{"line":89,"column":25},"skip":true},{"start":{"line":89,"column":29},"end":{"line":89,"column":48},"skip":true},{"start":{"line":89,"column":52},"end":{"line":89,"column":74},"skip":true}]},"12":{"line":92,"type":"if","locations":[{"start":{"line":92,"column":16},"end":{"line":92,"column":16},"skip":true},{"start":{"line":92,"column":16},"end":{"line":92,"column":16},"skip":true}]},"13":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":12},"end":{"line":108,"column":12},"skip":true},{"start":{"line":108,"column":12},"end":{"line":108,"column":12},"skip":true}]},"14":{"line":108,"type":"binary-expr","locations":[{"start":{"line":108,"column":16},"end":{"line":108,"column":61},"skip":true},{"start":{"line":108,"column":66},"end":{"line":108,"column":72},"skip":true},{"start":{"line":108,"column":77},"end":{"line":108,"column":82},"skip":true},{"start":{"line":109,"column":20},"end":{"line":109,"column":39},"skip":true},{"start":{"line":110,"column":20},"end":{"line":110,"column":49},"skip":true},{"start":{"line":111,"column":20},"end":{"line":111,"column":58},"skip":true},{"start":{"line":112,"column":20},"end":{"line":112,"column":68},"skip":true}]},"15":{"line":129,"type":"if","locations":[{"start":{"line":129,"column":16},"end":{"line":129,"column":16},"skip":true},{"start":{"line":129,"column":16},"end":{"line":129,"column":16},"skip":true}]},"16":{"line":134,"type":"cond-expr","locations":[{"start":{"line":135,"column":26},"end":{"line":135,"column":29},"skip":true},{"start":{"line":136,"column":26},"end":{"line":136,"column":54},"skip":true}]},"17":{"line":164,"type":"binary-expr","locations":[{"start":{"line":164,"column":27},"end":{"line":164,"column":43},"skip":true},{"start":{"line":164,"column":47},"end":{"line":164,"column":49},"skip":true}]},"18":{"line":258,"type":"if","locations":[{"start":{"line":258,"column":8},"end":{"line":258,"column":8},"skip":true},{"start":{"line":258,"column":8},"end":{"line":258,"column":8},"skip":true}]},"19":{"line":275,"type":"switch","locations":[{"start":{"line":276,"column":20},"end":{"line":277,"column":64},"skip":true},{"start":{"line":278,"column":20},"end":{"line":279,"column":40},"skip":true},{"start":{"line":280,"column":20},"end":{"line":281,"column":40},"skip":true},{"start":{"line":282,"column":20},"end":{"line":283,"column":39},"skip":true}]},"20":{"line":288,"type":"if","locations":[{"start":{"line":288,"column":8},"end":{"line":288,"column":8},"skip":true},{"start":{"line":288,"column":8},"end":{"line":288,"column":8},"skip":true}]},"21":{"line":288,"type":"binary-expr","locations":[{"start":{"line":288,"column":12},"end":{"line":288,"column":40},"skip":true},{"start":{"line":288,"column":44},"end":{"line":288,"column":67},"skip":true}]},"22":{"line":292,"type":"binary-expr","locations":[{"start":{"line":292,"column":12},"end":{"line":292,"column":50},"skip":true},{"start":{"line":293,"column":12},"end":{"line":293,"column":53},"skip":true}]},"23":{"line":297,"type":"binary-expr","locations":[{"start":{"line":297,"column":12},"end":{"line":297,"column":66},"skip":true},{"start":{"line":298,"column":12},"end":{"line":301,"column":36},"skip":true}]},"24":{"line":303,"type":"binary-expr","locations":[{"start":{"line":303,"column":43},"end":{"line":303,"column":75},"skip":true},{"start":{"line":303,"column":79},"end":{"line":303,"column":81},"skip":true}]},"25":{"line":306,"type":"if","locations":[{"start":{"line":306,"column":8},"end":{"line":306,"column":8},"skip":true},{"start":{"line":306,"column":8},"end":{"line":306,"column":8},"skip":true}]},"26":{"line":310,"type":"if","locations":[{"start":{"line":310,"column":8},"end":{"line":310,"column":8},"skip":true},{"start":{"line":310,"column":8},"end":{"line":310,"column":8},"skip":true}]},"27":{"line":313,"type":"binary-expr","locations":[{"start":{"line":313,"column":27},"end":{"line":313,"column":43},"skip":true},{"start":{"line":313,"column":47},"end":{"line":313,"column":53},"skip":true}]},"28":{"line":317,"type":"if","locations":[{"start":{"line":317,"column":12},"end":{"line":317,"column":12},"skip":true},{"start":{"line":317,"column":12},"end":{"line":317,"column":12},"skip":true}]}},"code":["/*","example.js","","quickstart example","","instruction","    1. save this script as example.js","    2. run the shell command:","        $ npm install npmtest-catberry && PORT=8081 node example.js","    3. play with the browser-demo on http://127.0.0.1:8081","*/","","","","/* istanbul instrument in package npmtest_catberry */","/*jslint","    bitwise: true,","    browser: true,","    maxerr: 8,","    maxlen: 96,","    node: true,","    nomen: true,","    regexp: true,","    stupid: true","*/","(function () {","    'use strict';","    var local;","","","","    // run shared js-env code - init-before","    (function () {","        // init local","        local = {};","        // init modeJs","        local.modeJs = (function () {","            try {","                return typeof navigator.userAgent === 'string' &&","                    typeof document.querySelector('body') === 'object' &&","                    typeof XMLHttpRequest.prototype.open === 'function' &&","                    'browser';","            } catch (errorCaughtBrowser) {","                return module.exports &&","                    typeof process.versions.node === 'string' &&","                    typeof require('http').createServer === 'function' &&","                    'node';","            }","        }());","        // init global","        local.global = local.modeJs === 'browser'","            ? window","            : global;","        // init utility2_rollup","        local = local.global.utility2_rollup || (local.modeJs === 'browser'","            ? local.global.utility2_npmtest_catberry","            : global.utility2_moduleExports);","        // export local","        local.global.local = local;","    }());","    switch (local.modeJs) {","","","","    // init-after","    // run browser js-env code - init-after","    /* istanbul ignore next */","    case 'browser':","        local.testRunBrowser = function (event) {","            if (!event || (event &&","                    event.currentTarget &&","                    event.currentTarget.className &&","                    event.currentTarget.className.includes &&","                    event.currentTarget.className.includes('onreset'))) {","                // reset output","                Array.from(","                    document.querySelectorAll('body > .resettable')","                ).forEach(function (element) {","                    switch (element.tagName) {","                    case 'INPUT':","                    case 'TEXTAREA':","                        element.value = '';","                        break;","                    default:","                        element.textContent = '';","                    }","                });","            }","            switch (event && event.currentTarget && event.currentTarget.id) {","            case 'testRunButton1':","                // show tests","                if (document.querySelector('#testReportDiv1').style.display === 'none') {","                    document.querySelector('#testReportDiv1').style.display = 'block';","                    document.querySelector('#testRunButton1').textContent =","                        'hide internal test';","                    local.modeTest = true;","                    local.testRunDefault(local);","                // hide tests","                } else {","                    document.querySelector('#testReportDiv1').style.display = 'none';","                    document.querySelector('#testRunButton1').textContent = 'run internal test';","                }","                break;","            // custom-case","            default:","                break;","            }","            if (document.querySelector('#inputTextareaEval1') && (!event || (event &&","                    event.currentTarget &&","                    event.currentTarget.className &&","                    event.currentTarget.className.includes &&","                    event.currentTarget.className.includes('oneval')))) {","                // try to eval input-code","                try {","                    /*jslint evil: true*/","                    eval(document.querySelector('#inputTextareaEval1').value);","                } catch (errorCaught) {","                    console.error(errorCaught);","                }","            }","        };","        // log stderr and stdout to #outputTextareaStdout1","        ['error', 'log'].forEach(function (key) {","            console[key + '_original'] = console[key];","            console[key] = function () {","                var element;","                console[key + '_original'].apply(console, arguments);","                element = document.querySelector('#outputTextareaStdout1');","                if (!element) {","                    return;","                }","                // append text to #outputTextareaStdout1","                element.value += Array.from(arguments).map(function (arg) {","                    return typeof arg === 'string'","                        ? arg","                        : JSON.stringify(arg, null, 4);","                }).join(' ') + '\\n';","                // scroll textarea to bottom","                element.scrollTop = element.scrollHeight;","            };","        });","        // init event-handling","        ['change', 'click', 'keyup'].forEach(function (event) {","            Array.from(document.querySelectorAll('.on' + event)).forEach(function (element) {","                element.addEventListener(event, local.testRunBrowser);","            });","        });","        // run tests","        local.testRunBrowser();","        break;","","","","    // run node js-env code - init-after","    /* istanbul ignore next */","    case 'node':","        // export local","        module.exports = local;","        // require modules","        local.fs = require('fs');","        local.http = require('http');","        local.url = require('url');","        // init assets","        local.assetsDict = local.assetsDict || {};","        /* jslint-ignore-begin */","        local.assetsDict['/assets.index.template.html'] = '\\","<!doctype html>\\n\\","<html lang=\"en\">\\n\\","<head>\\n\\","<meta charset=\"UTF-8\">\\n\\","<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\\n\\","<title>{{env.npm_package_name}} (v{{env.npm_package_version}})</title>\\n\\","<style>\\n\\","/*csslint\\n\\","    box-sizing: false,\\n\\","    universal-selector: false\\n\\","*/\\n\\","* {\\n\\","    box-sizing: border-box;\\n\\","}\\n\\","body {\\n\\","    background: #dde;\\n\\","    font-family: Arial, Helvetica, sans-serif;\\n\\","    margin: 2rem;\\n\\","}\\n\\","body > * {\\n\\","    margin-bottom: 1rem;\\n\\","}\\n\\",".utility2FooterDiv {\\n\\","    margin-top: 20px;\\n\\","    text-align: center;\\n\\","}\\n\\","</style>\\n\\","<style>\\n\\","/*csslint\\n\\","*/\\n\\","textarea {\\n\\","    font-family: monospace;\\n\\","    height: 10rem;\\n\\","    width: 100%;\\n\\","}\\n\\","textarea[readonly] {\\n\\","    background: #ddd;\\n\\","}\\n\\","</style>\\n\\","</head>\\n\\","<body>\\n\\","<!-- utility2-comment\\n\\","<div id=\"ajaxProgressDiv1\" style=\"background: #d00; height: 2px; left: 0; margin: 0; padding: 0; position: fixed; top: 0; transition: background 0.5s, width 1.5s; width: 25%;\"></div>\\n\\","utility2-comment -->\\n\\","<h1>\\n\\","<!-- utility2-comment\\n\\","    <a\\n\\","        {{#if env.npm_package_homepage}}\\n\\","        href=\"{{env.npm_package_homepage}}\"\\n\\","        {{/if env.npm_package_homepage}}\\n\\","        target=\"_blank\"\\n\\","    >\\n\\","utility2-comment -->\\n\\","        {{env.npm_package_name}} (v{{env.npm_package_version}})\\n\\","<!-- utility2-comment\\n\\","    </a>\\n\\","utility2-comment -->\\n\\","</h1>\\n\\","<h3>{{env.npm_package_description}}</h3>\\n\\","<!-- utility2-comment\\n\\","<h4><a download href=\"assets.app.js\">download standalone app</a></h4>\\n\\","<button class=\"onclick onreset\" id=\"testRunButton1\">run internal test</button><br>\\n\\","<div id=\"testReportDiv1\" style=\"display: none;\"></div>\\n\\","utility2-comment -->\\n\\","\\n\\","\\n\\","\\n\\","<label>stderr and stdout</label>\\n\\","<textarea class=\"resettable\" id=\"outputTextareaStdout1\" readonly></textarea>\\n\\","<!-- utility2-comment\\n\\","{{#if isRollup}}\\n\\","<script src=\"assets.app.js\"></script>\\n\\","{{#unless isRollup}}\\n\\","utility2-comment -->\\n\\","<script src=\"assets.utility2.rollup.js\"></script>\\n\\","<script src=\"jsonp.utility2._stateInit?callback=window.utility2._stateInit\"></script>\\n\\","<script src=\"assets.npmtest_catberry.rollup.js\"></script>\\n\\","<script src=\"assets.example.js\"></script>\\n\\","<script src=\"assets.test.js\"></script>\\n\\","<!-- utility2-comment\\n\\","{{/if isRollup}}\\n\\","utility2-comment -->\\n\\","<div class=\"utility2FooterDiv\">\\n\\","    [ this app was created with\\n\\","    <a href=\"https://github.com/kaizhu256/node-utility2\" target=\"_blank\">utility2</a>\\n\\","    ]\\n\\","</div>\\n\\","</body>\\n\\","</html>\\n\\","';","        /* jslint-ignore-end */","        if (local.templateRender) {","            local.assetsDict['/'] = local.templateRender(","                local.assetsDict['/assets.index.template.html'],","                {","                    env: local.objectSetDefault(local.env, {","                        npm_package_description: 'the greatest app in the world!',","                        npm_package_name: 'my-app',","                        npm_package_nameAlias: 'my_app',","                        npm_package_version: '0.0.1'","                    })","                }","            );","        } else {","            local.assetsDict['/'] = local.assetsDict['/assets.index.template.html']","                .replace((/\\{\\{env\\.(\\w+?)\\}\\}/g), function (match0, match1) {","                    // jslint-hack","                    String(match0);","                    switch (match1) {","                    case 'npm_package_description':","                        return 'the greatest app in the world!';","                    case 'npm_package_name':","                        return 'my-app';","                    case 'npm_package_nameAlias':","                        return 'my_app';","                    case 'npm_package_version':","                        return '0.0.1';","                    }","                });","        }","        // run the cli","        if (local.global.utility2_rollup || module !== require.main) {","            break;","        }","        local.assetsDict['/assets.example.js'] =","            local.assetsDict['/assets.example.js'] ||","            local.fs.readFileSync(__filename, 'utf8');","        // bug-workaround - long $npm_package_buildCustomOrg","        /* jslint-ignore-begin */","        local.assetsDict['/assets.npmtest_catberry.rollup.js'] =","            local.assetsDict['/assets.npmtest_catberry.rollup.js'] ||","            local.fs.readFileSync(","                local.npmtest_catberry.__dirname + '/lib.npmtest_catberry.js',","                'utf8'","            ).replace((/^#!/), '//');","        /* jslint-ignore-end */","        local.assetsDict['/favicon.ico'] = local.assetsDict['/favicon.ico'] || '';","        // if $npm_config_timeout_exit exists,","        // then exit this process after $npm_config_timeout_exit ms","        if (Number(process.env.npm_config_timeout_exit)) {","            setTimeout(process.exit, Number(process.env.npm_config_timeout_exit));","        }","        // start server","        if (local.global.utility2_serverHttp1) {","            break;","        }","        process.env.PORT = process.env.PORT || '8081';","        console.error('server starting on port ' + process.env.PORT);","        local.http.createServer(function (request, response) {","            request.urlParsed = local.url.parse(request.url);","            if (local.assetsDict[request.urlParsed.pathname] !== undefined) {","                response.end(local.assetsDict[request.urlParsed.pathname]);","                return;","            }","            response.statusCode = 404;","            response.end();","        }).listen(process.env.PORT);","        break;","    }","}());",""],"l":{"26":2,"28":2,"33":2,"35":2,"37":2,"38":2,"39":2,"44":1,"51":2,"55":2,"59":2,"61":2,"69":1,"70":2,"76":2,"79":2,"82":2,"83":2,"85":1,"89":2,"92":1,"93":1,"94":1,"96":1,"97":1,"100":1,"101":1,"103":1,"106":1,"108":2,"114":1,"116":1,"118":1,"123":1,"124":2,"125":2,"126":3,"127":3,"128":3,"129":3,"130":1,"133":3,"134":3,"139":3,"143":1,"144":3,"145":1,"149":1,"150":1,"158":1,"160":1,"161":1,"162":1,"164":1,"166":1,"258":1,"259":1,"271":1,"274":6,"275":6,"277":1,"279":2,"281":1,"283":2,"288":1,"289":1,"291":1,"296":1,"303":1,"306":1,"307":1,"310":1,"311":1,"313":1,"314":1,"315":1,"316":1,"317":1,"318":1,"319":1,"321":1,"322":1,"324":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/index.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":47}}},"branchMap":{},"code":["'use strict';","","module.exports = require('./lib/Bootstrapper');",""],"l":{"3":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/Bootstrapper.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/Bootstrapper.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":1},"b":{"1":[1,1]},"f":{"1":1,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":28,"loc":{"start":{"line":28,"column":12},"end":{"line":28,"column":15}}},"2":{"name":"(anonymous_2)","line":37,"loc":{"start":{"line":37,"column":10},"end":{"line":37,"column":34}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":29}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":53}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":67}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":49}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":72}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":74}},"7":{"start":{"line":9,"column":0},"end":{"line":9,"column":53}},"8":{"start":{"line":10,"column":0},"end":{"line":10,"column":61}},"9":{"start":{"line":11,"column":0},"end":{"line":11,"column":60}},"10":{"start":{"line":12,"column":0},"end":{"line":12,"column":39}},"11":{"start":{"line":14,"column":0},"end":{"line":14,"column":21}},"12":{"start":{"line":16,"column":0},"end":{"line":20,"column":1}},"13":{"start":{"line":17,"column":1},"end":{"line":17,"column":64}},"14":{"start":{"line":21,"column":0},"end":{"line":21,"column":42}},"15":{"start":{"line":29,"column":2},"end":{"line":29,"column":18}},"16":{"start":{"line":38,"column":2},"end":{"line":38,"column":41}},"17":{"start":{"line":40,"column":2},"end":{"line":40,"column":55}},"18":{"start":{"line":41,"column":2},"end":{"line":41,"column":59}},"19":{"start":{"line":42,"column":2},"end":{"line":42,"column":51}},"20":{"start":{"line":44,"column":2},"end":{"line":44,"column":71}},"21":{"start":{"line":45,"column":2},"end":{"line":45,"column":73}},"22":{"start":{"line":46,"column":2},"end":{"line":46,"column":53}},"23":{"start":{"line":47,"column":2},"end":{"line":47,"column":61}},"24":{"start":{"line":49,"column":2},"end":{"line":51,"column":4}},"25":{"start":{"line":50,"column":3},"end":{"line":50,"column":63}},"26":{"start":{"line":55,"column":0},"end":{"line":55,"column":36}}},"branchMap":{"1":{"line":21,"type":"binary-expr","locations":[{"start":{"line":21,"column":19},"end":{"line":21,"column":35}},{"start":{"line":21,"column":39},"end":{"line":21,"column":41}}]}},"code":["'use strict';","","const path = require('path');","const StoreDispatcher = require('./StoreDispatcher');","const ModuleApiProvider = require('./providers/ModuleApiProvider');","const CookieWrapper = require('./CookieWrapper');","const BrowserBundleBuilder = require('./builders/BrowserBundleBuilder');","const AppDefinitionsBuilder = require('./builders/AppDefinitionsBuilder');","const StoreFinder = require('./finders/StoreFinder');","const ComponentFinder = require('./finders/ComponentFinder');","const BootstrapperBase = require('./base/BootstrapperBase');","const Catberry = require('./Catberry');","","var routeDefinitions;","// try to load list of URI mappers","try {","\trouteDefinitions = require(path.join(process.cwd(), 'routes'));","} catch (e) {","\t// nothing to do here","}","routeDefinitions = routeDefinitions || [];","","class Bootstrapper extends BootstrapperBase {","","\t/**","\t * Creates a new instance of the server-side Catberry's bootstrapper.","\t */","\tconstructor() {","\t\tsuper(Catberry);","\t}","","\t/**","\t * Configures a Catberry's locator.","\t * @param {Object} configObject Config object.","\t * @param {ServiceLocator} locator Service locator to configure.","\t */","\tconfigure(configObject, locator) {","\t\tsuper.configure(configObject, locator);","","\t\tlocator.register('storeDispatcher', StoreDispatcher);","\t\tlocator.register('moduleApiProvider', ModuleApiProvider);","\t\tlocator.register('cookieWrapper', CookieWrapper);","","\t\tlocator.register('browserBundleBuilder', BrowserBundleBuilder, true);","\t\tlocator.register('appDefinitionsBuilder', AppDefinitionsBuilder, true);","\t\tlocator.register('storeFinder', StoreFinder, true);","\t\tlocator.register('componentFinder', ComponentFinder, true);","","\t\trouteDefinitions.forEach(routeDefinition =>","\t\t\tlocator.registerInstance('routeDefinition', routeDefinition)","\t\t);","\t}","}","","module.exports = new Bootstrapper();",""],"l":{"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"14":1,"16":1,"17":1,"21":1,"29":1,"38":0,"40":0,"41":0,"42":0,"44":0,"45":0,"46":0,"47":0,"49":0,"50":0,"55":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/StoreDispatcher.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/StoreDispatcher.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"fnMap":{"1":{"name":"(anonymous_1)","line":15,"loc":{"start":{"line":15,"column":12},"end":{"line":15,"column":22}}},"2":{"name":"(anonymous_2)","line":86,"loc":{"start":{"line":86,"column":13},"end":{"line":86,"column":25}}},"3":{"name":"(anonymous_3)","line":136,"loc":{"start":{"line":136,"column":11},"end":{"line":136,"column":41}}},"4":{"name":"(anonymous_4)","line":169,"loc":{"start":{"line":169,"column":9},"end":{"line":169,"column":36}}},"5":{"name":"(anonymous_5)","line":257,"loc":{"start":{"line":257,"column":17},"end":{"line":257,"column":29}}},"6":{"name":"(anonymous_6)","line":309,"loc":{"start":{"line":309,"column":9},"end":{"line":309,"column":21}}},"7":{"name":"(anonymous_7)","line":343,"loc":{"start":{"line":343,"column":20},"end":{"line":343,"column":27}}},"8":{"name":"(anonymous_8)","line":351,"loc":{"start":{"line":351,"column":12},"end":{"line":351,"column":15}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":49}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":55}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":59}},"4":{"start":{"line":7,"column":0},"end":{"line":7,"column":31}},"5":{"start":{"line":22,"column":2},"end":{"line":22,"column":33}},"6":{"start":{"line":29,"column":2},"end":{"line":29,"column":53}},"7":{"start":{"line":36,"column":2},"end":{"line":36,"column":47}},"8":{"start":{"line":43,"column":2},"end":{"line":43,"column":45}},"9":{"start":{"line":50,"column":2},"end":{"line":50,"column":39}},"10":{"start":{"line":57,"column":2},"end":{"line":57,"column":25}},"11":{"start":{"line":64,"column":2},"end":{"line":64,"column":41}},"12":{"start":{"line":71,"column":2},"end":{"line":71,"column":44}},"13":{"start":{"line":78,"column":2},"end":{"line":78,"column":35}},"14":{"start":{"line":87,"column":2},"end":{"line":89,"column":3}},"15":{"start":{"line":88,"column":3},"end":{"line":88,"column":29}},"16":{"start":{"line":90,"column":2},"end":{"line":92,"column":3}},"17":{"start":{"line":91,"column":3},"end":{"line":91,"column":32}},"18":{"start":{"line":93,"column":2},"end":{"line":99,"column":3}},"19":{"start":{"line":94,"column":3},"end":{"line":94,"column":70}},"20":{"start":{"line":95,"column":3},"end":{"line":97,"column":4}},"21":{"start":{"line":96,"column":4},"end":{"line":96,"column":59}},"22":{"start":{"line":98,"column":3},"end":{"line":98,"column":36}},"23":{"start":{"line":100,"column":2},"end":{"line":102,"column":5}},"24":{"start":{"line":104,"column":2},"end":{"line":104,"column":41}},"25":{"start":{"line":105,"column":2},"end":{"line":107,"column":3}},"26":{"start":{"line":106,"column":3},"end":{"line":106,"column":46}},"27":{"start":{"line":109,"column":2},"end":{"line":111,"column":20}},"28":{"start":{"line":113,"column":2},"end":{"line":126,"column":6}},"29":{"start":{"line":115,"column":4},"end":{"line":119,"column":6}},"30":{"start":{"line":120,"column":4},"end":{"line":124,"column":7}},"31":{"start":{"line":125,"column":4},"end":{"line":125,"column":16}},"32":{"start":{"line":137,"column":2},"end":{"line":139,"column":3}},"33":{"start":{"line":138,"column":3},"end":{"line":138,"column":29}},"34":{"start":{"line":140,"column":2},"end":{"line":144,"column":4}},"35":{"start":{"line":145,"column":2},"end":{"line":145,"column":51}},"36":{"start":{"line":147,"column":2},"end":{"line":147,"column":41}},"37":{"start":{"line":148,"column":2},"end":{"line":150,"column":3}},"38":{"start":{"line":149,"column":3},"end":{"line":149,"column":46}},"39":{"start":{"line":152,"column":2},"end":{"line":154,"column":4}},"40":{"start":{"line":155,"column":2},"end":{"line":159,"column":6}},"41":{"start":{"line":155,"column":43},"end":{"line":155,"column":61}},"42":{"start":{"line":157,"column":4},"end":{"line":157,"column":53}},"43":{"start":{"line":158,"column":4},"end":{"line":158,"column":18}},"44":{"start":{"line":170,"column":2},"end":{"line":170,"column":49}},"45":{"start":{"line":172,"column":2},"end":{"line":172,"column":54}},"46":{"start":{"line":173,"column":2},"end":{"line":173,"column":49}},"47":{"start":{"line":174,"column":2},"end":{"line":178,"column":5}},"48":{"start":{"line":175,"column":3},"end":{"line":177,"column":4}},"49":{"start":{"line":176,"column":4},"end":{"line":176,"column":100}},"50":{"start":{"line":180,"column":2},"end":{"line":184,"column":3}},"51":{"start":{"line":181,"column":3},"end":{"line":181,"column":44}},"52":{"start":{"line":182,"column":3},"end":{"line":182,"column":32}},"53":{"start":{"line":183,"column":3},"end":{"line":183,"column":13}},"54":{"start":{"line":187,"column":2},"end":{"line":187,"column":38}},"55":{"start":{"line":189,"column":2},"end":{"line":193,"column":6}},"56":{"start":{"line":190,"column":24},"end":{"line":190,"column":50}},"57":{"start":{"line":192,"column":4},"end":{"line":192,"column":25}},"58":{"start":{"line":195,"column":2},"end":{"line":220,"column":6}},"59":{"start":{"line":198,"column":4},"end":{"line":201,"column":5}},"60":{"start":{"line":199,"column":5},"end":{"line":199,"column":31}},"61":{"start":{"line":200,"column":5},"end":{"line":200,"column":12}},"62":{"start":{"line":204,"column":4},"end":{"line":204,"column":71}},"63":{"start":{"line":205,"column":4},"end":{"line":205,"column":69}},"64":{"start":{"line":207,"column":4},"end":{"line":210,"column":5}},"65":{"start":{"line":208,"column":5},"end":{"line":208,"column":31}},"66":{"start":{"line":209,"column":5},"end":{"line":209,"column":12}},"67":{"start":{"line":212,"column":4},"end":{"line":219,"column":7}},"68":{"start":{"line":213,"column":5},"end":{"line":217,"column":6}},"69":{"start":{"line":215,"column":6},"end":{"line":215,"column":32}},"70":{"start":{"line":216,"column":6},"end":{"line":216,"column":19}},"71":{"start":{"line":218,"column":5},"end":{"line":218,"column":17}},"72":{"start":{"line":222,"column":2},"end":{"line":222,"column":31}},"73":{"start":{"line":223,"column":2},"end":{"line":229,"column":3}},"74":{"start":{"line":224,"column":3},"end":{"line":224,"column":44}},"75":{"start":{"line":225,"column":3},"end":{"line":228,"column":7}},"76":{"start":{"line":227,"column":5},"end":{"line":227,"column":81}},"77":{"start":{"line":231,"column":2},"end":{"line":231,"column":48}},"78":{"start":{"line":232,"column":2},"end":{"line":242,"column":6}},"79":{"start":{"line":234,"column":4},"end":{"line":234,"column":43}},"80":{"start":{"line":235,"column":4},"end":{"line":237,"column":5}},"81":{"start":{"line":236,"column":5},"end":{"line":236,"column":12}},"82":{"start":{"line":238,"column":4},"end":{"line":241,"column":8}},"83":{"start":{"line":240,"column":6},"end":{"line":240,"column":37}},"84":{"start":{"line":244,"column":2},"end":{"line":247,"column":5}},"85":{"start":{"line":248,"column":2},"end":{"line":248,"column":40}},"86":{"start":{"line":258,"column":2},"end":{"line":258,"column":64}},"87":{"start":{"line":259,"column":2},"end":{"line":259,"column":65}},"88":{"start":{"line":260,"column":2},"end":{"line":262,"column":4}},"89":{"start":{"line":264,"column":2},"end":{"line":281,"column":4}},"90":{"start":{"line":265,"column":3},"end":{"line":265,"column":38}},"91":{"start":{"line":266,"column":3},"end":{"line":266,"column":30}},"92":{"start":{"line":268,"column":3},"end":{"line":279,"column":4}},"93":{"start":{"line":269,"column":4},"end":{"line":269,"column":37}},"94":{"start":{"line":270,"column":4},"end":{"line":272,"column":5}},"95":{"start":{"line":271,"column":5},"end":{"line":271,"column":14}},"96":{"start":{"line":273,"column":4},"end":{"line":273,"column":27}},"97":{"start":{"line":274,"column":4},"end":{"line":276,"column":5}},"98":{"start":{"line":275,"column":5},"end":{"line":275,"column":72}},"99":{"start":{"line":277,"column":4},"end":{"line":277,"column":35}},"100":{"start":{"line":278,"column":4},"end":{"line":278,"column":49}},"101":{"start":{"line":280,"column":3},"end":{"line":280,"column":30}},"102":{"start":{"line":283,"column":2},"end":{"line":285,"column":38}},"103":{"start":{"line":283,"column":49},"end":{"line":285,"column":37}},"104":{"start":{"line":287,"column":2},"end":{"line":292,"column":4}},"105":{"start":{"line":288,"column":3},"end":{"line":290,"column":4}},"106":{"start":{"line":289,"column":4},"end":{"line":289,"column":49}},"107":{"start":{"line":291,"column":3},"end":{"line":291,"column":44}},"108":{"start":{"line":293,"column":2},"end":{"line":298,"column":4}},"109":{"start":{"line":294,"column":3},"end":{"line":296,"column":4}},"110":{"start":{"line":295,"column":4},"end":{"line":295,"column":11}},"111":{"start":{"line":297,"column":3},"end":{"line":297,"column":44}},"112":{"start":{"line":299,"column":2},"end":{"line":299,"column":94}},"113":{"start":{"line":299,"column":55},"end":{"line":299,"column":93}},"114":{"start":{"line":301,"column":2},"end":{"line":301,"column":22}},"115":{"start":{"line":310,"column":2},"end":{"line":312,"column":3}},"116":{"start":{"line":311,"column":3},"end":{"line":311,"column":15}},"117":{"start":{"line":313,"column":2},"end":{"line":313,"column":48}},"118":{"start":{"line":314,"column":2},"end":{"line":316,"column":3}},"119":{"start":{"line":315,"column":3},"end":{"line":315,"column":16}},"120":{"start":{"line":318,"column":2},"end":{"line":318,"column":54}},"121":{"start":{"line":319,"column":2},"end":{"line":319,"column":56}},"122":{"start":{"line":320,"column":2},"end":{"line":322,"column":3}},"123":{"start":{"line":321,"column":3},"end":{"line":321,"column":15}},"124":{"start":{"line":324,"column":2},"end":{"line":324,"column":61}},"125":{"start":{"line":325,"column":2},"end":{"line":325,"column":77}},"126":{"start":{"line":326,"column":2},"end":{"line":326,"column":83}},"127":{"start":{"line":327,"column":2},"end":{"line":327,"column":85}},"128":{"start":{"line":329,"column":2},"end":{"line":334,"column":5}},"129":{"start":{"line":330,"column":3},"end":{"line":332,"column":5}},"130":{"start":{"line":333,"column":3},"end":{"line":333,"column":50}},"131":{"start":{"line":335,"column":2},"end":{"line":335,"column":41}},"132":{"start":{"line":344,"column":2},"end":{"line":344,"column":64}},"133":{"start":{"line":352,"column":2},"end":{"line":352,"column":77}},"134":{"start":{"line":356,"column":0},"end":{"line":356,"column":33}}},"branchMap":{"1":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":2},"end":{"line":87,"column":2}},{"start":{"line":87,"column":2},"end":{"line":87,"column":2}}]},"2":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":2},"end":{"line":90,"column":2}},{"start":{"line":90,"column":2},"end":{"line":90,"column":2}}]},"3":{"line":93,"type":"if","locations":[{"start":{"line":93,"column":2},"end":{"line":93,"column":2}},{"start":{"line":93,"column":2},"end":{"line":93,"column":2}}]},"4":{"line":95,"type":"if","locations":[{"start":{"line":95,"column":3},"end":{"line":95,"column":3}},{"start":{"line":95,"column":3},"end":{"line":95,"column":3}}]},"5":{"line":105,"type":"if","locations":[{"start":{"line":105,"column":2},"end":{"line":105,"column":2}},{"start":{"line":105,"column":2},"end":{"line":105,"column":2}}]},"6":{"line":109,"type":"cond-expr","locations":[{"start":{"line":110,"column":3},"end":{"line":110,"column":18}},{"start":{"line":111,"column":3},"end":{"line":111,"column":19}}]},"7":{"line":137,"type":"if","locations":[{"start":{"line":137,"column":2},"end":{"line":137,"column":2}},{"start":{"line":137,"column":2},"end":{"line":137,"column":2}}]},"8":{"line":148,"type":"if","locations":[{"start":{"line":148,"column":2},"end":{"line":148,"column":2}},{"start":{"line":148,"column":2},"end":{"line":148,"column":2}}]},"9":{"line":170,"type":"binary-expr","locations":[{"start":{"line":170,"column":15},"end":{"line":170,"column":25}},{"start":{"line":170,"column":29},"end":{"line":170,"column":48}}]},"10":{"line":175,"type":"if","locations":[{"start":{"line":175,"column":3},"end":{"line":175,"column":3}},{"start":{"line":175,"column":3},"end":{"line":175,"column":3}}]},"11":{"line":180,"type":"if","locations":[{"start":{"line":180,"column":2},"end":{"line":180,"column":2}},{"start":{"line":180,"column":2},"end":{"line":180,"column":2}}]},"12":{"line":198,"type":"if","locations":[{"start":{"line":198,"column":4},"end":{"line":198,"column":4}},{"start":{"line":198,"column":4},"end":{"line":198,"column":4}}]},"13":{"line":207,"type":"if","locations":[{"start":{"line":207,"column":4},"end":{"line":207,"column":4}},{"start":{"line":207,"column":4},"end":{"line":207,"column":4}}]},"14":{"line":213,"type":"if","locations":[{"start":{"line":213,"column":5},"end":{"line":213,"column":5}},{"start":{"line":213,"column":5},"end":{"line":213,"column":5}}]},"15":{"line":223,"type":"if","locations":[{"start":{"line":223,"column":2},"end":{"line":223,"column":2}},{"start":{"line":223,"column":2},"end":{"line":223,"column":2}}]},"16":{"line":235,"type":"if","locations":[{"start":{"line":235,"column":4},"end":{"line":235,"column":4}},{"start":{"line":235,"column":4},"end":{"line":235,"column":4}}]},"17":{"line":261,"type":"binary-expr","locations":[{"start":{"line":261,"column":26},"end":{"line":261,"column":52}},{"start":{"line":261,"column":56},"end":{"line":261,"column":75}}]},"18":{"line":270,"type":"if","locations":[{"start":{"line":270,"column":4},"end":{"line":270,"column":4}},{"start":{"line":270,"column":4},"end":{"line":270,"column":4}}]},"19":{"line":274,"type":"if","locations":[{"start":{"line":274,"column":4},"end":{"line":274,"column":4}},{"start":{"line":274,"column":4},"end":{"line":274,"column":4}}]},"20":{"line":283,"type":"cond-expr","locations":[{"start":{"line":284,"column":3},"end":{"line":284,"column":24}},{"start":{"line":285,"column":3},"end":{"line":285,"column":37}}]},"21":{"line":288,"type":"if","locations":[{"start":{"line":288,"column":3},"end":{"line":288,"column":3}},{"start":{"line":288,"column":3},"end":{"line":288,"column":3}}]},"22":{"line":294,"type":"if","locations":[{"start":{"line":294,"column":3},"end":{"line":294,"column":3}},{"start":{"line":294,"column":3},"end":{"line":294,"column":3}}]},"23":{"line":310,"type":"if","locations":[{"start":{"line":310,"column":2},"end":{"line":310,"column":2}},{"start":{"line":310,"column":2},"end":{"line":310,"column":2}}]},"24":{"line":314,"type":"if","locations":[{"start":{"line":314,"column":2},"end":{"line":314,"column":2}},{"start":{"line":314,"column":2},"end":{"line":314,"column":2}}]},"25":{"line":320,"type":"if","locations":[{"start":{"line":320,"column":2},"end":{"line":320,"column":2}},{"start":{"line":320,"column":2},"end":{"line":320,"column":2}}]}},"code":["'use strict';","","const SerialWrapper = require('./SerialWrapper');","const moduleHelper = require('./helpers/moduleHelper');","const propertyHelper = require('./helpers/propertyHelper');","","const DEFAULT_LIFETIME = 60000;","","class StoreDispatcher {","","\t/**","\t * Creates a new instance of the store dispatcher.","\t * @param {ServiceLocator} locator Locator for resolving dependencies.","\t */","\tconstructor(locator) {","","\t\t/**","\t\t * Current service locator.","\t\t * @type {ServiceLocator}","\t\t * @private","\t\t */","\t\tthis._serviceLocator = locator;","","\t\t/**","\t\t * Current store loader.","\t\t * @type {StoreLoader}","\t\t * @private","\t\t */","\t\tthis._storeLoader = locator.resolve('storeLoader');","","\t\t/**","\t\t * Current event bus.","\t\t * @type {EventEmitter}","\t\t * @private","\t\t */","\t\tthis._eventBus = locator.resolve('eventBus');","","\t\t/**","\t\t * Current map of all store instances.","\t\t * @type {null}","\t\t * @private","\t\t */","\t\tthis._storeInstances = Object.create(null);","","\t\t/**","\t\t * Current map of last data for each store.","\t\t * @type {Object}","\t\t * @private","\t\t */","\t\tthis._lastData = Object.create(null);","","\t\t/**","\t\t * Current map of last state of store dispatcher.","\t\t * @type {Object}","\t\t * @private","\t\t */","\t\tthis._lastState = null;","","\t\t/**","\t\t * Current set of store dependency graph.","\t\t * @type {Object}","\t\t * @private","\t\t */","\t\tthis._dependants = Object.create(null);","","\t\t/**","\t\t * Current serial wrapper.","\t\t * @type {SerialWrapper}","\t\t * @private","\t\t */","\t\tthis._serialWrapper = new SerialWrapper();","","\t\t/**","\t\t * Current basic context for all store contexts.","\t\t * @type {Object}","\t\t * @private","\t\t */","\t\tthis._currentBasicContext = null;","\t}","","\t/**","\t * Gets store data and creates a store instance if required.","\t * @param {string} storeName Name of store.","\t * @returns {Object} Store's data.","\t */","\tgetStoreData(storeName) {","\t\tif (!this._lastState) {","\t\t\treturn this._errorState();","\t\t}","\t\tif (typeof (storeName) !== 'string') {","\t\t\treturn Promise.resolve(null);","\t\t}","\t\tif (storeName in this._lastData) {","\t\t\tconst existTime = Date.now() - this._lastData[storeName].createdAt;","\t\t\tif (existTime <= this._lastData[storeName].lifetime) {","\t\t\t\treturn Promise.resolve(this._lastData[storeName].data);","\t\t\t}","\t\t\tdelete this._lastData[storeName];","\t\t}","\t\tthis._eventBus.emit('storeDataLoad', {","\t\t\tname: storeName","\t\t});","","\t\tconst store = this.getStore(storeName);","\t\tif (!store) {","\t\t\treturn this._errorStoreNotFound(storeName);","\t\t}","","\t\tconst lifetime = typeof (store.$lifetime) === 'number' ?","\t\t\tstore.$lifetime :","\t\t\tDEFAULT_LIFETIME;","","\t\treturn this._serialWrapper.invoke(storeName)","\t\t\t.then(data => {","\t\t\t\tthis._lastData[storeName] = {","\t\t\t\t\tdata,","\t\t\t\t\tlifetime,","\t\t\t\t\tcreatedAt: Date.now()","\t\t\t\t};","\t\t\t\tthis._eventBus.emit('storeDataLoaded', {","\t\t\t\t\tname: storeName,","\t\t\t\t\tdata,","\t\t\t\t\tlifetime","\t\t\t\t});","\t\t\t\treturn data;","\t\t\t});","\t}","","\t/**","\t * Sends an action to the specified store and resolves promises in the serial mode.","\t * @param {string} storeName Name of the store.","\t * @param {string} actionName Name of the action.","\t * @param {Object} args Action arguments.","\t * @returns {Promise<*>} Promise for an action handling result.","\t */","\tsendAction(storeName, actionName, args) {","\t\tif (!this._lastState) {","\t\t\treturn this._errorState();","\t\t}","\t\tconst actionDetails = {","\t\t\tstoreName,","\t\t\tactionName,","\t\t\targs","\t\t};","\t\tthis._eventBus.emit('actionSend', actionDetails);","","\t\tconst store = this.getStore(storeName);","\t\tif (!store) {","\t\t\treturn this._errorStoreNotFound(storeName);","\t\t}","","\t\tconst handleMethod = moduleHelper.getMethodToInvoke(","\t\t\tstore, 'handle', actionName","\t\t);","\t\treturn moduleHelper.getSafePromise(() => handleMethod(args))","\t\t\t.then(result => {","\t\t\t\tthis._eventBus.emit('actionSent', actionDetails);","\t\t\t\treturn result;","\t\t\t});","\t}","","\t/**","\t * Sets a new state to the store dispatcher and invokes the \"changed\" method for all","\t * stores which state has been changed.","\t * @param {Object} parameters Map of new parameters.","\t * @param {Object} basicContext Basic context for all stores.","\t * @returns {Array<string>} Names of stores that have been changed.","\t */","\tsetState(parameters, basicContext) {","\t\tparameters = parameters || Object.create(null);","","\t\tconst stores = this._storeLoader.getStoresByNames();","\t\tconst parameterNames = Object.keys(parameters);","\t\tparameterNames.forEach(storeName => {","\t\t\tif (!(storeName in stores)) {","\t\t\t\tthis._eventBus.emit('warn', `Store \"${storeName}\" does not exist (might be a typo in a route)`);","\t\t\t}","\t\t});","","\t\tif (!this._lastState) {","\t\t\tthis._currentBasicContext = basicContext;","\t\t\tthis._lastState = parameters;","\t\t\treturn [];","\t\t}","","\t\t// some store's parameters can be removed since last time","\t\tconst changed = Object.create(null);","","\t\tObject.keys(this._lastState)","\t\t\t.filter(storeName => !(storeName in parameters))","\t\t\t.forEach(name => {","\t\t\t\tchanged[name] = true;","\t\t\t});","","\t\tparameterNames","\t\t\t.forEach(storeName => {","\t\t\t\t// new parameters were set for store","\t\t\t\tif (!(storeName in this._lastState)) {","\t\t\t\t\tchanged[storeName] = true;","\t\t\t\t\treturn;","\t\t\t\t}","","\t\t\t\t// new and last parameters has different values","\t\t\t\tconst lastParameterNames = Object.keys(this._lastState[storeName]);","\t\t\t\tconst currentParameterNames = Object.keys(parameters[storeName]);","","\t\t\t\tif (currentParameterNames.length !== lastParameterNames.length) {","\t\t\t\t\tchanged[storeName] = true;","\t\t\t\t\treturn;","\t\t\t\t}","","\t\t\t\tcurrentParameterNames.every(parameterName => {","\t\t\t\t\tif (parameters[storeName][parameterName] !==","\t\t\t\t\t\tthis._lastState[storeName][parameterName]) {","\t\t\t\t\t\tchanged[storeName] = true;","\t\t\t\t\t\treturn false;","\t\t\t\t\t}","\t\t\t\t\treturn true;","\t\t\t\t});","\t\t\t});","","\t\tthis._lastState = parameters;","\t\tif (this._currentBasicContext !== basicContext) {","\t\t\tthis._currentBasicContext = basicContext;","\t\t\tObject.keys(this._storeInstances)","\t\t\t\t.forEach(storeName => {","\t\t\t\t\tthis._storeInstances[storeName].$context = this._getStoreContext(storeName);","\t\t\t\t});","\t\t}","","\t\tconst changedStoreNames = Object.create(null);","\t\tObject.keys(changed)","\t\t\t.forEach(storeName => {","\t\t\t\tconst store = this.getStore(storeName);","\t\t\t\tif (!store) {","\t\t\t\t\treturn;","\t\t\t\t}","\t\t\t\tstore.$context.changed()","\t\t\t\t\t.forEach(name => {","\t\t\t\t\t\tchangedStoreNames[name] = true;","\t\t\t\t\t});","\t\t\t});","","\t\tthis._eventBus.emit('stateChanged', {","\t\t\toldState: this._lastState,","\t\t\tnewState: parameters","\t\t});","\t\treturn Object.keys(changedStoreNames);","\t}","","\t/**","\t * Gets a context for a store using component's context as a prototype.","\t * @param {string} storeName Name of the store.","\t * @returns {Object} Store context.","\t * @private","\t */","\t_getStoreContext(storeName) {","\t\tconst storeContext = Object.create(this._currentBasicContext);","\t\tpropertyHelper.defineReadOnly(storeContext, 'name', storeName);","\t\tpropertyHelper.defineReadOnly(","\t\t\tstoreContext, 'state', this._lastState[storeName] || Object.create(null)","\t\t);","","\t\tstoreContext.changed = () => {","\t\t\tconst walked = Object.create(null);","\t\t\tvar toChange = [storeName];","","\t\t\twhile (toChange.length > 0) {","\t\t\t\tconst current = toChange.shift();","\t\t\t\tif (current in walked) {","\t\t\t\t\tcontinue;","\t\t\t\t}","\t\t\t\twalked[current] = true;","\t\t\t\tif (current in this._dependants) {","\t\t\t\t\ttoChange = toChange.concat(Object.keys(this._dependants[current]));","\t\t\t\t}","\t\t\t\tdelete this._lastData[current];","\t\t\t\tthis._eventBus.emit('storeChanged', current);","\t\t\t}","\t\t\treturn Object.keys(walked);","\t\t};","","\t\tstoreContext.getStoreData = sourceStoreName => sourceStoreName === storeName ?","\t\t\tPromise.resolve(null) :","\t\t\tthis.getStoreData(sourceStoreName);","","\t\tstoreContext.setDependency = name => {","\t\t\tif (!(name in this._dependants)) {","\t\t\t\tthis._dependants[name] = Object.create(null);","\t\t\t}","\t\t\tthis._dependants[name][storeName] = true;","\t\t};","\t\tstoreContext.unsetDependency = name => {","\t\t\tif (!(name in this._dependants)) {","\t\t\t\treturn;","\t\t\t}","\t\t\tdelete this._dependants[name][storeName];","\t\t};","\t\tstoreContext.sendAction = (storeName, name, args) => this.sendAction(storeName, name, args);","","\t\treturn storeContext;","\t}","","\t/**","\t * Gets a store instance and creates it if required.","\t * @param {string} storeName Name of the store.","\t * @returns {Promise<Object>} Promise for the store.","\t */","\tgetStore(storeName) {","\t\tif (!storeName) {","\t\t\treturn null;","\t\t}","\t\tconst store = this._storeInstances[storeName];","\t\tif (store) {","\t\t\treturn store;","\t\t}","","\t\tconst stores = this._storeLoader.getStoresByNames();","\t\tconst config = this._serviceLocator.resolve('config');","\t\tif (!(storeName in stores)) {","\t\t\treturn null;","\t\t}","","\t\tconst ComponentConstructor = stores[storeName].constructor;","\t\tComponentConstructor.prototype.$context = this._getStoreContext(storeName);","\t\tthis._storeInstances[storeName] = new ComponentConstructor(this._serviceLocator);","\t\tthis._storeInstances[storeName].$context = ComponentConstructor.prototype.$context;","","\t\tthis._serialWrapper.add(storeName, () => {","\t\t\tconst loadMethod = moduleHelper.getMethodToInvoke(","\t\t\t\tthis._storeInstances[storeName], 'load'","\t\t\t);","\t\t\treturn moduleHelper.getSafePromise(loadMethod);","\t\t});","\t\treturn this._storeInstances[storeName];","\t}","","\t/**","\t * Returns an error message about a not found store.","\t * @param  {string} name The store name.","\t * @return {Promise<Error>} The promise for the error.","\t */","\t_errorStoreNotFound(name) {","\t\treturn Promise.reject(new Error(`Store \"${name}\" not found`));","\t}","","\t/**","\t * Returns an error message about an uninitialized state.","\t * @return {Promise<Error>} The promise for the error.","\t */","\t_errorState() {","\t\treturn Promise.reject(new Error('State should be set before any request'));","\t}","}","","module.exports = StoreDispatcher;",""],"l":{"3":1,"4":1,"5":1,"7":1,"22":0,"29":0,"36":0,"43":0,"50":0,"57":0,"64":0,"71":0,"78":0,"87":0,"88":0,"90":0,"91":0,"93":0,"94":0,"95":0,"96":0,"98":0,"100":0,"104":0,"105":0,"106":0,"109":0,"113":0,"115":0,"120":0,"125":0,"137":0,"138":0,"140":0,"145":0,"147":0,"148":0,"149":0,"152":0,"155":0,"157":0,"158":0,"170":0,"172":0,"173":0,"174":0,"175":0,"176":0,"180":0,"181":0,"182":0,"183":0,"187":0,"189":0,"190":0,"192":0,"195":0,"198":0,"199":0,"200":0,"204":0,"205":0,"207":0,"208":0,"209":0,"212":0,"213":0,"215":0,"216":0,"218":0,"222":0,"223":0,"224":0,"225":0,"227":0,"231":0,"232":0,"234":0,"235":0,"236":0,"238":0,"240":0,"244":0,"248":0,"258":0,"259":0,"260":0,"264":0,"265":0,"266":0,"268":0,"269":0,"270":0,"271":0,"273":0,"274":0,"275":0,"277":0,"278":0,"280":0,"283":0,"287":0,"288":0,"289":0,"291":0,"293":0,"294":0,"295":0,"297":0,"299":0,"301":0,"310":0,"311":0,"313":0,"314":0,"315":0,"318":0,"319":0,"320":0,"321":0,"324":0,"325":0,"326":0,"327":0,"329":0,"330":0,"333":0,"335":0,"344":0,"352":0,"356":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/SerialWrapper.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/SerialWrapper.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":10,"loc":{"start":{"line":10,"column":12},"end":{"line":10,"column":15}}},"2":{"name":"(anonymous_2)","line":40,"loc":{"start":{"line":40,"column":4},"end":{"line":40,"column":21}}},"3":{"name":"(anonymous_3)","line":49,"loc":{"start":{"line":49,"column":13},"end":{"line":49,"column":20}}},"4":{"name":"(anonymous_4)","line":58,"loc":{"start":{"line":58,"column":7},"end":{"line":58,"column":14}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":33}},"2":{"start":{"line":17,"column":2},"end":{"line":17,"column":44}},"3":{"start":{"line":18,"column":2},"end":{"line":18,"column":35}},"4":{"start":{"line":25,"column":2},"end":{"line":25,"column":39}},"5":{"start":{"line":32,"column":2},"end":{"line":32,"column":41}},"6":{"start":{"line":41,"column":2},"end":{"line":41,"column":34}},"7":{"start":{"line":50,"column":2},"end":{"line":50,"column":54}},"8":{"start":{"line":59,"column":2},"end":{"line":61,"column":3}},"9":{"start":{"line":60,"column":3},"end":{"line":60,"column":74}},"10":{"start":{"line":63,"column":2},"end":{"line":68,"column":3}},"11":{"start":{"line":64,"column":3},"end":{"line":67,"column":6}},"12":{"start":{"line":65,"column":4},"end":{"line":65,"column":38}},"13":{"start":{"line":66,"column":4},"end":{"line":66,"column":49}},"14":{"start":{"line":70,"column":2},"end":{"line":70,"column":32}},"15":{"start":{"line":71,"column":2},"end":{"line":79,"column":6}},"16":{"start":{"line":73,"column":4},"end":{"line":73,"column":37}},"17":{"start":{"line":74,"column":4},"end":{"line":74,"column":34}},"18":{"start":{"line":77,"column":4},"end":{"line":77,"column":49}},"19":{"start":{"line":78,"column":4},"end":{"line":78,"column":34}},"20":{"start":{"line":81,"column":2},"end":{"line":81,"column":27}},"21":{"start":{"line":85,"column":0},"end":{"line":85,"column":31}}},"branchMap":{"1":{"line":59,"type":"if","locations":[{"start":{"line":59,"column":2},"end":{"line":59,"column":2}},{"start":{"line":59,"column":2},"end":{"line":59,"column":2}}]},"2":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":2},"end":{"line":63,"column":2}},{"start":{"line":63,"column":2},"end":{"line":63,"column":2}}]}},"code":["'use strict';","","const events = require('events');","","class SerialWrapper {","","\t/**","\t * Creates a new instance of the serial wrapper for promises.","\t */","\tconstructor() {","","\t\t/**","\t\t * Current event emitter.","\t\t * @type {EventEmitter}","\t\t * @private","\t\t */","\t\tthis._emitter = new events.EventEmitter();","\t\tthis._emitter.setMaxListeners(0);","","\t\t/**","\t\t * Current set of named methods to invoke.","\t\t * @type {Object}","\t\t * @private","\t\t */","\t\tthis._toInvoke = Object.create(null);","","\t\t/**","\t\t * Current set of flags if the method is in progress.","\t\t * @type {Object}","\t\t * @private","\t\t */","\t\tthis._inProgress = Object.create(null);","\t}","","\t/**","\t * Adds a method to the set.","\t * @param {string} name Method name.","\t * @param {Function} toInvoke Function that returns promise.","\t */","\tadd(name, toInvoke) {","\t\tthis._toInvoke[name] = toInvoke;","\t}","","\t/**","\t * Returns true if the method with such name was registered to the set.","\t * @param {string} name Name of method.","\t * @returns {boolean} True if method name is registered.","\t */","\tisRegistered(name) {","\t\treturn typeof (this._toInvoke[name]) === 'function';","\t}","","\t/**","\t * Invokes a method without concurrency.","\t * @param {string} name Method name.","\t * @returns {Promise<Object>} Promise for result.","\t */","\tinvoke(name) {","\t\tif (!this.isRegistered(name)) {","\t\t\treturn Promise.reject(new Error('There is no such registered method'));","\t\t}","","\t\tif (this._inProgress[name]) {","\t\t\treturn new Promise((fulfill, reject) => {","\t\t\t\tthis._emitter.once(name, fulfill);","\t\t\t\tthis._emitter.once(`${name}--error`, reject);","\t\t\t});","\t\t}","","\t\tthis._inProgress[name] = true;","\t\tthis._toInvoke[name]()","\t\t\t.then(result => {","\t\t\t\tthis._emitter.emit(name, result);","\t\t\t\tthis._inProgress[name] = null;","\t\t\t})","\t\t\t.catch(reason => {","\t\t\t\tthis._emitter.emit(`${name}--error`, reason);","\t\t\t\tthis._inProgress[name] = null;","\t\t\t});","","\t\treturn this.invoke(name);","\t}","}","","module.exports = SerialWrapper;",""],"l":{"3":1,"17":0,"18":0,"25":0,"32":0,"41":0,"50":0,"59":0,"60":0,"63":0,"64":0,"65":0,"66":0,"70":0,"71":0,"73":0,"74":0,"77":0,"78":0,"81":0,"85":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/helpers/moduleHelper.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/helpers/moduleHelper.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":1,"41":0,"42":1},"b":{"1":[0,0],"2":[0,0,0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"defaultPromiseMethod","line":159,"loc":{"start":{"line":159,"column":0},"end":{"line":159,"column":32}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":153,"column":2}},"2":{"start":{"line":22,"column":2},"end":{"line":24,"column":3}},"3":{"start":{"line":23,"column":3},"end":{"line":23,"column":13}},"4":{"start":{"line":25,"column":2},"end":{"line":25,"column":65}},"5":{"start":{"line":35,"column":2},"end":{"line":35,"column":64}},"6":{"start":{"line":44,"column":2},"end":{"line":44,"column":60}},"7":{"start":{"line":51,"column":2},"end":{"line":56,"column":3}},"8":{"start":{"line":64,"column":2},"end":{"line":66,"column":3}},"9":{"start":{"line":65,"column":3},"end":{"line":65,"column":13}},"10":{"start":{"line":68,"column":2},"end":{"line":70,"column":3}},"11":{"start":{"line":69,"column":3},"end":{"line":69,"column":41}},"12":{"start":{"line":72,"column":2},"end":{"line":74,"column":3}},"13":{"start":{"line":73,"column":3},"end":{"line":73,"column":37}},"14":{"start":{"line":76,"column":2},"end":{"line":78,"column":48}},"15":{"start":{"line":87,"column":2},"end":{"line":89,"column":3}},"16":{"start":{"line":88,"column":3},"end":{"line":88,"column":13}},"17":{"start":{"line":90,"column":2},"end":{"line":90,"column":57}},"18":{"start":{"line":91,"column":2},"end":{"line":93,"column":3}},"19":{"start":{"line":92,"column":3},"end":{"line":92,"column":29}},"20":{"start":{"line":94,"column":2},"end":{"line":96,"column":3}},"21":{"start":{"line":95,"column":3},"end":{"line":95,"column":35}},"22":{"start":{"line":97,"column":2},"end":{"line":97,"column":58}},"23":{"start":{"line":109,"column":2},"end":{"line":111,"column":3}},"24":{"start":{"line":110,"column":3},"end":{"line":110,"column":31}},"25":{"start":{"line":112,"column":2},"end":{"line":112,"column":59}},"26":{"start":{"line":113,"column":2},"end":{"line":115,"column":3}},"27":{"start":{"line":114,"column":3},"end":{"line":114,"column":42}},"28":{"start":{"line":116,"column":2},"end":{"line":118,"column":3}},"29":{"start":{"line":117,"column":3},"end":{"line":117,"column":44}},"30":{"start":{"line":120,"column":2},"end":{"line":120,"column":30}},"31":{"start":{"line":130,"column":2},"end":{"line":132,"column":3}},"32":{"start":{"line":131,"column":3},"end":{"line":131,"column":13}},"33":{"start":{"line":133,"column":2},"end":{"line":135,"column":3}},"34":{"start":{"line":134,"column":3},"end":{"line":134,"column":30}},"35":{"start":{"line":136,"column":2},"end":{"line":138,"column":47}},"36":{"start":{"line":137,"column":55},"end":{"line":137,"column":75}},"37":{"start":{"line":147,"column":2},"end":{"line":151,"column":3}},"38":{"start":{"line":148,"column":3},"end":{"line":148,"column":36}},"39":{"start":{"line":150,"column":3},"end":{"line":150,"column":28}},"40":{"start":{"line":159,"column":0},"end":{"line":161,"column":1}},"41":{"start":{"line":160,"column":1},"end":{"line":160,"column":26}},"42":{"start":{"line":163,"column":0},"end":{"line":163,"column":24}}},"branchMap":{"1":{"line":22,"type":"if","locations":[{"start":{"line":22,"column":2},"end":{"line":22,"column":2}},{"start":{"line":22,"column":2},"end":{"line":22,"column":2}}]},"2":{"line":51,"type":"binary-expr","locations":[{"start":{"line":51,"column":2},"end":{"line":51,"column":44}},{"start":{"line":53,"column":3},"end":{"line":53,"column":53}},{"start":{"line":54,"column":3},"end":{"line":54,"column":41}},{"start":{"line":55,"column":3},"end":{"line":55,"column":45}}]},"3":{"line":64,"type":"if","locations":[{"start":{"line":64,"column":2},"end":{"line":64,"column":2}},{"start":{"line":64,"column":2},"end":{"line":64,"column":2}}]},"4":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":2},"end":{"line":68,"column":2}},{"start":{"line":68,"column":2},"end":{"line":68,"column":2}}]},"5":{"line":72,"type":"if","locations":[{"start":{"line":72,"column":2},"end":{"line":72,"column":2}},{"start":{"line":72,"column":2},"end":{"line":72,"column":2}}]},"6":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":2},"end":{"line":87,"column":2}},{"start":{"line":87,"column":2},"end":{"line":87,"column":2}}]},"7":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":2},"end":{"line":91,"column":2}},{"start":{"line":91,"column":2},"end":{"line":91,"column":2}}]},"8":{"line":94,"type":"if","locations":[{"start":{"line":94,"column":2},"end":{"line":94,"column":2}},{"start":{"line":94,"column":2},"end":{"line":94,"column":2}}]},"9":{"line":109,"type":"if","locations":[{"start":{"line":109,"column":2},"end":{"line":109,"column":2}},{"start":{"line":109,"column":2},"end":{"line":109,"column":2}}]},"10":{"line":109,"type":"binary-expr","locations":[{"start":{"line":109,"column":6},"end":{"line":109,"column":13}},{"start":{"line":109,"column":17},"end":{"line":109,"column":45}}]},"11":{"line":113,"type":"if","locations":[{"start":{"line":113,"column":2},"end":{"line":113,"column":2}},{"start":{"line":113,"column":2},"end":{"line":113,"column":2}}]},"12":{"line":116,"type":"if","locations":[{"start":{"line":116,"column":2},"end":{"line":116,"column":2}},{"start":{"line":116,"column":2},"end":{"line":116,"column":2}}]},"13":{"line":130,"type":"if","locations":[{"start":{"line":130,"column":2},"end":{"line":130,"column":2}},{"start":{"line":130,"column":2},"end":{"line":130,"column":2}}]},"14":{"line":133,"type":"if","locations":[{"start":{"line":133,"column":2},"end":{"line":133,"column":2}},{"start":{"line":133,"column":2},"end":{"line":133,"column":2}}]}},"code":["'use strict';","","const helper = {","\tELEMENT_NODE_TYPE: 1,","\tCOMPONENT_TAG_PREFIX: 'CAT-',","\tCOMPONENT_ID: '$catberryId',","\tCOMPONENT_PREFIX_REGEXP: /^cat-/i,","\tCOMPONENT_ERROR_TEMPLATE_POSTFIX: '--error',","\tDOCUMENT_COMPONENT_NAME: 'document',","\tDOCUMENT_TAG_NAME: 'HTML',","\tHEAD_TAG_NAME: 'HEAD',","\tHEAD_COMPONENT_NAME: 'head',","\tATTRIBUTE_STORE: 'cat-store',","\tDEFAULT_LOGIC_FILENAME: 'index.js',","","\t/**","\t * Creates a name for the error template of the component.","\t * @param {string} componentName The name of the component.","\t * @returns {string} The name of the error template of the component.","\t */","\tgetNameForErrorTemplate: componentName => {","\t\tif (typeof (componentName) !== 'string') {","\t\t\treturn '';","\t\t}","\t\treturn componentName + helper.COMPONENT_ERROR_TEMPLATE_POSTFIX;","\t},","","\t/**","\t * Determines if the specified component name is a \"document\" component's name.","\t * @param {string} componentName The name of the component.","\t * @returns {boolean} True if the specified component's name","\t * is a \"document\" component's name.","\t */","\tisDocumentComponent: componentName =>","\t\tcomponentName.toLowerCase() === helper.DOCUMENT_COMPONENT_NAME,","","\t/**","\t * Determines if the specified component name is a \"head\" component name.","\t * @param {string} componentName The name of the component.","\t * @returns {boolean} True if the specified component's name","\t * is a \"head\" component's name.","\t */","\tisHeadComponent: componentName =>","\t\tcomponentName.toLowerCase() === helper.HEAD_COMPONENT_NAME,","","\t/**","\t * Determines if the DOM node is a component element.","\t * @param {Node} node The DOM node.","\t */","\tisComponentNode: node =>","\t\tnode.nodeType === helper.ELEMENT_NODE_TYPE &&","\t\t(","\t\t\thelper.COMPONENT_PREFIX_REGEXP.test(node.nodeName) ||","\t\t\tnode.nodeName === helper.HEAD_TAG_NAME ||","\t\t\tnode.nodeName === helper.DOCUMENT_TAG_NAME","\t\t),","","\t/**","\t * Gets a original component's name without a prefix.","\t * @param {string} fullComponentName The full component's name (tag name).","\t * @returns {string} The original component's name without a prefix.","\t */","\tgetOriginalComponentName: fullComponentName => {","\t\tif (typeof (fullComponentName) !== 'string') {","\t\t\treturn '';","\t\t}","","\t\tif (fullComponentName === helper.DOCUMENT_TAG_NAME) {","\t\t\treturn helper.DOCUMENT_COMPONENT_NAME;","\t\t}","","\t\tif (fullComponentName === helper.HEAD_TAG_NAME) {","\t\t\treturn helper.HEAD_COMPONENT_NAME;","\t\t}","","\t\treturn fullComponentName","\t\t\t.toLowerCase()","\t\t\t.replace(helper.COMPONENT_PREFIX_REGEXP, '');","\t},","","\t/**","\t * Gets a valid tag name for a component.","\t * @param {string} componentName The name of the component.","\t * @returns {string} The name of the tag.","\t */","\tgetTagNameForComponentName: componentName => {","\t\tif (typeof (componentName) !== 'string') {","\t\t\treturn '';","\t\t}","\t\tconst upperComponentName = componentName.toUpperCase();","\t\tif (componentName === helper.HEAD_COMPONENT_NAME) {","\t\t\treturn upperComponentName;","\t\t}","\t\tif (componentName === helper.DOCUMENT_COMPONENT_NAME) {","\t\t\treturn helper.DOCUMENT_TAG_NAME;","\t\t}","\t\treturn helper.COMPONENT_TAG_PREFIX + upperComponentName;","\t},","","\t/**","\t * Gets a prefixed method of the module that can be invoked.","\t * @param {Object} module The module implementation.","\t * @param {string} prefix The method prefix (i.e. handle).","\t * @param {string?} name The name of the entity to invoke method for","\t * (will be converted to a camel case).","\t * @returns {Function} The method to invoke.","\t */","\tgetMethodToInvoke: (module, prefix, name) => {","\t\tif (!module || typeof (module) !== 'object') {","\t\t\treturn defaultPromiseMethod;","\t\t}","\t\tconst methodName = helper.getCamelCaseName(prefix, name);","\t\tif (typeof (module[methodName]) === 'function') {","\t\t\treturn module[methodName].bind(module);","\t\t}","\t\tif (typeof (module[prefix]) === 'function') {","\t\t\treturn module[prefix].bind(module, name);","\t\t}","","\t\treturn defaultPromiseMethod;","\t},","","\t/**","\t * Gets a name in the camel case for anything.","\t * @param {string} prefix The prefix for the name.","\t * @param {string} name The name to convert.","\t * @returns {string} Name in the camel case.","\t */","\tgetCamelCaseName: (prefix, name) => {","\t\tif (!name) {","\t\t\treturn '';","\t\t}","\t\tif (prefix) {","\t\t\tname = `${prefix}-${name}`;","\t\t}","\t\treturn name","\t\t\t.replace(/(?:[^a-z0-9]+)(\\w)/gi, (space, letter) => letter.toUpperCase())","\t\t\t.replace(/(^[^a-z0-9])|([^a-z0-9]$)/gi, '');","\t},","","\t/**","\t * Gets a safe promise resolved by the action.","\t * @param {Function} action The action to wrap with a safe promise.","\t * @returns {Promise} The promise for the done action.","\t */","\tgetSafePromise: action => {","\t\ttry {","\t\t\treturn Promise.resolve(action());","\t\t} catch (e) {","\t\t\treturn Promise.reject(e);","\t\t}","\t}","};","","/**"," * Just returns a resolved promise."," * @returns {Promise} The promise for nothing."," */","function defaultPromiseMethod() {","\treturn Promise.resolve();","}","","module.exports = helper;",""],"l":{"3":1,"22":0,"23":0,"25":0,"35":0,"44":0,"51":0,"64":0,"65":0,"68":0,"69":0,"72":0,"73":0,"76":0,"87":0,"88":0,"90":0,"91":0,"92":0,"94":0,"95":0,"97":0,"109":0,"110":0,"112":0,"113":0,"114":0,"116":0,"117":0,"120":0,"130":0,"131":0,"133":0,"134":0,"136":0,"137":0,"147":0,"148":0,"150":0,"159":1,"160":0,"163":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/helpers/propertyHelper.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/helpers/propertyHelper.js","s":{"1":1,"2":0},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":19,"column":2}},"2":{"start":{"line":12,"column":2},"end":{"line":17,"column":5}}},"branchMap":{},"code":["'use strict';","","module.exports = {","","\t/**","\t * Defines a read-only property.","\t * @param {Object} object The object to define a property in.","\t * @param {string} name The name of the property.","\t * @param {*} value The value of the property.","\t */","\tdefineReadOnly: (object, name, value) => {","\t\tObject.defineProperty(object, name, {","\t\t\tenumerable: false,","\t\t\tconfigurable: false,","\t\t\twritable: false,","\t\t\tvalue","\t\t});","\t}","};",""],"l":{"3":1,"12":0}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/providers/ModuleApiProvider.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/providers/ModuleApiProvider.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"fnMap":{"1":{"name":"(anonymous_1)","line":17,"loc":{"start":{"line":17,"column":12},"end":{"line":17,"column":22}}},"2":{"name":"(anonymous_2)","line":36,"loc":{"start":{"line":36,"column":14},"end":{"line":36,"column":17}}},"3":{"name":"(anonymous_3)","line":44,"loc":{"start":{"line":44,"column":13},"end":{"line":44,"column":16}}},"4":{"name":"(anonymous_4)","line":53,"loc":{"start":{"line":53,"column":9},"end":{"line":53,"column":12}}},"5":{"name":"(anonymous_5)","line":63,"loc":{"start":{"line":63,"column":9},"end":{"line":63,"column":21}}},"6":{"name":"(anonymous_6)","line":74,"loc":{"start":{"line":74,"column":13},"end":{"line":74,"column":25}}},"7":{"name":"(anonymous_7)","line":84,"loc":{"start":{"line":84,"column":14},"end":{"line":84,"column":17}}},"8":{"name":"(anonymous_8)","line":93,"loc":{"start":{"line":93,"column":16},"end":{"line":93,"column":19}}},"9":{"name":"(anonymous_9)","line":125,"loc":{"start":{"line":125,"column":14},"end":{"line":125,"column":20}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":73}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":46}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":46}},"4":{"start":{"line":18,"column":2},"end":{"line":18,"column":17}},"5":{"start":{"line":25,"column":2},"end":{"line":29,"column":4}},"6":{"start":{"line":37,"column":2},"end":{"line":37,"column":15}},"7":{"start":{"line":45,"column":2},"end":{"line":45,"column":14}},"8":{"start":{"line":54,"column":2},"end":{"line":54,"column":39}},"9":{"start":{"line":55,"column":2},"end":{"line":55,"column":27}},"10":{"start":{"line":64,"column":2},"end":{"line":64,"column":40}},"11":{"start":{"line":65,"column":2},"end":{"line":65,"column":43}},"12":{"start":{"line":66,"column":2},"end":{"line":66,"column":27}},"13":{"start":{"line":75,"column":2},"end":{"line":75,"column":40}},"14":{"start":{"line":76,"column":2},"end":{"line":76,"column":43}},"15":{"start":{"line":77,"column":2},"end":{"line":77,"column":27}},"16":{"start":{"line":85,"column":2},"end":{"line":85,"column":40}},"17":{"start":{"line":86,"column":2},"end":{"line":86,"column":27}},"18":{"start":{"line":94,"column":2},"end":{"line":94,"column":23}},"19":{"start":{"line":96,"column":2},"end":{"line":100,"column":3}},"20":{"start":{"line":97,"column":3},"end":{"line":98,"column":111}},"21":{"start":{"line":98,"column":29},"end":{"line":98,"column":108}},"22":{"start":{"line":99,"column":3},"end":{"line":99,"column":30}},"23":{"start":{"line":102,"column":2},"end":{"line":106,"column":3}},"24":{"start":{"line":103,"column":3},"end":{"line":103,"column":96}},"25":{"start":{"line":104,"column":3},"end":{"line":104,"column":36}},"26":{"start":{"line":105,"column":3},"end":{"line":105,"column":45}},"27":{"start":{"line":108,"column":2},"end":{"line":111,"column":3}},"28":{"start":{"line":109,"column":3},"end":{"line":109,"column":49}},"29":{"start":{"line":110,"column":3},"end":{"line":110,"column":42}},"30":{"start":{"line":113,"column":2},"end":{"line":116,"column":3}},"31":{"start":{"line":114,"column":3},"end":{"line":114,"column":80}},"32":{"start":{"line":115,"column":3},"end":{"line":115,"column":51}},"33":{"start":{"line":118,"column":2},"end":{"line":118,"column":21}},"34":{"start":{"line":126,"column":2},"end":{"line":126,"column":39}},"35":{"start":{"line":129,"column":0},"end":{"line":129,"column":35}}},"branchMap":{"1":{"line":96,"type":"if","locations":[{"start":{"line":96,"column":2},"end":{"line":96,"column":2}},{"start":{"line":96,"column":2},"end":{"line":96,"column":2}}]},"2":{"line":102,"type":"if","locations":[{"start":{"line":102,"column":2},"end":{"line":102,"column":2}},{"start":{"line":102,"column":2},"end":{"line":102,"column":2}}]},"3":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":2},"end":{"line":108,"column":2}},{"start":{"line":108,"column":2},"end":{"line":108,"column":2}}]},"4":{"line":113,"type":"if","locations":[{"start":{"line":113,"column":2},"end":{"line":113,"column":2}},{"start":{"line":113,"column":2},"end":{"line":113,"column":2}}]}},"code":["'use strict';","","const ModuleApiProviderBase = require('./../base/ModuleApiProviderBase');","","const SCRIPT_TAG_REGEXP = /<(\\/)?(script)>/ig;","const SCRIPT_TAG_REPLACEMENT = '&lt;$1$2&gt;';","","/**"," * Implements the module API provider for the server environment."," */","class ModuleApiProvider extends ModuleApiProviderBase {","","\t/**","\t * Creates a new instance of the the module API provider.","\t * @param {ServiceLocator} locator Service locator for resolving dependencies.","\t */","\tconstructor(locator) {","\t\tsuper(locator);","","\t\t/**","\t\t * Current set of done actions.","\t\t * @type {Object}","\t\t * @private","\t\t */","\t\tthis.actions = {","\t\t\tredirectedTo: '',","\t\t\tisNotFoundCalled: false,","\t\t\tisFragmentCleared: false","\t\t};","\t}","","\t/**","\t * Returns false because the environment is supposed to be the server.","\t * @return {boolean} false.","\t */","\tget isBrowser() {","\t\treturn false;","\t}","","\t/**","\t * Returns true because the environment is supposed to be the server.","\t * @return {boolean} true.","\t */","\tget isServer() {","\t\treturn true;","\t}","","\t/**","\t * Sets the \"not found\" flag which means Catberry should hand over","\t * request handling to the next middleware.","\t * @returns {Promise} The promise for finished work.","\t */","\tnotFound() {","\t\tthis.actions.isNotFoundCalled = true;","\t\treturn Promise.resolve();","\t}","","\t/**","\t * Redirects the current page to the specified URI using 302 HTTP status code.","\t * @param {string} uriString The URI to direct.","\t * @returns {Promise} The promise for finished work.","\t */","\tredirect(uriString) {","\t\tthis.actions.redirectedTo = uriString;","\t\tthis.actions.redirectionStatusCode = 302;","\t\treturn Promise.resolve();","\t}","","\t/**","\t * Redirects the current page to the specified URI using 301 HTTP status code.","\t * @param {string} uriString The URI to direct.","\t * @returns {Promise} The promise for finished work.","\t */","\tpermRedirect(uriString) {","\t\tthis.actions.redirectedTo = uriString;","\t\tthis.actions.redirectionStatusCode = 301;","\t\treturn Promise.resolve();","\t}","","\t/**","\t * Clears current URI's fragment.","\t * @returns {Promise} The promise for finished work.","\t */","\tclearFragment() {","\t\tthis.actions.isFragmentCleared = true;","\t\treturn Promise.resolve();","\t}","","\t/**","\t * Gets inline script for making stored actions.","\t * @returns {string} SCRIPT tag with inline JavaScript to make actions.","\t */","\tgetInlineScript() {","\t\tvar scriptLines = '';","","\t\tif (this.cookie.setCookie.length > 0) {","\t\t\tthis.cookie.setCookie","\t\t\t\t.forEach(cookieSetup => (scriptLines += `window.document.cookie = '${this._escapeString(cookieSetup)}';`));","\t\t\tthis.cookie.setCookie = [];","\t\t}","","\t\tif (this.actions.redirectedTo) {","\t\t\tscriptLines += `window.location.assign('${this._escapeString(this.actions.redirectedTo)}');`;","\t\t\tthis.actions.redirectedTo = null;","\t\t\tthis.actions.redirectionStatusCode = null;","\t\t}","","\t\tif (this.actions.isFragmentCleared) {","\t\t\tscriptLines += 'window.location.hash = \\'\\';';","\t\t\tthis.actions.isFragmentCleared = false;","\t\t}","","\t\tif (scriptLines.length > 0) {","\t\t\tscriptLines = scriptLines.replace(SCRIPT_TAG_REGEXP, SCRIPT_TAG_REPLACEMENT);","\t\t\tscriptLines = `<script>${scriptLines}</script>`;","\t\t}","","\t\treturn scriptLines;","\t}","","\t/**","\t * Escapes a string for including into the inline script.","\t * @param {string} str The string to escape.","\t */","\t_escapeString(str) {","\t\treturn str.replace(/['\\\\]/g, '\\\\$&');","\t}","}","module.exports = ModuleApiProvider;",""],"l":{"3":1,"5":1,"6":1,"18":0,"25":0,"37":0,"45":0,"54":0,"55":0,"64":0,"65":0,"66":0,"75":0,"76":0,"77":0,"85":0,"86":0,"94":0,"96":0,"97":0,"98":0,"99":0,"102":0,"103":0,"104":0,"105":0,"108":0,"109":0,"110":0,"113":0,"114":0,"115":0,"118":0,"126":0,"129":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/base/ModuleApiProviderBase.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/base/ModuleApiProviderBase.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":1,"19":0,"20":0,"21":0,"22":0,"23":1,"24":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":12},"end":{"line":13,"column":22}}},"2":{"name":"(anonymous_2)","line":41,"loc":{"start":{"line":41,"column":3},"end":{"line":41,"column":24}}},"3":{"name":"(anonymous_3)","line":53,"loc":{"start":{"line":53,"column":5},"end":{"line":53,"column":26}}},"4":{"name":"(anonymous_4)","line":65,"loc":{"start":{"line":65,"column":15},"end":{"line":65,"column":36}}},"5":{"name":"(anonymous_5)","line":76,"loc":{"start":{"line":76,"column":19},"end":{"line":76,"column":31}}},"6":{"name":"(anonymous_6)","line":88,"loc":{"start":{"line":88,"column":12},"end":{"line":88,"column":27}}},"7":{"name":"checkEventNameAndHandler","line":99,"loc":{"start":{"line":99,"column":0},"end":{"line":99,"column":54}}},"8":{"name":"stub","line":112,"loc":{"start":{"line":112,"column":0},"end":{"line":112,"column":16}}}},"statementMap":{"1":{"start":{"line":19,"column":2},"end":{"line":19,"column":25}},"2":{"start":{"line":25,"column":2},"end":{"line":25,"column":49}},"3":{"start":{"line":32,"column":2},"end":{"line":32,"column":47}},"4":{"start":{"line":42,"column":2},"end":{"line":42,"column":47}},"5":{"start":{"line":43,"column":2},"end":{"line":43,"column":40}},"6":{"start":{"line":44,"column":2},"end":{"line":44,"column":14}},"7":{"start":{"line":54,"column":2},"end":{"line":54,"column":47}},"8":{"start":{"line":55,"column":2},"end":{"line":55,"column":42}},"9":{"start":{"line":56,"column":2},"end":{"line":56,"column":14}},"10":{"start":{"line":66,"column":2},"end":{"line":66,"column":47}},"11":{"start":{"line":67,"column":2},"end":{"line":67,"column":52}},"12":{"start":{"line":68,"column":2},"end":{"line":68,"column":14}},"13":{"start":{"line":77,"column":2},"end":{"line":77,"column":44}},"14":{"start":{"line":78,"column":2},"end":{"line":78,"column":47}},"15":{"start":{"line":79,"column":2},"end":{"line":79,"column":14}},"16":{"start":{"line":89,"column":2},"end":{"line":89,"column":62}},"17":{"start":{"line":90,"column":2},"end":{"line":90,"column":49}},"18":{"start":{"line":99,"column":0},"end":{"line":107,"column":1}},"19":{"start":{"line":100,"column":1},"end":{"line":102,"column":2}},"20":{"start":{"line":101,"column":2},"end":{"line":101,"column":51}},"21":{"start":{"line":104,"column":1},"end":{"line":106,"column":2}},"22":{"start":{"line":105,"column":2},"end":{"line":105,"column":56}},"23":{"start":{"line":112,"column":0},"end":{"line":112,"column":18}},"24":{"start":{"line":114,"column":0},"end":{"line":114,"column":39}}},"branchMap":{"1":{"line":100,"type":"if","locations":[{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},{"start":{"line":100,"column":1},"end":{"line":100,"column":1}}]},"2":{"line":104,"type":"if","locations":[{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},{"start":{"line":104,"column":1},"end":{"line":104,"column":1}}]}},"code":["'use strict';","","/**"," * Implements the basic Module API Provider class for both server"," * and browser environments."," */","class ModuleApiProviderBase {","","\t/**","\t * Creates a new instance of the basic API provider.","\t * @param {ServiceLocator} locator Service locator for resolving dependencies.","\t */","\tconstructor(locator) {","","\t\t/**","\t\t * Current service locator.","\t\t * @type {ServiceLocator}","\t\t */","\t\tthis.locator = locator;","","\t\t/**","\t\t * Current cookie provider.","\t\t * @type {CookieWrapper}","\t\t */","\t\tthis.cookie = locator.resolve('cookieWrapper');","","\t\t/**","\t\t * Current event bus.","\t\t * @type {EventEmitter}","\t\t * @private","\t\t */","\t\tthis._eventBus = locator.resolve('eventBus');","\t}","","\t/**","\t * Subscribes on the specified event in Catberry.","\t * @param {string} eventName The name of the event.","\t * @param {Function} handler The event handler.","\t * @returns {ModuleApiProviderBase} This object for chaining.","\t */","\ton(eventName, handler) {","\t\tcheckEventNameAndHandler(eventName, handler);","\t\tthis._eventBus.on(eventName, handler);","\t\treturn this;","\t}","","\t/**","\t * Subscribes on the specified event in Catberry to handle it once.","\t * @param {string} eventName The name of the event.","\t * @param {Function} handler The event handler.","\t * @returns {ModuleApiProviderBase} This object for chaining.","\t */","\tonce(eventName, handler) {","\t\tcheckEventNameAndHandler(eventName, handler);","\t\tthis._eventBus.once(eventName, handler);","\t\treturn this;","\t}","","\t/**","\t * Removes the specified handler from the specified event.","\t * @param {string} eventName The name of the event.","\t * @param {Function} handler The event handler.","\t * @returns {ModuleApiProviderBase} This object for chaining.","\t */","\tremoveListener(eventName, handler) {","\t\tcheckEventNameAndHandler(eventName, handler);","\t\tthis._eventBus.removeListener(eventName, handler);","\t\treturn this;","\t}","","\t/**","\t * Removes all handlers from the specified event in Catberry.","\t * @param {string} eventName The name of the event.","\t * @returns {ModuleApiProviderBase} This object for chaining.","\t */","\tremoveAllListeners(eventName) {","\t\tcheckEventNameAndHandler(eventName, stub);","\t\tthis._eventBus.removeAllListeners(eventName);","\t\treturn this;","\t}","","\t/**","\t * Gets URI for the named route and specified parameters.","\t * @param {string} name Name of the route.","\t * @param {Object} values Set of route parameter values.","\t * @returns {string} URI string.","\t */","\tgetRouteURI(name, values) {","\t\tconst stateProvider = this.locator.resolve('stateProvider');","\t\treturn stateProvider.getRouteURI(name, values);","\t}","}","","/**"," * Checks if an event name is a string and handler is a function."," * @param {*} eventName The name of the event to check."," * @param {*} handler The event handler to check."," */","function checkEventNameAndHandler(eventName, handler) {","\tif (typeof (eventName) !== 'string') {","\t\tthrow new Error('Event name should be a string');","\t}","","\tif (typeof (handler) !== 'function') {","\t\tthrow new Error('Event handler should be a function');","\t}","}","","/**"," * Does nothing. It is used as a default callback."," */","function stub() {}","","module.exports = ModuleApiProviderBase;",""],"l":{"19":0,"25":0,"32":0,"42":0,"43":0,"44":0,"54":0,"55":0,"56":0,"66":0,"67":0,"68":0,"77":0,"78":0,"79":0,"89":0,"90":0,"99":1,"100":0,"101":0,"104":0,"105":0,"112":1,"114":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/CookieWrapper.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/CookieWrapper.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":1},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":12},"end":{"line":13,"column":15}}},"2":{"name":"(anonymous_2)","line":40,"loc":{"start":{"line":40,"column":15},"end":{"line":40,"column":30}}},"3":{"name":"(anonymous_3)","line":48,"loc":{"start":{"line":48,"column":16},"end":{"line":48,"column":19}}},"4":{"name":"(anonymous_4)","line":69,"loc":{"start":{"line":69,"column":4},"end":{"line":69,"column":18}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":62}},"2":{"start":{"line":14,"column":2},"end":{"line":14,"column":10}},"3":{"start":{"line":20,"column":2},"end":{"line":20,"column":22}},"4":{"start":{"line":26,"column":2},"end":{"line":26,"column":25}},"5":{"start":{"line":33,"column":2},"end":{"line":33,"column":33}},"6":{"start":{"line":41,"column":2},"end":{"line":41,"column":43}},"7":{"start":{"line":49,"column":2},"end":{"line":49,"column":41}},"8":{"start":{"line":50,"column":2},"end":{"line":52,"column":5}},"9":{"start":{"line":51,"column":3},"end":{"line":51,"column":76}},"10":{"start":{"line":53,"column":2},"end":{"line":53,"column":16}},"11":{"start":{"line":70,"column":2},"end":{"line":70,"column":57}},"12":{"start":{"line":71,"column":2},"end":{"line":71,"column":30}},"13":{"start":{"line":72,"column":2},"end":{"line":72,"column":38}},"14":{"start":{"line":73,"column":2},"end":{"line":73,"column":16}},"15":{"start":{"line":77,"column":0},"end":{"line":77,"column":31}}},"branchMap":{"1":{"line":51,"type":"cond-expr","locations":[{"start":{"line":51,"column":25},"end":{"line":51,"column":29}},{"start":{"line":51,"column":32},"end":{"line":51,"column":34}}]}},"code":["'use strict';","","const CookieWrapperBase = require('./base/CookieWrapperBase');","","/**"," * Implements the Cookie Wrapper class for the server environment."," */","class CookieWrapper extends CookieWrapperBase {","","\t/**","\t * Creates a new instance of the server-side cookie wrapper.","\t */","\tconstructor() {","\t\tsuper();","","\t\t/**","\t\t * Current list of cookie strings set in the instance.","\t\t * @type {Array}","\t\t */","\t\tthis.setCookie = [];","","\t\t/**","\t\t * Current list of cookie setups set in the instance.","\t\t * @type {Array}","\t\t */","\t\tthis.cookieSetups = [];","","\t\t/**","\t\t * Current cookie string.","\t\t * @type {string}","\t\t * @private","\t\t */","\t\tthis._initialCookieString = '';","\t}","","\t/**","\t * Initializes the instance with the specified cookie string.","\t * @param {string} cookieString The cookie string.","\t */","\tinitWithString(cookieString) {","\t\tthis._initialCookieString = cookieString;","\t}","","\t/**","\t * Gets current cookie string.","\t * @returns {string} The cookie string.","\t */","\tgetCookieString() {","\t\tvar string = this._initialCookieString;","\t\tthis.cookieSetups.forEach(cookieSetup => {","\t\t\tstring += `${string ? '; ' : ''}${cookieSetup.key}=${cookieSetup.value}`;","\t\t});","\t\treturn string;","\t}","","\t/**","\t * Sets a cookie to the instance.","\t * @param {Object} cookieSetup The cookie setup object.","\t * @param {string} cookieSetup.key The cookie key.","\t * @param {string} cookieSetup.value The cookie's value.","\t * @param {number?} cookieSetup.maxAge The cookie's max age in seconds.","\t * @param {Date?} cookieSetup.expires The expiration date.","\t * @param {string?} cookieSetup.path The cookie's URI path.","\t * @param {string?} cookieSetup.domain The cookie's domain.","\t * @param {boolean?} cookieSetup.secure Is the cookie secured.","\t * @param {boolean?} cookieSetup.httpOnly Is the cookie HTTP only.","\t * @returns {string} The cookie setup string.","\t */","\tset(cookieSetup) {","\t\tconst cookie = this._convertToCookieSetup(cookieSetup);","\t\tthis.setCookie.push(cookie);","\t\tthis.cookieSetups.push(cookieSetup);","\t\treturn cookie;","\t}","}","","module.exports = CookieWrapper;",""],"l":{"3":1,"14":0,"20":0,"26":0,"33":0,"41":0,"49":0,"50":0,"51":0,"53":0,"70":0,"71":0,"72":0,"73":0,"77":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/base/CookieWrapperBase.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/base/CookieWrapperBase.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":7},"end":{"line":13,"column":10}}},"2":{"name":"(anonymous_2)","line":23,"loc":{"start":{"line":23,"column":4},"end":{"line":23,"column":11}}},"3":{"name":"(anonymous_3)","line":37,"loc":{"start":{"line":37,"column":19},"end":{"line":37,"column":28}}},"4":{"name":"(anonymous_4)","line":78,"loc":{"start":{"line":78,"column":22},"end":{"line":78,"column":36}}}},"statementMap":{"1":{"start":{"line":14,"column":2},"end":{"line":14,"column":40}},"2":{"start":{"line":15,"column":2},"end":{"line":15,"column":41}},"3":{"start":{"line":24,"column":2},"end":{"line":26,"column":3}},"4":{"start":{"line":25,"column":3},"end":{"line":25,"column":13}},"5":{"start":{"line":28,"column":2},"end":{"line":28,"column":35}},"6":{"start":{"line":38,"column":2},"end":{"line":38,"column":37}},"7":{"start":{"line":40,"column":2},"end":{"line":42,"column":3}},"8":{"start":{"line":41,"column":3},"end":{"line":41,"column":17}},"9":{"start":{"line":43,"column":2},"end":{"line":59,"column":6}},"10":{"start":{"line":46,"column":4},"end":{"line":46,"column":48}},"11":{"start":{"line":47,"column":4},"end":{"line":49,"column":5}},"12":{"start":{"line":48,"column":5},"end":{"line":48,"column":12}},"13":{"start":{"line":51,"column":4},"end":{"line":53,"column":13}},"14":{"start":{"line":55,"column":4},"end":{"line":58,"column":28}},"15":{"start":{"line":61,"column":2},"end":{"line":61,"column":16}},"16":{"start":{"line":79,"column":2},"end":{"line":82,"column":3}},"17":{"start":{"line":81,"column":3},"end":{"line":81,"column":41}},"18":{"start":{"line":84,"column":2},"end":{"line":84,"column":57}},"19":{"start":{"line":87,"column":2},"end":{"line":94,"column":3}},"20":{"start":{"line":88,"column":3},"end":{"line":88,"column":57}},"21":{"start":{"line":89,"column":3},"end":{"line":93,"column":4}},"22":{"start":{"line":91,"column":4},"end":{"line":92,"column":32}},"23":{"start":{"line":95,"column":2},"end":{"line":97,"column":3}},"24":{"start":{"line":96,"column":3},"end":{"line":96,"column":62}},"25":{"start":{"line":98,"column":2},"end":{"line":100,"column":3}},"26":{"start":{"line":99,"column":3},"end":{"line":99,"column":42}},"27":{"start":{"line":101,"column":2},"end":{"line":103,"column":3}},"28":{"start":{"line":102,"column":3},"end":{"line":102,"column":46}},"29":{"start":{"line":104,"column":2},"end":{"line":107,"column":3}},"30":{"start":{"line":106,"column":3},"end":{"line":106,"column":24}},"31":{"start":{"line":108,"column":2},"end":{"line":111,"column":3}},"32":{"start":{"line":110,"column":3},"end":{"line":110,"column":26}},"33":{"start":{"line":113,"column":2},"end":{"line":113,"column":16}},"34":{"start":{"line":117,"column":0},"end":{"line":117,"column":35}}},"branchMap":{"1":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":2},"end":{"line":24,"column":2}},{"start":{"line":24,"column":2},"end":{"line":24,"column":2}}]},"2":{"line":28,"type":"binary-expr","locations":[{"start":{"line":28,"column":9},"end":{"line":28,"column":28}},{"start":{"line":28,"column":32},"end":{"line":28,"column":34}}]},"3":{"line":40,"type":"if","locations":[{"start":{"line":40,"column":2},"end":{"line":40,"column":2}},{"start":{"line":40,"column":2},"end":{"line":40,"column":2}}]},"4":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":4},"end":{"line":47,"column":4}},{"start":{"line":47,"column":4},"end":{"line":47,"column":4}}]},"5":{"line":79,"type":"if","locations":[{"start":{"line":79,"column":2},"end":{"line":79,"column":2}},{"start":{"line":79,"column":2},"end":{"line":79,"column":2}}]},"6":{"line":79,"type":"binary-expr","locations":[{"start":{"line":79,"column":6},"end":{"line":79,"column":43}},{"start":{"line":80,"column":3},"end":{"line":80,"column":42}}]},"7":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":2},"end":{"line":87,"column":2}},{"start":{"line":87,"column":2},"end":{"line":87,"column":2}}]},"8":{"line":89,"type":"if","locations":[{"start":{"line":89,"column":3},"end":{"line":89,"column":3}},{"start":{"line":89,"column":3},"end":{"line":89,"column":3}}]},"9":{"line":95,"type":"if","locations":[{"start":{"line":95,"column":2},"end":{"line":95,"column":2}},{"start":{"line":95,"column":2},"end":{"line":95,"column":2}}]},"10":{"line":98,"type":"if","locations":[{"start":{"line":98,"column":2},"end":{"line":98,"column":2}},{"start":{"line":98,"column":2},"end":{"line":98,"column":2}}]},"11":{"line":101,"type":"if","locations":[{"start":{"line":101,"column":2},"end":{"line":101,"column":2}},{"start":{"line":101,"column":2},"end":{"line":101,"column":2}}]},"12":{"line":104,"type":"if","locations":[{"start":{"line":104,"column":2},"end":{"line":104,"column":2}},{"start":{"line":104,"column":2},"end":{"line":104,"column":2}}]},"13":{"line":104,"type":"binary-expr","locations":[{"start":{"line":104,"column":6},"end":{"line":104,"column":47}},{"start":{"line":105,"column":3},"end":{"line":105,"column":21}}]},"14":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":2},"end":{"line":108,"column":2}},{"start":{"line":108,"column":2},"end":{"line":108,"column":2}}]},"15":{"line":108,"type":"binary-expr","locations":[{"start":{"line":108,"column":6},"end":{"line":108,"column":49}},{"start":{"line":109,"column":3},"end":{"line":109,"column":23}}]}},"code":["'use strict';","","/**"," * Implements the basic Cookie Wrapper class for both server"," * and browser environments."," */","class CookieWrapperBase {","","\t/**","\t * Gets a map of cookie values by their names.","\t * @returns {Object} The cookies map by their names.","\t */","\tgetAll() {","\t\tconst string = this.getCookieString();","\t\treturn this._parseCookieString(string);","\t}","","\t/**","\t * Gets a cookie value by its name.","\t * @param {string} name The cookie name.","\t * @returns {string} The cookie value.","\t */","\tget(name) {","\t\tif (typeof (name) !== 'string') {","\t\t\treturn '';","\t\t}","","\t\treturn this.getAll()[name] || '';","\t}","","\t/**","\t * Parses a cookie string into the map of cookie key/value pairs.","\t * @param {string} string The cookie string.","\t * @returns {Object} The object with cookie values by their names.","\t * @protected","\t */","\t_parseCookieString(string) {","\t\tconst cookie = Object.create(null);","","\t\tif (typeof (string) !== 'string') {","\t\t\treturn cookie;","\t\t}","\t\tstring","\t\t\t.split(/; */)","\t\t\t.forEach(cookiePair => {","\t\t\t\tconst equalsIndex = cookiePair.indexOf('=');","\t\t\t\tif (equalsIndex < 0) {","\t\t\t\t\treturn;","\t\t\t\t}","","\t\t\t\tconst key = cookiePair","\t\t\t\t\t.substring(0, equalsIndex)","\t\t\t\t\t.trim();","","\t\t\t\tcookie[key] = cookiePair","\t\t\t\t\t.substring(equalsIndex + 1)","\t\t\t\t\t.trim()","\t\t\t\t\t.replace(/^\"|\"$/g, '');","\t\t\t});","","\t\treturn cookie;","\t}","","\t/**","\t * Converts a cookie setup object to the cookie string.","\t * @param {Object} cookieSetup The cookie setup object.","\t * @param {string} cookieSetup.key The cookie key.","\t * @param {string} cookieSetup.value The cookie's value.","\t * @param {number?} cookieSetup.maxAge The cookie's max age in seconds.","\t * @param {Date?} cookieSetup.expires The expiration date.","\t * @param {string?} cookieSetup.path The cookie's URI path.","\t * @param {string?} cookieSetup.domain The cookie's domain.","\t * @param {boolean?} cookieSetup.secure Is the cookie secured.","\t * @param {boolean?} cookieSetup.httpOnly Is the cookie HTTP only.","\t * @returns {string} The cookie string.","\t * @protected","\t */","\t_convertToCookieSetup(cookieSetup) {","\t\tif (typeof (cookieSetup.key) !== 'string' ||","\t\t\ttypeof (cookieSetup.value) !== 'string') {","\t\t\tthrow new Error('Wrong key or value');","\t\t}","","\t\tvar cookie = `${cookieSetup.key}=${cookieSetup.value}`;","","\t\t// http://tools.ietf.org/html/rfc6265#section-4.1.1","\t\tif (typeof (cookieSetup.maxAge) === 'number') {","\t\t\tcookie += `; Max-Age=${cookieSetup.maxAge.toFixed()}`;","\t\t\tif (!cookieSetup.expires) {","\t\t\t\t// by default expire date = current date + max-age in seconds","\t\t\t\tcookieSetup.expires = new Date(Date.now() +","\t\t\t\t\tcookieSetup.maxAge * 1000);","\t\t\t}","\t\t}","\t\tif (cookieSetup.expires instanceof Date) {","\t\t\tcookie += `; Expires=${cookieSetup.expires.toUTCString()}`;","\t\t}","\t\tif (typeof (cookieSetup.path) === 'string') {","\t\t\tcookie += `; Path=${cookieSetup.path}`;","\t\t}","\t\tif (typeof (cookieSetup.domain) === 'string') {","\t\t\tcookie += `; Domain=${cookieSetup.domain}`;","\t\t}","\t\tif (typeof (cookieSetup.secure) === 'boolean' &&","\t\t\tcookieSetup.secure) {","\t\t\tcookie += '; Secure';","\t\t}","\t\tif (typeof (cookieSetup.httpOnly) === 'boolean' &&","\t\t\tcookieSetup.httpOnly) {","\t\t\tcookie += '; HttpOnly';","\t\t}","","\t\treturn cookie;","\t}","}","","module.exports = CookieWrapperBase;",""],"l":{"14":0,"15":0,"24":0,"25":0,"28":0,"38":0,"40":0,"41":0,"43":0,"46":0,"47":0,"48":0,"51":0,"55":0,"61":0,"79":0,"81":0,"84":0,"87":0,"88":0,"89":0,"91":0,"95":0,"96":0,"98":0,"99":0,"101":0,"102":0,"104":0,"106":0,"108":0,"110":0,"113":0,"117":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/builders/BrowserBundleBuilder.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/builders/BrowserBundleBuilder.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":1,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":1},"b":{"1":[0,1],"2":[1,0],"3":[1,1,1],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0,0],"20":[0,0],"21":[0,0,0],"22":[0,0],"23":[0,0,0],"24":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"fnMap":{"1":{"name":"(anonymous_1)","line":51,"loc":{"start":{"line":51,"column":12},"end":{"line":51,"column":22}}},"2":{"name":"(anonymous_2)","line":200,"loc":{"start":{"line":200,"column":6},"end":{"line":200,"column":9}}},"3":{"name":"(anonymous_3)","line":236,"loc":{"start":{"line":236,"column":22},"end":{"line":236,"column":25}}},"4":{"name":"(anonymous_4)","line":256,"loc":{"start":{"line":256,"column":18},"end":{"line":256,"column":21}}},"5":{"name":"(anonymous_5)","line":328,"loc":{"start":{"line":328,"column":24},"end":{"line":328,"column":27}}},"6":{"name":"(anonymous_6)","line":367,"loc":{"start":{"line":367,"column":27},"end":{"line":367,"column":37}}},"7":{"name":"(anonymous_7)","line":404,"loc":{"start":{"line":404,"column":20},"end":{"line":404,"column":28}}},"8":{"name":"(anonymous_8)","line":433,"loc":{"start":{"line":433,"column":7},"end":{"line":433,"column":10}}},"9":{"name":"(anonymous_9)","line":450,"loc":{"start":{"line":450,"column":20},"end":{"line":450,"column":23}}},"10":{"name":"(anonymous_10)","line":472,"loc":{"start":{"line":472,"column":12},"end":{"line":472,"column":15}}},"11":{"name":"makeDirectory","line":496,"loc":{"start":{"line":496,"column":0},"end":{"line":496,"column":32}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":29}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":33}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":25}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":38}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":33}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":37}},"7":{"start":{"line":9,"column":0},"end":{"line":9,"column":37}},"8":{"start":{"line":10,"column":0},"end":{"line":10,"column":45}},"9":{"start":{"line":11,"column":0},"end":{"line":11,"column":46}},"10":{"start":{"line":12,"column":0},"end":{"line":12,"column":41}},"11":{"start":{"line":13,"column":0},"end":{"line":13,"column":56}},"12":{"start":{"line":15,"column":0},"end":{"line":15,"column":34}},"13":{"start":{"line":16,"column":0},"end":{"line":16,"column":66}},"14":{"start":{"line":17,"column":0},"end":{"line":17,"column":64}},"15":{"start":{"line":18,"column":0},"end":{"line":18,"column":45}},"16":{"start":{"line":19,"column":0},"end":{"line":19,"column":38}},"17":{"start":{"line":20,"column":0},"end":{"line":20,"column":50}},"18":{"start":{"line":21,"column":0},"end":{"line":21,"column":87}},"19":{"start":{"line":23,"column":0},"end":{"line":23,"column":34}},"20":{"start":{"line":25,"column":0},"end":{"line":40,"column":1}},"21":{"start":{"line":26,"column":1},"end":{"line":26,"column":76}},"22":{"start":{"line":27,"column":1},"end":{"line":37,"column":2}},"23":{"start":{"line":30,"column":2},"end":{"line":36,"column":2}},"24":{"start":{"line":52,"column":2},"end":{"line":52,"column":43}},"25":{"start":{"line":59,"column":2},"end":{"line":59,"column":46}},"26":{"start":{"line":66,"column":2},"end":{"line":66,"column":76}},"27":{"start":{"line":73,"column":2},"end":{"line":73,"column":98}},"28":{"start":{"line":80,"column":2},"end":{"line":80,"column":116}},"29":{"start":{"line":87,"column":2},"end":{"line":87,"column":88}},"30":{"start":{"line":94,"column":2},"end":{"line":94,"column":68}},"31":{"start":{"line":101,"column":2},"end":{"line":101,"column":33}},"32":{"start":{"line":108,"column":2},"end":{"line":108,"column":47}},"33":{"start":{"line":115,"column":2},"end":{"line":115,"column":73}},"34":{"start":{"line":122,"column":2},"end":{"line":122,"column":61}},"35":{"start":{"line":129,"column":2},"end":{"line":129,"column":53}},"36":{"start":{"line":136,"column":2},"end":{"line":136,"column":30}},"37":{"start":{"line":137,"column":2},"end":{"line":141,"column":3}},"38":{"start":{"line":138,"column":3},"end":{"line":138,"column":66}},"39":{"start":{"line":148,"column":2},"end":{"line":148,"column":39}},"40":{"start":{"line":149,"column":2},"end":{"line":153,"column":3}},"41":{"start":{"line":150,"column":3},"end":{"line":150,"column":84}},"42":{"start":{"line":160,"column":2},"end":{"line":160,"column":31}},"43":{"start":{"line":161,"column":2},"end":{"line":165,"column":3}},"44":{"start":{"line":162,"column":3},"end":{"line":162,"column":68}},"45":{"start":{"line":172,"column":2},"end":{"line":172,"column":26}},"46":{"start":{"line":179,"column":2},"end":{"line":179,"column":32}},"47":{"start":{"line":186,"column":2},"end":{"line":186,"column":29}},"48":{"start":{"line":193,"column":2},"end":{"line":193,"column":33}},"49":{"start":{"line":201,"column":2},"end":{"line":228,"column":58}},"50":{"start":{"line":202,"column":21},"end":{"line":202,"column":71}},"51":{"start":{"line":203,"column":15},"end":{"line":203,"column":43}},"52":{"start":{"line":204,"column":15},"end":{"line":211,"column":5}},"53":{"start":{"line":204,"column":48},"end":{"line":210,"column":14}},"54":{"start":{"line":206,"column":37},"end":{"line":208,"column":27}},"55":{"start":{"line":213,"column":15},"end":{"line":220,"column":5}},"56":{"start":{"line":213,"column":48},"end":{"line":219,"column":14}},"57":{"start":{"line":215,"column":37},"end":{"line":217,"column":27}},"58":{"start":{"line":223,"column":15},"end":{"line":223,"column":41}},"59":{"start":{"line":224,"column":15},"end":{"line":226,"column":18}},"60":{"start":{"line":228,"column":20},"end":{"line":228,"column":56}},"61":{"start":{"line":237,"column":2},"end":{"line":248,"column":6}},"62":{"start":{"line":241,"column":18},"end":{"line":241,"column":71}},"63":{"start":{"line":243,"column":4},"end":{"line":245,"column":5}},"64":{"start":{"line":244,"column":5},"end":{"line":244,"column":17}},"65":{"start":{"line":246,"column":4},"end":{"line":246,"column":51}},"66":{"start":{"line":247,"column":4},"end":{"line":247,"column":71}},"67":{"start":{"line":257,"column":2},"end":{"line":259,"column":3}},"68":{"start":{"line":258,"column":3},"end":{"line":258,"column":27}},"69":{"start":{"line":261,"column":2},"end":{"line":272,"column":5}},"70":{"start":{"line":266,"column":4},"end":{"line":268,"column":5}},"71":{"start":{"line":267,"column":5},"end":{"line":267,"column":17}},"72":{"start":{"line":269,"column":4},"end":{"line":269,"column":37}},"73":{"start":{"line":270,"column":4},"end":{"line":270,"column":17}},"74":{"start":{"line":274,"column":2},"end":{"line":276,"column":4}},"75":{"start":{"line":277,"column":2},"end":{"line":277,"column":40}},"76":{"start":{"line":279,"column":2},"end":{"line":282,"column":3}},"77":{"start":{"line":280,"column":3},"end":{"line":280,"column":37}},"78":{"start":{"line":281,"column":3},"end":{"line":281,"column":90}},"79":{"start":{"line":284,"column":2},"end":{"line":284,"column":52}},"80":{"start":{"line":286,"column":2},"end":{"line":286,"column":16}},"81":{"start":{"line":287,"column":2},"end":{"line":290,"column":4}},"82":{"start":{"line":288,"column":3},"end":{"line":288,"column":102}},"83":{"start":{"line":289,"column":3},"end":{"line":289,"column":34}},"84":{"start":{"line":292,"column":2},"end":{"line":317,"column":6}},"85":{"start":{"line":294,"column":4},"end":{"line":297,"column":7}},"86":{"start":{"line":299,"column":4},"end":{"line":299,"column":30}},"87":{"start":{"line":301,"column":25},"end":{"line":301,"column":60}},"88":{"start":{"line":304,"column":4},"end":{"line":304,"column":61}},"89":{"start":{"line":305,"column":4},"end":{"line":307,"column":5}},"90":{"start":{"line":306,"column":5},"end":{"line":306,"column":50}},"91":{"start":{"line":308,"column":4},"end":{"line":315,"column":7}},"92":{"start":{"line":309,"column":5},"end":{"line":309,"column":48}},"93":{"start":{"line":310,"column":5},"end":{"line":314,"column":8}},"94":{"start":{"line":316,"column":4},"end":{"line":316,"column":36}},"95":{"start":{"line":319,"column":2},"end":{"line":319,"column":17}},"96":{"start":{"line":320,"column":2},"end":{"line":320,"column":26}},"97":{"start":{"line":329,"column":2},"end":{"line":331,"column":3}},"98":{"start":{"line":330,"column":3},"end":{"line":330,"column":33}},"99":{"start":{"line":333,"column":2},"end":{"line":337,"column":5}},"100":{"start":{"line":338,"column":2},"end":{"line":338,"column":69}},"101":{"start":{"line":339,"column":2},"end":{"line":339,"column":52}},"102":{"start":{"line":340,"column":2},"end":{"line":340,"column":58}},"103":{"start":{"line":342,"column":2},"end":{"line":342,"column":39}},"104":{"start":{"line":343,"column":2},"end":{"line":343,"column":109}},"105":{"start":{"line":345,"column":2},"end":{"line":358,"column":6}},"106":{"start":{"line":346,"column":25},"end":{"line":346,"column":60}},"107":{"start":{"line":348,"column":4},"end":{"line":348,"column":67}},"108":{"start":{"line":349,"column":4},"end":{"line":356,"column":7}},"109":{"start":{"line":350,"column":5},"end":{"line":350,"column":48}},"110":{"start":{"line":351,"column":5},"end":{"line":355,"column":8}},"111":{"start":{"line":357,"column":4},"end":{"line":357,"column":36}},"112":{"start":{"line":360,"column":2},"end":{"line":360,"column":32}},"113":{"start":{"line":368,"column":2},"end":{"line":368,"column":35}},"114":{"start":{"line":370,"column":2},"end":{"line":380,"column":5}},"115":{"start":{"line":382,"column":2},"end":{"line":384,"column":3}},"116":{"start":{"line":383,"column":3},"end":{"line":383,"column":24}},"117":{"start":{"line":386,"column":2},"end":{"line":392,"column":5}},"118":{"start":{"line":394,"column":2},"end":{"line":394,"column":36}},"119":{"start":{"line":395,"column":2},"end":{"line":395,"column":28}},"120":{"start":{"line":405,"column":2},"end":{"line":408,"column":3}},"121":{"start":{"line":407,"column":3},"end":{"line":407,"column":45}},"122":{"start":{"line":409,"column":2},"end":{"line":411,"column":3}},"123":{"start":{"line":410,"column":3},"end":{"line":410,"column":28}},"124":{"start":{"line":413,"column":2},"end":{"line":426,"column":52}},"125":{"start":{"line":415,"column":4},"end":{"line":415,"column":55}},"126":{"start":{"line":416,"column":4},"end":{"line":421,"column":5}},"127":{"start":{"line":419,"column":5},"end":{"line":419,"column":98}},"128":{"start":{"line":420,"column":5},"end":{"line":420,"column":17}},"129":{"start":{"line":423,"column":4},"end":{"line":423,"column":73}},"130":{"start":{"line":425,"column":20},"end":{"line":425,"column":56}},"131":{"start":{"line":426,"column":15},"end":{"line":426,"column":50}},"132":{"start":{"line":434,"column":2},"end":{"line":434,"column":61}},"133":{"start":{"line":435,"column":2},"end":{"line":435,"column":32}},"134":{"start":{"line":436,"column":2},"end":{"line":439,"column":40}},"135":{"start":{"line":441,"column":2},"end":{"line":441,"column":28}},"136":{"start":{"line":442,"column":2},"end":{"line":444,"column":31}},"137":{"start":{"line":452,"column":2},"end":{"line":452,"column":64}},"138":{"start":{"line":454,"column":2},"end":{"line":466,"column":3}},"139":{"start":{"line":455,"column":3},"end":{"line":455,"column":79}},"140":{"start":{"line":456,"column":3},"end":{"line":456,"column":18}},"141":{"start":{"line":457,"column":3},"end":{"line":462,"column":4}},"142":{"start":{"line":460,"column":4},"end":{"line":460,"column":105}},"143":{"start":{"line":461,"column":4},"end":{"line":461,"column":13}},"144":{"start":{"line":463,"column":3},"end":{"line":465,"column":5}},"145":{"start":{"line":473,"column":2},"end":{"line":473,"column":56}},"146":{"start":{"line":475,"column":2},"end":{"line":487,"column":3}},"147":{"start":{"line":476,"column":3},"end":{"line":476,"column":63}},"148":{"start":{"line":477,"column":3},"end":{"line":477,"column":18}},"149":{"start":{"line":478,"column":3},"end":{"line":483,"column":4}},"150":{"start":{"line":481,"column":4},"end":{"line":481,"column":97}},"151":{"start":{"line":482,"column":4},"end":{"line":482,"column":13}},"152":{"start":{"line":484,"column":3},"end":{"line":486,"column":5}},"153":{"start":{"line":496,"column":0},"end":{"line":507,"column":1}},"154":{"start":{"line":497,"column":1},"end":{"line":506,"column":4}},"155":{"start":{"line":498,"column":2},"end":{"line":505,"column":5}},"156":{"start":{"line":499,"column":3},"end":{"line":502,"column":4}},"157":{"start":{"line":500,"column":4},"end":{"line":500,"column":18}},"158":{"start":{"line":501,"column":4},"end":{"line":501,"column":11}},"159":{"start":{"line":504,"column":3},"end":{"line":504,"column":13}},"160":{"start":{"line":509,"column":0},"end":{"line":509,"column":38}}},"branchMap":{"1":{"line":21,"type":"cond-expr","locations":[{"start":{"line":21,"column":64},"end":{"line":21,"column":75}},{"start":{"line":21,"column":78},"end":{"line":21,"column":86}}]},"2":{"line":27,"type":"if","locations":[{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},{"start":{"line":27,"column":1},"end":{"line":27,"column":1}}]},"3":{"line":27,"type":"binary-expr","locations":[{"start":{"line":27,"column":5},"end":{"line":27,"column":23}},{"start":{"line":28,"column":2},"end":{"line":28,"column":25}},{"start":{"line":29,"column":2},"end":{"line":29,"column":28}}]},"4":{"line":66,"type":"binary-expr","locations":[{"start":{"line":66,"column":21},"end":{"line":66,"column":47}},{"start":{"line":66,"column":51},"end":{"line":66,"column":75}}]},"5":{"line":73,"type":"binary-expr","locations":[{"start":{"line":73,"column":47},"end":{"line":73,"column":71}},{"start":{"line":73,"column":75},"end":{"line":73,"column":95}}]},"6":{"line":80,"type":"binary-expr","locations":[{"start":{"line":80,"column":53},"end":{"line":80,"column":83}},{"start":{"line":80,"column":87},"end":{"line":80,"column":113}}]},"7":{"line":202,"type":"cond-expr","locations":[{"start":{"line":202,"column":33},"end":{"line":202,"column":64}},{"start":{"line":202,"column":67},"end":{"line":202,"column":71}}]},"8":{"line":224,"type":"cond-expr","locations":[{"start":{"line":225,"column":5},"end":{"line":225,"column":41}},{"start":{"line":226,"column":5},"end":{"line":226,"column":18}}]},"9":{"line":243,"type":"if","locations":[{"start":{"line":243,"column":4},"end":{"line":243,"column":4}},{"start":{"line":243,"column":4},"end":{"line":243,"column":4}}]},"10":{"line":257,"type":"if","locations":[{"start":{"line":257,"column":2},"end":{"line":257,"column":2}},{"start":{"line":257,"column":2},"end":{"line":257,"column":2}}]},"11":{"line":266,"type":"if","locations":[{"start":{"line":266,"column":4},"end":{"line":266,"column":4}},{"start":{"line":266,"column":4},"end":{"line":266,"column":4}}]},"12":{"line":279,"type":"if","locations":[{"start":{"line":279,"column":2},"end":{"line":279,"column":2}},{"start":{"line":279,"column":2},"end":{"line":279,"column":2}}]},"13":{"line":305,"type":"if","locations":[{"start":{"line":305,"column":4},"end":{"line":305,"column":4}},{"start":{"line":305,"column":4},"end":{"line":305,"column":4}}]},"14":{"line":329,"type":"if","locations":[{"start":{"line":329,"column":2},"end":{"line":329,"column":2}},{"start":{"line":329,"column":2},"end":{"line":329,"column":2}}]},"15":{"line":382,"type":"if","locations":[{"start":{"line":382,"column":2},"end":{"line":382,"column":2}},{"start":{"line":382,"column":2},"end":{"line":382,"column":2}}]},"16":{"line":405,"type":"if","locations":[{"start":{"line":405,"column":2},"end":{"line":405,"column":2}},{"start":{"line":405,"column":2},"end":{"line":405,"column":2}}]},"17":{"line":409,"type":"if","locations":[{"start":{"line":409,"column":2},"end":{"line":409,"column":2}},{"start":{"line":409,"column":2},"end":{"line":409,"column":2}}]},"18":{"line":416,"type":"if","locations":[{"start":{"line":416,"column":4},"end":{"line":416,"column":4}},{"start":{"line":416,"column":4},"end":{"line":416,"column":4}}]},"19":{"line":416,"type":"binary-expr","locations":[{"start":{"line":416,"column":8},"end":{"line":416,"column":21}},{"start":{"line":417,"column":5},"end":{"line":417,"column":39}},{"start":{"line":418,"column":5},"end":{"line":418,"column":48}}]},"20":{"line":457,"type":"if","locations":[{"start":{"line":457,"column":3},"end":{"line":457,"column":3}},{"start":{"line":457,"column":3},"end":{"line":457,"column":3}}]},"21":{"line":457,"type":"binary-expr","locations":[{"start":{"line":457,"column":7},"end":{"line":457,"column":29}},{"start":{"line":458,"column":4},"end":{"line":458,"column":47}},{"start":{"line":459,"column":4},"end":{"line":459,"column":59}}]},"22":{"line":478,"type":"if","locations":[{"start":{"line":478,"column":3},"end":{"line":478,"column":3}},{"start":{"line":478,"column":3},"end":{"line":478,"column":3}}]},"23":{"line":478,"type":"binary-expr","locations":[{"start":{"line":478,"column":7},"end":{"line":478,"column":21}},{"start":{"line":479,"column":4},"end":{"line":479,"column":39}},{"start":{"line":480,"column":4},"end":{"line":480,"column":48}}]},"24":{"line":499,"type":"if","locations":[{"start":{"line":499,"column":3},"end":{"line":499,"column":3}},{"start":{"line":499,"column":3},"end":{"line":499,"column":3}}]}},"code":["'use strict';","","const path = require('path');","const stream = require('stream');","const fs = require('fs');","const pfs = require('../promises/fs');","const mkdirp = require('mkdirp');","const watchify = require('watchify');","const babelify = require('babelify');","const babelEnv = require('babel-preset-env');","const babili = require('babel-preset-babili');","const browserify = require('browserify');","const hrTimeHelper = require('../helpers/hrTimeHelper');","","const WORKING_DIR = process.cwd();","const DEFAULT_PUBLIC_DIRECTORY = path.join(WORKING_DIR, 'public');","const TEMPORARY_APP_DEFINITIONS_FILENAME = '.appDefinitions.js';","const BROWSER_SCRIPT_FILENAME = 'browser.js';","const APP_DEFAULT_FILENAME = 'app.js';","const EXTERNALS_DEFAULT_FILENAME = 'externals.js';","const APP_DEPENDENCY_ID_REGEXP = process.platform === 'win32' ?\t/^(\\.|\\w:)/ :\t/^[\\/.]/;","","var packageDescriptionString = '';","","try {","\tconst packageDescription = require(path.join(WORKING_DIR, 'package.json'));","\tif (packageDescription &&","\t\tpackageDescription.name &&","\t\tpackageDescription.version) {","\t\tpackageDescriptionString = `","/**"," * ${packageDescription.name}: ${packageDescription.version}"," * Build Date: ${(new Date()).toString()}"," */","","`;","\t}","} catch (e) {","\t// ok, nothing to do here","}","","/**"," * Implements the bundle builder module."," */","class BrowserBundleBuilder {","","\t/**","\t * Creates a new instance of the browser bundle builder.","\t * @param {ServiceLocator} locator Service locator for resolving dependencies.","\t */","\tconstructor(locator) {","\t\tconst config = locator.resolve('config');","","\t\t/**","\t\t * Is current application mode release.","\t\t * @type {boolean}","\t\t * @private","\t\t */","\t\tthis._isRelease = Boolean(config.isRelease);","","\t\t/**","\t\t * Current path where to publish bundle.","\t\t * @type {string}","\t\t * @private","\t\t */","\t\tthis._publicPath = config.publicDirectoryPath || DEFAULT_PUBLIC_DIRECTORY;","","\t\t/**","\t\t * Current path to the application bundle file.","\t\t * @type {string}","\t\t * @private","\t\t */","\t\tthis._appPath = path.join(this._publicPath, (config.appBundleFilename || APP_DEFAULT_FILENAME));","","\t\t/**","\t\t * Current path to the externals bunlde file.","\t\t * @type {string}","\t\t * @private","\t\t */","\t\tthis._externalsPath = path.join(this._publicPath, (config.externalsBundleFilename || EXTERNALS_DEFAULT_FILENAME));","","\t\t/**","\t\t * Current path to the __appDefinitions.js.","\t\t * @type {string}","\t\t * @private","\t\t */","\t\tthis._appDefinitionsPath = path.join(WORKING_DIR, TEMPORARY_APP_DEFINITIONS_FILENAME);","","\t\t/**","\t\t * Current path to the browser.js.","\t\t * @type {string}","\t\t * @private","\t\t */","\t\tthis._entryPath = path.join(WORKING_DIR, BROWSER_SCRIPT_FILENAME);","","\t\t/**","\t\t * Current service locator.","\t\t * @type {ServiceLocator}","\t\t * @private","\t\t */","\t\tthis._serviceLocator = locator;","","\t\t/**","\t\t * Current event bus.","\t\t * @type {EventEmitter}","\t\t * @private","\t\t */","\t\tthis._eventBus = locator.resolve('eventBus');","","\t\t/**","\t\t * Current app definitions builder.","\t\t * @type {AppDefinitionsBuilder}","\t\t * @private","\t\t */","\t\tthis._appDefinitionsBuilder = locator.resolve('appDefinitionsBuilder');","","\t\t/**","\t\t * Current component finder.","\t\t * @type {ComponentFinder}","\t\t * @private","\t\t */","\t\tthis._componentFinder = locator.resolve('componentFinder');","","\t\t/**","\t\t * Current store finder.","\t\t * @type {StoreFinder}","\t\t * @private","\t\t */","\t\tthis._storeFinder = locator.resolve('storeFinder');","","\t\t/**","\t\t * Current post build actions list.","\t\t * @type {Array}","\t\t * @private","\t\t */","\t\tthis._postBuildActions = [];","\t\ttry {","\t\t\tthis._postBuildActions = locator.resolveAll('postBuildAction');","\t\t} catch (e) {","\t\t\t// nothing to do here","\t\t}","","\t\t/**","\t\t * Current browserify transformations list.","\t\t * @type {Array}","\t\t * @private","\t\t */","\t\tthis._browserifyTransformations = [];","\t\ttry {","\t\t\tthis._browserifyTransformations = locator.resolveAll('browserifyTransformation');","\t\t} catch (e) {","\t\t\t// nothing to do here","\t\t}","","\t\t/**","\t\t * Current browserify plugins list.","\t\t * @type {Array}","\t\t * @private","\t\t */","\t\tthis._browserifyPlugins = [];","\t\ttry {","\t\t\tthis._browserifyPlugins = locator.resolveAll('browserifyPlugin');","\t\t} catch (e) {","\t\t\t// nothing to do here","\t\t}","","\t\t/**","\t\t * Current Browserify app bundler.","\t\t * @type {Browserify}","\t\t * @private","\t\t */","\t\tthis._appBundler = null;","","\t\t/**","\t\t * Current Browserify externals bundler.","\t\t * @type {Browserify}","\t\t * @private","\t\t */","\t\tthis._externalsBundler = null;","","\t\t/**","\t\t * Current set of external modules.","\t\t * @type {Object}","\t\t * @private","\t\t */","\t\tthis._externalModules = {};","","\t\t/**","\t\t * Current app definitions cache.","\t\t * @type {string}","\t\t * @private","\t\t */","\t\tthis._appDefinitionsCache = '';","\t}","","\t/**","\t * Builds the browser bundle.","\t * @returns {Promise} The promise for finished work.","\t */","\tbuild() {","\t\treturn pfs.exists(this._publicPath)","\t\t\t.then(isExists => !isExists ? makeDirectory(this._publicPath) : null)","\t\t\t.then(() => this._createAppDefinitions())","\t\t\t.then(() => new Promise((fulfill, reject) => this._createAppBundler()","\t\t\t\t\t.once('error', reject)","\t\t\t\t\t.once('bundle', bundleStream => bundleStream","\t\t\t\t\t\t\t.once('end', fulfill)","\t\t\t\t\t\t\t.on('error', reject)","\t\t\t\t\t)","\t\t\t\t\t.bundle()","\t\t\t\t)","\t\t\t)","\t\t\t.then(() => new Promise((fulfill, reject) => this._createExternalsBundler()","\t\t\t\t\t.once('error', reject)","\t\t\t\t\t.once('bundle', bundleStream => bundleStream","\t\t\t\t\t\t\t.once('end', fulfill)","\t\t\t\t\t\t\t.on('error', reject)","\t\t\t\t\t)","\t\t\t\t\t.bundle()","\t\t\t\t)","\t\t\t)","","\t\t\t.then(() => this._doPostBuildActions())","\t\t\t.then(() => this._isRelease ?","\t\t\t\t\tpfs.unlink(this._appDefinitionsPath) :","\t\t\t\t\tthis._watch()","\t\t\t)","\t\t\t.catch(reason => this._eventBus.emit('error', reason));","\t}","","\t/**","\t * Creates a app definitions file for the bundler.","\t * @returns {Promise} The promise for finished work.","\t * @private","\t */","\t_createAppDefinitions() {","\t\treturn Promise.all([","\t\t\tthis._storeFinder.find(),","\t\t\tthis._componentFinder.find()","\t\t])","\t\t\t.then(found => this._appDefinitionsBuilder.build(found[0], found[1]))","\t\t\t.then(realAppDefinitions => {","\t\t\t\tif (realAppDefinitions === this._appDefinitionsCache) {","\t\t\t\t\treturn null;","\t\t\t\t}","\t\t\t\tthis._appDefinitionsCache = realAppDefinitions;","\t\t\t\treturn pfs.writeFile(this._appDefinitionsPath, realAppDefinitions);","\t\t\t});","\t}","","\t/**","\t * Creates the browserify bundler for the app or re-uses the existing one.","\t * @returns {Browserify} The browserify instance.","\t * @private","\t */","\t_createAppBundler() {","\t\tif (this._appBundler) {","\t\t\treturn this._appBundler;","\t\t}","","\t\tthis._appBundler = browserify(this._entryPath, {","\t\t\tcache: {},","\t\t\tpackageCache: {},","\t\t\tdebug: !this._isRelease,","\t\t\tfilter: id => {","\t\t\t\tif (APP_DEPENDENCY_ID_REGEXP.test(id)) {","\t\t\t\t\treturn true;","\t\t\t\t}","\t\t\t\tthis._externalModules[id] = true;","\t\t\t\treturn false;","\t\t\t}","\t\t});","","\t\tthis._appBundler.require(","\t\t\tthis._appDefinitionsPath, {expose: 'appDefinitions'}","\t\t);","\t\tthis._appBundler.external('catberry');","","\t\tif (!this._isRelease) {","\t\t\tthis._appBundler.plugin(watchify);","\t\t\tthis._eventBus.emit('info', 'Watching files for changes to rebuild the app bundle...');","\t\t}","","\t\tthis._attachExtensionsToBundler(this._appBundler);","","\t\tvar startTime;","\t\tconst resetHandler = () => {","\t\t\tthis._eventBus.emit('info', `Building browser script bundle for the app at \"${this._appPath}\"...`);","\t\t\tstartTime = hrTimeHelper.get();","\t\t};","","\t\tthis._appBundler","\t\t\t.on('update', ids => {","\t\t\t\tthis._eventBus.emit('appBundleChanged', {","\t\t\t\t\tpath: this._appPath,","\t\t\t\t\tchangedFiles: ids","\t\t\t\t});","","\t\t\t\tthis._appBundler.bundle();","\t\t\t})","\t\t\t.on('error', error => this._eventBus.emit('error', error))","\t\t\t.on('reset', resetHandler)","\t\t\t.on('bundle', sourceStream => {","\t\t\t\tconst outputStream = fs.createWriteStream(this._appPath);","\t\t\t\tif (this._isRelease) {","\t\t\t\t\toutputStream.write(packageDescriptionString);","\t\t\t\t}","\t\t\t\toutputStream.once('finish', () => {","\t\t\t\t\tconst hrTime = hrTimeHelper.get(startTime);","\t\t\t\t\tthis._eventBus.emit('appBundleBuilt', {","\t\t\t\t\t\tpath: this._appPath,","\t\t\t\t\t\thrTime,","\t\t\t\t\t\ttime: hrTimeHelper.toMilliseconds(hrTime)","\t\t\t\t\t});","\t\t\t\t});","\t\t\t\tsourceStream.pipe(outputStream);","\t\t\t});","","\t\tresetHandler(); // to set startTime universally.","\t\treturn this._appBundler;","\t}","","\t/**","\t * Creates the browserify bundler for externals or re-uses the existing one.","\t * @returns {Browserify} The browserify instances.","\t * @private","\t */","\t_createExternalsBundler() {","\t\tif (this._externalsBundler) {","\t\t\treturn this._externalsBundler;","\t\t}","","\t\tthis._externalsBundler = browserify({","\t\t\tcache: {},","\t\t\tpackageCache: {},","\t\t\tdebug: !this._isRelease","\t\t});","\t\tthis._externalsBundler.require(Object.keys(this._externalModules));","\t\tthis._externalsBundler.external('appDefinitions');","\t\tthis._attachExtensionsToBundler(this._externalsBundler);","","\t\tconst startTime = hrTimeHelper.get();","\t\tthis._eventBus.emit('info', `Building browser script bundle for externals at \"${this._externalsPath}\"...`);","","\t\tthis._externalsBundler","\t\t\t.on('error', error => this._eventBus.emit('error', error))","\t\t\t.on('bundle', sourceStream => {","\t\t\t\tconst outputStream = fs.createWriteStream(this._externalsPath);","\t\t\t\toutputStream.once('finish', () => {","\t\t\t\t\tconst hrTime = hrTimeHelper.get(startTime);","\t\t\t\t\tthis._eventBus.emit('externalsBundleBuilt', {","\t\t\t\t\t\tpath: this._externalsPath,","\t\t\t\t\t\thrTime,","\t\t\t\t\t\ttime: hrTimeHelper.toMilliseconds(hrTime)","\t\t\t\t\t});","\t\t\t\t});","\t\t\t\tsourceStream.pipe(outputStream);","\t\t\t});","","\t\treturn this._externalsBundler;","\t}","","\t/**","\t * Attaches necessary plugins and transformations to the bundle.","\t * @param {Browserify} bundler The bundler to attach extensions.","\t */","\t_attachExtensionsToBundler(bundler) {","\t\tconst isDebug = !this._isRelease;","","\t\tconst presets = [[","\t\t\tbabelEnv, {","\t\t\t\ttargets: {","\t\t\t\t\tbrowsers: [","\t\t\t\t\t\t'last 2 versions',","\t\t\t\t\t\t'not ie <= 10'","\t\t\t\t\t]","\t\t\t\t},","\t\t\t\tdebug: isDebug","\t\t\t}","\t\t]];","","\t\tif (this._isRelease) {","\t\t\tpresets.push(babili);","\t\t}","","\t\tbundler.transform(babelify, {","\t\t\tglobal: true,","\t\t\tast: false,","\t\t\tcomments: false,","\t\t\tpresets,","\t\t\tsourceMap: isDebug","\t\t});","","\t\tthis._setTransformations(bundler);","\t\tthis._setPlugins(bundler);","\t}","","\t/**","\t * Does all the registered post build actions.","\t * @param {number?} index Current action index for recursive calls.","\t * @private","\t * @returns {Promise} The promise for finished work.","\t */","\t_doPostBuildActions(index) {","\t\tif (index === undefined) {","\t\t\t// we start from the end because the list a stack","\t\t\tindex = this._postBuildActions.length - 1;","\t\t}","\t\tif (index < 0) {","\t\t\treturn Promise.resolve();","\t\t}","","\t\treturn Promise.resolve()","\t\t\t.then(() => {","\t\t\t\tconst actionObject = this._postBuildActions[index];","\t\t\t\tif (!actionObject ||","\t\t\t\t\ttypeof (actionObject) !== 'object' ||","\t\t\t\t\ttypeof (actionObject.action) !== 'function') {","\t\t\t\t\tthis._eventBus.emit('warn', 'The post-build action has an incorrect interface, skipping...');","\t\t\t\t\treturn null;","\t\t\t\t}","","\t\t\t\treturn actionObject.action(this._storeFinder, this._componentFinder);","\t\t\t})","\t\t\t.catch(reason => this._eventBus.emit('error', reason))","\t\t\t.then(() => this._doPostBuildActions(index - 1));","\t}","","\t/**","\t * Watches the file's changes.","\t * @private","\t */","\t_watch() {","\t\tconst watchHandler = this._createAppDefinitions.bind(this);","\t\tthis._componentFinder.watch();","\t\tthis._componentFinder","\t\t\t.on('add', watchHandler)","\t\t\t.on('unlink', watchHandler)","\t\t\t.on('changeTemplates', watchHandler);","","\t\tthis._storeFinder.watch();","\t\tthis._storeFinder","\t\t\t.on('add', watchHandler)","\t\t\t.on('unlink', watchHandler);","\t}","","\t/**","\t * Sets the list of current transformations to the bundler.","\t */","\t_setTransformations() {","\t\t// traverse items in the reversed order","\t\tvar currentIndex = this._browserifyTransformations.length - 1;","","\t\twhile (currentIndex >= 0) {","\t\t\tconst currentTransformation = this._browserifyTransformations[currentIndex];","\t\t\tcurrentIndex--;","\t\t\tif (!currentTransformation ||","\t\t\t\ttypeof (currentTransformation) !== 'object' ||","\t\t\t\ttypeof (currentTransformation.transform) !== 'function') {","\t\t\t\tthis._eventBus.emit('warn', 'The browserify transformation has an incorrect interface, skipping...');","\t\t\t\tcontinue;","\t\t\t}","\t\t\tthis._appBundler.transform(","\t\t\t\tcurrentTransformation.transform, currentTransformation.options","\t\t\t);","\t\t}","\t}","","\t/**","\t * Sets the list of current plugins to the bundler.","\t */","\t_setPlugins() {","\t\tvar currentIndex = this._browserifyPlugins.length - 1;","","\t\twhile (currentIndex >= 0) {","\t\t\tconst currentPlugin = this._browserifyPlugins[currentIndex];","\t\t\tcurrentIndex--;","\t\t\tif (!currentPlugin ||","\t\t\t\ttypeof (currentPlugin) !== 'object' ||","\t\t\t\ttypeof (currentPlugin.plugin) !== 'function') {","\t\t\t\tthis._eventBus.emit('warn', 'The browserify plugin has an incorrect interface, skipping...');","\t\t\t\tcontinue;","\t\t\t}","\t\t\tthis._appBundler.plugin(","\t\t\t\tcurrentPlugin.plugin, currentPlugin.options","\t\t\t);","\t\t}","\t}","}","","/**"," * Creates all necessary directories for path."," * @param {string} dirPath Directory path."," * @returns {Promise} Promise for nothing."," */","function makeDirectory(dirPath) {","\treturn new Promise((fulfill, reject) => {","\t\tmkdirp(dirPath, error => {","\t\t\tif (error) {","\t\t\t\treject(error);","\t\t\t\treturn;","\t\t\t}","","\t\t\tfulfill();","\t\t});","\t});","}","","module.exports = BrowserBundleBuilder;",""],"l":{"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"23":1,"25":1,"26":1,"27":1,"30":1,"52":0,"59":0,"66":0,"73":0,"80":0,"87":0,"94":0,"101":0,"108":0,"115":0,"122":0,"129":0,"136":0,"137":0,"138":0,"148":0,"149":0,"150":0,"160":0,"161":0,"162":0,"172":0,"179":0,"186":0,"193":0,"201":0,"202":0,"203":0,"204":0,"206":0,"213":0,"215":0,"223":0,"224":0,"228":0,"237":0,"241":0,"243":0,"244":0,"246":0,"247":0,"257":0,"258":0,"261":0,"266":0,"267":0,"269":0,"270":0,"274":0,"277":0,"279":0,"280":0,"281":0,"284":0,"286":0,"287":0,"288":0,"289":0,"292":0,"294":0,"299":0,"301":0,"304":0,"305":0,"306":0,"308":0,"309":0,"310":0,"316":0,"319":0,"320":0,"329":0,"330":0,"333":0,"338":0,"339":0,"340":0,"342":0,"343":0,"345":0,"346":0,"348":0,"349":0,"350":0,"351":0,"357":0,"360":0,"368":0,"370":0,"382":0,"383":0,"386":0,"394":0,"395":0,"405":0,"407":0,"409":0,"410":0,"413":0,"415":0,"416":0,"419":0,"420":0,"423":0,"425":0,"426":0,"434":0,"435":0,"436":0,"441":0,"442":0,"452":0,"454":0,"455":0,"456":0,"457":0,"460":0,"461":0,"463":0,"473":0,"475":0,"476":0,"477":0,"478":0,"481":0,"482":0,"484":0,"496":1,"497":0,"498":0,"499":0,"500":0,"501":0,"504":0,"509":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/promises/fs.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/promises/fs.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":25}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":42}},"3":{"start":{"line":6,"column":0},"end":{"line":12,"column":2}},"4":{"start":{"line":7,"column":20},"end":{"line":7,"column":93}},"5":{"start":{"line":7,"column":43},"end":{"line":7,"column":92}},"6":{"start":{"line":7,"column":74},"end":{"line":7,"column":91}}},"branchMap":{},"code":["'use strict';","","const fs = require('fs');","const helper = require('./promiseHelper');","","module.exports = {","\texists: toCheck => new Promise(fulfill => fs.exists(toCheck, isExists => fulfill(isExists))),","\tmakeDir: helper.callbackToPromise(fs.mkdir),","\treadFile: helper.callbackToPromise(fs.readFile),","\twriteFile: helper.callbackToPromise(fs.writeFile),","\tunlink: helper.callbackToPromise(fs.unlink)","};",""],"l":{"3":1,"4":1,"6":1,"7":0}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/promises/promiseHelper.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/promises/promiseHelper.js","s":{"1":1,"2":4,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"b":{"1":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":9},"end":{"line":13,"column":27}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":26,"column":2}},"2":{"start":{"line":13,"column":2},"end":{"line":24,"column":4}},"3":{"start":{"line":14,"column":3},"end":{"line":23,"column":6}},"4":{"start":{"line":15,"column":4},"end":{"line":21,"column":7}},"5":{"start":{"line":16,"column":5},"end":{"line":19,"column":6}},"6":{"start":{"line":17,"column":6},"end":{"line":17,"column":20}},"7":{"start":{"line":18,"column":6},"end":{"line":18,"column":13}},"8":{"start":{"line":20,"column":5},"end":{"line":20,"column":21}},"9":{"start":{"line":22,"column":4},"end":{"line":22,"column":41}}},"branchMap":{"1":{"line":16,"type":"if","locations":[{"start":{"line":16,"column":5},"end":{"line":16,"column":5}},{"start":{"line":16,"column":5},"end":{"line":16,"column":5}}]}},"code":["'use strict';","","module.exports = {","","\t/**","\t * Converts a method with a callback to the method that returns a promise.","\t * @param {Function} methodWithCallback The method with a callback.","\t * @returns {Function} The method that returns a promise.","\t */","\tcallbackToPromise: methodWithCallback => {","","\t\t/* eslint no-invalid-this:0 */","\t\treturn function(...args) {","\t\t\treturn new Promise((fulfill, reject) => {","\t\t\t\targs.push((error, result) => {","\t\t\t\t\tif (error) {","\t\t\t\t\t\treject(error);","\t\t\t\t\t\treturn;","\t\t\t\t\t}","\t\t\t\t\tfulfill(result);","\t\t\t\t});","\t\t\t\tmethodWithCallback.apply(this, args);","\t\t\t});","\t\t};","\t}","};",""],"l":{"3":1,"13":4,"14":0,"15":0,"16":0,"17":0,"18":0,"20":0,"22":0}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/helpers/hrTimeHelper.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/helpers/hrTimeHelper.js","s":{"1":1,"2":0},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":27,"column":2}},"2":{"start":{"line":25,"column":2},"end":{"line":25,"column":55}}},"branchMap":{},"code":["'use strict';","","module.exports = {","","\t/**","\t * Gets the high resolution time or the difference between","\t * previous and current time.","\t * @param {Array?} Previous high resolution timestamp.","\t * @returns {Array} The high resolution time tuple.","\t */","\tget: process.hrtime,","","\t/**","\t * Converts the high resolution timestamp to the text message.","\t * @param {Array} The high resolution time tuple.","\t * @returns {string} Time message.","\t */","\ttoMessage: require('pretty-hrtime'),","","\t/**","\t * Converts high resolution time to milliseconds number.","\t * @param {Array} hrTime The high resolution time tuple.","\t */","\ttoMilliseconds: hrTime => {","\t\treturn hrTime[0] * 1e3 + Math.round(hrTime[1] / 1e6);","\t}","};",""],"l":{"3":1,"25":0}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/builders/AppDefinitionsBuilder.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/builders/AppDefinitionsBuilder.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":1,"75":0,"76":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":29,"loc":{"start":{"line":29,"column":12},"end":{"line":29,"column":22}}},"2":{"name":"(anonymous_2)","line":59,"loc":{"start":{"line":59,"column":6},"end":{"line":59,"column":27}}},"3":{"name":"(anonymous_3)","line":135,"loc":{"start":{"line":135,"column":26},"end":{"line":135,"column":35}}},"4":{"name":"(anonymous_4)","line":159,"loc":{"start":{"line":159,"column":30},"end":{"line":159,"column":43}}},"5":{"name":"escapeTemplateSource","line":219,"loc":{"start":{"line":219,"column":0},"end":{"line":219,"column":38}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":29}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":38}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":56}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":56}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":60}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":52}},"7":{"start":{"line":9,"column":0},"end":{"line":9,"column":58}},"8":{"start":{"line":10,"column":0},"end":{"line":10,"column":57}},"9":{"start":{"line":12,"column":0},"end":{"line":12,"column":53}},"10":{"start":{"line":13,"column":0},"end":{"line":13,"column":49}},"11":{"start":{"line":14,"column":0},"end":{"line":14,"column":42}},"12":{"start":{"line":15,"column":0},"end":{"line":15,"column":50}},"13":{"start":{"line":16,"column":0},"end":{"line":16,"column":49}},"14":{"start":{"line":17,"column":0},"end":{"line":17,"column":59}},"15":{"start":{"line":18,"column":0},"end":{"line":18,"column":47}},"16":{"start":{"line":36,"column":2},"end":{"line":36,"column":47}},"17":{"start":{"line":43,"column":2},"end":{"line":43,"column":77}},"18":{"start":{"line":50,"column":2},"end":{"line":50,"column":40}},"19":{"start":{"line":60,"column":2},"end":{"line":63,"column":4}},"20":{"start":{"line":64,"column":2},"end":{"line":67,"column":4}},"21":{"start":{"line":69,"column":2},"end":{"line":69,"column":39}},"22":{"start":{"line":70,"column":2},"end":{"line":70,"column":112}},"23":{"start":{"line":72,"column":2},"end":{"line":126,"column":58}},"24":{"start":{"line":75,"column":17},"end":{"line":84,"column":7}},"25":{"start":{"line":80,"column":22},"end":{"line":84,"column":5}},"26":{"start":{"line":87,"column":4},"end":{"line":115,"column":7}},"27":{"start":{"line":89,"column":6},"end":{"line":91,"column":8}},"28":{"start":{"line":92,"column":6},"end":{"line":92,"column":75}},"29":{"start":{"line":93,"column":6},"end":{"line":93,"column":34}},"30":{"start":{"line":95,"column":6},"end":{"line":108,"column":7}},"31":{"start":{"line":96,"column":7},"end":{"line":96,"column":62}},"32":{"start":{"line":99,"column":7},"end":{"line":107,"column":10}},"33":{"start":{"line":100,"column":8},"end":{"line":102,"column":9}},"34":{"start":{"line":101,"column":9},"end":{"line":101,"column":83}},"35":{"start":{"line":103,"column":8},"end":{"line":106,"column":9}},"36":{"start":{"line":105,"column":9},"end":{"line":105,"column":94}},"37":{"start":{"line":110,"column":6},"end":{"line":114,"column":77}},"38":{"start":{"line":118,"column":4},"end":{"line":118,"column":47}},"39":{"start":{"line":119,"column":4},"end":{"line":123,"column":7}},"40":{"start":{"line":124,"column":4},"end":{"line":124,"column":26}},"41":{"start":{"line":126,"column":20},"end":{"line":126,"column":56}},"42":{"start":{"line":136,"column":2},"end":{"line":136,"column":27}},"43":{"start":{"line":137,"column":2},"end":{"line":149,"column":6}},"44":{"start":{"line":140,"column":4},"end":{"line":142,"column":6}},"45":{"start":{"line":143,"column":4},"end":{"line":144,"column":39}},"46":{"start":{"line":145,"column":4},"end":{"line":147,"column":5}},"47":{"start":{"line":146,"column":5},"end":{"line":146,"column":12}},"48":{"start":{"line":148,"column":4},"end":{"line":148,"column":86}},"49":{"start":{"line":150,"column":2},"end":{"line":150,"column":50}},"50":{"start":{"line":160,"column":2},"end":{"line":160,"column":22}},"51":{"start":{"line":162,"column":2},"end":{"line":206,"column":6}},"52":{"start":{"line":164,"column":4},"end":{"line":164,"column":55}},"53":{"start":{"line":165,"column":4},"end":{"line":166,"column":42}},"54":{"start":{"line":167,"column":4},"end":{"line":167,"column":83}},"55":{"start":{"line":168,"column":4},"end":{"line":168,"column":70}},"56":{"start":{"line":170,"column":4},"end":{"line":170,"column":20}},"57":{"start":{"line":172,"column":4},"end":{"line":176,"column":5}},"58":{"start":{"line":173,"column":5},"end":{"line":173,"column":38}},"59":{"start":{"line":175,"column":5},"end":{"line":175,"column":37}},"60":{"start":{"line":178,"column":4},"end":{"line":181,"column":5}},"61":{"start":{"line":180,"column":5},"end":{"line":180,"column":12}},"62":{"start":{"line":183,"column":4},"end":{"line":183,"column":54}},"63":{"start":{"line":184,"column":4},"end":{"line":204,"column":8}},"64":{"start":{"line":185,"column":17},"end":{"line":185,"column":87}},"65":{"start":{"line":186,"column":17},"end":{"line":186,"column":55}},"66":{"start":{"line":188,"column":6},"end":{"line":188,"column":69}},"67":{"start":{"line":189,"column":6},"end":{"line":189,"column":55}},"68":{"start":{"line":190,"column":6},"end":{"line":191,"column":80}},"69":{"start":{"line":192,"column":6},"end":{"line":193,"column":68}},"70":{"start":{"line":194,"column":6},"end":{"line":203,"column":3}},"71":{"start":{"line":205,"column":4},"end":{"line":205,"column":27}},"72":{"start":{"line":208,"column":2},"end":{"line":210,"column":45}},"73":{"start":{"line":210,"column":23},"end":{"line":210,"column":43}},"74":{"start":{"line":219,"column":0},"end":{"line":226,"column":1}},"75":{"start":{"line":220,"column":1},"end":{"line":225,"column":25}},"76":{"start":{"line":228,"column":0},"end":{"line":228,"column":39}}},"branchMap":{"1":{"line":92,"type":"cond-expr","locations":[{"start":{"line":92,"column":39},"end":{"line":92,"column":65}},{"start":{"line":92,"column":68},"end":{"line":92,"column":74}}]},"2":{"line":95,"type":"if","locations":[{"start":{"line":95,"column":6},"end":{"line":95,"column":6}},{"start":{"line":95,"column":6},"end":{"line":95,"column":6}}]},"3":{"line":100,"type":"if","locations":[{"start":{"line":100,"column":8},"end":{"line":100,"column":8}},{"start":{"line":100,"column":8},"end":{"line":100,"column":8}}]},"4":{"line":103,"type":"if","locations":[{"start":{"line":103,"column":8},"end":{"line":103,"column":8}},{"start":{"line":103,"column":8},"end":{"line":103,"column":8}}]},"5":{"line":103,"type":"binary-expr","locations":[{"start":{"line":103,"column":12},"end":{"line":103,"column":44}},{"start":{"line":104,"column":10},"end":{"line":104,"column":53}}]},"6":{"line":143,"type":"cond-expr","locations":[{"start":{"line":144,"column":5},"end":{"line":144,"column":31}},{"start":{"line":144,"column":34},"end":{"line":144,"column":38}}]},"7":{"line":145,"type":"if","locations":[{"start":{"line":145,"column":4},"end":{"line":145,"column":4}},{"start":{"line":145,"column":4},"end":{"line":145,"column":4}}]},"8":{"line":165,"type":"binary-expr","locations":[{"start":{"line":165,"column":22},"end":{"line":165,"column":64}},{"start":{"line":166,"column":6},"end":{"line":166,"column":41}}]},"9":{"line":178,"type":"if","locations":[{"start":{"line":178,"column":4},"end":{"line":178,"column":4}},{"start":{"line":178,"column":4},"end":{"line":178,"column":4}}]},"10":{"line":178,"type":"binary-expr","locations":[{"start":{"line":178,"column":8},"end":{"line":178,"column":43}},{"start":{"line":179,"column":5},"end":{"line":179,"column":63}}]},"11":{"line":190,"type":"cond-expr","locations":[{"start":{"line":191,"column":10},"end":{"line":191,"column":70}},{"start":{"line":191,"column":73},"end":{"line":191,"column":79}}]},"12":{"line":192,"type":"cond-expr","locations":[{"start":{"line":193,"column":10},"end":{"line":193,"column":58}},{"start":{"line":193,"column":61},"end":{"line":193,"column":67}}]}},"code":["'use strict';","","const path = require('path');","const pfs = require('../promises/fs');","const hrTimeHelper = require('../helpers/hrTimeHelper');","const moduleHelper = require('../helpers/moduleHelper');","const templateHelper = require('../helpers/templateHelper');","const loadHelper = require('../helpers/loadHelper');","const requireHelper = require('../helpers/requireHelper');","const RouteParser = require('../tokenizers/RouteParser');","","const APP_DEFINITIONS_FILENAME = 'appDefinitions.js';","const LIB_ROOT_PATH = path.join(__dirname, '..');","const STORES_REPLACE = '/** __stores **/';","const COMPONENTS_REPLACE = '/** __components **/';","const ROUTE_DESCRIPTORS_REPLACE = '\\'__routes\\'';","const ROUTE_DEFINITIONS_REPLACE = '\\'__routeDefinitions\\'';","const ROUTE_DEFINITIONS_FILENAME = 'routes.js';","","/**"," * Implements the app definitions builder module."," */","class AppDefinitionsBuilder {","","\t/**","\t * Creates a new instance of the app definitions builder.","\t * @param {ServiceLocator} locator The Service Locator for resolving dependencies.","\t */","\tconstructor(locator) {","","\t\t/**","\t\t * Current event bus.","\t\t * @type {EventEmitter}","\t\t * @private","\t\t */","\t\tthis._eventBus = locator.resolve('eventBus');","","\t\t/**","\t\t * Current template provider list.","\t\t * @type {Array<TemplateProvider>}","\t\t * @private","\t\t */","\t\tthis._templateProviders = templateHelper.resolveTemplateProviders(locator);","","\t\t/**","\t\t * Current route parser.","\t\t * @type {RouteParser}","\t\t * @private","\t\t */","\t\tthis._routeParser = new RouteParser();","\t}","","\t/**","\t * Creates a real app definitions code from the template.","\t * @param {Object} stores The found stores by their names.","\t * @param {Object} components The found components by their names.","\t * @returns {Promise<string>} The promise for the source code of the app definitions.","\t */","\tbuild(stores, components) {","\t\tconst appDefinitionsTemplatePath = path.join(","\t\t\tLIB_ROOT_PATH,","\t\t\tAPP_DEFINITIONS_FILENAME","\t\t);","\t\tconst routeDefinitionsPath = path.join(","\t\t\tprocess.cwd(),","\t\t\tROUTE_DEFINITIONS_FILENAME","\t\t);","","\t\tconst startTime = hrTimeHelper.get();","\t\tthis._eventBus.emit('info', `Building app definitions using the template \"${appDefinitionsTemplatePath}\"...`);","","\t\treturn pfs.readFile(appDefinitionsTemplatePath, {","\t\t\tencoding: 'utf8'","\t\t})","\t\t\t.then(file => Promise","\t\t\t\t.all([","\t\t\t\t\tthis._generateStoreDescriptors(stores),","\t\t\t\t\tthis._generateComponentDescriptors(components)","\t\t\t\t])","\t\t\t\t.then(results => ({","\t\t\t\t\tfile,","\t\t\t\t\tstores: results[0],","\t\t\t\t\tcomponents: results[1]","\t\t\t\t})))","\t\t\t// check if paths exist and create require statements or undefined","\t\t\t.then(context =>","\t\t\t\tpfs.exists(routeDefinitionsPath)","\t\t\t\t\t.then(isExists => {","\t\t\t\t\t\tconst filePath = path.relative(","\t\t\t\t\t\t\tprocess.cwd(), requireHelper.getValidPath(routeDefinitionsPath)","\t\t\t\t\t\t);","\t\t\t\t\t\tconst requireString = isExists ? `require('./${filePath}')` : 'null';","\t\t\t\t\t\tconst routeDescriptors = [];","","\t\t\t\t\t\tif (isExists) {","\t\t\t\t\t\t\tconst routeDefinitions = require(routeDefinitionsPath);","","\t\t\t\t\t\t\t/* eslint max-nested-callbacks: 0 */","\t\t\t\t\t\t\trouteDefinitions.forEach(definition => {","\t\t\t\t\t\t\t\tif (typeof (definition) === 'string') {","\t\t\t\t\t\t\t\t\trouteDescriptors.push(this._routeParser.parseRouteExpression(definition));","\t\t\t\t\t\t\t\t}","\t\t\t\t\t\t\t\tif (typeof (definition) === 'object' &&","\t\t\t\t\t\t\t\t\t\ttypeof (definition.expression) === 'string') {","\t\t\t\t\t\t\t\t\trouteDescriptors.push(this._routeParser.parseRouteExpression(definition.expression));","\t\t\t\t\t\t\t\t}","\t\t\t\t\t\t\t});","\t\t\t\t\t\t}","","\t\t\t\t\t\treturn context.file","\t\t\t\t\t\t\t.replace(COMPONENTS_REPLACE, context.components)","\t\t\t\t\t\t\t.replace(STORES_REPLACE, context.stores)","\t\t\t\t\t\t\t.replace(ROUTE_DEFINITIONS_REPLACE, requireString)","\t\t\t\t\t\t\t.replace(ROUTE_DESCRIPTORS_REPLACE, JSON.stringify(routeDescriptors));","\t\t\t\t\t})","\t\t\t)","\t\t\t.then(appDefinitions => {","\t\t\t\tconst hrTime = hrTimeHelper.get(startTime);","\t\t\t\tthis._eventBus.emit('appDefinitionsBuilt', {","\t\t\t\t\ttemplate: appDefinitionsTemplatePath,","\t\t\t\t\thrTime,","\t\t\t\t\ttime: hrTimeHelper.toMilliseconds(hrTime)","\t\t\t\t});","\t\t\t\treturn appDefinitions;","\t\t\t})","\t\t\t.catch(reason => this._eventBus.emit('error', reason));","\t}","","\t/**","\t * Generates inline descriptors for each store.","\t * @param {Object} stores The found stores by their names.","\t * @returns {Promise<string>} The promise for the JSON string that describes the stores.","\t * @private","\t */","\t_generateStoreDescriptors(stores) {","\t\tconst storeRequires = [];","\t\tObject","\t\t\t.keys(stores)","\t\t\t.forEach(storeName => {","\t\t\t\tconst filePath = requireHelper.getValidPath(","\t\t\t\t\tpath.relative(process.cwd(), stores[storeName].path)","\t\t\t\t);","\t\t\t\tconst requireExpression = stores[storeName].path ?","\t\t\t\t\t`require('./${filePath}')` : null;","\t\t\t\tif (!requireExpression) {","\t\t\t\t\treturn;","\t\t\t\t}","\t\t\t\tstoreRequires.push(`\\n{name: '${storeName}', constructor: ${requireExpression}}`);","\t\t\t});","\t\treturn Promise.resolve(storeRequires.join(','));","\t}","","\t/**","\t * Generates inline descriptors for each component.","\t * @param {Object} components The found components by their names.","\t * @returns {Promise<string>} The promise for the JSON string that describes the components.","\t * @private","\t */","\t_generateComponentDescriptors(components) {","\t\tconst promises = [];","","\t\tObject.keys(components)","\t\t\t.forEach(componentName => {","\t\t\t\tconst componentDetails = components[componentName];","\t\t\t\tconst logicFile = components[componentName].properties.logic ||","\t\t\t\t\t\tmoduleHelper.DEFAULT_LOGIC_FILENAME;","\t\t\t\tconst logicPath = path.resolve(path.dirname(componentDetails.path), logicFile);","\t\t\t\tconst relativeLogicPath = path.relative(process.cwd(), logicPath);","","\t\t\t\tvar constructor;","","\t\t\t\ttry {","\t\t\t\t\tconstructor = require(logicPath);","\t\t\t\t} catch (e) {","\t\t\t\t\tthis._eventBus.emit('error', e);","\t\t\t\t}","","\t\t\t\tif (typeof (constructor) !== 'function' ||","\t\t\t\t\ttypeof (componentDetails.properties.template) !== 'string') {","\t\t\t\t\treturn;","\t\t\t\t}","","\t\t\t\tconst component = Object.create(componentDetails);","\t\t\t\tconst promise = loadHelper.loadTemplateSources(component)","\t\t\t\t\t.then(() => loadHelper.assignTemplateProviders(component, this._templateProviders))","\t\t\t\t\t.then(() => loadHelper.compileTemplates(component))","\t\t\t\t\t.then(() => {","\t\t\t\t\t\tconst filePath = requireHelper.getValidPath(relativeLogicPath);","\t\t\t\t\t\tconst requireString = `require('./${filePath}')`;","\t\t\t\t\t\tconst errorTemplateString = component.compiledErrorTemplate !== null ?","\t\t\t\t\t\t\t\t\t\t`'${escapeTemplateSource(component.compiledErrorTemplate)}'` : 'null';","\t\t\t\t\t\tconst errorTemplateProvider = component.errorTemplateProvider !== null ?","\t\t\t\t\t\t\t\t\t\t`'${component.errorTemplateProvider.getName()}'` : 'null';","\t\t\t\t\t\treturn `","{","\tname: '${componentName}',","\tconstructor: ${requireString},","\tproperties: ${JSON.stringify(componentDetails.properties)},","\ttemplateProviderName: '${component.templateProvider.getName()}',","\tcompiledTemplate: '${escapeTemplateSource(component.compiledTemplate)}',","\terrorTemplateProviderName: ${errorTemplateProvider},","\tcompiledErrorTemplate: ${errorTemplateString}","}`;","\t\t\t\t\t});","\t\t\t\tpromises.push(promise);","\t\t\t});","","\t\treturn Promise","\t\t\t.all(promises)","\t\t\t.then(components => components.join(','));","\t}","}","","/**"," * Escapes template source code for including into the app definitions."," * @param {string} source The compiled template source."," * @returns {string} The escaped string."," */","function escapeTemplateSource(source) {","\treturn source","\t\t.replace(/(\\\\.)/g, '\\\\$&')","\t\t.replace(/'/g, '\\\\\\'')","\t\t.replace(/\\r/g, '\\\\r')","\t\t.replace(/\\n/g, '\\\\n')","\t\t.replace(/\\t/g, '\\\\t');","}","","module.exports = AppDefinitionsBuilder;",""],"l":{"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"36":0,"43":0,"50":0,"60":0,"64":0,"69":0,"70":0,"72":0,"75":0,"80":0,"87":0,"89":0,"92":0,"93":0,"95":0,"96":0,"99":0,"100":0,"101":0,"103":0,"105":0,"110":0,"118":0,"119":0,"124":0,"126":0,"136":0,"137":0,"140":0,"143":0,"145":0,"146":0,"148":0,"150":0,"160":0,"162":0,"164":0,"165":0,"167":0,"168":0,"170":0,"172":0,"173":0,"175":0,"178":0,"180":0,"183":0,"184":0,"185":0,"186":0,"188":0,"189":0,"190":0,"192":0,"194":0,"205":0,"208":0,"210":0,"219":1,"220":0,"228":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/helpers/templateHelper.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/helpers/templateHelper.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":1},"b":{"1":[0,0],"2":[0,0,0],"3":[0,0]},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":47}},"2":{"start":{"line":5,"column":0},"end":{"line":69,"column":2}},"3":{"start":{"line":14,"column":2},"end":{"line":14,"column":90}},"4":{"start":{"line":16,"column":2},"end":{"line":18,"column":4}},"5":{"start":{"line":17,"column":22},"end":{"line":17,"column":80}},"6":{"start":{"line":20,"column":2},"end":{"line":22,"column":3}},"7":{"start":{"line":21,"column":3},"end":{"line":21,"column":10}},"8":{"start":{"line":24,"column":2},"end":{"line":24,"column":81}},"9":{"start":{"line":25,"column":2},"end":{"line":25,"column":103}},"10":{"start":{"line":27,"column":2},"end":{"line":29,"column":4}},"11":{"start":{"line":28,"column":22},"end":{"line":28,"column":88}},"12":{"start":{"line":38,"column":2},"end":{"line":38,"column":47}},"13":{"start":{"line":39,"column":2},"end":{"line":53,"column":3}},"14":{"start":{"line":40,"column":3},"end":{"line":50,"column":7}},"15":{"start":{"line":43,"column":5},"end":{"line":45,"column":49}},"16":{"start":{"line":46,"column":5},"end":{"line":48,"column":6}},"17":{"start":{"line":47,"column":6},"end":{"line":47,"column":93}},"18":{"start":{"line":49,"column":5},"end":{"line":49,"column":20}},"19":{"start":{"line":52,"column":3},"end":{"line":52,"column":13}},"20":{"start":{"line":62,"column":2},"end":{"line":67,"column":27}},"21":{"start":{"line":65,"column":4},"end":{"line":65,"column":37}},"22":{"start":{"line":66,"column":4},"end":{"line":66,"column":15}},"23":{"start":{"line":71,"column":0},"end":{"line":71,"column":24}}},"branchMap":{"1":{"line":20,"type":"if","locations":[{"start":{"line":20,"column":2},"end":{"line":20,"column":2}},{"start":{"line":20,"column":2},"end":{"line":20,"column":2}}]},"2":{"line":43,"type":"binary-expr","locations":[{"start":{"line":43,"column":21},"end":{"line":43,"column":61}},{"start":{"line":44,"column":9},"end":{"line":44,"column":58}},{"start":{"line":45,"column":9},"end":{"line":45,"column":48}}]},"3":{"line":46,"type":"if","locations":[{"start":{"line":46,"column":5},"end":{"line":46,"column":5}},{"start":{"line":46,"column":5},"end":{"line":46,"column":5}}]}},"code":["'use strict';","","const moduleHelper = require('./moduleHelper');","","const helper = {","","\t/**","\t * Registers templates into the component and template providers.","\t * @param {Object} component The component.","\t * @param {{template: string, errorTemplate: string}} templates","\t * The compiled templates.","\t */","\tregisterTemplates: component => {","\t\tcomponent.templateProvider.registerCompiled(component.name, component.compiledTemplate);","","\t\tcomponent.template = {","\t\t\trender: context => component.templateProvider.render(component.name, context)","\t\t};","","\t\tif (!component.compiledErrorTemplate) {","\t\t\treturn;","\t\t}","","\t\tconst errorTemplateName = moduleHelper.getNameForErrorTemplate(component.name);","\t\tcomponent.errorTemplateProvider.registerCompiled(errorTemplateName, component.compiledErrorTemplate);","","\t\tcomponent.errorTemplate = {","\t\t\trender: context => component.errorTemplateProvider.render(errorTemplateName, context)","\t\t};","\t},","","\t/**","\t * Resolves valid template providers.","\t * @param {ServiceLocator} locator Service locator that has providers registered.","\t * @returns {Array<TemplateProvider>} List of template providers.","\t */","\tresolveTemplateProviders: locator => {","\t\tconst eventBus = locator.resolve('eventBus');","\t\ttry {","\t\t\treturn locator","\t\t\t\t.resolveAll('templateProvider')","\t\t\t\t.filter(provider => {","\t\t\t\t\tconst isValid = typeof (provider.getName) === 'function' &&","\t\t\t\t\t\t\t\t\ttypeof (provider.registerCompiled) === 'function' &&","\t\t\t\t\t\t\t\t\ttypeof (provider.render) === 'function';","\t\t\t\t\tif (!isValid) {","\t\t\t\t\t\teventBus.emit('warn', 'Template provider does not have required methods, skipping...');","\t\t\t\t\t}","\t\t\t\t\treturn isValid;","\t\t\t\t});","\t\t} catch (e) {","\t\t\treturn [];","\t\t}","\t},","","\t/**","\t * Resolves valid template providers by names.","\t * @param {ServiceLocator} locator Service locator that has providers registered.","\t * @returns {Object} Map of template providers by names.","\t */","\tresolveTemplateProvidersByNames: locator => {","\t\treturn helper","\t\t\t.resolveTemplateProviders(locator)","\t\t\t.reduce((map, current) => {","\t\t\t\tmap[current.getName()] = current;","\t\t\t\treturn map;","\t\t\t}, Object.create(null));","\t}","};","","module.exports = helper;",""],"l":{"3":1,"5":1,"14":0,"16":0,"17":0,"20":0,"21":0,"24":0,"25":0,"27":0,"28":0,"38":0,"39":0,"40":0,"43":0,"46":0,"47":0,"49":0,"52":0,"62":0,"65":0,"66":0,"71":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/helpers/loadHelper.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/helpers/loadHelper.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":1,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"findTemplateProvider","line":108,"loc":{"start":{"line":108,"column":0},"end":{"line":108,"column":68}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":29}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":37}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":47}},"4":{"start":{"line":7,"column":0},"end":{"line":98,"column":2}},"5":{"start":{"line":16,"column":2},"end":{"line":16,"column":120}},"6":{"start":{"line":17,"column":2},"end":{"line":19,"column":3}},"7":{"start":{"line":18,"column":3},"end":{"line":18,"column":171}},"8":{"start":{"line":21,"column":2},"end":{"line":21,"column":41}},"9":{"start":{"line":22,"column":2},"end":{"line":24,"column":3}},"10":{"start":{"line":23,"column":3},"end":{"line":23,"column":10}},"11":{"start":{"line":25,"column":2},"end":{"line":25,"column":135}},"12":{"start":{"line":26,"column":2},"end":{"line":28,"column":3}},"13":{"start":{"line":27,"column":3},"end":{"line":27,"column":182}},"14":{"start":{"line":37,"column":2},"end":{"line":47,"column":6}},"15":{"start":{"line":39,"column":4},"end":{"line":42,"column":6}},"16":{"start":{"line":43,"column":4},"end":{"line":46,"column":8}},"17":{"start":{"line":45,"column":6},"end":{"line":45,"column":51}},"18":{"start":{"line":49,"column":2},"end":{"line":64,"column":6}},"19":{"start":{"line":51,"column":4},"end":{"line":51,"column":41}},"20":{"start":{"line":52,"column":4},"end":{"line":52,"column":60}},"21":{"start":{"line":53,"column":4},"end":{"line":55,"column":5}},"22":{"start":{"line":54,"column":5},"end":{"line":54,"column":17}},"23":{"start":{"line":56,"column":4},"end":{"line":59,"column":6}},"24":{"start":{"line":60,"column":4},"end":{"line":63,"column":8}},"25":{"start":{"line":62,"column":6},"end":{"line":62,"column":56}},"26":{"start":{"line":66,"column":2},"end":{"line":68,"column":5}},"27":{"start":{"line":77,"column":2},"end":{"line":78,"column":93}},"28":{"start":{"line":78,"column":15},"end":{"line":78,"column":91}},"29":{"start":{"line":80,"column":2},"end":{"line":80,"column":81}},"30":{"start":{"line":81,"column":2},"end":{"line":87,"column":6}},"31":{"start":{"line":83,"column":4},"end":{"line":85,"column":5}},"32":{"start":{"line":84,"column":5},"end":{"line":84,"column":17}},"33":{"start":{"line":86,"column":4},"end":{"line":86,"column":101}},"34":{"start":{"line":89,"column":2},"end":{"line":96,"column":6}},"35":{"start":{"line":94,"column":4},"end":{"line":94,"column":54}},"36":{"start":{"line":95,"column":4},"end":{"line":95,"column":67}},"37":{"start":{"line":108,"column":0},"end":{"line":118,"column":1}},"38":{"start":{"line":109,"column":1},"end":{"line":109,"column":29}},"39":{"start":{"line":110,"column":1},"end":{"line":116,"column":4}},"40":{"start":{"line":111,"column":2},"end":{"line":114,"column":3}},"41":{"start":{"line":112,"column":3},"end":{"line":112,"column":31}},"42":{"start":{"line":113,"column":3},"end":{"line":113,"column":15}},"43":{"start":{"line":115,"column":2},"end":{"line":115,"column":15}},"44":{"start":{"line":117,"column":1},"end":{"line":117,"column":25}},"45":{"start":{"line":120,"column":0},"end":{"line":120,"column":24}}},"branchMap":{"1":{"line":17,"type":"if","locations":[{"start":{"line":17,"column":2},"end":{"line":17,"column":2}},{"start":{"line":17,"column":2},"end":{"line":17,"column":2}}]},"2":{"line":22,"type":"if","locations":[{"start":{"line":22,"column":2},"end":{"line":22,"column":2}},{"start":{"line":22,"column":2},"end":{"line":22,"column":2}}]},"3":{"line":26,"type":"if","locations":[{"start":{"line":26,"column":2},"end":{"line":26,"column":2}},{"start":{"line":26,"column":2},"end":{"line":26,"column":2}}]},"4":{"line":53,"type":"if","locations":[{"start":{"line":53,"column":4},"end":{"line":53,"column":4}},{"start":{"line":53,"column":4},"end":{"line":53,"column":4}}]},"5":{"line":83,"type":"if","locations":[{"start":{"line":83,"column":4},"end":{"line":83,"column":4}},{"start":{"line":83,"column":4},"end":{"line":83,"column":4}}]},"6":{"line":95,"type":"binary-expr","locations":[{"start":{"line":95,"column":38},"end":{"line":95,"column":58}},{"start":{"line":95,"column":62},"end":{"line":95,"column":66}}]},"7":{"line":111,"type":"if","locations":[{"start":{"line":111,"column":2},"end":{"line":111,"column":2}},{"start":{"line":111,"column":2},"end":{"line":111,"column":2}}]}},"code":["'use strict';","","const path = require('path');","const fs = require('../promises/fs');","const moduleHelper = require('./moduleHelper');","","const helper = {","","\t/**","\t * Assigns template engines for component's templates.","\t * @param {Object} component The component.","\t * @param {Array<TemplateProvider>} providers Template providers to assign.","\t * @private","\t */","\tassignTemplateProviders: (component, providers) => {","\t\tcomponent.templateProvider = findTemplateProvider(providers, component.properties.template, component.templateSource);","\t\tif (!component.templateProvider) {","\t\t\tthrow new Error(`No template provider found that would be able to compile and render the template \"${component.properties.template}\" in \"${component.name}\" component`);","\t\t}","","\t\tcomponent.errorTemplateProvider = null;","\t\tif (typeof (component.errorTemplateSource) !== 'string') {","\t\t\treturn;","\t\t}","\t\tcomponent.errorTemplateProvider = findTemplateProvider(providers, component.properties.errorTemplate, component.errorTemplateSource);","\t\tif (!component.errorTemplateProvider) {","\t\t\tthrow new Error(`No template provider found that would be able to compile and render the error template \"${component.properties.errorTemplate}\" in \"${component.name}\" component`);","\t\t}","\t},","","\t/**","\t * Loads template sources from the files.","\t * @param {Object} component The component.","\t * @returns {Promise} The promise for finished work.","\t */","\tloadTemplateSources: component => {","\t\tconst templateSourcePromise = Promise.resolve()","\t\t\t.then(() => {","\t\t\t\tconst templatePath = path.resolve(","\t\t\t\t\tpath.dirname(component.path),","\t\t\t\t\tcomponent.properties.template","\t\t\t\t);","\t\t\t\treturn fs.readFile(templatePath)","\t\t\t\t\t.then(source => {","\t\t\t\t\t\tcomponent.templateSource = source.toString();","\t\t\t\t\t});","\t\t\t});","","\t\tconst errorTemplateSourcePromise = Promise.resolve()","\t\t\t.then(() => {","\t\t\t\tcomponent.errorTemplateSource = null;","\t\t\t\tconst relativePath = component.properties.errorTemplate;","\t\t\t\tif (typeof (relativePath) !== 'string') {","\t\t\t\t\treturn null;","\t\t\t\t}","\t\t\t\tconst templatePath = path.resolve(","\t\t\t\t\tpath.dirname(component.path),","\t\t\t\t\trelativePath","\t\t\t\t);","\t\t\t\treturn fs.readFile(templatePath)","\t\t\t\t\t.then(source => {","\t\t\t\t\t\tcomponent.errorTemplateSource = source.toString();","\t\t\t\t\t});","\t\t\t});","","\t\treturn Promise.all([","\t\t\ttemplateSourcePromise, errorTemplateSourcePromise","\t\t]);","\t},","","\t/**","\t * Compiles template sources of the component.","\t * @param {Object} component The component.","\t * @returns {Promise} The promise for finished work.","\t */","\tcompileTemplates: component => {","\t\tconst templateCompilePromise = Promise.resolve()","\t\t\t.then(() => component.templateProvider.compile(component.templateSource, component.name));","","\t\tconst errorTemplateName = moduleHelper.getNameForErrorTemplate(component.name);","\t\tconst errorTemplateCompilePromise = Promise.resolve()","\t\t\t.then(() => {","\t\t\t\tif (!component.errorTemplateSource) {","\t\t\t\t\treturn null;","\t\t\t\t}","\t\t\t\treturn component.errorTemplateProvider.compile(component.errorTemplateSource, errorTemplateName);","\t\t\t});","","\t\treturn Promise.all([","\t\t\ttemplateCompilePromise,","\t\t\terrorTemplateCompilePromise","\t\t])","\t\t\t.then(compiledTemplates => {","\t\t\t\tcomponent.compiledTemplate = compiledTemplates[0];","\t\t\t\tcomponent.compiledErrorTemplate = compiledTemplates[1] || null;","\t\t\t});","\t}","};","","/**"," * Finds a template provider that would work with the template."," * @param {Array<TemplateProviders>} providers List of template providers."," * @param {string} filename Filename of the template."," * @param {string} templateContent Content of the template file."," * @returns {TemplateProvider|null} Template provider that supports the template."," * @private"," */","function findTemplateProvider(providers, filename, templateContent) {","\tvar templateProvider = null;","\tproviders.some(provider => {","\t\tif (provider.isTemplateSupported(filename, templateContent)) {","\t\t\ttemplateProvider = provider;","\t\t\treturn true;","\t\t}","\t\treturn false;","\t});","\treturn templateProvider;","}","","module.exports = helper;",""],"l":{"3":1,"4":1,"5":1,"7":1,"16":0,"17":0,"18":0,"21":0,"22":0,"23":0,"25":0,"26":0,"27":0,"37":0,"39":0,"43":0,"45":0,"49":0,"51":0,"52":0,"53":0,"54":0,"56":0,"60":0,"62":0,"66":0,"77":0,"78":0,"80":0,"81":0,"83":0,"84":0,"86":0,"89":0,"94":0,"95":0,"108":1,"109":0,"110":0,"111":0,"112":0,"113":0,"115":0,"117":0,"120":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/helpers/requireHelper.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/helpers/requireHelper.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0},"b":{"1":[0,0],"2":[0,0]},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":29}},"2":{"start":{"line":5,"column":0},"end":{"line":32,"column":2}},"3":{"start":{"line":12,"column":37},"end":{"line":12,"column":67}},"4":{"start":{"line":19,"column":2},"end":{"line":19,"column":18}},"5":{"start":{"line":20,"column":2},"end":{"line":20,"column":40}},"6":{"start":{"line":21,"column":2},"end":{"line":21,"column":28}},"7":{"start":{"line":29,"column":23},"end":{"line":31,"column":4}}},"branchMap":{"1":{"line":19,"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":17}}]},"2":{"line":29,"type":"cond-expr","locations":[{"start":{"line":30,"column":2},"end":{"line":30,"column":29}},{"start":{"line":31,"column":2},"end":{"line":31,"column":4}}]}},"code":["'use strict';","","const path = require('path');","","module.exports = {","","\t/**","\t * Creates an absolute path for the require call.","\t * @param {string} filename The path to the file.","\t * @returns {string} The absolute path to the file.","\t */","\tgetAbsoluteRequirePath: filename => `${process.cwd()}/${filename}`,","","\t/**","\t * Clears the Node.js require cache for the specified key.","\t * @param {string} key The cache key.","\t */","\tclearCacheKey: key => {","\t\tkey = key || '';","\t\tkey = key.replace(/\\\\|\\//g, path.sep);","\t\tdelete require.cache[key];","\t},","","\t/**","\t * Gets a valid require path replacing all backslashes with slashes.","\t * @param {string} path The path to the file.","\t * @returns {string} The valid require path.","\t */","\tgetValidPath: path => typeof (path) === 'string' ?","\t\tpath.replace(/\\\\/g, '\\\\\\\\') :","\t\t''","};",""],"l":{"3":1,"5":1,"12":0,"19":0,"20":0,"21":0,"29":0}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/tokenizers/RouteParser.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/tokenizers/RouteParser.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":1,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":1,"76":0,"77":1,"78":0,"79":0,"80":0,"81":0,"82":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0,0,0,0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":20,"loc":{"start":{"line":20,"column":12},"end":{"line":20,"column":15}}},"2":{"name":"(anonymous_2)","line":37,"loc":{"start":{"line":37,"column":21},"end":{"line":37,"column":34}}},"3":{"name":"(anonymous_3)","line":88,"loc":{"start":{"line":88,"column":27},"end":{"line":88,"column":40}}},"4":{"name":"buildMatcher","line":150,"loc":{"start":{"line":150,"column":0},"end":{"line":150,"column":58}}},"5":{"name":"createParameterDescriptor","line":185,"loc":{"start":{"line":185,"column":0},"end":{"line":185,"column":37}}},"6":{"name":"createSpaces","line":199,"loc":{"start":{"line":199,"column":0},"end":{"line":199,"column":29}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":50}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":44}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":70}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":28}},"5":{"start":{"line":8,"column":0},"end":{"line":8,"column":55}},"6":{"start":{"line":9,"column":0},"end":{"line":9,"column":41}},"7":{"start":{"line":10,"column":0},"end":{"line":10,"column":58}},"8":{"start":{"line":27,"column":2},"end":{"line":27,"column":50}},"9":{"start":{"line":38,"column":2},"end":{"line":38,"column":44}},"10":{"start":{"line":39,"column":2},"end":{"line":39,"column":70}},"11":{"start":{"line":42,"column":2},"end":{"line":42,"column":73}},"12":{"start":{"line":43,"column":2},"end":{"line":43,"column":103}},"13":{"start":{"line":46,"column":2},"end":{"line":46,"column":29}},"14":{"start":{"line":48,"column":2},"end":{"line":72,"column":3}},"15":{"start":{"line":49,"column":3},"end":{"line":49,"column":50}},"16":{"start":{"line":50,"column":3},"end":{"line":70,"column":7}},"17":{"start":{"line":52,"column":5},"end":{"line":52,"column":66}},"18":{"start":{"line":53,"column":5},"end":{"line":53,"column":92}},"19":{"start":{"line":55,"column":5},"end":{"line":57,"column":11}},"20":{"start":{"line":58,"column":5},"end":{"line":60,"column":11}},"21":{"start":{"line":62,"column":5},"end":{"line":69,"column":8}},"22":{"start":{"line":74,"column":2},"end":{"line":79,"column":4}},"23":{"start":{"line":89,"column":2},"end":{"line":91,"column":3}},"24":{"start":{"line":90,"column":3},"end":{"line":90,"column":13}},"25":{"start":{"line":92,"column":2},"end":{"line":92,"column":48}},"26":{"start":{"line":94,"column":2},"end":{"line":94,"column":49}},"27":{"start":{"line":96,"column":2},"end":{"line":96,"column":24}},"28":{"start":{"line":97,"column":2},"end":{"line":97,"column":55}},"29":{"start":{"line":98,"column":2},"end":{"line":98,"column":53}},"30":{"start":{"line":99,"column":2},"end":{"line":99,"column":42}},"31":{"start":{"line":101,"column":2},"end":{"line":136,"column":46}},"32":{"start":{"line":102,"column":3},"end":{"line":102,"column":41}},"33":{"start":{"line":104,"column":3},"end":{"line":134,"column":4}},"34":{"start":{"line":106,"column":5},"end":{"line":106,"column":49}},"35":{"start":{"line":107,"column":5},"end":{"line":107,"column":11}},"36":{"start":{"line":109,"column":5},"end":{"line":109,"column":88}},"37":{"start":{"line":110,"column":5},"end":{"line":110,"column":11}},"38":{"start":{"line":112,"column":5},"end":{"line":112,"column":86}},"39":{"start":{"line":113,"column":5},"end":{"line":113,"column":11}},"40":{"start":{"line":115,"column":5},"end":{"line":121,"column":6}},"41":{"start":{"line":116,"column":6},"end":{"line":116,"column":48}},"42":{"start":{"line":117,"column":6},"end":{"line":117,"column":59}},"43":{"start":{"line":118,"column":6},"end":{"line":118,"column":42}},"44":{"start":{"line":119,"column":6},"end":{"line":119,"column":40}},"45":{"start":{"line":120,"column":6},"end":{"line":120,"column":53}},"46":{"start":{"line":122,"column":5},"end":{"line":122,"column":11}},"47":{"start":{"line":124,"column":5},"end":{"line":124,"column":45}},"48":{"start":{"line":125,"column":5},"end":{"line":125,"column":58}},"49":{"start":{"line":126,"column":5},"end":{"line":126,"column":41}},"50":{"start":{"line":127,"column":5},"end":{"line":127,"column":39}},"51":{"start":{"line":128,"column":5},"end":{"line":128,"column":52}},"52":{"start":{"line":129,"column":5},"end":{"line":129,"column":11}},"53":{"start":{"line":131,"column":5},"end":{"line":131,"column":80}},"54":{"start":{"line":132,"column":5},"end":{"line":132,"column":151}},"55":{"start":{"line":133,"column":5},"end":{"line":133,"column":35}},"56":{"start":{"line":138,"column":2},"end":{"line":138,"column":20}},"57":{"start":{"line":150,"column":0},"end":{"line":179,"column":1}},"58":{"start":{"line":151,"column":1},"end":{"line":151,"column":24}},"59":{"start":{"line":152,"column":1},"end":{"line":152,"column":28}},"60":{"start":{"line":153,"column":1},"end":{"line":153,"column":52}},"61":{"start":{"line":155,"column":1},"end":{"line":175,"column":2}},"62":{"start":{"line":157,"column":2},"end":{"line":165,"column":3}},"63":{"start":{"line":158,"column":3},"end":{"line":160,"column":4}},"64":{"start":{"line":161,"column":3},"end":{"line":161,"column":24}},"65":{"start":{"line":162,"column":3},"end":{"line":162,"column":50}},"66":{"start":{"line":163,"column":3},"end":{"line":163,"column":30}},"67":{"start":{"line":164,"column":3},"end":{"line":164,"column":12}},"68":{"start":{"line":167,"column":2},"end":{"line":167,"column":32}},"69":{"start":{"line":169,"column":2},"end":{"line":172,"column":3}},"70":{"start":{"line":170,"column":3},"end":{"line":170,"column":34}},"71":{"start":{"line":171,"column":3},"end":{"line":171,"column":12}},"72":{"start":{"line":174,"column":2},"end":{"line":174,"column":26}},"73":{"start":{"line":177,"column":1},"end":{"line":177,"column":21}},"74":{"start":{"line":178,"column":1},"end":{"line":178,"column":21}},"75":{"start":{"line":185,"column":0},"end":{"line":192,"column":1}},"76":{"start":{"line":186,"column":1},"end":{"line":191,"column":3}},"77":{"start":{"line":199,"column":0},"end":{"line":206,"column":1}},"78":{"start":{"line":200,"column":1},"end":{"line":200,"column":17}},"79":{"start":{"line":202,"column":1},"end":{"line":204,"column":2}},"80":{"start":{"line":203,"column":2},"end":{"line":203,"column":16}},"81":{"start":{"line":205,"column":1},"end":{"line":205,"column":15}},"82":{"start":{"line":208,"column":0},"end":{"line":208,"column":29}}},"branchMap":{"1":{"line":48,"type":"if","locations":[{"start":{"line":48,"column":2},"end":{"line":48,"column":2}},{"start":{"line":48,"column":2},"end":{"line":48,"column":2}}]},"2":{"line":48,"type":"binary-expr","locations":[{"start":{"line":48,"column":6},"end":{"line":48,"column":25}},{"start":{"line":48,"column":29},"end":{"line":48,"column":55}}]},"3":{"line":55,"type":"cond-expr","locations":[{"start":{"line":56,"column":6},"end":{"line":56,"column":56}},{"start":{"line":57,"column":6},"end":{"line":57,"column":10}}]},"4":{"line":58,"type":"cond-expr","locations":[{"start":{"line":59,"column":6},"end":{"line":59,"column":81}},{"start":{"line":60,"column":6},"end":{"line":60,"column":10}}]},"5":{"line":89,"type":"if","locations":[{"start":{"line":89,"column":2},"end":{"line":89,"column":2}},{"start":{"line":89,"column":2},"end":{"line":89,"column":2}}]},"6":{"line":104,"type":"switch","locations":[{"start":{"line":105,"column":4},"end":{"line":107,"column":11}},{"start":{"line":108,"column":4},"end":{"line":110,"column":11}},{"start":{"line":111,"column":4},"end":{"line":113,"column":11}},{"start":{"line":114,"column":4},"end":{"line":122,"column":11}},{"start":{"line":123,"column":4},"end":{"line":129,"column":11}},{"start":{"line":130,"column":4},"end":{"line":133,"column":35}}]},"7":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":5},"end":{"line":115,"column":5}},{"start":{"line":115,"column":5},"end":{"line":115,"column":5}}]},"8":{"line":157,"type":"if","locations":[{"start":{"line":157,"column":2},"end":{"line":157,"column":2}},{"start":{"line":157,"column":2},"end":{"line":157,"column":2}}]},"9":{"line":157,"type":"binary-expr","locations":[{"start":{"line":157,"column":6},"end":{"line":157,"column":19}},{"start":{"line":157,"column":23},"end":{"line":157,"column":48}}]},"10":{"line":169,"type":"if","locations":[{"start":{"line":169,"column":2},"end":{"line":169,"column":2}},{"start":{"line":169,"column":2},"end":{"line":169,"column":2}}]}},"code":["'use strict';","","const uriHelper = require('../helpers/uriHelper');","const catberryUri = require('catberry-uri');","const RouteParameterTokenizer = require('./RouteExpressionTokenizer');","const URI = catberryUri.URI;","","const PATH_SUBSTITUTE_REG_EXP_SOURCE = '([^\\\\/\\\\\\\\]*)';","const SUBSTITUTE_REG_EXP_SOURCE = '(.*)';","const REG_EXP_ESCAPE = /[\\-\\[\\]\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/;","","/**"," * Implements the route parser for the server environment."," */","class RouteParser {","","\t/**","\t * Creates a new instance of the route parser.","\t */","\tconstructor() {","","\t\t/**","\t\t * Current parameter string tokenizer.","\t\t * @type {RouteParameterTokenizer}","\t\t * @private","\t\t */","\t\tthis._tokenizer = new RouteParameterTokenizer();","\t}","","\t/**","\t * Creates route descriptor from the route expression.","\t * @param {string} expression Route expression.","\t * @returns {{expression: string, pathParameters: Array, queryParameters: Array, pathRegExpSource: string}}","\t * Route descriptor.","\t * @private","\t */","\tparseRouteExpression(expression) {","\t\tconst expressionUri = new URI(expression);","\t\tconst expressionPath = uriHelper.removeEndSlash(expressionUri.path);","","\t\t// finding required parameters in URI path for using the route","\t\tconst pathParameters = this._parseExpressionParameters(expressionPath);","\t\tconst matchExpression = buildMatcher(expressionPath, pathParameters, PATH_SUBSTITUTE_REG_EXP_SOURCE);","","\t\t// finding optional route parameters in query string","\t\tconst queryParameters = [];","","\t\tif (expressionUri.query && expressionUri.query.values) {","\t\t\tconst queryValues = expressionUri.query.values;","\t\t\tObject.keys(queryValues)","\t\t\t\t.forEach(name => {","\t\t\t\t\tconst nameParameters = this._parseExpressionParameters(name);","\t\t\t\t\tconst nameRegExpSource = buildMatcher(name, nameParameters, SUBSTITUTE_REG_EXP_SOURCE);","","\t\t\t\t\tconst valueParameters = queryValues[name] !== null ?","\t\t\t\t\t\tthis._parseExpressionParameters(queryValues[name]) :","\t\t\t\t\t\tnull;","\t\t\t\t\tconst valueRegExpSource = valueParameters ?","\t\t\t\t\t\tbuildMatcher(queryValues[name], valueParameters, SUBSTITUTE_REG_EXP_SOURCE) :","\t\t\t\t\t\tnull;","","\t\t\t\t\tqueryParameters.push({","\t\t\t\t\t\tnameExpression: name,","\t\t\t\t\t\tvalueExpression: queryValues[name],","\t\t\t\t\t\tnameParameters,","\t\t\t\t\t\tvalueParameters,","\t\t\t\t\t\tnameRegExpSource,","\t\t\t\t\t\tvalueRegExpSource","\t\t\t\t\t});","\t\t\t\t});","","\t\t}","","\t\treturn {","\t\t\texpression,","\t\t\tpathParameters,","\t\t\tqueryParameters,","\t\t\tpathRegExpSource: matchExpression","\t\t};","\t}","","\t/**","\t * Parses parameters from a route expression.","\t * @param {string} expression The route expression.","\t * @returns {Array} List of parameter descriptors.","\t * @private","\t */","\t_parseExpressionParameters(expression) {","\t\tif (!expression) {","\t\t\treturn [];","\t\t}","\t\tconst STATES = RouteParameterTokenizer.STATES;","","\t\tthis._tokenizer.setRouteExpression(expression);","","\t\tconst parameters = [];","\t\tlet currentToken = RouteParameterTokenizer.STATES.NO;","\t\tlet currentParameter = createParameterDescriptor();","\t\tlet currentStores = Object.create(null);","","\t\tdo {","\t\t\tcurrentToken = this._tokenizer.next();","","\t\t\tswitch (currentToken.state) {","\t\t\t\tcase STATES.PARAMETER_START:","\t\t\t\t\tcurrentParameter.start = currentToken.start;","\t\t\t\t\tbreak;","\t\t\t\tcase STATES.PARAMETER_NAME:","\t\t\t\t\tcurrentParameter.name = expression.substring(currentToken.start, currentToken.end);","\t\t\t\t\tbreak;","\t\t\t\tcase STATES.STORE_LIST_ITEM:","\t\t\t\t\tcurrentStores[expression.substring(currentToken.start, currentToken.end)] = true;","\t\t\t\t\tbreak;","\t\t\t\tcase STATES.TEXT:","\t\t\t\t\tif (currentParameter.start >= 0) {","\t\t\t\t\t\tcurrentParameter.end = currentToken.start;","\t\t\t\t\t\tcurrentParameter.stores = Object.keys(currentStores);","\t\t\t\t\t\tcurrentStores = Object.create(null);","\t\t\t\t\t\tparameters.push(currentParameter);","\t\t\t\t\t\tcurrentParameter = createParameterDescriptor();","\t\t\t\t\t}","\t\t\t\t\tbreak;","\t\t\t\tcase STATES.STORE_LIST_END:","\t\t\t\t\tcurrentParameter.end = currentToken.end;","\t\t\t\t\tcurrentParameter.stores = Object.keys(currentStores);","\t\t\t\t\tcurrentStores = Object.create(null);","\t\t\t\t\tparameters.push(currentParameter);","\t\t\t\t\tcurrentParameter = createParameterDescriptor();","\t\t\t\t\tbreak;","\t\t\t\tcase STATES.ILLEGAL:","\t\t\t\t\tconst illegal = expression.substring(currentToken.start, currentToken.end);","\t\t\t\t\tconst errorMessage = `Illegal character \"${illegal}\" at ${currentToken.start + 1} in route:\\n${expression}\\n${createSpaces(currentToken.start)}^`;","\t\t\t\t\tthrow new Error(errorMessage);","\t\t\t}","","\t\t} while (currentToken.state !== STATES.END);","","\t\treturn parameters;","\t}","}","","/**"," * Builds a regular expression for matching the actual URL parts"," * @param {string} expression Routing expression."," * @param {Array} parameters List of extracted parameters."," * @param {string} substitute Regular expression source for the"," * substitute of the parameter's value."," * @returns {string} Regular expression source."," */","function buildMatcher(expression, parameters, substitute) {","\tlet regExpSource = '^';","\tlet nextParameterIndex = 0;","\tlet nextParameter = parameters[nextParameterIndex];","","\tfor (let i = 0; i < expression.length; i++) {","","\t\tif (nextParameter && i === nextParameter.start) {","\t\t\twhile (++i < nextParameter.end - 1) {","\t\t\t\t// just skipping the parameter in the expression string","\t\t\t}","\t\t\tnextParameterIndex++;","\t\t\tnextParameter = parameters[nextParameterIndex];","\t\t\tregExpSource += substitute;","\t\t\tcontinue;","\t\t}","","\t\tconst current = expression[i];","","\t\tif (REG_EXP_ESCAPE.test(current)) {","\t\t\tregExpSource += `\\\\${current}`;","\t\t\tcontinue;","\t\t}","","\t\tregExpSource += current;","\t}","","\tregExpSource += '$';","\treturn regExpSource;","}","","/**"," * Creates a new parameter descriptor."," * @returns {{start: number, end: number, name: null, stores: {}}}"," */","function createParameterDescriptor() {","\treturn {","\t\tstart: -1,","\t\tend: -1,","\t\tname: null,","\t\tstores: Object.create(null)","\t};","}","","/**"," * Creates a string with the specified number of spaces."," * @param {number} count Number of spaces."," * @returns {string} The string with specified number of spaces."," */","function createSpaces(count) {","\tlet string = '';","","\twhile (count--) {","\t\tstring += ' ';","\t}","\treturn string;","}","","module.exports = RouteParser;",""],"l":{"3":1,"4":1,"5":1,"6":1,"8":1,"9":1,"10":1,"27":0,"38":0,"39":0,"42":0,"43":0,"46":0,"48":0,"49":0,"50":0,"52":0,"53":0,"55":0,"58":0,"62":0,"74":0,"89":0,"90":0,"92":0,"94":0,"96":0,"97":0,"98":0,"99":0,"101":0,"102":0,"104":0,"106":0,"107":0,"109":0,"110":0,"112":0,"113":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"122":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"131":0,"132":0,"133":0,"138":0,"150":1,"151":0,"152":0,"153":0,"155":0,"157":0,"158":0,"161":0,"162":0,"163":0,"164":0,"167":0,"169":0,"170":0,"171":0,"174":0,"177":0,"178":0,"185":1,"186":0,"199":1,"200":0,"202":0,"203":0,"205":0,"208":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/helpers/uriHelper.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/helpers/uriHelper.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":15},"end":{"line":12,"column":25}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":48}},"2":{"start":{"line":5,"column":0},"end":{"line":21,"column":2}},"3":{"start":{"line":13,"column":2},"end":{"line":15,"column":3}},"4":{"start":{"line":14,"column":3},"end":{"line":14,"column":13}},"5":{"start":{"line":16,"column":2},"end":{"line":18,"column":3}},"6":{"start":{"line":17,"column":3},"end":{"line":17,"column":18}},"7":{"start":{"line":19,"column":2},"end":{"line":19,"column":57}}},"branchMap":{"1":{"line":13,"type":"if","locations":[{"start":{"line":13,"column":2},"end":{"line":13,"column":2}},{"start":{"line":13,"column":2},"end":{"line":13,"column":2}}]},"2":{"line":13,"type":"binary-expr","locations":[{"start":{"line":13,"column":6},"end":{"line":13,"column":14}},{"start":{"line":13,"column":18},"end":{"line":13,"column":47}}]},"3":{"line":16,"type":"if","locations":[{"start":{"line":16,"column":2},"end":{"line":16,"column":2}},{"start":{"line":16,"column":2},"end":{"line":16,"column":2}}]}},"code":["'use strict';","","const PATH_END_SLASH_REG_EXP = /(.+)\\/($|\\?|#)/;","","module.exports = {","","\t/**","\t * Removes a slash from the end of the URI path.","\t * @param {string} uriPath The URI path.","\t * @returns {string} The URI without a slash at the end.","\t */","\tremoveEndSlash(uriPath) {","\t\tif (!uriPath || typeof (uriPath) !== 'string') {","\t\t\treturn '';","\t\t}","\t\tif (uriPath === '/') {","\t\t\treturn uriPath;","\t\t}","\t\treturn uriPath.replace(PATH_END_SLASH_REG_EXP, '$1$2');","\t}","};",""],"l":{"3":1,"5":1,"13":0,"14":0,"16":0,"17":0,"19":0}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry-uri/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry-uri/index.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":8,"column":2}}},"branchMap":{},"code":["'use strict';","","module.exports = {","\tURI: require('./lib/URI'),","\tAuthority: require('./lib/Authority'),","\tUserInfo: require('./lib/UserInfo'),","\tQuery: require('./lib/Query')","};",""],"l":{"3":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry-uri/lib/URI.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry-uri/lib/URI.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":1,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":1,"89":0,"90":0,"91":0,"92":0,"93":1,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"fnMap":{"1":{"name":"(anonymous_1)","line":23,"loc":{"start":{"line":23,"column":23},"end":{"line":23,"column":32}}},"2":{"name":"(anonymous_2)","line":32,"loc":{"start":{"line":32,"column":16},"end":{"line":32,"column":25}}},"3":{"name":"(anonymous_3)","line":41,"loc":{"start":{"line":41,"column":22},"end":{"line":41,"column":31}}},"4":{"name":"(anonymous_4)","line":50,"loc":{"start":{"line":50,"column":15},"end":{"line":50,"column":24}}},"5":{"name":"(anonymous_5)","line":59,"loc":{"start":{"line":59,"column":19},"end":{"line":59,"column":28}}},"6":{"name":"(anonymous_6)","line":68,"loc":{"start":{"line":68,"column":12},"end":{"line":68,"column":21}}},"7":{"name":"(anonymous_7)","line":76,"loc":{"start":{"line":76,"column":12},"end":{"line":76,"column":24}}},"8":{"name":"(anonymous_8)","line":146,"loc":{"start":{"line":146,"column":16},"end":{"line":146,"column":26}}},"9":{"name":"(anonymous_9)","line":158,"loc":{"start":{"line":158,"column":6},"end":{"line":158,"column":9}}},"10":{"name":"(anonymous_10)","line":189,"loc":{"start":{"line":189,"column":9},"end":{"line":189,"column":12}}},"11":{"name":"transformReference","line":229,"loc":{"start":{"line":229,"column":0},"end":{"line":229,"column":51}}},"12":{"name":"merge","line":284,"loc":{"start":{"line":284,"column":0},"end":{"line":284,"column":38}}},"13":{"name":"removeDotSegments","line":301,"loc":{"start":{"line":301,"column":0},"end":{"line":301,"column":36}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":65}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":41}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":33}},"4":{"start":{"line":9,"column":0},"end":{"line":11,"column":3}},"5":{"start":{"line":13,"column":0},"end":{"line":13,"column":47}},"6":{"start":{"line":14,"column":0},"end":{"line":14,"column":86}},"7":{"start":{"line":24,"column":2},"end":{"line":24,"column":31}},"8":{"start":{"line":33,"column":2},"end":{"line":33,"column":37}},"9":{"start":{"line":42,"column":2},"end":{"line":42,"column":42}},"10":{"start":{"line":51,"column":2},"end":{"line":51,"column":36}},"11":{"start":{"line":60,"column":2},"end":{"line":60,"column":27}},"12":{"start":{"line":69,"column":2},"end":{"line":69,"column":33}},"13":{"start":{"line":83,"column":2},"end":{"line":83,"column":21}},"14":{"start":{"line":90,"column":2},"end":{"line":90,"column":24}},"15":{"start":{"line":97,"column":2},"end":{"line":97,"column":19}},"16":{"start":{"line":104,"column":2},"end":{"line":104,"column":20}},"17":{"start":{"line":111,"column":2},"end":{"line":111,"column":23}},"18":{"start":{"line":113,"column":2},"end":{"line":115,"column":3}},"19":{"start":{"line":114,"column":3},"end":{"line":114,"column":18}},"20":{"start":{"line":118,"column":2},"end":{"line":118,"column":52}},"21":{"start":{"line":120,"column":2},"end":{"line":136,"column":3}},"22":{"start":{"line":121,"column":3},"end":{"line":123,"column":4}},"23":{"start":{"line":122,"column":4},"end":{"line":122,"column":59}},"24":{"start":{"line":124,"column":3},"end":{"line":126,"column":4}},"25":{"start":{"line":125,"column":4},"end":{"line":125,"column":53}},"26":{"start":{"line":127,"column":3},"end":{"line":129,"column":4}},"27":{"start":{"line":128,"column":4},"end":{"line":128,"column":61}},"28":{"start":{"line":130,"column":3},"end":{"line":132,"column":4}},"29":{"start":{"line":131,"column":4},"end":{"line":131,"column":45}},"30":{"start":{"line":133,"column":3},"end":{"line":135,"column":4}},"31":{"start":{"line":134,"column":4},"end":{"line":134,"column":61}},"32":{"start":{"line":147,"column":2},"end":{"line":149,"column":3}},"33":{"start":{"line":148,"column":3},"end":{"line":148,"column":79}},"34":{"start":{"line":151,"column":2},"end":{"line":151,"column":43}},"35":{"start":{"line":159,"column":2},"end":{"line":159,"column":24}},"36":{"start":{"line":161,"column":2},"end":{"line":163,"column":3}},"37":{"start":{"line":162,"column":3},"end":{"line":162,"column":28}},"38":{"start":{"line":165,"column":2},"end":{"line":167,"column":3}},"39":{"start":{"line":166,"column":3},"end":{"line":166,"column":42}},"40":{"start":{"line":169,"column":2},"end":{"line":171,"column":3}},"41":{"start":{"line":170,"column":3},"end":{"line":170,"column":24}},"42":{"start":{"line":173,"column":2},"end":{"line":175,"column":3}},"43":{"start":{"line":174,"column":3},"end":{"line":174,"column":34}},"44":{"start":{"line":177,"column":2},"end":{"line":179,"column":3}},"45":{"start":{"line":178,"column":3},"end":{"line":178,"column":32}},"46":{"start":{"line":181,"column":2},"end":{"line":181,"column":13}},"47":{"start":{"line":190,"column":2},"end":{"line":190,"column":18}},"48":{"start":{"line":192,"column":2},"end":{"line":198,"column":3}},"49":{"start":{"line":193,"column":3},"end":{"line":193,"column":38}},"50":{"start":{"line":194,"column":3},"end":{"line":196,"column":4}},"51":{"start":{"line":195,"column":4},"end":{"line":195,"column":34}},"52":{"start":{"line":197,"column":3},"end":{"line":197,"column":26}},"53":{"start":{"line":200,"column":2},"end":{"line":202,"column":3}},"54":{"start":{"line":201,"column":3},"end":{"line":201,"column":46}},"55":{"start":{"line":204,"column":2},"end":{"line":205,"column":26}},"56":{"start":{"line":206,"column":2},"end":{"line":206,"column":51}},"57":{"start":{"line":208,"column":2},"end":{"line":210,"column":3}},"58":{"start":{"line":209,"column":3},"end":{"line":209,"column":41}},"59":{"start":{"line":212,"column":2},"end":{"line":215,"column":3}},"60":{"start":{"line":213,"column":3},"end":{"line":213,"column":42}},"61":{"start":{"line":214,"column":3},"end":{"line":214,"column":66}},"62":{"start":{"line":217,"column":2},"end":{"line":217,"column":16}},"63":{"start":{"line":229,"column":0},"end":{"line":275,"column":1}},"64":{"start":{"line":232,"column":1},"end":{"line":232,"column":31}},"65":{"start":{"line":234,"column":1},"end":{"line":271,"column":2}},"66":{"start":{"line":235,"column":2},"end":{"line":235,"column":41}},"67":{"start":{"line":236,"column":2},"end":{"line":237,"column":59}},"68":{"start":{"line":238,"column":2},"end":{"line":238,"column":56}},"69":{"start":{"line":239,"column":2},"end":{"line":240,"column":51}},"70":{"start":{"line":242,"column":2},"end":{"line":269,"column":3}},"71":{"start":{"line":243,"column":3},"end":{"line":244,"column":60}},"72":{"start":{"line":245,"column":3},"end":{"line":245,"column":57}},"73":{"start":{"line":246,"column":3},"end":{"line":247,"column":52}},"74":{"start":{"line":249,"column":3},"end":{"line":266,"column":4}},"75":{"start":{"line":250,"column":4},"end":{"line":250,"column":34}},"76":{"start":{"line":251,"column":4},"end":{"line":256,"column":5}},"77":{"start":{"line":252,"column":5},"end":{"line":252,"column":50}},"78":{"start":{"line":254,"column":5},"end":{"line":255,"column":44}},"79":{"start":{"line":258,"column":4},"end":{"line":263,"column":5}},"80":{"start":{"line":259,"column":5},"end":{"line":259,"column":59}},"81":{"start":{"line":261,"column":5},"end":{"line":261,"column":51}},"82":{"start":{"line":262,"column":5},"end":{"line":262,"column":56}},"83":{"start":{"line":264,"column":4},"end":{"line":265,"column":53}},"84":{"start":{"line":267,"column":3},"end":{"line":268,"column":50}},"85":{"start":{"line":270,"column":2},"end":{"line":270,"column":36}},"86":{"start":{"line":273,"column":1},"end":{"line":273,"column":44}},"87":{"start":{"line":274,"column":1},"end":{"line":274,"column":18}},"88":{"start":{"line":284,"column":0},"end":{"line":293,"column":1}},"89":{"start":{"line":285,"column":1},"end":{"line":287,"column":2}},"90":{"start":{"line":286,"column":2},"end":{"line":286,"column":33}},"91":{"start":{"line":289,"column":1},"end":{"line":290,"column":46}},"92":{"start":{"line":292,"column":1},"end":{"line":292,"column":43}},"93":{"start":{"line":301,"column":0},"end":{"line":359,"column":1}},"94":{"start":{"line":302,"column":1},"end":{"line":304,"column":2}},"95":{"start":{"line":303,"column":2},"end":{"line":303,"column":12}},"96":{"start":{"line":306,"column":1},"end":{"line":306,"column":27}},"97":{"start":{"line":307,"column":1},"end":{"line":307,"column":20}},"98":{"start":{"line":308,"column":1},"end":{"line":308,"column":22}},"99":{"start":{"line":309,"column":1},"end":{"line":309,"column":23}},"100":{"start":{"line":311,"column":1},"end":{"line":356,"column":2}},"101":{"start":{"line":315,"column":2},"end":{"line":315,"column":50}},"102":{"start":{"line":316,"column":2},"end":{"line":319,"column":3}},"103":{"start":{"line":317,"column":3},"end":{"line":317,"column":27}},"104":{"start":{"line":318,"column":3},"end":{"line":318,"column":12}},"105":{"start":{"line":324,"column":2},"end":{"line":324,"column":62}},"106":{"start":{"line":325,"column":2},"end":{"line":328,"column":3}},"107":{"start":{"line":326,"column":3},"end":{"line":326,"column":27}},"108":{"start":{"line":327,"column":3},"end":{"line":327,"column":12}},"109":{"start":{"line":335,"column":2},"end":{"line":335,"column":66}},"110":{"start":{"line":336,"column":2},"end":{"line":340,"column":3}},"111":{"start":{"line":337,"column":3},"end":{"line":337,"column":56}},"112":{"start":{"line":338,"column":3},"end":{"line":338,"column":27}},"113":{"start":{"line":339,"column":3},"end":{"line":339,"column":12}},"114":{"start":{"line":344,"column":2},"end":{"line":346,"column":3}},"115":{"start":{"line":345,"column":3},"end":{"line":345,"column":9}},"116":{"start":{"line":352,"column":2},"end":{"line":352,"column":56}},"117":{"start":{"line":353,"column":2},"end":{"line":353,"column":58}},"118":{"start":{"line":354,"column":2},"end":{"line":354,"column":58}},"119":{"start":{"line":355,"column":2},"end":{"line":355,"column":30}},"120":{"start":{"line":358,"column":1},"end":{"line":358,"column":21}},"121":{"start":{"line":361,"column":0},"end":{"line":361,"column":21}}},"branchMap":{"1":{"line":113,"type":"if","locations":[{"start":{"line":113,"column":2},"end":{"line":113,"column":2}},{"start":{"line":113,"column":2},"end":{"line":113,"column":2}}]},"2":{"line":120,"type":"if","locations":[{"start":{"line":120,"column":2},"end":{"line":120,"column":2}},{"start":{"line":120,"column":2},"end":{"line":120,"column":2}}]},"3":{"line":121,"type":"if","locations":[{"start":{"line":121,"column":3},"end":{"line":121,"column":3}},{"start":{"line":121,"column":3},"end":{"line":121,"column":3}}]},"4":{"line":124,"type":"if","locations":[{"start":{"line":124,"column":3},"end":{"line":124,"column":3}},{"start":{"line":124,"column":3},"end":{"line":124,"column":3}}]},"5":{"line":127,"type":"if","locations":[{"start":{"line":127,"column":3},"end":{"line":127,"column":3}},{"start":{"line":127,"column":3},"end":{"line":127,"column":3}}]},"6":{"line":130,"type":"if","locations":[{"start":{"line":130,"column":3},"end":{"line":130,"column":3}},{"start":{"line":130,"column":3},"end":{"line":130,"column":3}}]},"7":{"line":133,"type":"if","locations":[{"start":{"line":133,"column":3},"end":{"line":133,"column":3}},{"start":{"line":133,"column":3},"end":{"line":133,"column":3}}]},"8":{"line":147,"type":"if","locations":[{"start":{"line":147,"column":2},"end":{"line":147,"column":2}},{"start":{"line":147,"column":2},"end":{"line":147,"column":2}}]},"9":{"line":161,"type":"if","locations":[{"start":{"line":161,"column":2},"end":{"line":161,"column":2}},{"start":{"line":161,"column":2},"end":{"line":161,"column":2}}]},"10":{"line":165,"type":"if","locations":[{"start":{"line":165,"column":2},"end":{"line":165,"column":2}},{"start":{"line":165,"column":2},"end":{"line":165,"column":2}}]},"11":{"line":169,"type":"if","locations":[{"start":{"line":169,"column":2},"end":{"line":169,"column":2}},{"start":{"line":169,"column":2},"end":{"line":169,"column":2}}]},"12":{"line":173,"type":"if","locations":[{"start":{"line":173,"column":2},"end":{"line":173,"column":2}},{"start":{"line":173,"column":2},"end":{"line":173,"column":2}}]},"13":{"line":177,"type":"if","locations":[{"start":{"line":177,"column":2},"end":{"line":177,"column":2}},{"start":{"line":177,"column":2},"end":{"line":177,"column":2}}]},"14":{"line":192,"type":"if","locations":[{"start":{"line":192,"column":2},"end":{"line":192,"column":2}},{"start":{"line":192,"column":2},"end":{"line":192,"column":2}}]},"15":{"line":192,"type":"binary-expr","locations":[{"start":{"line":192,"column":6},"end":{"line":192,"column":31}},{"start":{"line":192,"column":35},"end":{"line":192,"column":55}}]},"16":{"line":194,"type":"if","locations":[{"start":{"line":194,"column":3},"end":{"line":194,"column":3}},{"start":{"line":194,"column":3},"end":{"line":194,"column":3}}]},"17":{"line":200,"type":"if","locations":[{"start":{"line":200,"column":2},"end":{"line":200,"column":2}},{"start":{"line":200,"column":2},"end":{"line":200,"column":2}}]},"18":{"line":204,"type":"cond-expr","locations":[{"start":{"line":205,"column":3},"end":{"line":205,"column":5}},{"start":{"line":205,"column":8},"end":{"line":205,"column":25}}]},"19":{"line":204,"type":"binary-expr","locations":[{"start":{"line":204,"column":15},"end":{"line":204,"column":38}},{"start":{"line":204,"column":42},"end":{"line":204,"column":60}}]},"20":{"line":208,"type":"if","locations":[{"start":{"line":208,"column":2},"end":{"line":208,"column":2}},{"start":{"line":208,"column":2},"end":{"line":208,"column":2}}]},"21":{"line":212,"type":"if","locations":[{"start":{"line":212,"column":2},"end":{"line":212,"column":2}},{"start":{"line":212,"column":2},"end":{"line":212,"column":2}}]},"22":{"line":212,"type":"binary-expr","locations":[{"start":{"line":212,"column":6},"end":{"line":212,"column":33}},{"start":{"line":212,"column":37},"end":{"line":212,"column":59}}]},"23":{"line":234,"type":"if","locations":[{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},{"start":{"line":234,"column":1},"end":{"line":234,"column":1}}]},"24":{"line":236,"type":"cond-expr","locations":[{"start":{"line":237,"column":3},"end":{"line":237,"column":33}},{"start":{"line":237,"column":36},"end":{"line":237,"column":58}}]},"25":{"line":239,"type":"cond-expr","locations":[{"start":{"line":240,"column":3},"end":{"line":240,"column":29}},{"start":{"line":240,"column":32},"end":{"line":240,"column":50}}]},"26":{"line":242,"type":"if","locations":[{"start":{"line":242,"column":2},"end":{"line":242,"column":2}},{"start":{"line":242,"column":2},"end":{"line":242,"column":2}}]},"27":{"line":243,"type":"cond-expr","locations":[{"start":{"line":244,"column":4},"end":{"line":244,"column":34}},{"start":{"line":244,"column":37},"end":{"line":244,"column":59}}]},"28":{"line":246,"type":"cond-expr","locations":[{"start":{"line":247,"column":4},"end":{"line":247,"column":30}},{"start":{"line":247,"column":33},"end":{"line":247,"column":51}}]},"29":{"line":249,"type":"if","locations":[{"start":{"line":249,"column":3},"end":{"line":249,"column":3}},{"start":{"line":249,"column":3},"end":{"line":249,"column":3}}]},"30":{"line":251,"type":"if","locations":[{"start":{"line":251,"column":4},"end":{"line":251,"column":4}},{"start":{"line":251,"column":4},"end":{"line":251,"column":4}}]},"31":{"line":254,"type":"cond-expr","locations":[{"start":{"line":255,"column":6},"end":{"line":255,"column":27}},{"start":{"line":255,"column":30},"end":{"line":255,"column":43}}]},"32":{"line":258,"type":"if","locations":[{"start":{"line":258,"column":4},"end":{"line":258,"column":4}},{"start":{"line":258,"column":4},"end":{"line":258,"column":4}}]},"33":{"line":264,"type":"cond-expr","locations":[{"start":{"line":265,"column":5},"end":{"line":265,"column":31}},{"start":{"line":265,"column":34},"end":{"line":265,"column":52}}]},"34":{"line":267,"type":"cond-expr","locations":[{"start":{"line":268,"column":4},"end":{"line":268,"column":29}},{"start":{"line":268,"column":32},"end":{"line":268,"column":49}}]},"35":{"line":285,"type":"if","locations":[{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},{"start":{"line":285,"column":1},"end":{"line":285,"column":1}}]},"36":{"line":285,"type":"binary-expr","locations":[{"start":{"line":285,"column":5},"end":{"line":285,"column":22}},{"start":{"line":285,"column":26},"end":{"line":285,"column":45}}]},"37":{"line":289,"type":"cond-expr","locations":[{"start":{"line":290,"column":2},"end":{"line":290,"column":40}},{"start":{"line":290,"column":43},"end":{"line":290,"column":45}}]},"38":{"line":302,"type":"if","locations":[{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},{"start":{"line":302,"column":1},"end":{"line":302,"column":1}}]},"39":{"line":316,"type":"if","locations":[{"start":{"line":316,"column":2},"end":{"line":316,"column":2}},{"start":{"line":316,"column":2},"end":{"line":316,"column":2}}]},"40":{"line":325,"type":"if","locations":[{"start":{"line":325,"column":2},"end":{"line":325,"column":2}},{"start":{"line":325,"column":2},"end":{"line":325,"column":2}}]},"41":{"line":336,"type":"if","locations":[{"start":{"line":336,"column":2},"end":{"line":336,"column":2}},{"start":{"line":336,"column":2},"end":{"line":336,"column":2}}]},"42":{"line":344,"type":"if","locations":[{"start":{"line":344,"column":2},"end":{"line":344,"column":2}},{"start":{"line":344,"column":2},"end":{"line":344,"column":2}}]},"43":{"line":344,"type":"binary-expr","locations":[{"start":{"line":344,"column":6},"end":{"line":344,"column":25}},{"start":{"line":344,"column":29},"end":{"line":344,"column":49}}]}},"code":["'use strict';","","const percentEncodingHelper = require('./percentEncodingHelper');","","const Authority = require('./Authority');","const Query = require('./Query');","","// https://tools.ietf.org/html/rfc3986#appendix-B","const URI_PARSE_REGEXP = new RegExp(","\t'^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\\\?([^#]*))?(#(.*))?'","\t);","// https://tools.ietf.org/html/rfc3986#section-3.1","const SCHEME_REGEXP = /^[a-z]+[a-z\\d\\+\\.-]*$/i;","const ERROR_SCHEME = `URI scheme must satisfy expression ${SCHEME_REGEXP.toString()}`;","","class URI {","","\t/**","\t * Creates a new URI authority component.","\t * @param {string?} Existing string.","\t * @return {Authority} The authority component.","\t */","\tstatic createAuthority(string) {","\t\treturn new Authority(string);","\t}","","\t/**","\t * Creates a new URI authority component.","\t * @param {string?} Existing string.","\t * @return {Authority} The authority component.","\t */","\tcreateAuthority(string) {","\t\treturn URI.createAuthority(string);","\t}","","\t/**","\t * Creates a new URI user info component.","\t * @param {string?} Existing string.","\t * @return {UserInfo} The user info component.","\t */","\tstatic createUserInfo(string) {","\t\treturn Authority.createUserInfo(string);","\t}","","\t/**","\t * Creates a new URI user info component.","\t * @param {string?} Existing string.","\t * @return {UserInfo} The user info component.","\t */","\tcreateUserInfo(string) {","\t\treturn URI.createUserInfo(string);","\t}","","\t/**","\t * Creates a new URI query component.","\t * @param {string?} Existing string.","\t * @return {Query} The query component.","\t */","\tstatic createQuery(string) {","\t\treturn new Query(string);","\t}","","\t/**","\t * Creates a new URI query component.","\t * @param {string?} Existing string.","\t * @return {Query} The query component.","\t */","\tcreateQuery(string) {","\t\treturn URI.createQuery(string);","\t}","","\t/**","\t * Creates new instance of URI according to RFC 3986.","\t * @param {string?} uriString URI string to parse components.","\t */","\tconstructor(uriString) {","","\t\t/**","\t\t * Current URI scheme.","\t\t * https://tools.ietf.org/html/rfc3986#section-3.1","\t\t * @type {string}","\t\t */","\t\tthis.scheme = null;","","\t\t/**","\t\t * Current URI authority.","\t\t * https://tools.ietf.org/html/rfc3986#section-3.2","\t\t * @type {Authority}","\t\t */","\t\tthis.authority = null;","","\t\t/**","\t\t * Current URI path.","\t\t * https://tools.ietf.org/html/rfc3986#section-3.3","\t\t * @type {string}","\t\t */","\t\tthis.path = null;","","\t\t/**","\t\t * Current URI query.","\t\t * https://tools.ietf.org/html/rfc3986#section-3.4","\t\t * @type {Query}","\t\t */","\t\tthis.query = null;","","\t\t/**","\t\t * Current URI fragment.","\t\t * https://tools.ietf.org/html/rfc3986#section-3.5","\t\t * @type {string}","\t\t */","\t\tthis.fragment = null;","","\t\tif (typeof (uriString) !== 'string') {","\t\t\turiString = '';","\t\t}","","\t\t// https://tools.ietf.org/html/rfc3986#appendix-B","\t\tconst matches = uriString.match(URI_PARSE_REGEXP);","","\t\tif (matches) {","\t\t\tif (typeof (matches[2]) === 'string') {","\t\t\t\tthis.scheme = percentEncodingHelper.decode(matches[2]);","\t\t\t}","\t\t\tif (typeof (matches[4]) === 'string') {","\t\t\t\tthis.authority = URI.createAuthority(matches[4]);","\t\t\t}","\t\t\tif (typeof (matches[5]) === 'string') {","\t\t\t\tthis.path = percentEncodingHelper.decodePath(matches[5]);","\t\t\t}","\t\t\tif (typeof (matches[7]) === 'string') {","\t\t\t\tthis.query = URI.createQuery(matches[7]);","\t\t\t}","\t\t\tif (typeof (matches[9]) === 'string') {","\t\t\t\tthis.fragment = percentEncodingHelper.decode(matches[9]);","\t\t\t}","\t\t}","\t}","","\t/**","\t * Converts a URI reference that might be relative to a given base URI","\t * into the reference's target URI.","\t * https://tools.ietf.org/html/rfc3986#section-5.2","\t * @param {URI} baseUri Base URI.","\t * @returns {URI} Resolved URI.","\t */","\tresolveRelative(baseUri) {","\t\tif (!baseUri.scheme) {","\t\t\tthrow new Error('Scheme component is required to be present in a base URI');","\t\t}","","\t\treturn transformReference(baseUri, this);","\t}","","\t/**","\t * Clones current URI to a new object.","\t * @returns {URI} New clone of current object.","\t */","\tclone() {","\t\tconst uri = new URI();","","\t\tif (typeof (this.scheme) === 'string') {","\t\t\turi.scheme = this.scheme;","\t\t}","","\t\tif (this.authority) {","\t\t\turi.authority = this.authority.clone();","\t\t}","","\t\tif (typeof (this.path) === 'string') {","\t\t\turi.path = this.path;","\t\t}","","\t\tif (this.query) {","\t\t\turi.query = this.query.clone();","\t\t}","","\t\tif (typeof (this.fragment) === 'string') {","\t\t\turi.fragment = this.fragment;","\t\t}","","\t\treturn uri;","\t}","","\t/**","\t * Recomposes URI components to URI string,","\t * https://tools.ietf.org/html/rfc3986#section-5.3","\t * @returns {string} URI string.","\t */","\ttoString() {","\t\tlet result = '';","","\t\tif (this.scheme !== undefined && this.scheme !== null) {","\t\t\tconst scheme = String(this.scheme);","\t\t\tif (!SCHEME_REGEXP.test(scheme)) {","\t\t\t\tthrow new Error(ERROR_SCHEME);","\t\t\t}","\t\t\tresult += `${scheme}:`;","\t\t}","","\t\tif (this.authority instanceof Authority) {","\t\t\tresult += `//${this.authority.toString()}`;","\t\t}","","\t\tconst path = this.path === undefined || this.path === null ?","\t\t\t'' : String(this.path);","\t\tresult += percentEncodingHelper.encodePath(path);","","\t\tif (this.query instanceof Query) {","\t\t\tresult += `?${this.query.toString()}`;","\t\t}","","\t\tif (this.fragment !== undefined && this.fragment !== null) {","\t\t\tconst fragment = String(this.fragment);","\t\t\tresult += `#${percentEncodingHelper.encodeFragment(fragment)}`;","\t\t}","","\t\treturn result;","\t}","}","","/**"," * Transforms reference for relative resolution."," * Whole algorithm has been taken from"," * https://tools.ietf.org/html/rfc3986#section-5.2.2"," * @param {URI} baseUri Base URI for resolution."," * @param {URI} referenceUri Reference URI to resolve."," * @returns {URI} Components of target URI."," */","function transformReference(baseUri, referenceUri) {","","\t/* eslint complexity: [2, 13]*/","\tconst targetUri = new URI('');","","\tif (referenceUri.scheme) {","\t\ttargetUri.scheme = referenceUri.scheme;","\t\ttargetUri.authority = referenceUri.authority ?","\t\t\treferenceUri.authority.clone() : referenceUri.authority;","\t\ttargetUri.path = removeDotSegments(referenceUri.path);","\t\ttargetUri.query = referenceUri.query ?","\t\t\treferenceUri.query.clone() : referenceUri.query;","\t} else {","\t\tif (referenceUri.authority) {","\t\t\ttargetUri.authority = referenceUri.authority ?","\t\t\t\treferenceUri.authority.clone() : referenceUri.authority;","\t\t\ttargetUri.path = removeDotSegments(referenceUri.path);","\t\t\ttargetUri.query = referenceUri.query ?","\t\t\t\treferenceUri.query.clone() : referenceUri.query;","\t\t} else {","\t\t\tif (referenceUri.path === '') {","\t\t\t\ttargetUri.path = baseUri.path;","\t\t\t\tif (referenceUri.query) {","\t\t\t\t\ttargetUri.query = referenceUri.query.clone();","\t\t\t\t} else {","\t\t\t\t\ttargetUri.query = baseUri.query ?","\t\t\t\t\t\tbaseUri.query.clone() : baseUri.query;","\t\t\t\t}","\t\t\t} else {","\t\t\t\tif (referenceUri.path[0] === '/') {","\t\t\t\t\ttargetUri.path = removeDotSegments(referenceUri.path);","\t\t\t\t} else {","\t\t\t\t\ttargetUri.path = merge(baseUri, referenceUri);","\t\t\t\t\ttargetUri.path = removeDotSegments(targetUri.path);","\t\t\t\t}","\t\t\t\ttargetUri.query = referenceUri.query ?","\t\t\t\t\treferenceUri.query.clone() : referenceUri.query;","\t\t\t}","\t\t\ttargetUri.authority = baseUri.authority ?","\t\t\t\tbaseUri.authority.clone() : baseUri.authority;","\t\t}","\t\ttargetUri.scheme = baseUri.scheme;","\t}","","\ttargetUri.fragment = referenceUri.fragment;","\treturn targetUri;","}","","/**"," * Merges a relative-path reference with the path of the base URI."," * https://tools.ietf.org/html/rfc3986#section-5.2.3"," * @param {URI} baseUri Components of base URI."," * @param {URI} referenceUri Components of reference URI."," * @returns {string} Merged path."," */","function merge(baseUri, referenceUri) {","\tif (baseUri.authority && baseUri.path === '') {","\t\treturn `/${referenceUri.path}`;","\t}","","\tconst segmentsString = baseUri.path.indexOf('/') !== -1 ?","\t\tbaseUri.path.replace(/\\/[^\\/]+$/, '/') : '';","","\treturn segmentsString + referenceUri.path;","}","","/**"," * Removes dots segments from URI path."," * https://tools.ietf.org/html/rfc3986#section-5.2.4"," * @param {string} uriPath URI path with possible dot segments."," * @returns {string} URI path without dot segments."," */","function removeDotSegments(uriPath) {","\tif (!uriPath) {","\t\treturn '';","\t}","","\tlet inputBuffer = uriPath;","\tlet newBuffer = '';","\tlet nextSegment = '';","\tlet outputBuffer = '';","","\twhile (inputBuffer.length !== 0) {","","\t\t// If the input buffer begins with a prefix of \"../\" or \"./\",","\t\t// then remove that prefix from the input buffer","\t\tnewBuffer = inputBuffer.replace(/^\\.?\\.\\//, '');","\t\tif (newBuffer !== inputBuffer) {","\t\t\tinputBuffer = newBuffer;","\t\t\tcontinue;","\t\t}","","\t\t// if the input buffer begins with a prefix of \"/./\" or \"/.\",","\t\t// where \".\" is a complete path segment, then replace that","\t\t// prefix with \"/\" in the input buffer","\t\tnewBuffer = inputBuffer.replace(/^((\\/\\.\\/)|(\\/\\.$))/, '/');","\t\tif (newBuffer !== inputBuffer) {","\t\t\tinputBuffer = newBuffer;","\t\t\tcontinue;","\t\t}","","\t\t// if the input buffer begins with a prefix of \"/../\" or \"/..\",","\t\t// where \"..\" is a complete path segment, then replace that","\t\t// prefix with \"/\" in the input buffer and remove the last","\t\t// segment and its preceding \"/\" (if any) from the output","\t\t// buffer","\t\tnewBuffer = inputBuffer.replace(/^((\\/\\.\\.\\/)|(\\/\\.\\.$))/, '/');","\t\tif (newBuffer !== inputBuffer) {","\t\t\toutputBuffer = outputBuffer.replace(/\\/[^\\/]+$/, '');","\t\t\tinputBuffer = newBuffer;","\t\t\tcontinue;","\t\t}","","\t\t// if the input buffer consists only of \".\" or \"..\", then remove","\t\t// that from the input buffer","\t\tif (inputBuffer === '.' || inputBuffer === '..') {","\t\t\tbreak;","\t\t}","","\t\t// move the first path segment in the input buffer to the end of","\t\t// the output buffer, including the initial \"/\" character (if","\t\t// any) and any subsequent characters up to, but not including,","\t\t// the next \"/\" character or the end of the input buffer","\t\tnextSegment = /^\\/?[^\\/]*(\\/|$)/.exec(inputBuffer)[0];","\t\tnextSegment = nextSegment.replace(/([^\\/])(\\/$)/, '$1');","\t\tinputBuffer = inputBuffer.substring(nextSegment.length);","\t\toutputBuffer += nextSegment;","\t}","","\treturn outputBuffer;","}","","module.exports = URI;",""],"l":{"3":1,"5":1,"6":1,"9":1,"13":1,"14":1,"24":0,"33":0,"42":0,"51":0,"60":0,"69":0,"83":0,"90":0,"97":0,"104":0,"111":0,"113":0,"114":0,"118":0,"120":0,"121":0,"122":0,"124":0,"125":0,"127":0,"128":0,"130":0,"131":0,"133":0,"134":0,"147":0,"148":0,"151":0,"159":0,"161":0,"162":0,"165":0,"166":0,"169":0,"170":0,"173":0,"174":0,"177":0,"178":0,"181":0,"190":0,"192":0,"193":0,"194":0,"195":0,"197":0,"200":0,"201":0,"204":0,"206":0,"208":0,"209":0,"212":0,"213":0,"214":0,"217":0,"229":1,"232":0,"234":0,"235":0,"236":0,"238":0,"239":0,"242":0,"243":0,"245":0,"246":0,"249":0,"250":0,"251":0,"252":0,"254":0,"258":0,"259":0,"261":0,"262":0,"264":0,"267":0,"270":0,"273":0,"274":0,"284":1,"285":0,"286":0,"289":0,"292":0,"301":1,"302":0,"303":0,"306":0,"307":0,"308":0,"309":0,"311":0,"315":0,"316":0,"317":0,"318":0,"324":0,"325":0,"326":0,"327":0,"335":0,"336":0,"337":0,"338":0,"339":0,"344":0,"345":0,"352":0,"353":0,"354":0,"355":0,"358":0,"361":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry-uri/lib/percentEncodingHelper.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry-uri/lib/percentEncodingHelper.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":27},"end":{"line":13,"column":36}}},"2":{"name":"(anonymous_2)","line":26,"loc":{"start":{"line":26,"column":11},"end":{"line":26,"column":20}}},"3":{"name":"(anonymous_3)","line":39,"loc":{"start":{"line":39,"column":11},"end":{"line":39,"column":20}}},"4":{"name":"(anonymous_4)","line":56,"loc":{"start":{"line":56,"column":24},"end":{"line":56,"column":33}}},"5":{"name":"(anonymous_5)","line":69,"loc":{"start":{"line":69,"column":15},"end":{"line":69,"column":24}}},"6":{"name":"(anonymous_6)","line":82,"loc":{"start":{"line":82,"column":7},"end":{"line":82,"column":16}}},"7":{"name":"(anonymous_7)","line":91,"loc":{"start":{"line":91,"column":11},"end":{"line":91,"column":20}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":96,"column":2}},"2":{"start":{"line":14,"column":2},"end":{"line":18,"column":4}},"3":{"start":{"line":27,"column":2},"end":{"line":31,"column":4}},"4":{"start":{"line":40,"column":2},"end":{"line":48,"column":76}},"5":{"start":{"line":42,"column":4},"end":{"line":46,"column":6}},"6":{"start":{"line":48,"column":30},"end":{"line":48,"column":70}},"7":{"start":{"line":57,"column":2},"end":{"line":61,"column":4}},"8":{"start":{"line":70,"column":2},"end":{"line":74,"column":4}},"9":{"start":{"line":83,"column":2},"end":{"line":83,"column":36}},"10":{"start":{"line":92,"column":2},"end":{"line":94,"column":76}},"11":{"start":{"line":94,"column":30},"end":{"line":94,"column":70}}},"branchMap":{"1":{"line":48,"type":"cond-expr","locations":[{"start":{"line":48,"column":38},"end":{"line":48,"column":45}},{"start":{"line":48,"column":48},"end":{"line":48,"column":70}}]},"2":{"line":94,"type":"cond-expr","locations":[{"start":{"line":94,"column":38},"end":{"line":94,"column":45}},{"start":{"line":94,"column":48},"end":{"line":94,"column":70}}]}},"code":["'use strict';","","// https://tools.ietf.org/html/rfc3986#section-2.1","","module.exports = {","\t// \\uD800-\\uDBFF \\uDC00-\\uDFFF","\t// surrogates pairs like emoji we should ignore","\t/**","\t * Encodes authority user information sub-component according to RFC 3986.","\t * @param {string} string Component to encode.","\t * @returns {string} Encoded component.","\t */","\tencodeUserInfoSubComponent(string) {","\t\treturn string.replace(","\t\t\t// https://tools.ietf.org/html/rfc3986#section-3.2.1","\t\t\t/[^\\w\\.~\\-!\\$&'\\(\\)\\*\\+,;=\\uD800-\\uDBFF\\uDC00-\\uDFFF]/g,","\t\t\tencodeURIComponent","\t\t);","\t},","","\t/**","\t * Encodes authority host component according to RFC 3986.","\t * @param {string} string Component to encode.","\t * @returns {string} Encoded component.","\t */","\tencodeHost(string) {","\t\treturn string.replace(","\t\t\t// https://tools.ietf.org/html/rfc3986#section-3.2.2","\t\t\t/[^\\w\\.~\\-!\\$&'\\(\\)\\*\\+,;=:\\[\\]\\uD800-\\uDBFF\\uDC00-\\uDFFF]/g,","\t\t\tencodeURIComponent","\t\t);","\t},","","\t/**","\t * Encodes URI path component according to RFC 3986.","\t * @param {string} string Component to encode.","\t * @returns {string} Encoded component.","\t */","\tencodePath(string) {","\t\treturn string.split(/%2f/i)","\t\t\t.map(part => {","\t\t\t\treturn part.replace(","\t\t\t\t\t// https://tools.ietf.org/html/rfc3986#section-3.3","\t\t\t\t\t/[^\\w\\.~\\-!\\$&'\\(\\)\\*\\+,;=:@\\/\\uD800-\\uDBFF\\uDC00-\\uDFFF]/g,","\t\t\t\t\tencodeURIComponent","\t\t\t\t);","\t\t\t})","\t\t\t.reduce((prev, current) => !prev ? current : `${prev}%2F${current}`, '');","\t},","","\t/**","\t * Encodes query sub-component according to RFC 3986.","\t * @param {string} string Component to encode.","\t * @returns {string} Encoded component.","\t */","\tencodeQuerySubComponent(string) {","\t\treturn string.replace(","\t\t\t// https://tools.ietf.org/html/rfc3986#section-3.4","\t\t\t/[^\\w\\.~\\-!\\$'\\(\\)\\*,;:@\\/\\?\\uD800-\\uDBFF\\uDC00-\\uDFFF]/g,","\t\t\tencodeURIComponent","\t\t);","\t},","","\t/**","\t * Encodes URI fragment component according to RFC 3986.","\t * @param {string} string Component to encode.","\t * @returns {string} Encoded component.","\t */","\tencodeFragment(string) {","\t\treturn string.replace(","\t\t\t// https://tools.ietf.org/html/rfc3986#section-3.5","\t\t\t/[^\\w\\.~\\-!\\$&'\\(\\)\\*\\+,;=:@\\/\\?\\uD800-\\uDBFF\\uDC00-\\uDFFF]/g,","\t\t\tencodeURIComponent","\t\t);","\t},","","\t/**","\t * Decodes percent encoded component.","\t * @param {string} string Component to decode.","\t * @returns {string} Decoded component.","\t */","\tdecode(string) {","\t\treturn decodeURIComponent(string);","\t},","","\t/**","\t * Decodes percent encoded path component.","\t * @param {string} string Component to decode.","\t * @returns {string} Decoded path component.","\t */","\tdecodePath(string) {","\t\treturn string.split(/%2f/i)","\t\t\t.map(decodeURIComponent)","\t\t\t.reduce((prev, current) => !prev ? current : `${prev}%2F${current}`, '');","\t}","};",""],"l":{"5":1,"14":0,"27":0,"40":0,"42":0,"48":0,"57":0,"70":0,"83":0,"92":0,"94":0}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry-uri/lib/Authority.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry-uri/lib/Authority.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":16,"loc":{"start":{"line":16,"column":22},"end":{"line":16,"column":31}}},"2":{"name":"(anonymous_2)","line":25,"loc":{"start":{"line":25,"column":15},"end":{"line":25,"column":24}}},"3":{"name":"(anonymous_3)","line":34,"loc":{"start":{"line":34,"column":12},"end":{"line":34,"column":30}}},"4":{"name":"(anonymous_4)","line":85,"loc":{"start":{"line":85,"column":6},"end":{"line":85,"column":9}}},"5":{"name":"(anonymous_5)","line":103,"loc":{"start":{"line":103,"column":9},"end":{"line":103,"column":12}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":39}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":65}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":28}},"4":{"start":{"line":7,"column":0},"end":{"line":7,"column":90}},"5":{"start":{"line":17,"column":2},"end":{"line":17,"column":30}},"6":{"start":{"line":26,"column":2},"end":{"line":26,"column":42}},"7":{"start":{"line":41,"column":2},"end":{"line":41,"column":23}},"8":{"start":{"line":48,"column":2},"end":{"line":48,"column":19}},"9":{"start":{"line":55,"column":2},"end":{"line":55,"column":19}},"10":{"start":{"line":57,"column":2},"end":{"line":78,"column":3}},"11":{"start":{"line":58,"column":3},"end":{"line":58,"column":53}},"12":{"start":{"line":59,"column":3},"end":{"line":63,"column":4}},"13":{"start":{"line":60,"column":4},"end":{"line":60,"column":70}},"14":{"start":{"line":61,"column":4},"end":{"line":61,"column":49}},"15":{"start":{"line":62,"column":4},"end":{"line":62,"column":66}},"16":{"start":{"line":65,"column":3},"end":{"line":65,"column":59}},"17":{"start":{"line":66,"column":3},"end":{"line":75,"column":4}},"18":{"start":{"line":67,"column":4},"end":{"line":67,"column":69}},"19":{"start":{"line":68,"column":4},"end":{"line":74,"column":5}},"20":{"start":{"line":69,"column":5},"end":{"line":69,"column":20}},"21":{"start":{"line":70,"column":5},"end":{"line":70,"column":68}},"22":{"start":{"line":71,"column":11},"end":{"line":74,"column":5}},"23":{"start":{"line":72,"column":5},"end":{"line":72,"column":28}},"24":{"start":{"line":73,"column":5},"end":{"line":73,"column":68}},"25":{"start":{"line":77,"column":3},"end":{"line":77,"column":61}},"26":{"start":{"line":86,"column":2},"end":{"line":86,"column":36}},"27":{"start":{"line":87,"column":2},"end":{"line":89,"column":3}},"28":{"start":{"line":88,"column":3},"end":{"line":88,"column":46}},"29":{"start":{"line":90,"column":2},"end":{"line":92,"column":3}},"30":{"start":{"line":91,"column":3},"end":{"line":91,"column":30}},"31":{"start":{"line":93,"column":2},"end":{"line":95,"column":3}},"32":{"start":{"line":94,"column":3},"end":{"line":94,"column":30}},"33":{"start":{"line":96,"column":2},"end":{"line":96,"column":19}},"34":{"start":{"line":104,"column":2},"end":{"line":104,"column":18}},"35":{"start":{"line":105,"column":2},"end":{"line":107,"column":3}},"36":{"start":{"line":106,"column":3},"end":{"line":106,"column":44}},"37":{"start":{"line":108,"column":2},"end":{"line":111,"column":3}},"38":{"start":{"line":109,"column":3},"end":{"line":109,"column":34}},"39":{"start":{"line":110,"column":3},"end":{"line":110,"column":52}},"40":{"start":{"line":112,"column":2},"end":{"line":118,"column":3}},"41":{"start":{"line":113,"column":3},"end":{"line":113,"column":34}},"42":{"start":{"line":114,"column":3},"end":{"line":116,"column":4}},"43":{"start":{"line":115,"column":4},"end":{"line":115,"column":32}},"44":{"start":{"line":117,"column":3},"end":{"line":117,"column":24}},"45":{"start":{"line":119,"column":2},"end":{"line":119,"column":16}},"46":{"start":{"line":123,"column":0},"end":{"line":123,"column":27}}},"branchMap":{"1":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":2},"end":{"line":57,"column":2}},{"start":{"line":57,"column":2},"end":{"line":57,"column":2}}]},"2":{"line":57,"type":"binary-expr","locations":[{"start":{"line":57,"column":6},"end":{"line":57,"column":43}},{"start":{"line":57,"column":47},"end":{"line":57,"column":73}}]},"3":{"line":59,"type":"if","locations":[{"start":{"line":59,"column":3},"end":{"line":59,"column":3}},{"start":{"line":59,"column":3},"end":{"line":59,"column":3}}]},"4":{"line":66,"type":"if","locations":[{"start":{"line":66,"column":3},"end":{"line":66,"column":3}},{"start":{"line":66,"column":3},"end":{"line":66,"column":3}}]},"5":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":4},"end":{"line":68,"column":4}},{"start":{"line":68,"column":4},"end":{"line":68,"column":4}}]},"6":{"line":71,"type":"if","locations":[{"start":{"line":71,"column":11},"end":{"line":71,"column":11}},{"start":{"line":71,"column":11},"end":{"line":71,"column":11}}]},"7":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":2},"end":{"line":87,"column":2}},{"start":{"line":87,"column":2},"end":{"line":87,"column":2}}]},"8":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":2},"end":{"line":90,"column":2}},{"start":{"line":90,"column":2},"end":{"line":90,"column":2}}]},"9":{"line":93,"type":"if","locations":[{"start":{"line":93,"column":2},"end":{"line":93,"column":2}},{"start":{"line":93,"column":2},"end":{"line":93,"column":2}}]},"10":{"line":105,"type":"if","locations":[{"start":{"line":105,"column":2},"end":{"line":105,"column":2}},{"start":{"line":105,"column":2},"end":{"line":105,"column":2}}]},"11":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":2},"end":{"line":108,"column":2}},{"start":{"line":108,"column":2},"end":{"line":108,"column":2}}]},"12":{"line":108,"type":"binary-expr","locations":[{"start":{"line":108,"column":6},"end":{"line":108,"column":29}},{"start":{"line":108,"column":33},"end":{"line":108,"column":51}}]},"13":{"line":112,"type":"if","locations":[{"start":{"line":112,"column":2},"end":{"line":112,"column":2}},{"start":{"line":112,"column":2},"end":{"line":112,"column":2}}]},"14":{"line":112,"type":"binary-expr","locations":[{"start":{"line":112,"column":6},"end":{"line":112,"column":29}},{"start":{"line":112,"column":33},"end":{"line":112,"column":51}}]},"15":{"line":114,"type":"if","locations":[{"start":{"line":114,"column":3},"end":{"line":114,"column":3}},{"start":{"line":114,"column":3},"end":{"line":114,"column":3}}]},"16":{"line":114,"type":"binary-expr","locations":[{"start":{"line":114,"column":7},"end":{"line":114,"column":22}},{"start":{"line":114,"column":26},"end":{"line":114,"column":49}}]}},"code":["'use strict';","","const UserInfo = require('./UserInfo');","const percentEncodingHelper = require('./percentEncodingHelper');","","const PORT_REGEXP = /^\\d+$/;","const ERROR_PORT = `URI authority port must satisfy expression ${PORT_REGEXP.toString()}`;","","class Authority {","","\t/**","\t * Creates a new URI user info component.","\t * @param {string?} Existing string.","\t * @return {UserInfo} The user info component.","\t */","\tstatic createUserInfo(string) {","\t\treturn new UserInfo(string);","\t}","","\t/**","\t * Creates a new URI user info component.","\t * @param {string?} Existing string.","\t * @return {UserInfo} The user info component.","\t */","\tcreateUserInfo(string) {","\t\treturn Authority.createUserInfo(string);","\t}","","\t/**","\t * Creates new instance of URI authority component parser.","\t * https://tools.ietf.org/html/rfc3986#section-3.2","\t * @param {string?} authorityString URI authority component string.","\t */","\tconstructor(authorityString) {","","\t\t/**","\t\t * Current user information.","\t\t * https://tools.ietf.org/html/rfc3986#section-3.2.1","\t\t * @type {UserInfo}","\t\t */","\t\tthis.userInfo = null;","","\t\t/**","\t\t * Current port.","\t\t * https://tools.ietf.org/html/rfc3986#section-3.2.3","\t\t * @type {string}","\t\t */","\t\tthis.port = null;","","\t\t/**","\t\t * Current host.","\t\t * https://tools.ietf.org/html/rfc3986#section-3.2.2","\t\t * @type {string}","\t\t */","\t\tthis.host = null;","","\t\tif (typeof (authorityString) === 'string' && authorityString.length > 0) {","\t\t\tconst firstAtIndex = authorityString.indexOf('@');","\t\t\tif (firstAtIndex !== -1) {","\t\t\t\tconst userInfoString = authorityString.substring(0, firstAtIndex);","\t\t\t\tthis.userInfo = new UserInfo(userInfoString);","\t\t\t\tauthorityString = authorityString.substring(firstAtIndex + 1);","\t\t\t}","","\t\t\tconst lastColonIndex = authorityString.lastIndexOf(':');","\t\t\tif (lastColonIndex !== -1) {","\t\t\t\tconst portString = authorityString.substring(lastColonIndex + 1);","\t\t\t\tif (lastColonIndex === authorityString.length - 1) {","\t\t\t\t\tthis.port = '';","\t\t\t\t\tauthorityString = authorityString.substring(0, lastColonIndex);","\t\t\t\t} else if (PORT_REGEXP.test(portString)) {","\t\t\t\t\tthis.port = portString;","\t\t\t\t\tauthorityString = authorityString.substring(0, lastColonIndex);","\t\t\t\t}","\t\t\t}","","\t\t\tthis.host = percentEncodingHelper.decode(authorityString);","\t\t}","\t}","","\t/**","\t * Clones current authority.","\t * @returns {Authority} New clone of current object.","\t */","\tclone() {","\t\tconst authority = new Authority();","\t\tif (this.userInfo) {","\t\t\tauthority.userInfo = this.userInfo.clone();","\t\t}","\t\tif (typeof (this.host) === 'string') {","\t\t\tauthority.host = this.host;","\t\t}","\t\tif (typeof (this.port) === 'string') {","\t\t\tauthority.port = this.port;","\t\t}","\t\treturn authority;","\t}","","\t/**","\t * Recombine all authority components into authority string.","\t * @returns {string} Authority component string.","\t */","\ttoString() {","\t\tlet result = '';","\t\tif (this.userInfo instanceof UserInfo) {","\t\t\tresult += `${this.userInfo.toString()}@`;","\t\t}","\t\tif (this.host !== undefined && this.host !== null) {","\t\t\tconst host = String(this.host);","\t\t\tresult += percentEncodingHelper.encodeHost(host);","\t\t}","\t\tif (this.port !== undefined && this.port !== null) {","\t\t\tconst port = String(this.port);","\t\t\tif (port.length > 0 && !PORT_REGEXP.test(port)) {","\t\t\t\tthrow new Error(ERROR_PORT);","\t\t\t}","\t\t\tresult += `:${port}`;","\t\t}","\t\treturn result;","\t}","}","","module.exports = Authority;",""],"l":{"3":1,"4":1,"6":1,"7":1,"17":0,"26":0,"41":0,"48":0,"55":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"77":0,"86":0,"87":0,"88":0,"90":0,"91":0,"93":0,"94":0,"96":0,"104":0,"105":0,"106":0,"108":0,"109":0,"110":0,"112":0,"113":0,"114":0,"115":0,"117":0,"119":0,"123":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry-uri/lib/UserInfo.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry-uri/lib/UserInfo.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":29}}},"2":{"name":"(anonymous_2)","line":41,"loc":{"start":{"line":41,"column":6},"end":{"line":41,"column":9}}},"3":{"name":"(anonymous_3)","line":56,"loc":{"start":{"line":56,"column":9},"end":{"line":56,"column":12}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":65}},"2":{"start":{"line":18,"column":2},"end":{"line":18,"column":19}},"3":{"start":{"line":24,"column":2},"end":{"line":24,"column":23}},"4":{"start":{"line":26,"column":2},"end":{"line":34,"column":3}},"5":{"start":{"line":27,"column":3},"end":{"line":27,"column":43}},"6":{"start":{"line":28,"column":3},"end":{"line":30,"column":4}},"7":{"start":{"line":29,"column":4},"end":{"line":29,"column":55}},"8":{"start":{"line":31,"column":3},"end":{"line":33,"column":4}},"9":{"start":{"line":32,"column":4},"end":{"line":32,"column":59}},"10":{"start":{"line":42,"column":2},"end":{"line":42,"column":34}},"11":{"start":{"line":43,"column":2},"end":{"line":45,"column":3}},"12":{"start":{"line":44,"column":3},"end":{"line":44,"column":29}},"13":{"start":{"line":46,"column":2},"end":{"line":48,"column":3}},"14":{"start":{"line":47,"column":3},"end":{"line":47,"column":37}},"15":{"start":{"line":49,"column":2},"end":{"line":49,"column":18}},"16":{"start":{"line":57,"column":2},"end":{"line":57,"column":18}},"17":{"start":{"line":58,"column":2},"end":{"line":62,"column":3}},"18":{"start":{"line":59,"column":3},"end":{"line":59,"column":34}},"19":{"start":{"line":60,"column":3},"end":{"line":61,"column":38}},"20":{"start":{"line":63,"column":2},"end":{"line":66,"column":3}},"21":{"start":{"line":64,"column":3},"end":{"line":64,"column":42}},"22":{"start":{"line":65,"column":3},"end":{"line":65,"column":78}},"23":{"start":{"line":68,"column":2},"end":{"line":68,"column":16}},"24":{"start":{"line":72,"column":0},"end":{"line":72,"column":26}}},"branchMap":{"1":{"line":26,"type":"if","locations":[{"start":{"line":26,"column":2},"end":{"line":26,"column":2}},{"start":{"line":26,"column":2},"end":{"line":26,"column":2}}]},"2":{"line":26,"type":"binary-expr","locations":[{"start":{"line":26,"column":6},"end":{"line":26,"column":42}},{"start":{"line":26,"column":46},"end":{"line":26,"column":71}}]},"3":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":3},"end":{"line":28,"column":3}},{"start":{"line":28,"column":3},"end":{"line":28,"column":3}}]},"4":{"line":31,"type":"if","locations":[{"start":{"line":31,"column":3},"end":{"line":31,"column":3}},{"start":{"line":31,"column":3},"end":{"line":31,"column":3}}]},"5":{"line":43,"type":"if","locations":[{"start":{"line":43,"column":2},"end":{"line":43,"column":2}},{"start":{"line":43,"column":2},"end":{"line":43,"column":2}}]},"6":{"line":46,"type":"if","locations":[{"start":{"line":46,"column":2},"end":{"line":46,"column":2}},{"start":{"line":46,"column":2},"end":{"line":46,"column":2}}]},"7":{"line":58,"type":"if","locations":[{"start":{"line":58,"column":2},"end":{"line":58,"column":2}},{"start":{"line":58,"column":2},"end":{"line":58,"column":2}}]},"8":{"line":58,"type":"binary-expr","locations":[{"start":{"line":58,"column":6},"end":{"line":58,"column":29}},{"start":{"line":58,"column":33},"end":{"line":58,"column":51}}]},"9":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":2},"end":{"line":63,"column":2}},{"start":{"line":63,"column":2},"end":{"line":63,"column":2}}]},"10":{"line":63,"type":"binary-expr","locations":[{"start":{"line":63,"column":6},"end":{"line":63,"column":33}},{"start":{"line":63,"column":37},"end":{"line":63,"column":59}}]}},"code":["'use strict';","","const percentEncodingHelper = require('./percentEncodingHelper');","","class UserInfo {","","\t/**","\t * Creates new instance of user information component parser.","\t * https://tools.ietf.org/html/rfc3986#section-3.2.1","\t * @param {string?} userInfoString User information component string.","\t */","\tconstructor(userInfoString) {","","\t\t/**","\t\t * Current user component.","\t\t * @type {string}","\t\t */","\t\tthis.user = null;","","\t\t/**","\t\t * Current password.","\t\t * @type {string}","\t\t */","\t\tthis.password = null;","","\t\tif (typeof (userInfoString) === 'string' && userInfoString.length > 0) {","\t\t\tconst parts = userInfoString.split(':');","\t\t\tif (typeof (parts[0]) === 'string') {","\t\t\t\tthis.user = percentEncodingHelper.decode(parts[0]);","\t\t\t}","\t\t\tif (typeof (parts[1]) === 'string') {","\t\t\t\tthis.password = percentEncodingHelper.decode(parts[1]);","\t\t\t}","\t\t}","\t}","","\t/**","\t * Clones current user information.","\t * @returns {UserInfo} New clone of current object.","\t */","\tclone() {","\t\tconst userInfo = new UserInfo();","\t\tif (typeof (this.user) === 'string') {","\t\t\tuserInfo.user = this.user;","\t\t}","\t\tif (typeof (this.password) === 'string') {","\t\t\tuserInfo.password = this.password;","\t\t}","\t\treturn userInfo;","\t}","","\t/**","\t * Recombines user information components to userInfo string.","\t * @returns {string} User information component string.","\t */","\ttoString() {","\t\tlet result = '';","\t\tif (this.user !== undefined && this.user !== null) {","\t\t\tconst user = String(this.user);","\t\t\tresult += percentEncodingHelper","\t\t\t\t.encodeUserInfoSubComponent(user);","\t\t}","\t\tif (this.password !== undefined && this.password !== null) {","\t\t\tconst password = String(this.password);","\t\t\tresult += `:${percentEncodingHelper.encodeUserInfoSubComponent(password)}`;","\t\t}","","\t\treturn result;","\t}","}","","module.exports = UserInfo;",""],"l":{"3":1,"18":0,"24":0,"26":0,"27":0,"28":0,"29":0,"31":0,"32":0,"42":0,"43":0,"44":0,"46":0,"47":0,"49":0,"57":0,"58":0,"59":0,"60":0,"63":0,"64":0,"65":0,"68":0,"72":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry-uri/lib/Query.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry-uri/lib/Query.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":26}}},"2":{"name":"(anonymous_2)","line":52,"loc":{"start":{"line":52,"column":6},"end":{"line":52,"column":9}}},"3":{"name":"(anonymous_3)","line":68,"loc":{"start":{"line":68,"column":9},"end":{"line":68,"column":12}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":65}},"2":{"start":{"line":18,"column":2},"end":{"line":18,"column":21}},"3":{"start":{"line":20,"column":2},"end":{"line":45,"column":3}},"4":{"start":{"line":21,"column":3},"end":{"line":21,"column":20}},"5":{"start":{"line":23,"column":3},"end":{"line":44,"column":13}},"6":{"start":{"line":26,"column":5},"end":{"line":26,"column":35}},"7":{"start":{"line":27,"column":5},"end":{"line":27,"column":56}},"8":{"start":{"line":28,"column":5},"end":{"line":30,"column":6}},"9":{"start":{"line":29,"column":6},"end":{"line":29,"column":13}},"10":{"start":{"line":31,"column":5},"end":{"line":34,"column":6}},"11":{"start":{"line":33,"column":6},"end":{"line":33,"column":44}},"12":{"start":{"line":36,"column":5},"end":{"line":37,"column":52}},"13":{"start":{"line":39,"column":5},"end":{"line":43,"column":6}},"14":{"start":{"line":40,"column":6},"end":{"line":40,"column":35}},"15":{"start":{"line":42,"column":6},"end":{"line":42,"column":31}},"16":{"start":{"line":53,"column":2},"end":{"line":53,"column":28}},"17":{"start":{"line":54,"column":2},"end":{"line":60,"column":3}},"18":{"start":{"line":55,"column":3},"end":{"line":55,"column":21}},"19":{"start":{"line":56,"column":3},"end":{"line":59,"column":13}},"20":{"start":{"line":58,"column":5},"end":{"line":58,"column":42}},"21":{"start":{"line":61,"column":2},"end":{"line":61,"column":15}},"22":{"start":{"line":69,"column":2},"end":{"line":71,"column":3}},"23":{"start":{"line":70,"column":3},"end":{"line":70,"column":13}},"24":{"start":{"line":73,"column":2},"end":{"line":73,"column":23}},"25":{"start":{"line":74,"column":2},"end":{"line":87,"column":12}},"26":{"start":{"line":76,"column":4},"end":{"line":77,"column":43}},"27":{"start":{"line":79,"column":4},"end":{"line":86,"column":7}},"28":{"start":{"line":80,"column":5},"end":{"line":80,"column":77}},"29":{"start":{"line":81,"column":5},"end":{"line":83,"column":6}},"30":{"start":{"line":82,"column":6},"end":{"line":82,"column":13}},"31":{"start":{"line":84,"column":5},"end":{"line":84,"column":27}},"32":{"start":{"line":85,"column":5},"end":{"line":85,"column":79}},"33":{"start":{"line":89,"column":2},"end":{"line":89,"column":39}},"34":{"start":{"line":93,"column":0},"end":{"line":93,"column":23}}},"branchMap":{"1":{"line":20,"type":"if","locations":[{"start":{"line":20,"column":2},"end":{"line":20,"column":2}},{"start":{"line":20,"column":2},"end":{"line":20,"column":2}}]},"2":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":5},"end":{"line":28,"column":5}},{"start":{"line":28,"column":5},"end":{"line":28,"column":5}}]},"3":{"line":31,"type":"if","locations":[{"start":{"line":31,"column":5},"end":{"line":31,"column":5}},{"start":{"line":31,"column":5},"end":{"line":31,"column":5}}]},"4":{"line":31,"type":"binary-expr","locations":[{"start":{"line":31,"column":9},"end":{"line":31,"column":27}},{"start":{"line":32,"column":6},"end":{"line":32,"column":42}}]},"5":{"line":36,"type":"cond-expr","locations":[{"start":{"line":37,"column":6},"end":{"line":37,"column":44}},{"start":{"line":37,"column":47},"end":{"line":37,"column":51}}]},"6":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":5},"end":{"line":39,"column":5}},{"start":{"line":39,"column":5},"end":{"line":39,"column":5}}]},"7":{"line":54,"type":"if","locations":[{"start":{"line":54,"column":2},"end":{"line":54,"column":2}},{"start":{"line":54,"column":2},"end":{"line":54,"column":2}}]},"8":{"line":69,"type":"if","locations":[{"start":{"line":69,"column":2},"end":{"line":69,"column":2}},{"start":{"line":69,"column":2},"end":{"line":69,"column":2}}]},"9":{"line":76,"type":"cond-expr","locations":[{"start":{"line":77,"column":5},"end":{"line":77,"column":21}},{"start":{"line":77,"column":24},"end":{"line":77,"column":42}}]},"10":{"line":81,"type":"if","locations":[{"start":{"line":81,"column":5},"end":{"line":81,"column":5}},{"start":{"line":81,"column":5},"end":{"line":81,"column":5}}]},"11":{"line":81,"type":"binary-expr","locations":[{"start":{"line":81,"column":9},"end":{"line":81,"column":28}},{"start":{"line":81,"column":32},"end":{"line":81,"column":46}}]}},"code":["'use strict';","","const percentEncodingHelper = require('./percentEncodingHelper');","","class Query {","","\t/**","\t * Creates new instance of URI query component parser.","\t * https://tools.ietf.org/html/rfc3986#section-3.4","\t * @param {string?} queryString URI query component string.","\t */","\tconstructor(queryString) {","","\t\t/**","\t\t * Current set of values of query.","\t\t * @type {Object}","\t\t */","\t\tthis.values = null;","","\t\tif (typeof (queryString) === 'string') {","\t\t\tthis.values = {};","","\t\t\tqueryString","\t\t\t\t.split('&')","\t\t\t\t.forEach(pair => {","\t\t\t\t\tconst parts = pair.split('=');","\t\t\t\t\tconst key = percentEncodingHelper.decode(parts[0]);","\t\t\t\t\tif (!key) {","\t\t\t\t\t\treturn;","\t\t\t\t\t}","\t\t\t\t\tif (key in this.values &&","\t\t\t\t\t\t!(this.values[key] instanceof Array)) {","\t\t\t\t\t\tthis.values[key] = [this.values[key]];","\t\t\t\t\t}","","\t\t\t\t\tconst value = typeof (parts[1]) === 'string' ?","\t\t\t\t\t\tpercentEncodingHelper.decode(parts[1]) : null;","","\t\t\t\t\tif (this.values[key] instanceof Array) {","\t\t\t\t\t\tthis.values[key].push(value);","\t\t\t\t\t} else {","\t\t\t\t\t\tthis.values[key] = value;","\t\t\t\t\t}","\t\t\t\t}, this);","\t\t}","\t}","","\t/**","\t * Clones current query to a new object.","\t * @returns {Query} New clone of current object.","\t */","\tclone() {","\t\tconst query = new Query();","\t\tif (this.values) {","\t\t\tquery.values = {};","\t\t\tObject.keys(this.values)","\t\t\t\t.forEach(key => {","\t\t\t\t\tquery.values[key] = this.values[key];","\t\t\t\t}, this);","\t\t}","\t\treturn query;","\t}","","\t/**","\t * Converts current set of query values to string.","\t * @returns {string} Query component string.","\t */","\ttoString() {","\t\tif (!this.values) {","\t\t\treturn '';","\t\t}","","\t\tlet queryString = '';","\t\tObject.keys(this.values)","\t\t\t.forEach(key => {","\t\t\t\tconst values = this.values[key] instanceof Array ?","\t\t\t\t\tthis.values[key] : [this.values[key]];","","\t\t\t\tvalues.forEach(value => {","\t\t\t\t\tqueryString += `&${percentEncodingHelper.encodeQuerySubComponent(key)}`;","\t\t\t\t\tif (value === undefined || value === null) {","\t\t\t\t\t\treturn;","\t\t\t\t\t}","\t\t\t\t\tvalue = String(value);","\t\t\t\t\tqueryString += `=${percentEncodingHelper.encodeQuerySubComponent(value)}`;","\t\t\t\t});","\t\t\t}, this);","","\t\treturn queryString.replace(/^&/, '');","\t}","}","","module.exports = Query;",""],"l":{"3":1,"18":0,"20":0,"21":0,"23":0,"26":0,"27":0,"28":0,"29":0,"31":0,"33":0,"36":0,"39":0,"40":0,"42":0,"53":0,"54":0,"55":0,"56":0,"58":0,"61":0,"69":0,"70":0,"73":0,"74":0,"76":0,"79":0,"80":0,"81":0,"82":0,"84":0,"85":0,"89":0,"93":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/tokenizers/RouteExpressionTokenizer.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/tokenizers/RouteExpressionTokenizer.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":1},"b":{"1":[0,0,0,0,0,0,0,0,0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"fnMap":{"1":{"name":"(anonymous_1)","line":27,"loc":{"start":{"line":27,"column":12},"end":{"line":27,"column":15}}},"2":{"name":"(anonymous_2)","line":61,"loc":{"start":{"line":61,"column":18},"end":{"line":61,"column":21}}},"3":{"name":"(anonymous_3)","line":69,"loc":{"start":{"line":69,"column":19},"end":{"line":69,"column":37}}},"4":{"name":"(anonymous_4)","line":81,"loc":{"start":{"line":81,"column":5},"end":{"line":81,"column":8}}},"5":{"name":"(anonymous_5)","line":135,"loc":{"start":{"line":135,"column":20},"end":{"line":135,"column":23}}},"6":{"name":"(anonymous_6)","line":150,"loc":{"start":{"line":150,"column":19},"end":{"line":150,"column":22}}},"7":{"name":"(anonymous_7)","line":174,"loc":{"start":{"line":174,"column":20},"end":{"line":174,"column":23}}},"8":{"name":"(anonymous_8)","line":195,"loc":{"start":{"line":195,"column":19},"end":{"line":195,"column":22}}},"9":{"name":"(anonymous_9)","line":221,"loc":{"start":{"line":221,"column":20},"end":{"line":221,"column":23}}},"10":{"name":"(anonymous_10)","line":237,"loc":{"start":{"line":237,"column":18},"end":{"line":237,"column":21}}},"11":{"name":"(anonymous_11)","line":251,"loc":{"start":{"line":251,"column":10},"end":{"line":251,"column":13}}},"12":{"name":"(anonymous_12)","line":270,"loc":{"start":{"line":270,"column":15},"end":{"line":270,"column":18}}},"13":{"name":"(anonymous_13)","line":280,"loc":{"start":{"line":280,"column":11},"end":{"line":280,"column":14}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":14,"column":2}},"2":{"start":{"line":15,"column":0},"end":{"line":15,"column":22}},"3":{"start":{"line":17,"column":0},"end":{"line":17,"column":42}},"4":{"start":{"line":18,"column":0},"end":{"line":18,"column":38}},"5":{"start":{"line":19,"column":0},"end":{"line":19,"column":37}},"6":{"start":{"line":20,"column":0},"end":{"line":20,"column":31}},"7":{"start":{"line":34,"column":2},"end":{"line":34,"column":20}},"8":{"start":{"line":41,"column":2},"end":{"line":41,"column":25}},"9":{"start":{"line":48,"column":2},"end":{"line":48,"column":23}},"10":{"start":{"line":55,"column":2},"end":{"line":55,"column":33}},"11":{"start":{"line":62,"column":2},"end":{"line":62,"column":16}},"12":{"start":{"line":70,"column":2},"end":{"line":70,"column":33}},"13":{"start":{"line":71,"column":2},"end":{"line":71,"column":25}},"14":{"start":{"line":72,"column":2},"end":{"line":72,"column":23}},"15":{"start":{"line":73,"column":2},"end":{"line":73,"column":33}},"16":{"start":{"line":82,"column":2},"end":{"line":82,"column":35}},"17":{"start":{"line":83,"column":2},"end":{"line":83,"column":35}},"18":{"start":{"line":85,"column":2},"end":{"line":123,"column":3}},"19":{"start":{"line":87,"column":4},"end":{"line":87,"column":31}},"20":{"start":{"line":88,"column":4},"end":{"line":88,"column":10}},"21":{"start":{"line":90,"column":4},"end":{"line":90,"column":30}},"22":{"start":{"line":91,"column":4},"end":{"line":91,"column":10}},"23":{"start":{"line":93,"column":4},"end":{"line":93,"column":31}},"24":{"start":{"line":94,"column":4},"end":{"line":94,"column":10}},"25":{"start":{"line":96,"column":4},"end":{"line":96,"column":30}},"26":{"start":{"line":97,"column":4},"end":{"line":97,"column":10}},"27":{"start":{"line":99,"column":4},"end":{"line":99,"column":31}},"28":{"start":{"line":100,"column":4},"end":{"line":100,"column":10}},"29":{"start":{"line":102,"column":4},"end":{"line":102,"column":29}},"30":{"start":{"line":103,"column":4},"end":{"line":103,"column":10}},"31":{"start":{"line":105,"column":4},"end":{"line":105,"column":21}},"32":{"start":{"line":106,"column":4},"end":{"line":106,"column":10}},"33":{"start":{"line":109,"column":4},"end":{"line":113,"column":6}},"34":{"start":{"line":115,"column":4},"end":{"line":121,"column":5}},"35":{"start":{"line":116,"column":5},"end":{"line":116,"column":37}},"36":{"start":{"line":117,"column":11},"end":{"line":121,"column":5}},"37":{"start":{"line":118,"column":5},"end":{"line":118,"column":49}},"38":{"start":{"line":120,"column":5},"end":{"line":120,"column":38}},"39":{"start":{"line":122,"column":4},"end":{"line":122,"column":23}},"40":{"start":{"line":125,"column":2},"end":{"line":129,"column":4}},"41":{"start":{"line":136,"column":2},"end":{"line":136,"column":20}},"42":{"start":{"line":138,"column":2},"end":{"line":142,"column":3}},"43":{"start":{"line":140,"column":3},"end":{"line":140,"column":46}},"44":{"start":{"line":141,"column":3},"end":{"line":141,"column":10}},"45":{"start":{"line":144,"column":2},"end":{"line":144,"column":38}},"46":{"start":{"line":151,"column":2},"end":{"line":151,"column":20}},"47":{"start":{"line":153,"column":2},"end":{"line":156,"column":3}},"48":{"start":{"line":155,"column":3},"end":{"line":155,"column":21}},"49":{"start":{"line":158,"column":2},"end":{"line":161,"column":3}},"50":{"start":{"line":159,"column":3},"end":{"line":159,"column":48}},"51":{"start":{"line":160,"column":3},"end":{"line":160,"column":10}},"52":{"start":{"line":163,"column":2},"end":{"line":166,"column":3}},"53":{"start":{"line":164,"column":3},"end":{"line":164,"column":35}},"54":{"start":{"line":165,"column":3},"end":{"line":165,"column":10}},"55":{"start":{"line":168,"column":2},"end":{"line":168,"column":35}},"56":{"start":{"line":175,"column":2},"end":{"line":175,"column":20}},"57":{"start":{"line":176,"column":2},"end":{"line":176,"column":24}},"58":{"start":{"line":178,"column":2},"end":{"line":181,"column":3}},"59":{"start":{"line":179,"column":3},"end":{"line":179,"column":46}},"60":{"start":{"line":180,"column":3},"end":{"line":180,"column":10}},"61":{"start":{"line":183,"column":2},"end":{"line":187,"column":3}},"62":{"start":{"line":185,"column":3},"end":{"line":185,"column":47}},"63":{"start":{"line":186,"column":3},"end":{"line":186,"column":10}},"64":{"start":{"line":189,"column":2},"end":{"line":189,"column":38}},"65":{"start":{"line":196,"column":2},"end":{"line":196,"column":20}},"66":{"start":{"line":198,"column":2},"end":{"line":201,"column":3}},"67":{"start":{"line":200,"column":3},"end":{"line":200,"column":21}},"68":{"start":{"line":203,"column":2},"end":{"line":203,"column":24}},"69":{"start":{"line":205,"column":2},"end":{"line":208,"column":3}},"70":{"start":{"line":206,"column":3},"end":{"line":206,"column":48}},"71":{"start":{"line":207,"column":3},"end":{"line":207,"column":10}},"72":{"start":{"line":210,"column":2},"end":{"line":213,"column":3}},"73":{"start":{"line":211,"column":3},"end":{"line":211,"column":46}},"74":{"start":{"line":212,"column":3},"end":{"line":212,"column":10}},"75":{"start":{"line":215,"column":2},"end":{"line":215,"column":38}},"76":{"start":{"line":222,"column":2},"end":{"line":222,"column":20}},"77":{"start":{"line":223,"column":2},"end":{"line":223,"column":24}},"78":{"start":{"line":225,"column":2},"end":{"line":229,"column":3}},"79":{"start":{"line":227,"column":3},"end":{"line":227,"column":47}},"80":{"start":{"line":228,"column":3},"end":{"line":228,"column":10}},"81":{"start":{"line":231,"column":2},"end":{"line":231,"column":38}},"82":{"start":{"line":238,"column":2},"end":{"line":238,"column":20}},"83":{"start":{"line":240,"column":2},"end":{"line":243,"column":3}},"84":{"start":{"line":241,"column":3},"end":{"line":241,"column":35}},"85":{"start":{"line":242,"column":3},"end":{"line":242,"column":10}},"86":{"start":{"line":245,"column":2},"end":{"line":245,"column":35}},"87":{"start":{"line":252,"column":2},"end":{"line":252,"column":20}},"88":{"start":{"line":254,"column":2},"end":{"line":257,"column":3}},"89":{"start":{"line":256,"column":3},"end":{"line":256,"column":21}},"90":{"start":{"line":259,"column":2},"end":{"line":262,"column":3}},"91":{"start":{"line":260,"column":3},"end":{"line":260,"column":47}},"92":{"start":{"line":261,"column":3},"end":{"line":261,"column":10}},"93":{"start":{"line":264,"column":2},"end":{"line":264,"column":34}},"94":{"start":{"line":271,"column":2},"end":{"line":274,"column":3}},"95":{"start":{"line":273,"column":3},"end":{"line":273,"column":24}},"96":{"start":{"line":281,"column":2},"end":{"line":281,"column":23}},"97":{"start":{"line":282,"column":2},"end":{"line":282,"column":40}},"98":{"start":{"line":286,"column":0},"end":{"line":286,"column":42}}},"branchMap":{"1":{"line":85,"type":"switch","locations":[{"start":{"line":86,"column":3},"end":{"line":88,"column":10}},{"start":{"line":89,"column":3},"end":{"line":91,"column":10}},{"start":{"line":92,"column":3},"end":{"line":94,"column":10}},{"start":{"line":95,"column":3},"end":{"line":97,"column":10}},{"start":{"line":98,"column":3},"end":{"line":100,"column":10}},{"start":{"line":101,"column":3},"end":{"line":103,"column":10}},{"start":{"line":104,"column":3},"end":{"line":106,"column":10}},{"start":{"line":107,"column":3},"end":{"line":107,"column":23}},{"start":{"line":108,"column":3},"end":{"line":113,"column":6}},{"start":{"line":114,"column":3},"end":{"line":122,"column":23}}]},"2":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":4},"end":{"line":115,"column":4}},{"start":{"line":115,"column":4},"end":{"line":115,"column":4}}]},"3":{"line":117,"type":"if","locations":[{"start":{"line":117,"column":11},"end":{"line":117,"column":11}},{"start":{"line":117,"column":11},"end":{"line":117,"column":11}}]},"4":{"line":138,"type":"if","locations":[{"start":{"line":138,"column":2},"end":{"line":138,"column":2}},{"start":{"line":138,"column":2},"end":{"line":138,"column":2}}]},"5":{"line":138,"type":"binary-expr","locations":[{"start":{"line":138,"column":6},"end":{"line":138,"column":46}},{"start":{"line":139,"column":3},"end":{"line":139,"column":64}}]},"6":{"line":153,"type":"binary-expr","locations":[{"start":{"line":153,"column":9},"end":{"line":153,"column":49}},{"start":{"line":154,"column":5},"end":{"line":154,"column":65}}]},"7":{"line":158,"type":"if","locations":[{"start":{"line":158,"column":2},"end":{"line":158,"column":2}},{"start":{"line":158,"column":2},"end":{"line":158,"column":2}}]},"8":{"line":163,"type":"if","locations":[{"start":{"line":163,"column":2},"end":{"line":163,"column":2}},{"start":{"line":163,"column":2},"end":{"line":163,"column":2}}]},"9":{"line":178,"type":"if","locations":[{"start":{"line":178,"column":2},"end":{"line":178,"column":2}},{"start":{"line":178,"column":2},"end":{"line":178,"column":2}}]},"10":{"line":183,"type":"if","locations":[{"start":{"line":183,"column":2},"end":{"line":183,"column":2}},{"start":{"line":183,"column":2},"end":{"line":183,"column":2}}]},"11":{"line":183,"type":"binary-expr","locations":[{"start":{"line":183,"column":6},"end":{"line":183,"column":46}},{"start":{"line":184,"column":3},"end":{"line":184,"column":59}}]},"12":{"line":198,"type":"binary-expr","locations":[{"start":{"line":198,"column":9},"end":{"line":198,"column":49}},{"start":{"line":199,"column":5},"end":{"line":199,"column":61}}]},"13":{"line":205,"type":"if","locations":[{"start":{"line":205,"column":2},"end":{"line":205,"column":2}},{"start":{"line":205,"column":2},"end":{"line":205,"column":2}}]},"14":{"line":210,"type":"if","locations":[{"start":{"line":210,"column":2},"end":{"line":210,"column":2}},{"start":{"line":210,"column":2},"end":{"line":210,"column":2}}]},"15":{"line":225,"type":"if","locations":[{"start":{"line":225,"column":2},"end":{"line":225,"column":2}},{"start":{"line":225,"column":2},"end":{"line":225,"column":2}}]},"16":{"line":225,"type":"binary-expr","locations":[{"start":{"line":225,"column":6},"end":{"line":225,"column":46}},{"start":{"line":226,"column":3},"end":{"line":226,"column":59}}]},"17":{"line":240,"type":"if","locations":[{"start":{"line":240,"column":2},"end":{"line":240,"column":2}},{"start":{"line":240,"column":2},"end":{"line":240,"column":2}}]},"18":{"line":254,"type":"binary-expr","locations":[{"start":{"line":254,"column":9},"end":{"line":254,"column":49}},{"start":{"line":255,"column":4},"end":{"line":255,"column":44}}]},"19":{"line":259,"type":"if","locations":[{"start":{"line":259,"column":2},"end":{"line":259,"column":2}},{"start":{"line":259,"column":2},"end":{"line":259,"column":2}}]},"20":{"line":271,"type":"binary-expr","locations":[{"start":{"line":271,"column":9},"end":{"line":271,"column":49}},{"start":{"line":272,"column":5},"end":{"line":272,"column":61}}]}},"code":["'use strict';","","const STATES = {","\tILLEGAL: -1,","\tNO: 0,","\tPARAMETER_START: 1,","\tPARAMETER_NAME: 2,","\tSTORE_LIST_START: 3,","\tSTORE_LIST_ITEM: 4,","\tSTORE_LIST_COMMA: 5,","\tSTORE_LIST_END: 6,","\tTEXT: 7,","\tEND: 8","};","Object.freeze(STATES);","","const PARAMETER_FIRST_REGEXP = /[$A-Z_]/i;","const PARAMETER_TAIL_REGEXP = /[$\\w]/;","const STORE_NAME_REGEXP = /[\\w$\\/-]/;","const WHITESPACE_REGEXP = /\\s/;","","class RouteExpressionTokenizer {","","\t/**","\t * Creates a new instance of the route expression tokenizer.","\t */","\tconstructor() {","","\t\t/**","\t\t * Current source code of the route rule.","\t\t * @type {string}","\t\t * @private","\t\t */","\t\tthis._source = '';","","\t\t/**","\t\t * Current index in the route expression.","\t\t * @type {number}","\t\t * @private","\t\t */","\t\tthis._currentIndex = 0;","","\t\t/**","\t\t * Current token end index in the route expression.","\t\t * @type {number}","\t\t * @private","\t\t */","\t\tthis._currentEnd = 0;","","\t\t/**","\t\t * Current state.","\t\t * @type {number}","\t\t * @private","\t\t */","\t\tthis._currentState = STATES.NO;","\t}","","\t/**","\t * Gets the state constants map.","\t */","\tstatic get STATES() {","\t\treturn STATES;","\t}","","\t/**","\t * Sets the route expression string to tokenize.","\t * @param {string} routeExpression Route expression string.","\t */","\tsetRouteExpression(routeExpression) {","\t\tthis._source = routeExpression;","\t\tthis._currentIndex = 0;","\t\tthis._currentEnd = 0;","\t\tthis._currentState = STATES.NO;","\t}","","\t/**","\t * Gets a next token in source.","\t * @returns {{state: (number), start: number, end: number}}","\t */","\t/* eslint complexity: 0 */","\tnext() {","\t\tconst start = this._currentIndex;","\t\tconst state = this._currentState;","","\t\tswitch (this._currentState) {","\t\t\tcase STATES.PARAMETER_START:","\t\t\t\tthis.parameterStartState();","\t\t\t\tbreak;","\t\t\tcase STATES.PARAMETER_NAME:","\t\t\t\tthis.parameterNameState();","\t\t\t\tbreak;","\t\t\tcase STATES.STORE_LIST_START:","\t\t\t\tthis.storeListStartState();","\t\t\t\tbreak;","\t\t\tcase STATES.STORE_LIST_ITEM:","\t\t\t\tthis.storeListItemState();","\t\t\t\tbreak;","\t\t\tcase STATES.STORE_LIST_COMMA:","\t\t\t\tthis.storeListCommaState();","\t\t\t\tbreak;","\t\t\tcase STATES.STORE_LIST_END:","\t\t\t\tthis.storeListEndState();","\t\t\t\tbreak;","\t\t\tcase STATES.TEXT:","\t\t\t\tthis.textState();","\t\t\t\tbreak;","\t\t\tcase STATES.ILLEGAL:","\t\t\tcase STATES.END:","\t\t\t\treturn {","\t\t\t\t\tstate,","\t\t\t\t\tstart,","\t\t\t\t\tend: start + 1","\t\t\t\t};","\t\t\tdefault:","\t\t\t\tif (this._currentIndex === this._source.length) {","\t\t\t\t\tthis._currentState = STATES.END;","\t\t\t\t} else if (this._source[start] === ':') {","\t\t\t\t\tthis._currentState = STATES.PARAMETER_START;","\t\t\t\t} else {","\t\t\t\t\tthis._currentState = STATES.TEXT;","\t\t\t\t}","\t\t\t\treturn this.next();","\t\t}","","\t\treturn {","\t\t\tstate,","\t\t\tstart,","\t\t\tend: this._currentEnd","\t\t};","\t}","","\t/**","\t * Describes the PARAMETER_START state.","\t */","\tparameterStartState() {","\t\tthis.toNextChar();","","\t\tif (this._currentIndex < this._source.length &&","\t\t\tPARAMETER_FIRST_REGEXP.test(this._source[this._currentIndex])) {","\t\t\tthis._currentState = STATES.PARAMETER_NAME;","\t\t\treturn;","\t\t}","","\t\tthis._currentState = STATES.ILLEGAL;","\t}","","\t/**","\t * Describes the PARAMETER_NAME state.","\t */","\tparameterNameState() {","\t\tthis.toNextChar();","","\t\twhile (this._currentIndex < this._source.length &&","\t\t\t\t\tPARAMETER_TAIL_REGEXP.test(this._source[this._currentIndex])) {","\t\t\tthis.toNextChar();","\t\t}","","\t\tif (this._source[this._currentIndex] === '[') {","\t\t\tthis._currentState = STATES.STORE_LIST_START;","\t\t\treturn;","\t\t}","","\t\tif (this._currentIndex === this._source.length) {","\t\t\tthis._currentState = STATES.END;","\t\t\treturn;","\t\t}","","\t\tthis._currentState = STATES.TEXT;","\t}","","\t/**","\t * Describes the STORE_LIST_START state.","\t */","\tstoreListStartState() {","\t\tthis.toNextChar();","\t\tthis.skipWhitespace();","","\t\tif (this._source[this._currentIndex] === ']') {","\t\t\tthis._currentState = STATES.STORE_LIST_END;","\t\t\treturn;","\t\t}","","\t\tif (this._currentIndex < this._source.length &&","\t\t\tSTORE_NAME_REGEXP.test(this._source[this._currentIndex])) {","\t\t\tthis._currentState = STATES.STORE_LIST_ITEM;","\t\t\treturn;","\t\t}","","\t\tthis._currentState = STATES.ILLEGAL;","\t}","","\t/**","\t * Describes the STORE_LIST_ITEM state.","\t */","\tstoreListItemState() {","\t\tthis.toNextChar();","","\t\twhile (this._currentIndex < this._source.length &&","\t\t\t\t\tSTORE_NAME_REGEXP.test(this._source[this._currentIndex])) {","\t\t\tthis.toNextChar();","\t\t}","","\t\tthis.skipWhitespace();","","\t\tif (this._source[this._currentIndex] === ',') {","\t\t\tthis._currentState = STATES.STORE_LIST_COMMA;","\t\t\treturn;","\t\t}","","\t\tif (this._source[this._currentIndex] === ']') {","\t\t\tthis._currentState = STATES.STORE_LIST_END;","\t\t\treturn;","\t\t}","","\t\tthis._currentState = STATES.ILLEGAL;","\t}","","\t/**","\t * Describes the STORE_LIST_COMMA state.","\t */","\tstoreListCommaState() {","\t\tthis.toNextChar();","\t\tthis.skipWhitespace();","","\t\tif (this._currentIndex < this._source.length &&","\t\t\tSTORE_NAME_REGEXP.test(this._source[this._currentIndex])) {","\t\t\tthis._currentState = STATES.STORE_LIST_ITEM;","\t\t\treturn;","\t\t}","","\t\tthis._currentState = STATES.ILLEGAL;","\t}","","\t/**","\t * Describes the STORE_LIST_END state.","\t */","\tstoreListEndState() {","\t\tthis.toNextChar();","","\t\tif (this._currentIndex === this._source.length) {","\t\t\tthis._currentState = STATES.END;","\t\t\treturn;","\t\t}","","\t\tthis._currentState = STATES.TEXT;","\t}","","\t/**","\t * Describes the TEXT state.","\t */","\ttextState() {","\t\tthis.toNextChar();","","\t\twhile (this._currentIndex < this._source.length &&","\t\t\t\tthis._source[this._currentIndex] !== ':') {","\t\t\tthis.toNextChar();","\t\t}","","\t\tif (this._source[this._currentIndex] === ':') {","\t\t\tthis._currentState = STATES.PARAMETER_START;","\t\t\treturn;","\t\t}","","\t\tthis._currentState = STATES.END;","\t}","","\t/**","\t * Skips all whitespace characters.","\t */","\tskipWhitespace() {","\t\twhile (this._currentIndex < this._source.length &&","\t\t\t\t\tWHITESPACE_REGEXP.test(this._source[this._currentIndex])) {","\t\t\tthis._currentIndex++;","\t\t}","\t}","","\t/**","\t * Moved pointer to the next char.","\t */","\ttoNextChar() {","\t\tthis._currentIndex++;","\t\tthis._currentEnd = this._currentIndex;","\t}","}","","module.exports = RouteExpressionTokenizer;",""],"l":{"3":1,"15":1,"17":1,"18":1,"19":1,"20":1,"34":0,"41":0,"48":0,"55":0,"62":0,"70":0,"71":0,"72":0,"73":0,"82":0,"83":0,"85":0,"87":0,"88":0,"90":0,"91":0,"93":0,"94":0,"96":0,"97":0,"99":0,"100":0,"102":0,"103":0,"105":0,"106":0,"109":0,"115":0,"116":0,"117":0,"118":0,"120":0,"122":0,"125":0,"136":0,"138":0,"140":0,"141":0,"144":0,"151":0,"153":0,"155":0,"158":0,"159":0,"160":0,"163":0,"164":0,"165":0,"168":0,"175":0,"176":0,"178":0,"179":0,"180":0,"183":0,"185":0,"186":0,"189":0,"196":0,"198":0,"200":0,"203":0,"205":0,"206":0,"207":0,"210":0,"211":0,"212":0,"215":0,"222":0,"223":0,"225":0,"227":0,"228":0,"231":0,"238":0,"240":0,"241":0,"242":0,"245":0,"252":0,"254":0,"256":0,"259":0,"260":0,"261":0,"264":0,"271":0,"273":0,"281":0,"282":0,"286":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/finders/StoreFinder.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/finders/StoreFinder.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":27,"loc":{"start":{"line":27,"column":12},"end":{"line":27,"column":22}}},"2":{"name":"(anonymous_2)","line":74,"loc":{"start":{"line":74,"column":5},"end":{"line":74,"column":8}}},"3":{"name":"(anonymous_3)","line":103,"loc":{"start":{"line":103,"column":6},"end":{"line":103,"column":9}}},"4":{"name":"(anonymous_4)","line":148,"loc":{"start":{"line":148,"column":11},"end":{"line":148,"column":14}}},"5":{"name":"(anonymous_5)","line":166,"loc":{"start":{"line":166,"column":23},"end":{"line":166,"column":34}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":29}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":58}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":33}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":37}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":29}},"6":{"start":{"line":9,"column":0},"end":{"line":9,"column":46}},"7":{"start":{"line":10,"column":0},"end":{"line":10,"column":38}},"8":{"start":{"line":12,"column":0},"end":{"line":16,"column":2}},"9":{"start":{"line":28,"column":2},"end":{"line":28,"column":10}},"10":{"start":{"line":30,"column":2},"end":{"line":30,"column":43}},"11":{"start":{"line":37,"column":2},"end":{"line":37,"column":47}},"12":{"start":{"line":43,"column":2},"end":{"line":45,"column":4}},"13":{"start":{"line":51,"column":2},"end":{"line":53,"column":5}},"14":{"start":{"line":60,"column":2},"end":{"line":60,"column":28}},"15":{"start":{"line":67,"column":2},"end":{"line":67,"column":34}},"16":{"start":{"line":75,"column":2},"end":{"line":77,"column":3}},"17":{"start":{"line":76,"column":3},"end":{"line":76,"column":52}},"18":{"start":{"line":79,"column":2},"end":{"line":79,"column":49}},"19":{"start":{"line":81,"column":2},"end":{"line":97,"column":40}},"20":{"start":{"line":82,"column":3},"end":{"line":86,"column":6}},"21":{"start":{"line":88,"column":3},"end":{"line":95,"column":24}},"22":{"start":{"line":90,"column":5},"end":{"line":90,"column":64}},"23":{"start":{"line":91,"column":5},"end":{"line":91,"column":70}},"24":{"start":{"line":92,"column":5},"end":{"line":92,"column":56}},"25":{"start":{"line":94,"column":26},"end":{"line":94,"column":39}},"26":{"start":{"line":97,"column":14},"end":{"line":97,"column":38}},"27":{"start":{"line":104,"column":2},"end":{"line":106,"column":3}},"28":{"start":{"line":105,"column":3},"end":{"line":105,"column":29}},"29":{"start":{"line":108,"column":2},"end":{"line":110,"column":4}},"30":{"start":{"line":111,"column":2},"end":{"line":115,"column":5}},"31":{"start":{"line":112,"column":3},"end":{"line":114,"column":43}},"32":{"start":{"line":113,"column":25},"end":{"line":113,"column":34}},"33":{"start":{"line":114,"column":28},"end":{"line":114,"column":41}},"34":{"start":{"line":117,"column":2},"end":{"line":139,"column":6}},"35":{"start":{"line":120,"column":4},"end":{"line":136,"column":8}},"36":{"start":{"line":121,"column":27},"end":{"line":121,"column":62}},"37":{"start":{"line":123,"column":6},"end":{"line":123,"column":58}},"38":{"start":{"line":124,"column":6},"end":{"line":124,"column":51}},"39":{"start":{"line":125,"column":6},"end":{"line":125,"column":30}},"40":{"start":{"line":128,"column":6},"end":{"line":128,"column":58}},"41":{"start":{"line":129,"column":6},"end":{"line":129,"column":51}},"42":{"start":{"line":130,"column":6},"end":{"line":130,"column":33}},"43":{"start":{"line":133,"column":6},"end":{"line":133,"column":58}},"44":{"start":{"line":134,"column":6},"end":{"line":134,"column":50}},"45":{"start":{"line":135,"column":6},"end":{"line":135,"column":33}},"46":{"start":{"line":137,"column":4},"end":{"line":137,"column":28}},"47":{"start":{"line":138,"column":4},"end":{"line":138,"column":23}},"48":{"start":{"line":141,"column":2},"end":{"line":141,"column":28}},"49":{"start":{"line":149,"column":2},"end":{"line":155,"column":3}},"50":{"start":{"line":150,"column":3},"end":{"line":150,"column":38}},"51":{"start":{"line":152,"column":3},"end":{"line":152,"column":29}},"52":{"start":{"line":154,"column":3},"end":{"line":154,"column":51}},"53":{"start":{"line":154,"column":34},"end":{"line":154,"column":49}},"54":{"start":{"line":157,"column":2},"end":{"line":157,"column":27}},"55":{"start":{"line":167,"column":2},"end":{"line":167,"column":66}},"56":{"start":{"line":168,"column":2},"end":{"line":168,"column":67}},"57":{"start":{"line":169,"column":2},"end":{"line":169,"column":43}},"58":{"start":{"line":170,"column":2},"end":{"line":171,"column":59}},"59":{"start":{"line":173,"column":2},"end":{"line":176,"column":4}},"60":{"start":{"line":180,"column":0},"end":{"line":180,"column":29}}},"branchMap":{"1":{"line":44,"type":"binary-expr","locations":[{"start":{"line":44,"column":3},"end":{"line":44,"column":25}},{"start":{"line":44,"column":29},"end":{"line":44,"column":48}}]},"2":{"line":52,"type":"binary-expr","locations":[{"start":{"line":52,"column":26},"end":{"line":52,"column":43}},{"start":{"line":52,"column":47},"end":{"line":52,"column":66}}]},"3":{"line":75,"type":"if","locations":[{"start":{"line":75,"column":2},"end":{"line":75,"column":2}},{"start":{"line":75,"column":2},"end":{"line":75,"column":2}}]},"4":{"line":104,"type":"if","locations":[{"start":{"line":104,"column":2},"end":{"line":104,"column":2}},{"start":{"line":104,"column":2},"end":{"line":104,"column":2}}]},"5":{"line":149,"type":"if","locations":[{"start":{"line":149,"column":2},"end":{"line":149,"column":2}},{"start":{"line":149,"column":2},"end":{"line":149,"column":2}}]},"6":{"line":170,"type":"cond-expr","locations":[{"start":{"line":171,"column":3},"end":{"line":171,"column":47}},{"start":{"line":171,"column":50},"end":{"line":171,"column":58}}]}},"code":["'use strict';","","const path = require('path');","const requireHelper = require('../helpers/requireHelper');","const events = require('events');","const chokidar = require('chokidar');","const glob = require('glob');","","const DEFAULT_STORES_ROOT = 'catberry_stores';","const DEFAULT_STORES_GLOB = '**/*.js';","","const CHOKIDAR_OPTIONS = {","\tignoreInitial: true,","\tcwd: process.cwd(),","\tignorePermissionErrors: true","};","","/**"," * Implements the store finder module."," */","class StoreFinder extends events.EventEmitter {","","\t/**","\t * Creates a new instance of the store finder.","\t * @param {ServiceLocator} locator The service locator for resolving dependencies.","\t */","\tconstructor(locator) {","\t\tsuper();","","\t\tconst config = locator.resolve('config');","","\t\t/**","\t\t * Current event bus.","\t\t * @type {EventEmitter}","\t\t * @private","\t\t */","\t\tthis._eventBus = locator.resolve('eventBus');","","\t\t/**","\t\t * Current folder with Catberry stores.","\t\t * @type {string}","\t\t */","\t\tthis._storesDirectory = requireHelper.getValidPath(","\t\t\tconfig.storesDirectory || DEFAULT_STORES_ROOT","\t\t);","","\t\t/**","\t\t * Current glob for the store files.","\t\t * @type {string}","\t\t */","\t\tthis._storesGlobExpression = requireHelper.getValidPath(path.join(","\t\t\tthis._storesDirectory, config.storesGlob || DEFAULT_STORES_GLOB","\t\t));","","\t\t/**","\t\t * Current Promise for the ready state.","\t\t * @type {Promise}","\t\t * @private","\t\t */","\t\tthis._readyPromise = null;","","\t\t/**","\t\t * Current Map of last found stores by their names.","\t\t * @type {Map}","\t\t * @private","\t\t */","\t\tthis._foundStoresByNames = null;","\t}","","\t/**","\t * Finds all the stores.","\t * @returns {Promise<Map>} The Promise for Map of found stores by names.","\t */","\tfind() {","\t\tif (this._foundStoresByNames) {","\t\t\treturn Promise.resolve(this._foundStoresByNames);","\t\t}","","\t\tthis._foundStoresByNames = Object.create(null);","","\t\treturn new Promise((fulfill, reject) => {","\t\t\tconst storeFilesGlob = new glob.Glob(this._storesGlobExpression, {","\t\t\t\tnosort: true,","\t\t\t\tsilent: true,","\t\t\t\tnodir: true","\t\t\t});","","\t\t\tstoreFilesGlob","\t\t\t\t.on('match', match => {","\t\t\t\t\tconst storeDescriptor = this._createStoreDescriptor(match);","\t\t\t\t\tthis._foundStoresByNames[storeDescriptor.name] = storeDescriptor;","\t\t\t\t\tthis._eventBus.emit('storeFound', storeDescriptor);","\t\t\t\t})","\t\t\t\t.on('error', error => reject(error))","\t\t\t\t.on('end', fulfill);","\t\t})","\t\t.then(() => this._foundStoresByNames);","\t}","","\t/**","\t * Watches the components for changing.","\t */","\twatch() {","\t\tif (this._readyPromise) {","\t\t\treturn this._readyPromise;","\t\t}","","\t\tconst fileWatcher = chokidar.watch(","\t\t\tthis._storesGlobExpression, CHOKIDAR_OPTIONS","\t\t);","\t\tconst fileWatcherPromise = new Promise((fulfill, reject) => {","\t\t\tfileWatcher","\t\t\t\t.once('ready', () => fulfill())","\t\t\t\t.once('error', error => reject(error));","\t\t});","","\t\tthis._readyPromise = fileWatcherPromise","\t\t\t.then(() => {","","\t\t\t\tfileWatcher","\t\t\t\t\t.on('error', error => this._eventBus.emit('error', error))","\t\t\t\t\t.on('add', filename => {","\t\t\t\t\t\tconst store = this._createStoreDescriptor(filename);","\t\t\t\t\t\tthis._foundStoresByNames[store.name] = store;","\t\t\t\t\t\tthis.emit('add', store);","\t\t\t\t\t})","\t\t\t\t\t.on('change', filename => {","\t\t\t\t\t\tconst store = this._createStoreDescriptor(filename);","\t\t\t\t\t\tthis._foundStoresByNames[store.name] = store;","\t\t\t\t\t\tthis.emit('change', store);","\t\t\t\t\t})","\t\t\t\t\t.on('unlink', filename => {","\t\t\t\t\t\tconst store = this._createStoreDescriptor(filename);","\t\t\t\t\t\tdelete this._foundStoresByNames[store.name];","\t\t\t\t\t\tthis.emit('unlink', store);","\t\t\t\t\t});","\t\t\t\tthis.emit('watchReady');","\t\t\t\treturn fileWatcher;","\t\t\t});","","\t\treturn this._readyPromise;","\t}","","\t/**","\t * Closes watcher.","\t * @returns {Promise} Promise of closed watcher.","\t */","\tcloseWatch() {","\t\tif (this._readyPromise) {","\t\t\tconst promise = this._readyPromise;","","\t\t\tthis._readyPromise = null;","","\t\t\treturn promise.then(watcher => watcher.close());","\t\t}","","\t\treturn Promise.resolve();","\t}","","\t/**","\t * Creates a descriptor for the found store.","\t * @param {string} filename The store's filename.","\t * @returns {{name: string, path: string}} The store descriptor.","\t * @private","\t */","\t_createStoreDescriptor(filename) {","\t\tconst relative = path.relative(this._storesDirectory, filename);","\t\tconst basename = path.basename(relative, path.extname(relative));","\t\tconst directory = path.dirname(relative);","\t\tconst storeName = directory !== '.' ?","\t\t\tpath.dirname(relative) + path.sep + basename : basename;","","\t\treturn {","\t\t\tname: storeName.replace(/\\\\/g, '/'), // normalize name for windows","\t\t\tpath: path.relative(process.cwd(), filename)","\t\t};","\t}","}","","module.exports = StoreFinder;",""],"l":{"3":1,"4":1,"5":1,"6":1,"7":1,"9":1,"10":1,"12":1,"28":0,"30":0,"37":0,"43":0,"51":0,"60":0,"67":0,"75":0,"76":0,"79":0,"81":0,"82":0,"88":0,"90":0,"91":0,"92":0,"94":0,"97":0,"104":0,"105":0,"108":0,"111":0,"112":0,"113":0,"114":0,"117":0,"120":0,"121":0,"123":0,"124":0,"125":0,"128":0,"129":0,"130":0,"133":0,"134":0,"135":0,"137":0,"138":0,"141":0,"149":0,"150":0,"152":0,"154":0,"157":0,"167":0,"168":0,"169":0,"170":0,"173":0,"180":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/finders/ComponentFinder.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/finders/ComponentFinder.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"fnMap":{"1":{"name":"(anonymous_1)","line":32,"loc":{"start":{"line":32,"column":12},"end":{"line":32,"column":22}}},"2":{"name":"(anonymous_2)","line":94,"loc":{"start":{"line":94,"column":5},"end":{"line":94,"column":8}}},"3":{"name":"(anonymous_3)","line":141,"loc":{"start":{"line":141,"column":6},"end":{"line":141,"column":9}}},"4":{"name":"(anonymous_4)","line":268,"loc":{"start":{"line":268,"column":11},"end":{"line":268,"column":14}}},"5":{"name":"(anonymous_5)","line":288,"loc":{"start":{"line":288,"column":27},"end":{"line":288,"column":38}}},"6":{"name":"(anonymous_6)","line":342,"loc":{"start":{"line":342,"column":20},"end":{"line":342,"column":31}}},"7":{"name":"(anonymous_7)","line":362,"loc":{"start":{"line":362,"column":17},"end":{"line":362,"column":29}}},"8":{"name":"(anonymous_8)","line":382,"loc":{"start":{"line":382,"column":14},"end":{"line":382,"column":26}}},"9":{"name":"(anonymous_9)","line":409,"loc":{"start":{"line":409,"column":25},"end":{"line":409,"column":52}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":29}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":58}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":56}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":37}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":33}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":29}},"7":{"start":{"line":10,"column":0},"end":{"line":15,"column":2}},"8":{"start":{"line":17,"column":0},"end":{"line":20,"column":2}},"9":{"start":{"line":21,"column":0},"end":{"line":21,"column":42}},"10":{"start":{"line":33,"column":2},"end":{"line":33,"column":10}},"11":{"start":{"line":40,"column":2},"end":{"line":40,"column":47}},"12":{"start":{"line":47,"column":2},"end":{"line":47,"column":27}},"13":{"start":{"line":54,"column":2},"end":{"line":54,"column":38}},"14":{"start":{"line":61,"column":2},"end":{"line":61,"column":37}},"15":{"start":{"line":68,"column":2},"end":{"line":68,"column":28}},"16":{"start":{"line":75,"column":2},"end":{"line":75,"column":49}},"17":{"start":{"line":77,"column":2},"end":{"line":77,"column":66}},"18":{"start":{"line":78,"column":2},"end":{"line":87,"column":3}},"19":{"start":{"line":79,"column":3},"end":{"line":79,"column":43}},"20":{"start":{"line":80,"column":9},"end":{"line":87,"column":3}},"21":{"start":{"line":81,"column":3},"end":{"line":82,"column":59}},"22":{"start":{"line":82,"column":25},"end":{"line":82,"column":57}},"23":{"start":{"line":84,"column":3},"end":{"line":86,"column":4}},"24":{"start":{"line":85,"column":4},"end":{"line":85,"column":42}},"25":{"start":{"line":95,"column":2},"end":{"line":97,"column":3}},"26":{"start":{"line":96,"column":3},"end":{"line":96,"column":56}},"27":{"start":{"line":99,"column":2},"end":{"line":99,"column":53}},"28":{"start":{"line":100,"column":2},"end":{"line":100,"column":52}},"29":{"start":{"line":102,"column":2},"end":{"line":102,"column":19}},"30":{"start":{"line":103,"column":2},"end":{"line":103,"column":22}},"31":{"start":{"line":104,"column":2},"end":{"line":104,"column":23}},"32":{"start":{"line":106,"column":2},"end":{"line":129,"column":7}},"33":{"start":{"line":107,"column":22},"end":{"line":129,"column":5}},"34":{"start":{"line":108,"column":4},"end":{"line":115,"column":7}},"35":{"start":{"line":117,"column":4},"end":{"line":128,"column":25}},"36":{"start":{"line":119,"column":6},"end":{"line":120,"column":46}},"37":{"start":{"line":122,"column":6},"end":{"line":122,"column":46}},"38":{"start":{"line":123,"column":6},"end":{"line":125,"column":8}},"39":{"start":{"line":127,"column":27},"end":{"line":127,"column":40}},"40":{"start":{"line":131,"column":2},"end":{"line":133,"column":45}},"41":{"start":{"line":133,"column":15},"end":{"line":133,"column":43}},"42":{"start":{"line":142,"column":2},"end":{"line":144,"column":3}},"43":{"start":{"line":143,"column":3},"end":{"line":143,"column":29}},"44":{"start":{"line":146,"column":2},"end":{"line":146,"column":97}},"45":{"start":{"line":147,"column":2},"end":{"line":151,"column":5}},"46":{"start":{"line":148,"column":3},"end":{"line":150,"column":43}},"47":{"start":{"line":149,"column":25},"end":{"line":149,"column":34}},"48":{"start":{"line":150,"column":28},"end":{"line":150,"column":41}},"49":{"start":{"line":153,"column":2},"end":{"line":153,"column":86}},"50":{"start":{"line":154,"column":2},"end":{"line":158,"column":5}},"51":{"start":{"line":155,"column":3},"end":{"line":157,"column":43}},"52":{"start":{"line":156,"column":25},"end":{"line":156,"column":34}},"53":{"start":{"line":157,"column":28},"end":{"line":157,"column":41}},"54":{"start":{"line":160,"column":2},"end":{"line":258,"column":6}},"55":{"start":{"line":163,"column":4},"end":{"line":163,"column":36}},"56":{"start":{"line":164,"column":4},"end":{"line":221,"column":8}},"57":{"start":{"line":165,"column":27},"end":{"line":165,"column":62}},"58":{"start":{"line":168,"column":6},"end":{"line":168,"column":59}},"59":{"start":{"line":169,"column":6},"end":{"line":171,"column":7}},"60":{"start":{"line":170,"column":7},"end":{"line":170,"column":14}},"61":{"start":{"line":173,"column":6},"end":{"line":176,"column":8}},"62":{"start":{"line":179,"column":6},"end":{"line":181,"column":8}},"63":{"start":{"line":182,"column":6},"end":{"line":186,"column":7}},"64":{"start":{"line":183,"column":7},"end":{"line":183,"column":43}},"65":{"start":{"line":184,"column":7},"end":{"line":184,"column":39}},"66":{"start":{"line":185,"column":7},"end":{"line":185,"column":14}},"67":{"start":{"line":189,"column":6},"end":{"line":191,"column":8}},"68":{"start":{"line":192,"column":6},"end":{"line":196,"column":19}},"69":{"start":{"line":198,"column":6},"end":{"line":203,"column":7}},"70":{"start":{"line":200,"column":7},"end":{"line":200,"column":47}},"71":{"start":{"line":201,"column":7},"end":{"line":201,"column":39}},"72":{"start":{"line":202,"column":7},"end":{"line":202,"column":14}},"73":{"start":{"line":205,"column":6},"end":{"line":205,"column":38}},"74":{"start":{"line":208,"column":6},"end":{"line":208,"column":59}},"75":{"start":{"line":210,"column":6},"end":{"line":212,"column":7}},"76":{"start":{"line":211,"column":7},"end":{"line":211,"column":14}},"77":{"start":{"line":213,"column":6},"end":{"line":213,"column":49}},"78":{"start":{"line":216,"column":6},"end":{"line":216,"column":59}},"79":{"start":{"line":217,"column":6},"end":{"line":219,"column":7}},"80":{"start":{"line":218,"column":7},"end":{"line":218,"column":14}},"81":{"start":{"line":220,"column":6},"end":{"line":220,"column":49}},"82":{"start":{"line":223,"column":4},"end":{"line":254,"column":8}},"83":{"start":{"line":224,"column":27},"end":{"line":224,"column":62}},"84":{"start":{"line":227,"column":6},"end":{"line":227,"column":69}},"85":{"start":{"line":228,"column":6},"end":{"line":228,"column":39}},"86":{"start":{"line":229,"column":6},"end":{"line":229,"column":37}},"87":{"start":{"line":233,"column":6},"end":{"line":233,"column":59}},"88":{"start":{"line":234,"column":6},"end":{"line":236,"column":7}},"89":{"start":{"line":235,"column":7},"end":{"line":235,"column":14}},"90":{"start":{"line":237,"column":6},"end":{"line":237,"column":75}},"91":{"start":{"line":240,"column":6},"end":{"line":240,"column":39}},"92":{"start":{"line":241,"column":6},"end":{"line":241,"column":37}},"93":{"start":{"line":243,"column":6},"end":{"line":243,"column":39}},"94":{"start":{"line":244,"column":6},"end":{"line":244,"column":37}},"95":{"start":{"line":248,"column":6},"end":{"line":248,"column":59}},"96":{"start":{"line":249,"column":6},"end":{"line":251,"column":7}},"97":{"start":{"line":250,"column":7},"end":{"line":250,"column":14}},"98":{"start":{"line":252,"column":6},"end":{"line":252,"column":39}},"99":{"start":{"line":253,"column":6},"end":{"line":253,"column":37}},"100":{"start":{"line":256,"column":4},"end":{"line":256,"column":28}},"101":{"start":{"line":257,"column":4},"end":{"line":257,"column":47}},"102":{"start":{"line":260,"column":2},"end":{"line":260,"column":28}},"103":{"start":{"line":269,"column":2},"end":{"line":269,"column":27}},"104":{"start":{"line":270,"column":2},"end":{"line":276,"column":3}},"105":{"start":{"line":271,"column":3},"end":{"line":271,"column":38}},"106":{"start":{"line":273,"column":3},"end":{"line":273,"column":29}},"107":{"start":{"line":275,"column":3},"end":{"line":275,"column":81}},"108":{"start":{"line":275,"column":35},"end":{"line":275,"column":79}},"109":{"start":{"line":275,"column":63},"end":{"line":275,"column":78}},"110":{"start":{"line":278,"column":2},"end":{"line":278,"column":27}},"111":{"start":{"line":289,"column":2},"end":{"line":291,"column":3}},"112":{"start":{"line":290,"column":3},"end":{"line":290,"column":15}},"113":{"start":{"line":293,"column":2},"end":{"line":293,"column":70}},"114":{"start":{"line":294,"column":2},"end":{"line":294,"column":44}},"115":{"start":{"line":296,"column":2},"end":{"line":296,"column":17}},"116":{"start":{"line":297,"column":2},"end":{"line":301,"column":3}},"117":{"start":{"line":298,"column":3},"end":{"line":298,"column":38}},"118":{"start":{"line":300,"column":3},"end":{"line":300,"column":35}},"119":{"start":{"line":303,"column":2},"end":{"line":305,"column":3}},"120":{"start":{"line":304,"column":3},"end":{"line":304,"column":15}},"121":{"start":{"line":307,"column":2},"end":{"line":308,"column":56}},"122":{"start":{"line":310,"column":2},"end":{"line":315,"column":3}},"123":{"start":{"line":311,"column":3},"end":{"line":313,"column":5}},"124":{"start":{"line":314,"column":3},"end":{"line":314,"column":15}},"125":{"start":{"line":317,"column":2},"end":{"line":319,"column":3}},"126":{"start":{"line":318,"column":3},"end":{"line":318,"column":58}},"127":{"start":{"line":321,"column":2},"end":{"line":326,"column":3}},"128":{"start":{"line":322,"column":3},"end":{"line":324,"column":5}},"129":{"start":{"line":325,"column":3},"end":{"line":325,"column":15}},"130":{"start":{"line":328,"column":2},"end":{"line":332,"column":4}},"131":{"start":{"line":343,"column":2},"end":{"line":343,"column":25}},"132":{"start":{"line":344,"column":2},"end":{"line":344,"column":23}},"133":{"start":{"line":346,"column":2},"end":{"line":352,"column":3}},"134":{"start":{"line":347,"column":3},"end":{"line":350,"column":4}},"135":{"start":{"line":348,"column":4},"end":{"line":348,"column":53}},"136":{"start":{"line":349,"column":4},"end":{"line":349,"column":10}},"137":{"start":{"line":351,"column":3},"end":{"line":351,"column":35}},"138":{"start":{"line":353,"column":2},"end":{"line":353,"column":19}},"139":{"start":{"line":363,"column":2},"end":{"line":363,"column":47}},"140":{"start":{"line":364,"column":2},"end":{"line":364,"column":76}},"141":{"start":{"line":366,"column":2},"end":{"line":366,"column":44}},"142":{"start":{"line":368,"column":2},"end":{"line":368,"column":54}},"143":{"start":{"line":369,"column":2},"end":{"line":369,"column":46}},"144":{"start":{"line":371,"column":2},"end":{"line":373,"column":3}},"145":{"start":{"line":372,"column":3},"end":{"line":372,"column":38}},"146":{"start":{"line":383,"column":2},"end":{"line":385,"column":3}},"147":{"start":{"line":384,"column":3},"end":{"line":384,"column":10}},"148":{"start":{"line":387,"column":2},"end":{"line":393,"column":3}},"149":{"start":{"line":388,"column":3},"end":{"line":388,"column":73}},"150":{"start":{"line":389,"column":3},"end":{"line":391,"column":5}},"151":{"start":{"line":392,"column":3},"end":{"line":392,"column":10}},"152":{"start":{"line":394,"column":2},"end":{"line":394,"column":47}},"153":{"start":{"line":395,"column":2},"end":{"line":395,"column":59}},"154":{"start":{"line":396,"column":2},"end":{"line":396,"column":51}},"155":{"start":{"line":398,"column":2},"end":{"line":400,"column":3}},"156":{"start":{"line":399,"column":3},"end":{"line":399,"column":34}},"157":{"start":{"line":410,"column":2},"end":{"line":414,"column":4}},"158":{"start":{"line":418,"column":0},"end":{"line":418,"column":33}}},"branchMap":{"1":{"line":78,"type":"if","locations":[{"start":{"line":78,"column":2},"end":{"line":78,"column":2}},{"start":{"line":78,"column":2},"end":{"line":78,"column":2}}]},"2":{"line":80,"type":"if","locations":[{"start":{"line":80,"column":9},"end":{"line":80,"column":9}},{"start":{"line":80,"column":9},"end":{"line":80,"column":9}}]},"3":{"line":84,"type":"if","locations":[{"start":{"line":84,"column":3},"end":{"line":84,"column":3}},{"start":{"line":84,"column":3},"end":{"line":84,"column":3}}]},"4":{"line":95,"type":"if","locations":[{"start":{"line":95,"column":2},"end":{"line":95,"column":2}},{"start":{"line":95,"column":2},"end":{"line":95,"column":2}}]},"5":{"line":142,"type":"if","locations":[{"start":{"line":142,"column":2},"end":{"line":142,"column":2}},{"start":{"line":142,"column":2},"end":{"line":142,"column":2}}]},"6":{"line":169,"type":"if","locations":[{"start":{"line":169,"column":6},"end":{"line":169,"column":6}},{"start":{"line":169,"column":6},"end":{"line":169,"column":6}}]},"7":{"line":169,"type":"binary-expr","locations":[{"start":{"line":169,"column":10},"end":{"line":169,"column":20}},{"start":{"line":169,"column":24},"end":{"line":169,"column":51}}]},"8":{"line":182,"type":"if","locations":[{"start":{"line":182,"column":6},"end":{"line":182,"column":6}},{"start":{"line":182,"column":6},"end":{"line":182,"column":6}}]},"9":{"line":193,"type":"cond-expr","locations":[{"start":{"line":194,"column":10},"end":{"line":196,"column":11}},{"start":{"line":196,"column":14},"end":{"line":196,"column":18}}]},"10":{"line":198,"type":"if","locations":[{"start":{"line":198,"column":6},"end":{"line":198,"column":6}},{"start":{"line":198,"column":6},"end":{"line":198,"column":6}}]},"11":{"line":198,"type":"binary-expr","locations":[{"start":{"line":198,"column":10},"end":{"line":198,"column":39}},{"start":{"line":199,"column":8},"end":{"line":199,"column":42}}]},"12":{"line":210,"type":"if","locations":[{"start":{"line":210,"column":6},"end":{"line":210,"column":6}},{"start":{"line":210,"column":6},"end":{"line":210,"column":6}}]},"13":{"line":210,"type":"binary-expr","locations":[{"start":{"line":210,"column":10},"end":{"line":210,"column":20}},{"start":{"line":210,"column":24},"end":{"line":210,"column":51}}]},"14":{"line":217,"type":"if","locations":[{"start":{"line":217,"column":6},"end":{"line":217,"column":6}},{"start":{"line":217,"column":6},"end":{"line":217,"column":6}}]},"15":{"line":217,"type":"binary-expr","locations":[{"start":{"line":217,"column":10},"end":{"line":217,"column":20}},{"start":{"line":217,"column":24},"end":{"line":217,"column":51}}]},"16":{"line":234,"type":"if","locations":[{"start":{"line":234,"column":6},"end":{"line":234,"column":6}},{"start":{"line":234,"column":6},"end":{"line":234,"column":6}}]},"17":{"line":249,"type":"if","locations":[{"start":{"line":249,"column":6},"end":{"line":249,"column":6}},{"start":{"line":249,"column":6},"end":{"line":249,"column":6}}]},"18":{"line":270,"type":"if","locations":[{"start":{"line":270,"column":2},"end":{"line":270,"column":2}},{"start":{"line":270,"column":2},"end":{"line":270,"column":2}}]},"19":{"line":289,"type":"if","locations":[{"start":{"line":289,"column":2},"end":{"line":289,"column":2}},{"start":{"line":289,"column":2},"end":{"line":289,"column":2}}]},"20":{"line":303,"type":"if","locations":[{"start":{"line":303,"column":2},"end":{"line":303,"column":2}},{"start":{"line":303,"column":2},"end":{"line":303,"column":2}}]},"21":{"line":307,"type":"binary-expr","locations":[{"start":{"line":307,"column":25},"end":{"line":307,"column":40}},{"start":{"line":308,"column":3},"end":{"line":308,"column":40}}]},"22":{"line":310,"type":"if","locations":[{"start":{"line":310,"column":2},"end":{"line":310,"column":2}},{"start":{"line":310,"column":2},"end":{"line":310,"column":2}}]},"23":{"line":317,"type":"if","locations":[{"start":{"line":317,"column":2},"end":{"line":317,"column":2}},{"start":{"line":317,"column":2},"end":{"line":317,"column":2}}]},"24":{"line":321,"type":"if","locations":[{"start":{"line":321,"column":2},"end":{"line":321,"column":2}},{"start":{"line":321,"column":2},"end":{"line":321,"column":2}}]},"25":{"line":347,"type":"if","locations":[{"start":{"line":347,"column":3},"end":{"line":347,"column":3}},{"start":{"line":347,"column":3},"end":{"line":347,"column":3}}]},"26":{"line":371,"type":"if","locations":[{"start":{"line":371,"column":2},"end":{"line":371,"column":2}},{"start":{"line":371,"column":2},"end":{"line":371,"column":2}}]},"27":{"line":383,"type":"if","locations":[{"start":{"line":383,"column":2},"end":{"line":383,"column":2}},{"start":{"line":383,"column":2},"end":{"line":383,"column":2}}]},"28":{"line":387,"type":"if","locations":[{"start":{"line":387,"column":2},"end":{"line":387,"column":2}},{"start":{"line":387,"column":2},"end":{"line":387,"column":2}}]},"29":{"line":398,"type":"if","locations":[{"start":{"line":398,"column":2},"end":{"line":398,"column":2}},{"start":{"line":398,"column":2},"end":{"line":398,"column":2}}]}},"code":["'use strict';","","const path = require('path');","const requireHelper = require('../helpers/requireHelper');","const moduleHelper = require('../helpers/moduleHelper');","const chokidar = require('chokidar');","const events = require('events');","const glob = require('glob');","","const CHOKIDAR_OPTIONS = {","\tignoreInitial: true,","\tuseFsEvents: false,","\tcwd: process.cwd(),","\tignorePermissionErrors: true","};","","const COMPONENTS_DEFAULT_GLOB = [","\t'catberry_components/**/cat-component.json',","\t'node_modules/*/cat-component.json'","];","const COMPONENT_NAME_REGEXP = /^[\\w-]+$/i;","","/**"," * Implements the component finder module."," */","class ComponentFinder extends events.EventEmitter {","","\t/**","\t * Creates a new instance of the component finder.","\t * @param {ServiceLocator} locator The Service Locator for resolving dependencies.","\t */","\tconstructor(locator) {","\t\tsuper();","","\t\t/**","\t\t * Current event bus.","\t\t * @type {EventEmitter}","\t\t * @private","\t\t */","\t\tthis._eventBus = locator.resolve('eventBus');","","\t\t/**","\t\t * Current file watcher.","\t\t * @type {FileWatcher}","\t\t * @private","\t\t */","\t\tthis._fileWatcher = null;","","\t\t/**","\t\t * Current set of last found components by their names.","\t\t * @type {Map}","\t\t * @private","\t\t */","\t\tthis._foundComponentsByNames = null;","","\t\t/**","\t\t * Current Map of last found components by their directories.","\t\t * @type {Map}","\t\t * @private","\t\t */","\t\tthis._foundComponentsByDirs = null;","","\t\t/**","\t\t * Current Promise for the ready state.","\t\t * @type {Promise}","\t\t * @private","\t\t */","\t\tthis._readyPromise = null;","","\t\t/**","\t\t * Current components' glob.","\t\t * @type {string}","\t\t * @private","\t\t */","\t\tthis._componentsGlob = COMPONENTS_DEFAULT_GLOB;","","\t\tconst componentsGlob = locator.resolve('config').componentsGlob;","\t\tif (typeof (componentsGlob) === 'string') {","\t\t\tthis._componentsGlob = [componentsGlob];","\t\t} else if (Array.isArray(componentsGlob)) {","\t\t\tconst areStrings = componentsGlob","\t\t\t\t.every(expression => typeof (expression) === 'string');","","\t\t\tif (areStrings) {","\t\t\t\tthis._componentsGlob = componentsGlob;","\t\t\t}","\t\t}","\t}","","\t/**","\t * Finds all the components.","\t * @returns {Promise<Map>} Promise for Map of found components by their names.","\t */","\tfind() {","\t\tif (this._foundComponentsByNames) {","\t\t\treturn Promise.resolve(this._foundComponentsByNames);","\t\t}","","\t\tthis._foundComponentsByNames = Object.create(null);","\t\tthis._foundComponentsByDirs = Object.create(null);","","\t\tconst cache = {};","\t\tconst symlinks = {};","\t\tconst statCache = {};","","\t\tconst promises = this._componentsGlob","\t\t\t.map(expression => new Promise((fulfill, reject) => {","\t\t\t\tconst componentFilesGlob = new glob.Glob(expression, {","\t\t\t\t\tnosort: true,","\t\t\t\t\tsilent: true,","\t\t\t\t\tnodir: true,","\t\t\t\t\tcache,","\t\t\t\t\tstatCache,","\t\t\t\t\tsymlinks","\t\t\t\t});","","\t\t\t\tcomponentFilesGlob","\t\t\t\t\t.on('match', match => {","\t\t\t\t\t\tconst componentDescriptor =","\t\t\t\t\t\t\tthis._createComponentDescriptor(match);","","\t\t\t\t\t\tthis._addComponent(componentDescriptor);","\t\t\t\t\t\tthis._eventBus.emit(","\t\t\t\t\t\t\t'componentFound', componentDescriptor","\t\t\t\t\t\t);","\t\t\t\t\t})","\t\t\t\t\t.on('error', error => reject(error))","\t\t\t\t\t.on('end', fulfill);","\t\t\t}));","","\t\treturn Promise","\t\t\t.all(promises)","\t\t\t.then(() => this._foundComponentsByNames);","\t}","","\t/**","\t * Watches the components for changing.","\t *","\t * @return {Promise} Promise of ready watchers.","\t */","\twatch() {","\t\tif (this._readyPromise) {","\t\t\treturn this._readyPromise;","\t\t}","","\t\tconst fileWatcher = chokidar.watch(Object.keys(this._foundComponentsByDirs), CHOKIDAR_OPTIONS);","\t\tconst fileWatcherReadyPromise = new Promise((fulfill, reject) => {","\t\t\tfileWatcher","\t\t\t\t.once('ready', () => fulfill())","\t\t\t\t.once('error', error => reject(error));","\t\t});","\t\t// watch cat-component.json files","\t\tconst componentJsonWatcher = chokidar.watch(this._componentsGlob, CHOKIDAR_OPTIONS);","\t\tconst componentJsonReadyPromise = new Promise((fulfill, reject) => {","\t\t\tcomponentJsonWatcher","\t\t\t\t.once('ready', () => fulfill())","\t\t\t\t.once('error', error => reject(error));","\t\t});","","\t\tthis._readyPromise = Promise","\t\t\t.all([fileWatcherReadyPromise, componentJsonReadyPromise])","\t\t\t.then(() => {","\t\t\t\tthis._fileWatcher = fileWatcher;","\t\t\t\tfileWatcher","\t\t\t\t\t.on('error', error => this._eventBus.emit('error', error))","\t\t\t\t// component's directory is changed","\t\t\t\t\t.on('change', filename => {","\t\t\t\t\t\tconst component = this._recognizeComponent(filename);","\t\t\t\t\t\tif (!component || component.path === filename) {","\t\t\t\t\t\t\treturn;","\t\t\t\t\t\t}","","\t\t\t\t\t\tconst changeArgs = {","\t\t\t\t\t\t\tfilename,","\t\t\t\t\t\t\tcomponent","\t\t\t\t\t\t};","","\t\t\t\t\t\t// logic file is changed","\t\t\t\t\t\tconst relativeLogic = this._getRelativeForComponent(","\t\t\t\t\t\t\tcomponent.path, component.properties.logic","\t\t\t\t\t\t);","\t\t\t\t\t\tif (filename === relativeLogic) {","\t\t\t\t\t\t\tthis.emit('changeLogic', component);","\t\t\t\t\t\t\tthis.emit('change', changeArgs);","\t\t\t\t\t\t\treturn;","\t\t\t\t\t\t}","","\t\t\t\t\t\t// template files are changed","\t\t\t\t\t\tconst relativeTemplate = this._getRelativeForComponent(","\t\t\t\t\t\t\tcomponent.path, component.properties.template","\t\t\t\t\t\t);","\t\t\t\t\t\tconst relativeErrorTemplate =","\t\t\t\t\t\t\t\t\t\ttypeof (component.properties.errorTemplate) === 'string' ?","\t\t\t\t\t\t\t\t\t\tthis._getRelativeForComponent(","\t\t\t\t\t\t\t\t\t\t\tcomponent.path, component.properties.errorTemplate","\t\t\t\t\t\t\t\t\t\t) : null;","","\t\t\t\t\t\tif (filename === relativeTemplate ||","\t\t\t\t\t\t\t\tfilename === relativeErrorTemplate) {","\t\t\t\t\t\t\tthis.emit('changeTemplates', component);","\t\t\t\t\t\t\tthis.emit('change', changeArgs);","\t\t\t\t\t\t\treturn;","\t\t\t\t\t\t}","","\t\t\t\t\t\tthis.emit('change', changeArgs);","\t\t\t\t\t})","\t\t\t\t\t.on('unlink', filename => {","\t\t\t\t\t\tconst component = this._recognizeComponent(filename);","","\t\t\t\t\t\tif (!component || component.path === filename) {","\t\t\t\t\t\t\treturn;","\t\t\t\t\t\t}","\t\t\t\t\t\tthis.emit('change', {filename, component});","\t\t\t\t\t})","\t\t\t\t\t.on('add', filename => {","\t\t\t\t\t\tconst component = this._recognizeComponent(filename);","\t\t\t\t\t\tif (!component || component.path === filename) {","\t\t\t\t\t\t\treturn;","\t\t\t\t\t\t}","\t\t\t\t\t\tthis.emit('change', {filename, component});","\t\t\t\t\t});","","\t\t\t\tcomponentJsonWatcher","\t\t\t\t\t.on('error', error => this._eventBus.emit('error', error))","\t\t\t\t// add new component","\t\t\t\t\t.on('add', filename => {","\t\t\t\t\t\tconst newComponent = this._createComponentDescriptor(filename);","\t\t\t\t\t\tthis._addComponent(newComponent);","\t\t\t\t\t\tthis.emit('add', newComponent);","\t\t\t\t\t})","\t\t\t\t// change cat-component.json of the found component","\t\t\t\t\t.on('change', filename => {","\t\t\t\t\t\tconst component = this._recognizeComponent(filename);","\t\t\t\t\t\tif (!component) {","\t\t\t\t\t\t\treturn;","\t\t\t\t\t\t}","\t\t\t\t\t\tconst newComponent = this._createComponentDescriptor(component.path);","","\t\t\t\t\t\t// because component name could be changed","\t\t\t\t\t\tthis._removeComponent(component);","\t\t\t\t\t\tthis.emit('unlink', component);","","\t\t\t\t\t\tthis._addComponent(newComponent);","\t\t\t\t\t\tthis.emit('add', newComponent);","\t\t\t\t\t})","\t\t\t\t// unlink found component","\t\t\t\t\t.on('unlink', filename => {","\t\t\t\t\t\tconst component = this._recognizeComponent(filename);","\t\t\t\t\t\tif (!component) {","\t\t\t\t\t\t\treturn;","\t\t\t\t\t\t}","\t\t\t\t\t\tthis._removeComponent(component);","\t\t\t\t\t\tthis.emit('unlink', component);","\t\t\t\t\t});","","\t\t\t\tthis.emit('watchReady');","\t\t\t\treturn [fileWatcher, componentJsonWatcher];","\t\t\t});","","\t\treturn this._readyPromise;","\t}","","\t/**","\t * Close watchers","\t *","\t * @return {Promise} Promise of closed watchers.","\t */","\tcloseWatch() {","\t\tthis._fileWatcher = null;","\t\tif (this._readyPromise) {","\t\t\tconst promise = this._readyPromise;","","\t\t\tthis._readyPromise = null;","","\t\t\treturn promise.then(watchers => watchers.forEach(watcher => watcher.close()));","\t\t}","","\t\treturn Promise.resolve();","\t}","","\t/**","\t * Creates a descriptor for a found component.","\t * @param {string} filename The component's filename.","\t * @returns {{name: string, path: string, properties: Object}|null} The found","\t * component's descriptor.","\t * @private","\t */","\t_createComponentDescriptor(filename) {","\t\tif (!filename) {","\t\t\treturn null;","\t\t}","","\t\tconst absolutePath = requireHelper.getAbsoluteRequirePath(filename);","\t\trequireHelper.clearCacheKey(absolutePath);","","\t\tvar properties;","\t\ttry {","\t\t\tproperties = require(absolutePath);","\t\t} catch (e) {","\t\t\tthis._eventBus.emit('error', e);","\t\t}","","\t\tif (!properties) {","\t\t\treturn null;","\t\t}","","\t\tconst componentName = (properties.name ||","\t\t\tpath.basename(path.dirname(filename))).toLowerCase();","","\t\tif (!COMPONENT_NAME_REGEXP.test(componentName)) {","\t\t\tthis._eventBus.emit('warn',","\t\t\t\t`Component name \"${componentName}\" is incorrect (${COMPONENT_NAME_REGEXP.toString()}), skipping...`","\t\t\t);","\t\t\treturn null;","\t\t}","","\t\tif (typeof (properties.logic) !== 'string') {","\t\t\tproperties.logic = moduleHelper.DEFAULT_LOGIC_FILENAME;","\t\t}","","\t\tif (typeof (properties.template) !== 'string') {","\t\t\tthis._eventBus.emit('warn',","\t\t\t\t`\"template\" is a required field for component \"${properties.name}\" at ${properties.path}, skipping...`","\t\t\t);","\t\t\treturn null;","\t\t}","","\t\treturn {","\t\t\tname: componentName,","\t\t\tproperties,","\t\t\tpath: path.relative(process.cwd(), filename)","\t\t};","\t}","","\t/**","\t * Recognizes a component by a path to its internal file.","\t * @param {string} filename The filename of the internal file of the component.","\t * @returns {{name: string, path: string, properties: Object}|null} The found","\t * component's descriptor.","\t * @private","\t */","\t_recognizeComponent(filename) {","\t\tvar current = filename;","\t\tvar component = null;","","\t\twhile (current !== '.') {","\t\t\tif (current in this._foundComponentsByDirs) {","\t\t\t\tcomponent = this._foundComponentsByDirs[current];","\t\t\t\tbreak;","\t\t\t}","\t\t\tcurrent = path.dirname(current);","\t\t}","\t\treturn component;","\t}","","\t/**","\t * Removes a found component.","\t * @param {{name: string, path: string, properties: Object}?} component The found","\t * component's descriptor to remove.","\t * @private","\t */","\t_removeComponent(component) {","\t\tconst dirName = path.dirname(component.path);","\t\tconst absolutePath = requireHelper.getAbsoluteRequirePath(component.path);","","\t\trequireHelper.clearCacheKey(absolutePath);","","\t\tdelete this._foundComponentsByNames[component.name];","\t\tdelete this._foundComponentsByDirs[dirName];","","\t\tif (this._fileWatcher) {","\t\t\tthis._fileWatcher.unwatch(dirName);","\t\t}","\t}","","\t/**","\t * Adds a found component.","\t * @param {{name: string, path: string, properties: Object}?} component The found","\t * component's descriptor to add.","\t * @private","\t */","\t_addComponent(component) {","\t\tif (!component) {","\t\t\treturn;","\t\t}","","\t\tif (component.name in this._foundComponentsByNames) {","\t\t\tconst existedComponent = this._foundComponentsByNames[component.name];","\t\t\tthis._eventBus.emit('warn',","\t\t\t\t`Component ${component.path} has the same name as ${existedComponent.path} (${component.name}), skipping...`","\t\t\t);","\t\t\treturn;","\t\t}","\t\tconst dirName = path.dirname(component.path);","\t\tthis._foundComponentsByNames[component.name] = component;","\t\tthis._foundComponentsByDirs[dirName] = component;","","\t\tif (this._fileWatcher) {","\t\t\tthis._fileWatcher.add(dirName);","\t\t}","\t}","","\t/**","\t * Gets a component's inner path which is relative to CWD.","\t * @param {string} componentPath The path to the component.","\t * @param {string} innerPath The path inside the component.","\t * @returns {string} The path which is relative to CWD.","\t */","\t_getRelativeForComponent(componentPath, innerPath) {","\t\treturn path.relative(","\t\t\tprocess.cwd(), path.normalize(","\t\t\t\tpath.join(path.dirname(componentPath), innerPath)","\t\t\t)","\t\t);","\t}","}","","module.exports = ComponentFinder;",""],"l":{"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"10":1,"17":1,"21":1,"33":0,"40":0,"47":0,"54":0,"61":0,"68":0,"75":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"84":0,"85":0,"95":0,"96":0,"99":0,"100":0,"102":0,"103":0,"104":0,"106":0,"107":0,"108":0,"117":0,"119":0,"122":0,"123":0,"127":0,"131":0,"133":0,"142":0,"143":0,"146":0,"147":0,"148":0,"149":0,"150":0,"153":0,"154":0,"155":0,"156":0,"157":0,"160":0,"163":0,"164":0,"165":0,"168":0,"169":0,"170":0,"173":0,"179":0,"182":0,"183":0,"184":0,"185":0,"189":0,"192":0,"198":0,"200":0,"201":0,"202":0,"205":0,"208":0,"210":0,"211":0,"213":0,"216":0,"217":0,"218":0,"220":0,"223":0,"224":0,"227":0,"228":0,"229":0,"233":0,"234":0,"235":0,"237":0,"240":0,"241":0,"243":0,"244":0,"248":0,"249":0,"250":0,"252":0,"253":0,"256":0,"257":0,"260":0,"269":0,"270":0,"271":0,"273":0,"275":0,"278":0,"289":0,"290":0,"293":0,"294":0,"296":0,"297":0,"298":0,"300":0,"303":0,"304":0,"307":0,"310":0,"311":0,"314":0,"317":0,"318":0,"321":0,"322":0,"325":0,"328":0,"343":0,"344":0,"346":0,"347":0,"348":0,"349":0,"351":0,"353":0,"363":0,"364":0,"366":0,"368":0,"369":0,"371":0,"372":0,"383":0,"384":0,"387":0,"388":0,"389":0,"392":0,"394":0,"395":0,"396":0,"398":0,"399":0,"410":0,"418":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/base/BootstrapperBase.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/base/BootstrapperBase.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":1},"b":{"1":[0,0]},"f":{"1":1,"2":0,"3":0},"fnMap":{"1":{"name":"(anonymous_1)","line":24,"loc":{"start":{"line":24,"column":12},"end":{"line":24,"column":34}}},"2":{"name":"(anonymous_2)","line":39,"loc":{"start":{"line":39,"column":7},"end":{"line":39,"column":22}}},"3":{"name":"(anonymous_3)","line":53,"loc":{"start":{"line":53,"column":10},"end":{"line":53,"column":34}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":56}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":60}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":54}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":62}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":56}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":50}},"7":{"start":{"line":9,"column":0},"end":{"line":9,"column":71}},"8":{"start":{"line":10,"column":0},"end":{"line":10,"column":52}},"9":{"start":{"line":11,"column":0},"end":{"line":11,"column":52}},"10":{"start":{"line":31,"column":2},"end":{"line":31,"column":50}},"11":{"start":{"line":40,"column":2},"end":{"line":40,"column":43}},"12":{"start":{"line":41,"column":2},"end":{"line":41,"column":51}},"13":{"start":{"line":43,"column":2},"end":{"line":43,"column":50}},"14":{"start":{"line":44,"column":2},"end":{"line":44,"column":64}},"15":{"start":{"line":45,"column":2},"end":{"line":45,"column":18}},"16":{"start":{"line":54,"column":2},"end":{"line":54,"column":38}},"17":{"start":{"line":55,"column":2},"end":{"line":55,"column":30}},"18":{"start":{"line":56,"column":2},"end":{"line":56,"column":49}},"19":{"start":{"line":57,"column":2},"end":{"line":57,"column":51}},"20":{"start":{"line":58,"column":2},"end":{"line":58,"column":57}},"21":{"start":{"line":59,"column":2},"end":{"line":59,"column":59}},"22":{"start":{"line":60,"column":2},"end":{"line":60,"column":53}},"23":{"start":{"line":61,"column":2},"end":{"line":61,"column":61}},"24":{"start":{"line":62,"column":2},"end":{"line":62,"column":63}},"25":{"start":{"line":63,"column":2},"end":{"line":63,"column":57}},"26":{"start":{"line":67,"column":0},"end":{"line":67,"column":34}}},"branchMap":{"1":{"line":40,"type":"binary-expr","locations":[{"start":{"line":40,"column":24},"end":{"line":40,"column":36}},{"start":{"line":40,"column":40},"end":{"line":40,"column":42}}]}},"code":["'use strict';","","const moduleHelper = require('../helpers/moduleHelper');","const StateProvider = require('../providers/StateProvider');","const StoreLoader = require('../loaders/StoreLoader');","const ComponentLoader = require('../loaders/ComponentLoader');","const DocumentRenderer = require('../DocumentRenderer');","const RequestRouter = require('../RequestRouter');","const ModuleApiProviderBase = require('../base/ModuleApiProviderBase');","const ContextFactory = require('../ContextFactory');","const EventEmitter = require('events').EventEmitter;","","/**"," * Implements the basic bootstrapper class"," * for both server and browser environments."," */","class BootstrapperBase {","","\t/**","\t * Creates a new instance of the basic Catberry bootstrapper.","\t * @param {Function} catberryConstructor Constructor","\t * of the Catberry's main module.","\t */","\tconstructor(catberryConstructor) {","","\t\t/**","\t\t * Current constructor of the Catberry's main module.","\t\t * @type {Function}","\t\t * @private","\t\t */","\t\tthis._catberryConstructor = catberryConstructor;","\t}","","\t/**","\t * Creates a new full-configured instance of the Catberry application.","\t * @param {Object?} configObject The configuration object.","\t * @returns {Catberry} The Catberry application instance.","\t */","\tcreate(configObject) {","\t\tconst currentConfig = configObject || {};","\t\tconst catberry = new this._catberryConstructor();","","\t\tthis.configure(currentConfig, catberry.locator);","\t\tcatberry.events = new ModuleApiProviderBase(catberry.locator);","\t\treturn catberry;","\t}","","\t/**","\t * Configures a locator with all required type registrations.","\t * @param {Object} configObject The configuration object.","\t * @param {ServiceLocator} locator The Service locator to configure.","\t */","\tconfigure(configObject, locator) {","\t\tconst eventBus = new EventEmitter();","\t\teventBus.setMaxListeners(0);","\t\tlocator.registerInstance('eventBus', eventBus);","\t\tlocator.registerInstance('config', configObject);","\t\tlocator.register('stateProvider', StateProvider, true);","\t\tlocator.register('contextFactory', ContextFactory, true);","\t\tlocator.register('storeLoader', StoreLoader, true);","\t\tlocator.register('componentLoader', ComponentLoader, true);","\t\tlocator.register('documentRenderer', DocumentRenderer, true);","\t\tlocator.register('requestRouter', RequestRouter, true);","\t}","}","","module.exports = BootstrapperBase;",""],"l":{"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"31":1,"40":0,"41":0,"43":0,"44":0,"45":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"67":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/providers/StateProvider.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/providers/StateProvider.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0,0]},"f":{"1":0},"fnMap":{"1":{"name":"(anonymous_1)","line":18,"loc":{"start":{"line":18,"column":21},"end":{"line":18,"column":38}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":63}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":57}},"3":{"start":{"line":19,"column":2},"end":{"line":19,"column":25}},"4":{"start":{"line":20,"column":2},"end":{"line":20,"column":35}},"5":{"start":{"line":22,"column":2},"end":{"line":22,"column":23}},"6":{"start":{"line":24,"column":2},"end":{"line":28,"column":3}},"7":{"start":{"line":25,"column":3},"end":{"line":25,"column":67}},"8":{"start":{"line":27,"column":3},"end":{"line":27,"column":25}},"9":{"start":{"line":30,"column":2},"end":{"line":62,"column":6}},"10":{"start":{"line":33,"column":4},"end":{"line":36,"column":5}},"11":{"start":{"line":34,"column":5},"end":{"line":34,"column":58}},"12":{"start":{"line":35,"column":5},"end":{"line":35,"column":12}},"13":{"start":{"line":39,"column":4},"end":{"line":54,"column":5}},"14":{"start":{"line":42,"column":5},"end":{"line":42,"column":70}},"15":{"start":{"line":44,"column":5},"end":{"line":46,"column":6}},"16":{"start":{"line":45,"column":6},"end":{"line":45,"column":35}},"17":{"start":{"line":48,"column":5},"end":{"line":50,"column":6}},"18":{"start":{"line":49,"column":6},"end":{"line":49,"column":33}},"19":{"start":{"line":52,"column":5},"end":{"line":52,"column":34}},"20":{"start":{"line":53,"column":5},"end":{"line":53,"column":12}},"21":{"start":{"line":57,"column":4},"end":{"line":61,"column":5}},"22":{"start":{"line":60,"column":5},"end":{"line":60,"column":29}},"23":{"start":{"line":63,"column":2},"end":{"line":63,"column":21}},"24":{"start":{"line":67,"column":0},"end":{"line":67,"column":31}}},"branchMap":{"1":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":4},"end":{"line":33,"column":4}},{"start":{"line":33,"column":4},"end":{"line":33,"column":4}}]},"2":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":4},"end":{"line":39,"column":4}},{"start":{"line":39,"column":4},"end":{"line":39,"column":4}}]},"3":{"line":39,"type":"binary-expr","locations":[{"start":{"line":39,"column":8},"end":{"line":39,"column":35}},{"start":{"line":40,"column":6},"end":{"line":40,"column":44}}]},"4":{"line":44,"type":"if","locations":[{"start":{"line":44,"column":5},"end":{"line":44,"column":5}},{"start":{"line":44,"column":5},"end":{"line":44,"column":5}}]},"5":{"line":48,"type":"if","locations":[{"start":{"line":48,"column":5},"end":{"line":48,"column":5}},{"start":{"line":48,"column":5},"end":{"line":48,"column":5}}]},"6":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":4},"end":{"line":57,"column":4}},{"start":{"line":57,"column":4},"end":{"line":57,"column":4}}]},"7":{"line":57,"type":"binary-expr","locations":[{"start":{"line":57,"column":8},"end":{"line":57,"column":35}},{"start":{"line":58,"column":6},"end":{"line":58,"column":40}},{"start":{"line":59,"column":6},"end":{"line":59,"column":35}}]}},"code":["'use strict';","","const StateProviderBase = require('../base/StateProviderBase');","const RouteParser = require('../tokenizers/RouteParser');","","/**"," * Implements the state provider for the server environment."," */","class StateProvider extends StateProviderBase {","","\t/**","\t * Gets a list of route descriptors.","\t * @param {ServiceLocator} serviceLocator The Service locator","\t * for getting route definitions.","\t * @returns {Array} The list of URI mappers.","\t * @private","\t */","\t_getRouteDescriptors(serviceLocator) {","\t\tconst descriptors = [];","\t\tconst parser = new RouteParser();","","\t\tvar routeDefinitions;","","\t\ttry {","\t\t\trouteDefinitions = serviceLocator.resolveAll('routeDefinition');","\t\t} catch (e) {","\t\t\trouteDefinitions = [];","\t\t}","","\t\trouteDefinitions","\t\t\t.forEach(route => {","\t\t\t\t// just colon-parametrized string","\t\t\t\tif (typeof (route) === 'string') {","\t\t\t\t\tdescriptors.push(parser.parseRouteExpression(route));","\t\t\t\t\treturn;","\t\t\t\t}","","\t\t\t\t// extended colon-parametrized mapper","\t\t\t\tif (typeof (route) === 'object' &&","\t\t\t\t\t\ttypeof (route.expression) === 'string') {","","\t\t\t\t\tconst descriptor = parser.parseRouteExpression(route.expression);","","\t\t\t\t\tif (typeof (route.name) === 'string') {","\t\t\t\t\t\tdescriptor.name = route.name;","\t\t\t\t\t}","","\t\t\t\t\tif (route.map instanceof Function) {","\t\t\t\t\t\tdescriptor.map = route.map;","\t\t\t\t\t}","","\t\t\t\t\tdescriptors.push(descriptor);","\t\t\t\t\treturn;","\t\t\t\t}","","\t\t\t\t// regular expression mapper","\t\t\t\tif (typeof (route) === 'object' &&","\t\t\t\t\t(route.expression instanceof RegExp) &&","\t\t\t\t\t(route.map instanceof Function)) {","\t\t\t\t\tdescriptors.push(route);","\t\t\t\t}","\t\t\t});","\t\treturn descriptors;","\t}","}","","module.exports = StateProvider;",""],"l":{"3":1,"4":1,"19":0,"20":0,"22":0,"24":0,"25":0,"27":0,"30":0,"33":0,"34":0,"35":0,"39":0,"42":0,"44":0,"45":0,"48":0,"49":0,"52":0,"53":0,"57":0,"60":0,"63":0,"67":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/base/StateProviderBase.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/base/StateProviderBase.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":1,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":1,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":1,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":1,"152":0,"153":0,"154":0,"155":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"fnMap":{"1":{"name":"(anonymous_1)","line":16,"loc":{"start":{"line":16,"column":12},"end":{"line":16,"column":22}}},"2":{"name":"(anonymous_2)","line":49,"loc":{"start":{"line":49,"column":14},"end":{"line":49,"column":20}}},"3":{"name":"(anonymous_3)","line":78,"loc":{"start":{"line":78,"column":12},"end":{"line":78,"column":27}}},"4":{"name":"(anonymous_4)","line":166,"loc":{"start":{"line":166,"column":10},"end":{"line":166,"column":16}}},"5":{"name":"(anonymous_5)","line":181,"loc":{"start":{"line":181,"column":15},"end":{"line":181,"column":18}}},"6":{"name":"(anonymous_6)","line":206,"loc":{"start":{"line":206,"column":21},"end":{"line":206,"column":38}}},"7":{"name":"(anonymous_7)","line":215,"loc":{"start":{"line":215,"column":27},"end":{"line":215,"column":40}}},"8":{"name":"(anonymous_8)","line":239,"loc":{"start":{"line":239,"column":26},"end":{"line":239,"column":44}}},"9":{"name":"setStateValues","line":267,"loc":{"start":{"line":267,"column":0},"end":{"line":267,"column":51}}},"10":{"name":"setQueryParameters","line":295,"loc":{"start":{"line":295,"column":0},"end":{"line":295,"column":65}}},"11":{"name":"setParameterValues","line":350,"loc":{"start":{"line":350,"column":0},"end":{"line":350,"column":74}}},"12":{"name":"defaultParameterValueProcessor","line":383,"loc":{"start":{"line":383,"column":0},"end":{"line":383,"column":58}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":50}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":44}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":28}},"4":{"start":{"line":23,"column":2},"end":{"line":23,"column":42}},"5":{"start":{"line":28,"column":2},"end":{"line":28,"column":62}},"6":{"start":{"line":29,"column":2},"end":{"line":34,"column":5}},"7":{"start":{"line":30,"column":3},"end":{"line":30,"column":47}},"8":{"start":{"line":31,"column":3},"end":{"line":33,"column":4}},"9":{"start":{"line":32,"column":4},"end":{"line":32,"column":52}},"10":{"start":{"line":41,"column":2},"end":{"line":41,"column":43}},"11":{"start":{"line":50,"column":2},"end":{"line":52,"column":3}},"12":{"start":{"line":51,"column":3},"end":{"line":51,"column":15}},"13":{"start":{"line":54,"column":2},"end":{"line":54,"column":20}},"14":{"start":{"line":55,"column":2},"end":{"line":55,"column":20}},"15":{"start":{"line":56,"column":2},"end":{"line":56,"column":23}},"16":{"start":{"line":57,"column":2},"end":{"line":57,"column":22}},"17":{"start":{"line":58,"column":2},"end":{"line":58,"column":48}},"18":{"start":{"line":60,"column":2},"end":{"line":60,"column":36}},"19":{"start":{"line":61,"column":2},"end":{"line":63,"column":3}},"20":{"start":{"line":62,"column":3},"end":{"line":62,"column":15}},"21":{"start":{"line":66,"column":2},"end":{"line":66,"column":75}},"22":{"start":{"line":66,"column":42},"end":{"line":66,"column":73}},"23":{"start":{"line":67,"column":2},"end":{"line":67,"column":23}},"24":{"start":{"line":69,"column":2},"end":{"line":69,"column":15}},"25":{"start":{"line":79,"column":2},"end":{"line":79,"column":41}},"26":{"start":{"line":80,"column":2},"end":{"line":80,"column":45}},"27":{"start":{"line":81,"column":2},"end":{"line":83,"column":3}},"28":{"start":{"line":82,"column":3},"end":{"line":82,"column":62}},"29":{"start":{"line":85,"column":2},"end":{"line":85,"column":45}},"30":{"start":{"line":88,"column":2},"end":{"line":93,"column":3}},"31":{"start":{"line":89,"column":3},"end":{"line":92,"column":5}},"32":{"start":{"line":91,"column":26},"end":{"line":91,"column":94}},"33":{"start":{"line":96,"column":2},"end":{"line":155,"column":3}},"34":{"start":{"line":97,"column":3},"end":{"line":97,"column":43}},"35":{"start":{"line":99,"column":3},"end":{"line":148,"column":6}},"36":{"start":{"line":100,"column":4},"end":{"line":102,"column":6}},"37":{"start":{"line":105,"column":4},"end":{"line":107,"column":5}},"38":{"start":{"line":106,"column":5},"end":{"line":106,"column":12}},"39":{"start":{"line":111,"column":4},"end":{"line":114,"column":5}},"40":{"start":{"line":112,"column":5},"end":{"line":112,"column":30}},"41":{"start":{"line":113,"column":5},"end":{"line":113,"column":12}},"42":{"start":{"line":118,"column":4},"end":{"line":121,"column":5}},"43":{"start":{"line":119,"column":5},"end":{"line":119,"column":56}},"44":{"start":{"line":120,"column":5},"end":{"line":120,"column":12}},"45":{"start":{"line":123,"column":4},"end":{"line":123,"column":70}},"46":{"start":{"line":124,"column":4},"end":{"line":124,"column":59}},"47":{"start":{"line":127,"column":4},"end":{"line":140,"column":5}},"48":{"start":{"line":128,"column":5},"end":{"line":128,"column":28}},"49":{"start":{"line":129,"column":5},"end":{"line":138,"column":8}},"50":{"start":{"line":130,"column":6},"end":{"line":130,"column":47}},"51":{"start":{"line":131,"column":6},"end":{"line":131,"column":47}},"52":{"start":{"line":132,"column":6},"end":{"line":134,"column":8}},"53":{"start":{"line":135,"column":6},"end":{"line":137,"column":7}},"54":{"start":{"line":136,"column":7},"end":{"line":136,"column":48}},"55":{"start":{"line":139,"column":5},"end":{"line":139,"column":12}},"56":{"start":{"line":142,"column":4},"end":{"line":144,"column":6}},"57":{"start":{"line":145,"column":4},"end":{"line":147,"column":5}},"58":{"start":{"line":146,"column":5},"end":{"line":146,"column":42}},"59":{"start":{"line":150,"column":3},"end":{"line":154,"column":4}},"60":{"start":{"line":151,"column":4},"end":{"line":151,"column":21}},"61":{"start":{"line":153,"column":4},"end":{"line":153,"column":35}},"62":{"start":{"line":157,"column":2},"end":{"line":157,"column":24}},"63":{"start":{"line":167,"column":2},"end":{"line":167,"column":19}},"64":{"start":{"line":168,"column":2},"end":{"line":171,"column":5}},"65":{"start":{"line":169,"column":3},"end":{"line":169,"column":23}},"66":{"start":{"line":170,"column":3},"end":{"line":170,"column":25}},"67":{"start":{"line":173,"column":2},"end":{"line":173,"column":15}},"68":{"start":{"line":182,"column":2},"end":{"line":195,"column":5}},"69":{"start":{"line":183,"column":3},"end":{"line":185,"column":4}},"70":{"start":{"line":184,"column":4},"end":{"line":184,"column":90}},"71":{"start":{"line":184,"column":18},"end":{"line":184,"column":89}},"72":{"start":{"line":187,"column":3},"end":{"line":187,"column":64}},"73":{"start":{"line":188,"column":3},"end":{"line":193,"column":4}},"74":{"start":{"line":189,"column":4},"end":{"line":192,"column":6}},"75":{"start":{"line":190,"column":5},"end":{"line":190,"column":34}},"76":{"start":{"line":191,"column":5},"end":{"line":191,"column":50}},"77":{"start":{"line":194,"column":3},"end":{"line":194,"column":20}},"78":{"start":{"line":219,"column":2},"end":{"line":221,"column":3}},"79":{"start":{"line":220,"column":3},"end":{"line":220,"column":72}},"80":{"start":{"line":222,"column":2},"end":{"line":224,"column":3}},"81":{"start":{"line":223,"column":3},"end":{"line":223,"column":10}},"82":{"start":{"line":225,"column":2},"end":{"line":230,"column":5}},"83":{"start":{"line":226,"column":3},"end":{"line":226,"column":70}},"84":{"start":{"line":227,"column":3},"end":{"line":229,"column":4}},"85":{"start":{"line":228,"column":4},"end":{"line":228,"column":73}},"86":{"start":{"line":240,"column":2},"end":{"line":240,"column":66}},"87":{"start":{"line":241,"column":2},"end":{"line":257,"column":4}},"88":{"start":{"line":242,"column":3},"end":{"line":242,"column":50}},"89":{"start":{"line":243,"column":3},"end":{"line":245,"column":4}},"90":{"start":{"line":244,"column":4},"end":{"line":244,"column":16}},"91":{"start":{"line":247,"column":3},"end":{"line":247,"column":37}},"92":{"start":{"line":248,"column":3},"end":{"line":248,"column":52}},"93":{"start":{"line":250,"column":3},"end":{"line":250,"column":78}},"94":{"start":{"line":252,"column":3},"end":{"line":254,"column":4}},"95":{"start":{"line":253,"column":4},"end":{"line":253,"column":65}},"96":{"start":{"line":256,"column":3},"end":{"line":256,"column":16}},"97":{"start":{"line":267,"column":0},"end":{"line":287,"column":1}},"98":{"start":{"line":268,"column":1},"end":{"line":286,"column":4}},"99":{"start":{"line":269,"column":2},"end":{"line":269,"column":38}},"100":{"start":{"line":270,"column":2},"end":{"line":285,"column":5}},"101":{"start":{"line":271,"column":3},"end":{"line":273,"column":4}},"102":{"start":{"line":272,"column":4},"end":{"line":272,"column":43}},"103":{"start":{"line":276,"column":3},"end":{"line":284,"column":4}},"104":{"start":{"line":277,"column":4},"end":{"line":281,"column":5}},"105":{"start":{"line":278,"column":5},"end":{"line":278,"column":50}},"106":{"start":{"line":280,"column":5},"end":{"line":280,"column":82}},"107":{"start":{"line":283,"column":4},"end":{"line":283,"column":45}},"108":{"start":{"line":295,"column":0},"end":{"line":339,"column":1}},"109":{"start":{"line":296,"column":1},"end":{"line":338,"column":5}},"110":{"start":{"line":298,"column":3},"end":{"line":298,"column":35}},"111":{"start":{"line":300,"column":3},"end":{"line":307,"column":4}},"112":{"start":{"line":301,"column":4},"end":{"line":305,"column":7}},"113":{"start":{"line":302,"column":5},"end":{"line":302,"column":43}},"114":{"start":{"line":303,"column":5},"end":{"line":303,"column":28}},"115":{"start":{"line":304,"column":5},"end":{"line":304,"column":59}},"116":{"start":{"line":306,"column":4},"end":{"line":306,"column":11}},"117":{"start":{"line":308,"column":3},"end":{"line":308,"column":47}},"118":{"start":{"line":310,"column":3},"end":{"line":310,"column":31}},"119":{"start":{"line":311,"column":3},"end":{"line":311,"column":32}},"120":{"start":{"line":312,"column":3},"end":{"line":312,"column":29}},"121":{"start":{"line":314,"column":3},"end":{"line":326,"column":6}},"122":{"start":{"line":315,"column":4},"end":{"line":315,"column":56}},"123":{"start":{"line":317,"column":4},"end":{"line":319,"column":5}},"124":{"start":{"line":318,"column":5},"end":{"line":318,"column":60}},"125":{"start":{"line":321,"column":4},"end":{"line":324,"column":5}},"126":{"start":{"line":322,"column":5},"end":{"line":322,"column":32}},"127":{"start":{"line":323,"column":5},"end":{"line":323,"column":17}},"128":{"start":{"line":325,"column":4},"end":{"line":325,"column":17}},"129":{"start":{"line":328,"column":3},"end":{"line":330,"column":4}},"130":{"start":{"line":329,"column":4},"end":{"line":329,"column":11}},"131":{"start":{"line":332,"column":3},"end":{"line":332,"column":83}},"132":{"start":{"line":334,"column":3},"end":{"line":336,"column":4}},"133":{"start":{"line":335,"column":4},"end":{"line":335,"column":11}},"134":{"start":{"line":337,"column":3},"end":{"line":337,"column":85}},"135":{"start":{"line":350,"column":0},"end":{"line":375,"column":1}},"136":{"start":{"line":351,"column":1},"end":{"line":353,"column":2}},"137":{"start":{"line":352,"column":2},"end":{"line":352,"column":20}},"138":{"start":{"line":355,"column":1},"end":{"line":355,"column":63}},"139":{"start":{"line":358,"column":1},"end":{"line":358,"column":28}},"140":{"start":{"line":359,"column":1},"end":{"line":359,"column":52}},"141":{"start":{"line":360,"column":1},"end":{"line":360,"column":17}},"142":{"start":{"line":362,"column":1},"end":{"line":373,"column":2}},"143":{"start":{"line":363,"column":2},"end":{"line":371,"column":3}},"144":{"start":{"line":364,"column":3},"end":{"line":364,"column":69}},"145":{"start":{"line":365,"column":3},"end":{"line":367,"column":4}},"146":{"start":{"line":368,"column":3},"end":{"line":368,"column":24}},"147":{"start":{"line":369,"column":3},"end":{"line":369,"column":50}},"148":{"start":{"line":370,"column":3},"end":{"line":370,"column":12}},"149":{"start":{"line":372,"column":2},"end":{"line":372,"column":26}},"150":{"start":{"line":374,"column":1},"end":{"line":374,"column":15}},"151":{"start":{"line":383,"column":0},"end":{"line":388,"column":1}},"152":{"start":{"line":384,"column":1},"end":{"line":386,"column":2}},"153":{"start":{"line":385,"column":2},"end":{"line":385,"column":88}},"154":{"start":{"line":387,"column":1},"end":{"line":387,"column":49}},"155":{"start":{"line":390,"column":0},"end":{"line":390,"column":35}}},"branchMap":{"1":{"line":31,"type":"if","locations":[{"start":{"line":31,"column":3},"end":{"line":31,"column":3}},{"start":{"line":31,"column":3},"end":{"line":31,"column":3}}]},"2":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":2},"end":{"line":50,"column":2}},{"start":{"line":50,"column":2},"end":{"line":50,"column":2}}]},"3":{"line":61,"type":"if","locations":[{"start":{"line":61,"column":2},"end":{"line":61,"column":2}},{"start":{"line":61,"column":2},"end":{"line":61,"column":2}}]},"4":{"line":79,"type":"binary-expr","locations":[{"start":{"line":79,"column":11},"end":{"line":79,"column":17}},{"start":{"line":79,"column":21},"end":{"line":79,"column":40}}]},"5":{"line":81,"type":"if","locations":[{"start":{"line":81,"column":2},"end":{"line":81,"column":2}},{"start":{"line":81,"column":2},"end":{"line":81,"column":2}}]},"6":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":2},"end":{"line":88,"column":2}},{"start":{"line":88,"column":2},"end":{"line":88,"column":2}}]},"7":{"line":96,"type":"if","locations":[{"start":{"line":96,"column":2},"end":{"line":96,"column":2}},{"start":{"line":96,"column":2},"end":{"line":96,"column":2}}]},"8":{"line":105,"type":"if","locations":[{"start":{"line":105,"column":4},"end":{"line":105,"column":4}},{"start":{"line":105,"column":4},"end":{"line":105,"column":4}}]},"9":{"line":111,"type":"if","locations":[{"start":{"line":111,"column":4},"end":{"line":111,"column":4}},{"start":{"line":111,"column":4},"end":{"line":111,"column":4}}]},"10":{"line":118,"type":"if","locations":[{"start":{"line":118,"column":4},"end":{"line":118,"column":4}},{"start":{"line":118,"column":4},"end":{"line":118,"column":4}}]},"11":{"line":127,"type":"if","locations":[{"start":{"line":127,"column":4},"end":{"line":127,"column":4}},{"start":{"line":127,"column":4},"end":{"line":127,"column":4}}]},"12":{"line":127,"type":"binary-expr","locations":[{"start":{"line":127,"column":8},"end":{"line":127,"column":51}},{"start":{"line":127,"column":55},"end":{"line":127,"column":89}}]},"13":{"line":135,"type":"if","locations":[{"start":{"line":135,"column":6},"end":{"line":135,"column":6}},{"start":{"line":135,"column":6},"end":{"line":135,"column":6}}]},"14":{"line":145,"type":"if","locations":[{"start":{"line":145,"column":4},"end":{"line":145,"column":4}},{"start":{"line":145,"column":4},"end":{"line":145,"column":4}}]},"15":{"line":150,"type":"if","locations":[{"start":{"line":150,"column":3},"end":{"line":150,"column":3}},{"start":{"line":150,"column":3},"end":{"line":150,"column":3}}]},"16":{"line":183,"type":"if","locations":[{"start":{"line":183,"column":3},"end":{"line":183,"column":3}},{"start":{"line":183,"column":3},"end":{"line":183,"column":3}}]},"17":{"line":184,"type":"cond-expr","locations":[{"start":{"line":184,"column":63},"end":{"line":184,"column":82}},{"start":{"line":184,"column":85},"end":{"line":184,"column":89}}]},"18":{"line":188,"type":"if","locations":[{"start":{"line":188,"column":3},"end":{"line":188,"column":3}},{"start":{"line":188,"column":3},"end":{"line":188,"column":3}}]},"19":{"line":191,"type":"cond-expr","locations":[{"start":{"line":191,"column":20},"end":{"line":191,"column":41}},{"start":{"line":191,"column":44},"end":{"line":191,"column":49}}]},"20":{"line":219,"type":"if","locations":[{"start":{"line":219,"column":2},"end":{"line":219,"column":2}},{"start":{"line":219,"column":2},"end":{"line":219,"column":2}}]},"21":{"line":222,"type":"if","locations":[{"start":{"line":222,"column":2},"end":{"line":222,"column":2}},{"start":{"line":222,"column":2},"end":{"line":222,"column":2}}]},"22":{"line":227,"type":"if","locations":[{"start":{"line":227,"column":3},"end":{"line":227,"column":3}},{"start":{"line":227,"column":3},"end":{"line":227,"column":3}}]},"23":{"line":243,"type":"if","locations":[{"start":{"line":243,"column":3},"end":{"line":243,"column":3}},{"start":{"line":243,"column":3},"end":{"line":243,"column":3}}]},"24":{"line":252,"type":"if","locations":[{"start":{"line":252,"column":3},"end":{"line":252,"column":3}},{"start":{"line":252,"column":3},"end":{"line":252,"column":3}}]},"25":{"line":252,"type":"binary-expr","locations":[{"start":{"line":252,"column":7},"end":{"line":252,"column":16}},{"start":{"line":252,"column":20},"end":{"line":252,"column":36}}]},"26":{"line":271,"type":"if","locations":[{"start":{"line":271,"column":3},"end":{"line":271,"column":3}},{"start":{"line":271,"column":3},"end":{"line":271,"column":3}}]},"27":{"line":276,"type":"if","locations":[{"start":{"line":276,"column":3},"end":{"line":276,"column":3}},{"start":{"line":276,"column":3},"end":{"line":276,"column":3}}]},"28":{"line":277,"type":"if","locations":[{"start":{"line":277,"column":4},"end":{"line":277,"column":4}},{"start":{"line":277,"column":4},"end":{"line":277,"column":4}}]},"29":{"line":300,"type":"if","locations":[{"start":{"line":300,"column":3},"end":{"line":300,"column":3}},{"start":{"line":300,"column":3},"end":{"line":300,"column":3}}]},"30":{"line":317,"type":"if","locations":[{"start":{"line":317,"column":4},"end":{"line":317,"column":4}},{"start":{"line":317,"column":4},"end":{"line":317,"column":4}}]},"31":{"line":317,"type":"binary-expr","locations":[{"start":{"line":317,"column":8},"end":{"line":317,"column":15}},{"start":{"line":317,"column":19},"end":{"line":317,"column":40}}]},"32":{"line":321,"type":"if","locations":[{"start":{"line":321,"column":4},"end":{"line":321,"column":4}},{"start":{"line":321,"column":4},"end":{"line":321,"column":4}}]},"33":{"line":328,"type":"if","locations":[{"start":{"line":328,"column":3},"end":{"line":328,"column":3}},{"start":{"line":328,"column":3},"end":{"line":328,"column":3}}]},"34":{"line":334,"type":"if","locations":[{"start":{"line":334,"column":3},"end":{"line":334,"column":3}},{"start":{"line":334,"column":3},"end":{"line":334,"column":3}}]},"35":{"line":351,"type":"if","locations":[{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},{"start":{"line":351,"column":1},"end":{"line":351,"column":1}}]},"36":{"line":351,"type":"binary-expr","locations":[{"start":{"line":351,"column":5},"end":{"line":351,"column":16}},{"start":{"line":351,"column":20},"end":{"line":351,"column":43}}]},"37":{"line":355,"type":"binary-expr","locations":[{"start":{"line":355,"column":16},"end":{"line":355,"column":28}},{"start":{"line":355,"column":32},"end":{"line":355,"column":62}}]},"38":{"line":363,"type":"if","locations":[{"start":{"line":363,"column":2},"end":{"line":363,"column":2}},{"start":{"line":363,"column":2},"end":{"line":363,"column":2}}]},"39":{"line":363,"type":"binary-expr","locations":[{"start":{"line":363,"column":6},"end":{"line":363,"column":19}},{"start":{"line":363,"column":23},"end":{"line":363,"column":48}}]},"40":{"line":384,"type":"if","locations":[{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},{"start":{"line":384,"column":1},"end":{"line":384,"column":1}}]},"41":{"line":387,"type":"cond-expr","locations":[{"start":{"line":387,"column":30},"end":{"line":387,"column":32}},{"start":{"line":387,"column":35},"end":{"line":387,"column":48}}]}},"code":["'use strict';","","const uriHelper = require('../helpers/uriHelper');","const catberryUri = require('catberry-uri');","const URI = catberryUri.URI;","","/**"," * Implements the state provider for the server environment."," */","class StateProviderBase {","","\t/**","\t * Create a new instance of the state provider.","\t * @param {ServiceLocator} locator Service locator for resolving URI mappers.","\t */","\tconstructor(locator) {","","\t\t/**","\t\t * Current set of named routes.","\t\t * @type {Object}","\t\t * @private","\t\t */","\t\tthis._namedRoutes = Object.create(null);","","\t\t/**","\t\t * Current route descriptors.","\t\t */","\t\tthis._routeDescriptors = this._getRouteDescriptors(locator);","\t\tthis._routeDescriptors.forEach(descriptor => {","\t\t\tthis._restoreRegularExpressions(descriptor);","\t\t\tif (typeof (descriptor.name) === 'string') {","\t\t\t\tthis._namedRoutes[descriptor.name] = descriptor;","\t\t\t}","\t\t});","","\t\t/**","\t\t * Current list of URI mappers.","\t\t * @type {Array}","\t\t * @private","\t\t */","\t\tthis._uriMappers = this._getUriMappers();","\t}","","\t/**","\t * Gets a state by the specified location URI.","\t * @param {URI} uri The URI location.","\t * @returns {Object|null} The state object.","\t */","\tgetStateByUri(uri) {","\t\tif (this._uriMappers.length === 0) {","\t\t\treturn null;","\t\t}","","\t\turi = uri.clone();","\t\turi.scheme = null;","\t\turi.authority = null;","\t\turi.fragment = null;","\t\turi.path = uriHelper.removeEndSlash(uri.path);","","\t\tconst state = this._mapState(uri);","\t\tif (!state) {","\t\t\treturn null;","\t\t}","","\t\t// make state object immutable","\t\tObject.keys(state).forEach(storeName => Object.freeze(state[storeName]));","\t\tObject.freeze(state);","","\t\treturn state;","\t}","","\t/**","\t * Gets a URI path string for the named route using specified parameters.","\t * @param {string} name The name of the route.","\t * @param {Object} values The set of parameter values for the route.","\t * @returns {string} URI path string.","\t */","\tgetRouteURI(name, values) {","\t\tvalues = values || Object.create(null);","\t\tconst descriptor = this._namedRoutes[name];","\t\tif (!descriptor) {","\t\t\tthrow new Error(`There is no such route called \"${name}\"`);","\t\t}","","\t\tconst uri = new URI(descriptor.expression);","","\t\t// set value to URI path parameters first","\t\tif (descriptor.pathParameters.length > 0) {","\t\t\turi.path = setParameterValues(","\t\t\t\turi.path, descriptor.pathParameters, values,","\t\t\t\t(parameter, value) => encodeURIComponent(defaultParameterValueProcessor(parameter, value))","\t\t\t);","\t\t}","","\t\t// trying to set query string parameters if they exist","\t\tif (descriptor.queryParameters.length > 0) {","\t\t\tconst queryValues = Object.create(null);","","\t\t\tdescriptor.queryParameters.forEach(queryParameter => {","\t\t\t\tconst name = setParameterValues(","\t\t\t\t\tqueryParameter.nameExpression, queryParameter.nameParameters, values","\t\t\t\t);","","\t\t\t\t// if there is no name means there is no query parameter at all","\t\t\t\tif (!name) {","\t\t\t\t\treturn;","\t\t\t\t}","","\t\t\t\t// if there are no parameter values it means the query","\t\t\t\t// parameter does not have value","\t\t\t\tif (!queryParameter.valueParameters) {","\t\t\t\t\tqueryValues[name] = null;","\t\t\t\t\treturn;","\t\t\t\t}","","\t\t\t\t// if there are no route parameters in the query parameter's value","\t\t\t\t// that means it has a static value","\t\t\t\tif (queryParameter.valueParameters.length === 0) {","\t\t\t\t\tqueryValues[name] = queryParameter.valueExpression;","\t\t\t\t\treturn;","\t\t\t\t}","","\t\t\t\tconst firstParameterName = queryParameter.valueParameters[0].name;","\t\t\t\tconst firstParameterValue = values[firstParameterName];","\t\t\t\t// if there is only one parameter in query value and","\t\t\t\t// the specified parameter's value is an array","\t\t\t\tif (queryParameter.valueParameters.length === 1 && Array.isArray(firstParameterValue)) {","\t\t\t\t\tqueryValues[name] = [];","\t\t\t\t\tfirstParameterValue.forEach(value => {","\t\t\t\t\t\tconst valuesObject = Object.create(null);","\t\t\t\t\t\tvaluesObject[firstParameterName] = value;","\t\t\t\t\t\tconst queryValueString = setParameterValues(","\t\t\t\t\t\t\tqueryParameter.valueExpression, queryParameter.valueParameters, valuesObject","\t\t\t\t\t\t);","\t\t\t\t\t\tif (queryValueString.length > 0) {","\t\t\t\t\t\t\tqueryValues[name].push(queryValueString);","\t\t\t\t\t\t}","\t\t\t\t\t});","\t\t\t\t\treturn;","\t\t\t\t}","","\t\t\t\tconst queryValueString = setParameterValues(","\t\t\t\t\tqueryParameter.valueExpression, queryParameter.valueParameters, values","\t\t\t\t);","\t\t\t\tif (queryValueString.length > 0) {","\t\t\t\t\tqueryValues[name] = queryValueString;","\t\t\t\t}","\t\t\t});","","\t\t\tif (Object.keys(queryValues).length === 0) {","\t\t\t\turi.query = null;","\t\t\t} else {","\t\t\t\turi.query.values = queryValues;","\t\t\t}","\t\t}","","\t\treturn uri.toString();","\t}","","\t/**","\t * Maps the state.","\t * @param {URI} uri URI that describes the state.","\t * @returns {Object|null} The state from URI.","\t * @private","\t */","\t_mapState(uri) {","\t\tlet state = null;","\t\tthis._uriMappers.some(mapper => {","\t\t\tstate = mapper(uri);","\t\t\treturn Boolean(state);","\t\t});","","\t\treturn state;","\t}","","\t/**","\t * Gets a list of URI mappers.","\t * @returns {Array} The list of URI mappers.","\t * @private","\t */","\t_getUriMappers() {","\t\treturn this._routeDescriptors.map(descriptor => {","\t\t\tif (descriptor.expression instanceof RegExp) {","\t\t\t\treturn uri => descriptor.expression.test(uri.toString()) ? descriptor.map(uri) : null;","\t\t\t}","","\t\t\tconst extractor = this._createParameterExtractor(descriptor);","\t\t\tif (descriptor.map instanceof Function) {","\t\t\t\treturn uri => {","\t\t\t\t\tconst state = extractor(uri);","\t\t\t\t\treturn state ? descriptor.map(state) : state;","\t\t\t\t};","\t\t\t}","\t\t\treturn extractor;","\t\t});","\t}","","\t/**","\t * Gets a list of route descriptors.","\t * @param {ServiceLocator} serviceLocator The Service locator","\t * for getting route definitions.","\t * @returns {Array} The list of route descriptors.","\t * @protected","\t * @abstract","\t */","\t_getRouteDescriptors(serviceLocator) {","","\t}","","\t/**","\t * Restores all the regular expressions from their sources.","\t * @param {Object} descriptor The route descriptor.","\t * @private","\t */","\t_restoreRegularExpressions(descriptor) {","","\t\t// because the object is converted to JSON we have to store the","\t\t// regular expressions as their sources","\t\tif (descriptor.pathRegExpSource) {","\t\t\tdescriptor.pathRegExp = new RegExp(descriptor.pathRegExpSource, 'i');","\t\t}","\t\tif (!descriptor.queryParameters) {","\t\t\treturn;","\t\t}","\t\tdescriptor.queryParameters.forEach(parameter => {","\t\t\tparameter.nameRegExp = new RegExp(parameter.nameRegExpSource, 'i');","\t\t\tif (parameter.valueRegExpSource) {","\t\t\t\tparameter.valueRegExp = new RegExp(parameter.valueRegExpSource, 'i');","\t\t\t}","\t\t});","\t}","","\t/**","\t * Creates a function that extracts parameters from the URI.","\t * @param {Object} routeDescriptor Route descriptor.","\t * @returns {function} Function","\t * @private","\t */","\t_createParameterExtractor(routeDescriptor) {","\t\tconst pathRegExp = new RegExp(routeDescriptor.pathRegExpSource);","\t\treturn uri => {","\t\t\tconst pathMatches = uri.path.match(pathRegExp);","\t\t\tif (!pathMatches) {","\t\t\t\treturn null;","\t\t\t}","","\t\t\tconst state = Object.create(null);","\t\t\tconst pathParameterValues = pathMatches.slice(1);","","\t\t\tsetStateValues(state, pathParameterValues, routeDescriptor.pathParameters);","","\t\t\tif (uri.query && uri.query.values) {","\t\t\t\tsetQueryParameters(state, uri.query.values, routeDescriptor);","\t\t\t}","","\t\t\treturn state;","\t\t};","\t}","}","","/**"," * Sets parameter values to the state using parameter and store names."," * @param {Object} state Current state object."," * @param {Array} values Current values."," * @param {Array} parameters List of parameter descriptors."," */","function setStateValues(state, values, parameters) {","\tvalues.forEach((value, index) => {","\t\tconst parameter = parameters[index];","\t\tparameter.stores.forEach(storeName => {","\t\t\tif (!(storeName in state)) {","\t\t\t\tstate[storeName] = Object.create(null);","\t\t\t}","","\t\t\t// if URI has several values for the same parameter it turns to an array","\t\t\tif (parameter.name in state[storeName]) {","\t\t\t\tif (Array.isArray(state[storeName][parameter.name])) {","\t\t\t\t\tstate[storeName][parameter.name].push(value);","\t\t\t\t} else {","\t\t\t\t\tstate[storeName][parameter.name] = [state[storeName][parameter.name], value];","\t\t\t\t}","\t\t\t} else {","\t\t\t\tstate[storeName][parameter.name] = value;","\t\t\t}","\t\t});","\t});","}","","/**"," * Sets query parameters to the state."," * @param {Object} state Current state object."," * @param {Object} queryValues URI query parameters."," * @param {Object} routeDescriptor Current route descriptor."," */","function setQueryParameters(state, queryValues, routeDescriptor) {","\tObject.keys(queryValues)","\t\t.forEach(name => {","\t\t\tconst value = queryValues[name];","","\t\t\tif (Array.isArray(value)) {","\t\t\t\tvalue.forEach(item => {","\t\t\t\t\tconst subValues = Object.create(null);","\t\t\t\t\tsubValues[name] = item;","\t\t\t\t\tsetQueryParameters(state, subValues, routeDescriptor);","\t\t\t\t});","\t\t\t\treturn;","\t\t\t}","\t\t\tconst isValue = typeof (value) === 'string';","","\t\t\tlet queryNameMatches = null;","\t\t\tlet queryValueMatches = null;","\t\t\tlet routeParameter = null;","","\t\t\trouteDescriptor.queryParameters.some(parameter => {","\t\t\t\tqueryNameMatches = name.match(parameter.nameRegExp);","","\t\t\t\tif (isValue && parameter.valueRegExp) {","\t\t\t\t\tqueryValueMatches = value.match(parameter.valueRegExp);","\t\t\t\t}","","\t\t\t\tif (queryNameMatches) {","\t\t\t\t\trouteParameter = parameter;","\t\t\t\t\treturn true;","\t\t\t\t}","\t\t\t\treturn false;","\t\t\t});","","\t\t\tif (!routeParameter) {","\t\t\t\treturn;","\t\t\t}","","\t\t\tsetStateValues(state, queryNameMatches.slice(1), routeParameter.nameParameters);","","\t\t\tif (!queryValueMatches) {","\t\t\t\treturn;","\t\t\t}","\t\t\tsetStateValues(state, queryValueMatches.slice(1), routeParameter.valueParameters);","\t\t});","}","","/**"," * Sets parameter values to a route expression."," * @param {string} expression The route expression."," * @param {Array} parameters Array of route parameters."," * @param {Object} values Dictionary of route parameter values."," * @param {function?} preProcessor Value preprocessor"," * @returns {string} String with substituted values."," * @private"," */","function setParameterValues(expression, parameters, values, preProcessor) {","\tif (!parameters || parameters.length === 0) {","\t\treturn expression;","\t}","","\tpreProcessor = preProcessor || defaultParameterValueProcessor;","","\t// apply values for parameters in the URI path","\tlet nextParameterIndex = 0;","\tlet nextParameter = parameters[nextParameterIndex];","\tlet result = '';","","\tfor (let i = 0; i < expression.length; i++) {","\t\tif (nextParameter && i === nextParameter.start) {","\t\t\tresult += preProcessor(nextParameter, values[nextParameter.name]);","\t\t\twhile (++i < nextParameter.end - 1) {","\t\t\t\t// just skipping the parameter in the expression string","\t\t\t}","\t\t\tnextParameterIndex++;","\t\t\tnextParameter = parameters[nextParameterIndex];","\t\t\tcontinue;","\t\t}","\t\tresult += expression[i];","\t}","\treturn result;","}","","/**"," * Processes parameter value by default."," * @param {Object} parameter Parameter descriptor."," * @param {*} value Parameter's value."," * @returns {string} Processed value."," */","function defaultParameterValueProcessor(parameter, value) {","\tif (Array.isArray(value)) {","\t\tthrow new Error(`Array value is not supported for the parameter \"${parameter.name}\"`);","\t}","\treturn value === undefined ? '' : String(value);","}","","module.exports = StateProviderBase;",""],"l":{"3":1,"4":1,"5":1,"23":0,"28":0,"29":0,"30":0,"31":0,"32":0,"41":0,"50":0,"51":0,"54":0,"55":0,"56":0,"57":0,"58":0,"60":0,"61":0,"62":0,"66":0,"67":0,"69":0,"79":0,"80":0,"81":0,"82":0,"85":0,"88":0,"89":0,"91":0,"96":0,"97":0,"99":0,"100":0,"105":0,"106":0,"111":0,"112":0,"113":0,"118":0,"119":0,"120":0,"123":0,"124":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"135":0,"136":0,"139":0,"142":0,"145":0,"146":0,"150":0,"151":0,"153":0,"157":0,"167":0,"168":0,"169":0,"170":0,"173":0,"182":0,"183":0,"184":0,"187":0,"188":0,"189":0,"190":0,"191":0,"194":0,"219":0,"220":0,"222":0,"223":0,"225":0,"226":0,"227":0,"228":0,"240":0,"241":0,"242":0,"243":0,"244":0,"247":0,"248":0,"250":0,"252":0,"253":0,"256":0,"267":1,"268":0,"269":0,"270":0,"271":0,"272":0,"276":0,"277":0,"278":0,"280":0,"283":0,"295":1,"296":0,"298":0,"300":0,"301":0,"302":0,"303":0,"304":0,"306":0,"308":0,"310":0,"311":0,"312":0,"314":0,"315":0,"317":0,"318":0,"321":0,"322":0,"323":0,"325":0,"328":0,"329":0,"332":0,"334":0,"335":0,"337":0,"350":1,"351":0,"352":0,"355":0,"358":0,"359":0,"360":0,"362":0,"363":0,"364":0,"365":0,"368":0,"369":0,"370":0,"372":0,"374":0,"383":1,"384":0,"385":0,"387":0,"390":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/loaders/StoreLoader.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/loaders/StoreLoader.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":16,"loc":{"start":{"line":16,"column":12},"end":{"line":16,"column":22}}},"2":{"name":"(anonymous_2)","line":58,"loc":{"start":{"line":58,"column":5},"end":{"line":58,"column":8}}},"3":{"name":"(anonymous_3)","line":97,"loc":{"start":{"line":97,"column":17},"end":{"line":97,"column":20}}},"4":{"name":"(anonymous_4)","line":107,"loc":{"start":{"line":107,"column":10},"end":{"line":107,"column":25}}},"5":{"name":"(anonymous_5)","line":143,"loc":{"start":{"line":143,"column":15},"end":{"line":143,"column":18}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":58}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":29}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":49}},"4":{"start":{"line":17,"column":2},"end":{"line":17,"column":22}},"5":{"start":{"line":18,"column":2},"end":{"line":22,"column":3}},"6":{"start":{"line":19,"column":3},"end":{"line":19,"column":58}},"7":{"start":{"line":21,"column":3},"end":{"line":21,"column":24}},"8":{"start":{"line":23,"column":2},"end":{"line":23,"column":34}},"9":{"start":{"line":30,"column":2},"end":{"line":30,"column":47}},"10":{"start":{"line":37,"column":2},"end":{"line":37,"column":53}},"11":{"start":{"line":44,"column":2},"end":{"line":44,"column":65}},"12":{"start":{"line":51,"column":2},"end":{"line":51,"column":28}},"13":{"start":{"line":59,"column":2},"end":{"line":61,"column":3}},"14":{"start":{"line":60,"column":3},"end":{"line":60,"column":46}},"15":{"start":{"line":63,"column":2},"end":{"line":63,"column":37}},"16":{"start":{"line":65,"column":2},"end":{"line":90,"column":6}},"17":{"start":{"line":67,"column":4},"end":{"line":68,"column":59}},"18":{"start":{"line":68,"column":23},"end":{"line":68,"column":57}},"19":{"start":{"line":69,"column":4},"end":{"line":69,"column":38}},"20":{"start":{"line":72,"column":4},"end":{"line":78,"column":7}},"21":{"start":{"line":73,"column":5},"end":{"line":75,"column":6}},"22":{"start":{"line":74,"column":6},"end":{"line":74,"column":13}},"23":{"start":{"line":77,"column":5},"end":{"line":77,"column":32}},"24":{"start":{"line":80,"column":4},"end":{"line":80,"column":32}},"25":{"start":{"line":82,"column":4},"end":{"line":86,"column":5}},"26":{"start":{"line":83,"column":5},"end":{"line":83,"column":67}},"27":{"start":{"line":84,"column":5},"end":{"line":84,"column":31}},"28":{"start":{"line":85,"column":5},"end":{"line":85,"column":27}},"29":{"start":{"line":88,"column":4},"end":{"line":88,"column":51}},"30":{"start":{"line":89,"column":4},"end":{"line":89,"column":30}},"31":{"start":{"line":98,"column":2},"end":{"line":98,"column":51}},"32":{"start":{"line":108,"column":2},"end":{"line":108,"column":18}},"33":{"start":{"line":109,"column":2},"end":{"line":114,"column":3}},"34":{"start":{"line":110,"column":3},"end":{"line":110,"column":82}},"35":{"start":{"line":112,"column":3},"end":{"line":112,"column":35}},"36":{"start":{"line":113,"column":3},"end":{"line":113,"column":32}},"37":{"start":{"line":116,"column":2},"end":{"line":120,"column":3}},"38":{"start":{"line":117,"column":3},"end":{"line":117,"column":108}},"39":{"start":{"line":118,"column":3},"end":{"line":118,"column":57}},"40":{"start":{"line":119,"column":3},"end":{"line":119,"column":32}},"41":{"start":{"line":122,"column":2},"end":{"line":122,"column":45}},"42":{"start":{"line":123,"column":2},"end":{"line":123,"column":35}},"43":{"start":{"line":125,"column":2},"end":{"line":136,"column":6}},"44":{"start":{"line":127,"column":4},"end":{"line":129,"column":5}},"45":{"start":{"line":128,"column":5},"end":{"line":128,"column":98}},"46":{"start":{"line":130,"column":4},"end":{"line":130,"column":52}},"47":{"start":{"line":131,"column":4},"end":{"line":131,"column":23}},"48":{"start":{"line":134,"column":4},"end":{"line":134,"column":40}},"49":{"start":{"line":135,"column":4},"end":{"line":135,"column":16}},"50":{"start":{"line":144,"column":2},"end":{"line":149,"column":4}},"51":{"start":{"line":145,"column":3},"end":{"line":148,"column":7}},"52":{"start":{"line":147,"column":5},"end":{"line":147,"column":51}},"53":{"start":{"line":151,"column":2},"end":{"line":166,"column":6}},"54":{"start":{"line":153,"column":4},"end":{"line":153,"column":96}},"55":{"start":{"line":154,"column":4},"end":{"line":154,"column":89}},"56":{"start":{"line":155,"column":4},"end":{"line":155,"column":28}},"57":{"start":{"line":158,"column":4},"end":{"line":158,"column":100}},"58":{"start":{"line":159,"column":4},"end":{"line":159,"column":89}},"59":{"start":{"line":160,"column":4},"end":{"line":160,"column":28}},"60":{"start":{"line":163,"column":4},"end":{"line":163,"column":95}},"61":{"start":{"line":164,"column":4},"end":{"line":164,"column":89}},"62":{"start":{"line":165,"column":4},"end":{"line":165,"column":49}},"63":{"start":{"line":170,"column":0},"end":{"line":170,"column":29}}},"branchMap":{"1":{"line":59,"type":"if","locations":[{"start":{"line":59,"column":2},"end":{"line":59,"column":2}},{"start":{"line":59,"column":2},"end":{"line":59,"column":2}}]},"2":{"line":73,"type":"if","locations":[{"start":{"line":73,"column":5},"end":{"line":73,"column":5}},{"start":{"line":73,"column":5},"end":{"line":73,"column":5}}]},"3":{"line":73,"type":"binary-expr","locations":[{"start":{"line":73,"column":9},"end":{"line":73,"column":15}},{"start":{"line":73,"column":19},"end":{"line":73,"column":46}}]},"4":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":4},"end":{"line":82,"column":4}},{"start":{"line":82,"column":4},"end":{"line":82,"column":4}}]},"5":{"line":98,"type":"binary-expr","locations":[{"start":{"line":98,"column":9},"end":{"line":98,"column":27}},{"start":{"line":98,"column":31},"end":{"line":98,"column":50}}]},"6":{"line":116,"type":"if","locations":[{"start":{"line":116,"column":2},"end":{"line":116,"column":2}},{"start":{"line":116,"column":2},"end":{"line":116,"column":2}}]},"7":{"line":127,"type":"if","locations":[{"start":{"line":127,"column":4},"end":{"line":127,"column":4}},{"start":{"line":127,"column":4},"end":{"line":127,"column":4}}]}},"code":["'use strict';","","const requireHelper = require('../helpers/requireHelper');","const path = require('path');","const LoaderBase = require('../base/LoaderBase');","","/**"," * Implements the component Loader class for server environment."," */","class StoreLoader extends LoaderBase {","","\t/**","\t * Creates a new instance of the store loader.","\t * @param {ServiceLocator} locator The service locator for resolving dependencies.","\t */","\tconstructor(locator) {","\t\tvar storeTransforms;","\t\ttry {","\t\t\tstoreTransforms = locator.resolveAll('storeTransform');","\t\t} catch (e) {","\t\t\tstoreTransforms = [];","\t\t}","\t\tsuper(locator, storeTransforms);","","\t\t/**","\t\t * Current event bus.","\t\t * @type {EventEmitter}","\t\t * @private","\t\t */","\t\tthis._eventBus = locator.resolve('eventBus');","","\t\t/**","\t\t * Current store finder.","\t\t * @type {StoreFinder}","\t\t * @private","\t\t */","\t\tthis._storeFinder = locator.resolve('storeFinder');","","\t\t/**","\t\t * Current release flag.","\t\t * @type {boolean}","\t\t * @private","\t\t */","\t\tthis._isRelease = Boolean(locator.resolve('config').isRelease);","","\t\t/**","\t\t * Current map of loaded stores by their names.","\t\t * @type {Object}","\t\t * @private","\t\t */","\t\tthis._loadedStores = null;","\t}","","\t/**","\t * Loads all stores into the memory.","\t * @returns {Promise<Object>} The promise for a map of the loaded stores.","\t */","\tload() {","\t\tif (this._loadedStores) {","\t\t\treturn Promise.resolve(this._loadedStores);","\t\t}","","\t\tconst result = Object.create(null);","","\t\treturn this._storeFinder.find()","\t\t\t.then(details => {","\t\t\t\tconst storePromises = Object.keys(details)","\t\t\t\t\t.map(storeName => this._getStore(details[storeName]));","\t\t\t\treturn Promise.all(storePromises);","\t\t\t})","\t\t\t.then(stores => {","\t\t\t\tstores.forEach(store => {","\t\t\t\t\tif (!store || typeof (store) !== 'object') {","\t\t\t\t\t\treturn;","\t\t\t\t\t}","","\t\t\t\t\tresult[store.name] = store;","\t\t\t\t});","","\t\t\t\tthis._loadedStores = result;","","\t\t\t\tif (!this._isRelease) {","\t\t\t\t\tthis._eventBus.emit('info', 'Watching stores for changes...');","\t\t\t\t\tthis._storeFinder.watch();","\t\t\t\t\tthis._handleChanges();","\t\t\t\t}","","\t\t\t\tthis._eventBus.emit('allStoresLoaded', result);","\t\t\t\treturn this._loadedStores;","\t\t\t});","\t}","","\t/**","\t * Gets current map of stores by their names.","\t * @returns {Object} The map of stores by their names.","\t */","\tgetStoresByNames() {","\t\treturn this._loadedStores || Object.create(null);","\t}","","\t/**","\t * Gets a store object by the found store details.","\t * @param {Object} storeDetails The found details.","\t * @returns {Object} The store object.","\t * @private","\t */","\t_getStore(storeDetails) {","\t\tvar constructor;","\t\ttry {","\t\t\tconstructor = require(requireHelper.getAbsoluteRequirePath(storeDetails.path));","\t\t} catch (e) {","\t\t\tthis._eventBus.emit('error', e);","\t\t\treturn Promise.resolve(null);","\t\t}","","\t\tif (typeof (constructor) !== 'function') {","\t\t\tconst errorMessage = `Store's file ${storeDetails.path} should export a constructor function or a class`;","\t\t\tthis._eventBus.emit('error', new Error(errorMessage));","\t\t\treturn Promise.resolve(null);","\t\t}","","\t\tconst result = Object.create(storeDetails);","\t\tresult.constructor = constructor;","","\t\treturn this._applyTransforms(result)","\t\t\t.then(transformed => {","\t\t\t\tif (!transformed) {","\t\t\t\t\tthrow new Error(`Transformation for the \"${storeDetails.name}\" store returned a bad result`);","\t\t\t\t}","\t\t\t\tthis._eventBus.emit('storeLoaded', transformed);","\t\t\t\treturn transformed;","\t\t\t})","\t\t\t.catch(error => {","\t\t\t\tthis._eventBus.emit('error', error);","\t\t\t\treturn null;","\t\t\t});","\t}","","\t/**","\t * Handles changes while watching.","\t * @private","\t */","\t_handleChanges() {","\t\tconst loadStore = storeDetails => {","\t\t\tthis._getStore(storeDetails)","\t\t\t\t.then(store => {","\t\t\t\t\tthis._loadedStores[storeDetails.name] = store;","\t\t\t\t});","\t\t};","","\t\tthis._storeFinder","\t\t\t.on('add', storeDetails => {","\t\t\t\tthis._eventBus.emit('info', `Store \"${storeDetails.path}\" has been added, initializing...`);","\t\t\t\trequireHelper.clearCacheKey(requireHelper.getAbsoluteRequirePath(storeDetails.path));","\t\t\t\tloadStore(storeDetails);","\t\t\t})","\t\t\t.on('change', storeDetails => {","\t\t\t\tthis._eventBus.emit('info', `Store \"${storeDetails.path}\" has been changed, reinitializing...`);","\t\t\t\trequireHelper.clearCacheKey(requireHelper.getAbsoluteRequirePath(storeDetails.path));","\t\t\t\tloadStore(storeDetails);","\t\t\t})","\t\t\t.on('unlink', storeDetails => {","\t\t\t\tthis._eventBus.emit('info', `Store \"${storeDetails.path}\" has been unlinked, removing...`);","\t\t\t\trequireHelper.clearCacheKey(requireHelper.getAbsoluteRequirePath(storeDetails.path));","\t\t\t\tdelete this._loadedStores[storeDetails.name];","\t\t\t});","\t}","}","","module.exports = StoreLoader;",""],"l":{"3":1,"4":1,"5":1,"17":0,"18":0,"19":0,"21":0,"23":0,"30":0,"37":0,"44":0,"51":0,"59":0,"60":0,"63":0,"65":0,"67":0,"68":0,"69":0,"72":0,"73":0,"74":0,"77":0,"80":0,"82":0,"83":0,"84":0,"85":0,"88":0,"89":0,"98":0,"108":0,"109":0,"110":0,"112":0,"113":0,"116":0,"117":0,"118":0,"119":0,"122":0,"123":0,"125":0,"127":0,"128":0,"130":0,"131":0,"134":0,"135":0,"144":0,"145":0,"147":0,"151":0,"153":0,"154":0,"155":0,"158":0,"159":0,"160":0,"163":0,"164":0,"165":0,"170":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/base/LoaderBase.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/base/LoaderBase.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":14,"loc":{"start":{"line":14,"column":12},"end":{"line":14,"column":34}}},"2":{"name":"(anonymous_2)","line":32,"loc":{"start":{"line":32,"column":17},"end":{"line":32,"column":33}}}},"statementMap":{"1":{"start":{"line":21,"column":2},"end":{"line":21,"column":32}},"2":{"start":{"line":22,"column":2},"end":{"line":22,"column":47}},"3":{"start":{"line":33,"column":2},"end":{"line":36,"column":3}},"4":{"start":{"line":35,"column":3},"end":{"line":35,"column":39}},"5":{"start":{"line":38,"column":2},"end":{"line":40,"column":3}},"6":{"start":{"line":39,"column":3},"end":{"line":39,"column":34}},"7":{"start":{"line":42,"column":2},"end":{"line":42,"column":49}},"8":{"start":{"line":44,"column":2},"end":{"line":50,"column":83}},"9":{"start":{"line":45,"column":15},"end":{"line":45,"column":47}},"10":{"start":{"line":47,"column":4},"end":{"line":47,"column":41}},"11":{"start":{"line":48,"column":4},"end":{"line":48,"column":18}},"12":{"start":{"line":50,"column":30},"end":{"line":50,"column":81}},"13":{"start":{"line":54,"column":0},"end":{"line":54,"column":28}}},"branchMap":{"1":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":2},"end":{"line":33,"column":2}},{"start":{"line":33,"column":2},"end":{"line":33,"column":2}}]},"2":{"line":38,"type":"if","locations":[{"start":{"line":38,"column":2},"end":{"line":38,"column":2}},{"start":{"line":38,"column":2},"end":{"line":38,"column":2}}]}},"code":["'use strict';","","/**"," * Implements the basic Loader class for both server"," * and browser environments."," */","class LoaderBase {","","\t/**","\t * Creates a new instance of the basic loader.","\t * @param {ServiceLocator} locator The service locator for resolving dependencies.","\t * @param {Array} transforms The list of module transformations.","\t */","\tconstructor(locator, transforms) {","","\t\t/**","\t\t * Current list of module transformations.","\t\t * @type {Array}","\t\t * @private","\t\t */","\t\tthis._transforms = transforms;","\t\tthis._eventBus = locator.resolve('eventBus');","\t}","","\t/**","\t * Applies all the transformations for the loaded module.","\t * @param {Object} module The loaded module.","\t * @param {number?} index The transformation index in the list.","\t * @returns {Promise<Object>} The transformed module.","\t * @protected","\t */","\t_applyTransforms(module, index) {","\t\tif (index === undefined) {","\t\t\t// the list is a stack, we should reverse it","\t\t\tindex = this._transforms.length - 1;","\t\t}","","\t\tif (index < 0) {","\t\t\treturn Promise.resolve(module);","\t\t}","","\t\tconst transformation = this._transforms[index];","","\t\treturn Promise.resolve()","\t\t\t.then(() => transformation.transform(module))","\t\t\t.catch(reason => {","\t\t\t\tthis._eventBus.emit('error', reason);","\t\t\t\treturn module;","\t\t\t})","\t\t\t.then(transformedModule => this._applyTransforms(transformedModule, index - 1));","\t}","}","","module.exports = LoaderBase;",""],"l":{"21":0,"22":0,"33":0,"35":0,"38":0,"39":0,"42":0,"44":0,"45":0,"47":0,"48":0,"50":0,"54":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/loaders/ComponentLoader.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/loaders/ComponentLoader.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":20,"loc":{"start":{"line":20,"column":12},"end":{"line":20,"column":22}}},"2":{"name":"(anonymous_2)","line":69,"loc":{"start":{"line":69,"column":5},"end":{"line":69,"column":8}}},"3":{"name":"(anonymous_3)","line":120,"loc":{"start":{"line":120,"column":21},"end":{"line":120,"column":24}}},"4":{"name":"(anonymous_4)","line":130,"loc":{"start":{"line":130,"column":14},"end":{"line":130,"column":33}}},"5":{"name":"(anonymous_5)","line":177,"loc":{"start":{"line":177,"column":15},"end":{"line":177,"column":18}}},"6":{"name":"(anonymous_6)","line":209,"loc":{"start":{"line":209,"column":14},"end":{"line":209,"column":33}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":37}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":58}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":56}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":52}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":60}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":29}},"7":{"start":{"line":9,"column":0},"end":{"line":9,"column":49}},"8":{"start":{"line":21,"column":2},"end":{"line":21,"column":26}},"9":{"start":{"line":22,"column":2},"end":{"line":26,"column":3}},"10":{"start":{"line":23,"column":3},"end":{"line":23,"column":66}},"11":{"start":{"line":25,"column":3},"end":{"line":25,"column":28}},"12":{"start":{"line":27,"column":2},"end":{"line":27,"column":38}},"13":{"start":{"line":34,"column":2},"end":{"line":34,"column":47}},"14":{"start":{"line":41,"column":2},"end":{"line":41,"column":77}},"15":{"start":{"line":48,"column":2},"end":{"line":48,"column":61}},"16":{"start":{"line":55,"column":2},"end":{"line":55,"column":65}},"17":{"start":{"line":62,"column":2},"end":{"line":62,"column":32}},"18":{"start":{"line":70,"column":2},"end":{"line":72,"column":3}},"19":{"start":{"line":71,"column":3},"end":{"line":71,"column":50}},"20":{"start":{"line":74,"column":2},"end":{"line":74,"column":30}},"21":{"start":{"line":75,"column":2},"end":{"line":75,"column":37}},"22":{"start":{"line":77,"column":2},"end":{"line":113,"column":6}},"23":{"start":{"line":79,"column":4},"end":{"line":86,"column":8}},"24":{"start":{"line":81,"column":6},"end":{"line":81,"column":57}},"25":{"start":{"line":82,"column":6},"end":{"line":84,"column":7}},"26":{"start":{"line":83,"column":7},"end":{"line":83,"column":30}},"27":{"start":{"line":85,"column":6},"end":{"line":85,"column":50}},"28":{"start":{"line":88,"column":4},"end":{"line":88,"column":42}},"29":{"start":{"line":91,"column":4},"end":{"line":97,"column":7}},"30":{"start":{"line":92,"column":5},"end":{"line":94,"column":6}},"31":{"start":{"line":93,"column":6},"end":{"line":93,"column":13}},"32":{"start":{"line":96,"column":5},"end":{"line":96,"column":40}},"33":{"start":{"line":99,"column":4},"end":{"line":99,"column":36}},"34":{"start":{"line":101,"column":4},"end":{"line":105,"column":5}},"35":{"start":{"line":102,"column":5},"end":{"line":102,"column":71}},"36":{"start":{"line":103,"column":5},"end":{"line":103,"column":35}},"37":{"start":{"line":104,"column":5},"end":{"line":104,"column":27}},"38":{"start":{"line":106,"column":4},"end":{"line":110,"column":5}},"39":{"start":{"line":107,"column":5},"end":{"line":109,"column":7}},"40":{"start":{"line":111,"column":4},"end":{"line":111,"column":55}},"41":{"start":{"line":112,"column":4},"end":{"line":112,"column":34}},"42":{"start":{"line":121,"column":2},"end":{"line":121,"column":55}},"43":{"start":{"line":131,"column":2},"end":{"line":131,"column":57}},"44":{"start":{"line":133,"column":2},"end":{"line":133,"column":18}},"45":{"start":{"line":134,"column":2},"end":{"line":139,"column":3}},"46":{"start":{"line":135,"column":3},"end":{"line":135,"column":36}},"47":{"start":{"line":137,"column":3},"end":{"line":137,"column":35}},"48":{"start":{"line":138,"column":3},"end":{"line":138,"column":32}},"49":{"start":{"line":141,"column":2},"end":{"line":146,"column":3}},"50":{"start":{"line":142,"column":3},"end":{"line":144,"column":5}},"51":{"start":{"line":145,"column":3},"end":{"line":145,"column":32}},"52":{"start":{"line":148,"column":2},"end":{"line":148,"column":50}},"53":{"start":{"line":149,"column":2},"end":{"line":149,"column":38}},"54":{"start":{"line":151,"column":2},"end":{"line":170,"column":6}},"55":{"start":{"line":152,"column":15},"end":{"line":152,"column":85}},"56":{"start":{"line":153,"column":15},"end":{"line":153,"column":53}},"57":{"start":{"line":154,"column":15},"end":{"line":161,"column":7}},"58":{"start":{"line":156,"column":6},"end":{"line":158,"column":7}},"59":{"start":{"line":157,"column":7},"end":{"line":157,"column":101}},"60":{"start":{"line":159,"column":6},"end":{"line":159,"column":30}},"61":{"start":{"line":160,"column":6},"end":{"line":160,"column":57}},"62":{"start":{"line":164,"column":4},"end":{"line":164,"column":54}},"63":{"start":{"line":165,"column":4},"end":{"line":165,"column":21}},"64":{"start":{"line":168,"column":4},"end":{"line":168,"column":41}},"65":{"start":{"line":169,"column":4},"end":{"line":169,"column":16}},"66":{"start":{"line":178,"column":2},"end":{"line":179,"column":83}},"67":{"start":{"line":178,"column":44},"end":{"line":179,"column":82}},"68":{"start":{"line":179,"column":23},"end":{"line":179,"column":80}},"69":{"start":{"line":181,"column":2},"end":{"line":200,"column":6}},"70":{"start":{"line":183,"column":4},"end":{"line":183,"column":104}},"71":{"start":{"line":184,"column":4},"end":{"line":184,"column":70}},"72":{"start":{"line":185,"column":4},"end":{"line":185,"column":36}},"73":{"start":{"line":188,"column":4},"end":{"line":188,"column":124}},"74":{"start":{"line":189,"column":4},"end":{"line":189,"column":70}},"75":{"start":{"line":190,"column":4},"end":{"line":190,"column":36}},"76":{"start":{"line":193,"column":4},"end":{"line":193,"column":125}},"77":{"start":{"line":194,"column":4},"end":{"line":194,"column":36}},"78":{"start":{"line":197,"column":4},"end":{"line":197,"column":103}},"79":{"start":{"line":198,"column":4},"end":{"line":198,"column":70}},"80":{"start":{"line":199,"column":4},"end":{"line":199,"column":57}},"81":{"start":{"line":210,"column":2},"end":{"line":212,"column":4}},"82":{"start":{"line":216,"column":0},"end":{"line":216,"column":33}}},"branchMap":{"1":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":2},"end":{"line":70,"column":2}},{"start":{"line":70,"column":2},"end":{"line":70,"column":2}}]},"2":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":6},"end":{"line":82,"column":6}},{"start":{"line":82,"column":6},"end":{"line":82,"column":6}}]},"3":{"line":92,"type":"if","locations":[{"start":{"line":92,"column":5},"end":{"line":92,"column":5}},{"start":{"line":92,"column":5},"end":{"line":92,"column":5}}]},"4":{"line":92,"type":"binary-expr","locations":[{"start":{"line":92,"column":9},"end":{"line":92,"column":19}},{"start":{"line":92,"column":23},"end":{"line":92,"column":54}}]},"5":{"line":101,"type":"if","locations":[{"start":{"line":101,"column":4},"end":{"line":101,"column":4}},{"start":{"line":101,"column":4},"end":{"line":101,"column":4}}]},"6":{"line":106,"type":"if","locations":[{"start":{"line":106,"column":4},"end":{"line":106,"column":4}},{"start":{"line":106,"column":4},"end":{"line":106,"column":4}}]},"7":{"line":121,"type":"binary-expr","locations":[{"start":{"line":121,"column":9},"end":{"line":121,"column":31}},{"start":{"line":121,"column":35},"end":{"line":121,"column":54}}]},"8":{"line":141,"type":"if","locations":[{"start":{"line":141,"column":2},"end":{"line":141,"column":2}},{"start":{"line":141,"column":2},"end":{"line":141,"column":2}}]},"9":{"line":156,"type":"if","locations":[{"start":{"line":156,"column":6},"end":{"line":156,"column":6}},{"start":{"line":156,"column":6},"end":{"line":156,"column":6}}]}},"code":["'use strict';","","const fs = require('../promises/fs');","const requireHelper = require('../helpers/requireHelper');","const moduleHelper = require('../helpers/moduleHelper');","const loadHelper = require('../helpers/loadHelper');","const templateHelper = require('../helpers/templateHelper');","const path = require('path');","const LoaderBase = require('../base/LoaderBase');","","/**"," * Implements the component Loader class for server environment."," */","class ComponentLoader extends LoaderBase {","","\t/**","\t * Creates new instance of the component loader.","\t * @param {ServiceLocator} locator The service locator for resolving dependencies.","\t */","\tconstructor(locator) {","\t\tvar componentTransforms;","\t\ttry {","\t\t\tcomponentTransforms = locator.resolveAll('componentTransform');","\t\t} catch (e) {","\t\t\tcomponentTransforms = [];","\t\t}","\t\tsuper(locator, componentTransforms);","","\t\t/**","\t\t * Current event bus.","\t\t * @type {EventEmitter}","\t\t * @private","\t\t */","\t\tthis._eventBus = locator.resolve('eventBus');","","\t\t/**","\t\t * Current template provider list.","\t\t * @type {Array<TemplateProvider>}","\t\t * @private","\t\t */","\t\tthis._templateProviders = templateHelper.resolveTemplateProviders(locator);","","\t\t/**","\t\t * Current component finder.","\t\t * @type {ComponentFinder}","\t\t * @private","\t\t */","\t\tthis._componentFinder = locator.resolve('componentFinder');","","\t\t/**","\t\t * Current release flag.","\t\t * @type {boolean}","\t\t * @private","\t\t */","\t\tthis._isRelease = Boolean(locator.resolve('config').isRelease);","","\t\t/**","\t\t * Current map of the loaded components by their names.","\t\t * @type {Object}","\t\t * @private","\t\t */","\t\tthis._loadedComponents = null;","\t}","","\t/**","\t * Loads all components into the memory.","\t * @returns {Promise<Object>} The promise for map of loaded components.","\t */","\tload() {","\t\tif (this._loadedComponents) {","\t\t\treturn Promise.resolve(this._loadedComponents);","\t\t}","","\t\tvar isDocumentFound = false;","\t\tconst result = Object.create(null);","","\t\treturn this._componentFinder.find()","\t\t\t.then(components => {","\t\t\t\tconst componentPromises = Object.keys(components)","\t\t\t\t\t.map(componentName => {","\t\t\t\t\t\tconst componentDetails = components[componentName];","\t\t\t\t\t\tif (moduleHelper.isDocumentComponent(componentDetails.name)) {","\t\t\t\t\t\t\tisDocumentFound = true;","\t\t\t\t\t\t}","\t\t\t\t\t\treturn this._getComponent(componentDetails);","\t\t\t\t\t});","","\t\t\t\treturn Promise.all(componentPromises);","\t\t\t})","\t\t\t.then(componentList => {","\t\t\t\tcomponentList.forEach(component => {","\t\t\t\t\tif (!component || typeof (component) !== 'object') {","\t\t\t\t\t\treturn;","\t\t\t\t\t}","","\t\t\t\t\tresult[component.name] = component;","\t\t\t\t});","","\t\t\t\tthis._loadedComponents = result;","","\t\t\t\tif (!this._isRelease) {","\t\t\t\t\tthis._eventBus.emit('info', 'Watching components for changes...');","\t\t\t\t\tthis._componentFinder.watch();","\t\t\t\t\tthis._handleChanges();","\t\t\t\t}","\t\t\t\tif (!isDocumentFound) {","\t\t\t\t\tthis._eventBus.emit('warn',","\t\t\t\t\t\t`Component \"${moduleHelper.DOCUMENT_COMPONENT_NAME}\" not found, blank page will be rendered`","\t\t\t\t\t);","\t\t\t\t}","\t\t\t\tthis._eventBus.emit('allComponentsLoaded', result);","\t\t\t\treturn this._loadedComponents;","\t\t\t});","\t}","","\t/**","\t * Gets current map of components by their names.","\t * @returns {Object} The map of components by their names.","\t */","\tgetComponentsByNames() {","\t\treturn this._loadedComponents || Object.create(null);","\t}","","\t/**","\t * Gets a component object by the found component details.","\t * @param {Object} componentDetails The found details.","\t * @returns {Object} The component object.","\t * @private","\t */","\t_getComponent(componentDetails) {","\t\tconst logicPath = this._getLogicPath(componentDetails);","","\t\tvar constructor;","\t\ttry {","\t\t\tconstructor = require(logicPath);","\t\t} catch (e) {","\t\t\tthis._eventBus.emit('error', e);","\t\t\treturn Promise.resolve(null);","\t\t}","","\t\tif (typeof (constructor) !== 'function') {","\t\t\tthis._eventBus.emit('warn',","\t\t\t\t`File at ${logicPath} of component \"${componentDetails.name}\" not found or does not export a constructor function. Skipping...`","\t\t\t);","\t\t\treturn Promise.resolve(null);","\t\t}","","\t\tvar component = Object.create(componentDetails);","\t\tcomponent.constructor = constructor;","","\t\treturn loadHelper.loadTemplateSources(component)","\t\t\t.then(() => loadHelper.assignTemplateProviders(component, this._templateProviders))","\t\t\t.then(() => loadHelper.compileTemplates(component))","\t\t\t.then(() => this._applyTransforms(component)","\t\t\t\t\t.then(transformed => {","\t\t\t\t\t\tif (!transformed) {","\t\t\t\t\t\t\tthrow new Error(`Transformation for the \"${component.name}\" component returned a bad result`);","\t\t\t\t\t\t}","\t\t\t\t\t\tcomponent = transformed;","\t\t\t\t\t\treturn templateHelper.registerTemplates(component);","\t\t\t\t\t})","\t\t\t)","\t\t\t.then(() => {","\t\t\t\tthis._eventBus.emit('componentLoaded', component);","\t\t\t\treturn component;","\t\t\t})","\t\t\t.catch(reason => {","\t\t\t\tthis._eventBus.emit('error', reason);","\t\t\t\treturn null;","\t\t\t});","\t}","","\t/**","\t * Handles changes while watching.","\t * @private","\t */","\t_handleChanges() {","\t\tconst loadComponent = componentDetails => this._getComponent(componentDetails)","\t\t\t.then(component => (this._loadedComponents[componentDetails.name] = component));","","\t\tthis._componentFinder","\t\t\t.on('add', componentDetails => {","\t\t\t\tthis._eventBus.emit('info', `Component \"${componentDetails.path}\" has been added, initializing...`);","\t\t\t\trequireHelper.clearCacheKey(this._getLogicPath(componentDetails));","\t\t\t\tloadComponent(componentDetails);","\t\t\t})","\t\t\t.on('changeLogic', componentDetails => {","\t\t\t\tthis._eventBus.emit('info', `Scripts of the \"${componentDetails.path}\" component have been changed, reinitializing...`);","\t\t\t\trequireHelper.clearCacheKey(this._getLogicPath(componentDetails));","\t\t\t\tloadComponent(componentDetails);","\t\t\t})","\t\t\t.on('changeTemplates', componentDetails => {","\t\t\t\tthis._eventBus.emit('info', `Template of the \"${componentDetails.path}\" component have been changed, reinitializing...`);","\t\t\t\tloadComponent(componentDetails);","\t\t\t})","\t\t\t.on('unlink', componentDetails => {","\t\t\t\tthis._eventBus.emit('info', `Component \"${componentDetails.path}\" has been unlinked, removing...`);","\t\t\t\trequireHelper.clearCacheKey(this._getLogicPath(componentDetails));","\t\t\t\tdelete this._loadedComponents[componentDetails.name];","\t\t\t});","\t}","","\t/**","\t * Gets an absolute path to the component's logic file.","\t * @param {Object} componentDetails The component details object.","\t * @returns {string} The absolute path to the logic file.","\t * @private","\t */","\t_getLogicPath(componentDetails) {","\t\treturn path.resolve(","\t\t\tpath.dirname(componentDetails.path), componentDetails.properties.logic","\t\t);","\t}","}","","module.exports = ComponentLoader;",""],"l":{"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"21":0,"22":0,"23":0,"25":0,"27":0,"34":0,"41":0,"48":0,"55":0,"62":0,"70":0,"71":0,"74":0,"75":0,"77":0,"79":0,"81":0,"82":0,"83":0,"85":0,"88":0,"91":0,"92":0,"93":0,"96":0,"99":0,"101":0,"102":0,"103":0,"104":0,"106":0,"107":0,"111":0,"112":0,"121":0,"131":0,"133":0,"134":0,"135":0,"137":0,"138":0,"141":0,"142":0,"145":0,"148":0,"149":0,"151":0,"152":0,"153":0,"154":0,"156":0,"157":0,"159":0,"160":0,"164":0,"165":0,"168":0,"169":0,"178":0,"179":0,"181":0,"183":0,"184":0,"185":0,"188":0,"189":0,"190":0,"193":0,"194":0,"197":0,"198":0,"199":0,"210":0,"216":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/DocumentRenderer.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/DocumentRenderer.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":22}}},"2":{"name":"(anonymous_2)","line":21,"loc":{"start":{"line":21,"column":7},"end":{"line":21,"column":31}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":68}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":65}},"3":{"start":{"line":13,"column":2},"end":{"line":13,"column":17}},"4":{"start":{"line":22,"column":2},"end":{"line":42,"column":58}},"5":{"start":{"line":24,"column":4},"end":{"line":32,"column":6}},"6":{"start":{"line":33,"column":4},"end":{"line":33,"column":69}},"7":{"start":{"line":35,"column":4},"end":{"line":35,"column":65}},"8":{"start":{"line":37,"column":4},"end":{"line":37,"column":34}},"9":{"start":{"line":38,"column":4},"end":{"line":40,"column":82}},"10":{"start":{"line":40,"column":25},"end":{"line":40,"column":80}},"11":{"start":{"line":42,"column":20},"end":{"line":42,"column":56}},"12":{"start":{"line":46,"column":0},"end":{"line":46,"column":34}}},"branchMap":{},"code":["'use strict';","","const DocumentRendererBase = require('./base/DocumentRendererBase');","const ComponentReadable = require('./streams/ComponentReadable');","","class DocumentRenderer extends DocumentRendererBase {","","\t/**","\t * Creates a new instance of the document renderer.","\t * @param {ServiceLocator} locator The service locator for resolving dependencies.","\t */","\tconstructor(locator) {","\t\tsuper(locator);","\t}","","\t/**","\t * Renders a response on the request with the specified state and routing context.","\t * @param {Object} state State of the application.","\t * @param {Object} routingContext Routing Context.","\t */","\trender(state, routingContext) {","\t\tthis._getPromiseForReadyState()","\t\t\t.then(() => {","\t\t\t\tconst renderingContext = {","\t\t\t\t\tisDocumentRendered: false,","\t\t\t\t\tisHeadRendered: false,","\t\t\t\t\tconfig: this._serviceLocator.resolve('config'),","\t\t\t\t\troutingContext,","\t\t\t\t\tstoreDispatcher: this._serviceLocator.resolve('storeDispatcher'),","\t\t\t\t\teventBus: this._eventBus,","\t\t\t\t\tcomponents: this._componentLoader.getComponentsByNames()","\t\t\t\t};","\t\t\t\trenderingContext.storeDispatcher.setState(state, routingContext);","","\t\t\t\tconst renderStream = new ComponentReadable(renderingContext);","","\t\t\t\trenderStream.renderDocument();","\t\t\t\trenderStream","\t\t\t\t\t.pipe(routingContext.middleware.response)","\t\t\t\t\t.on('finish', () => this._eventBus.emit('documentRendered', routingContext));","\t\t\t})","\t\t\t.catch(reason => this._eventBus.emit('error', reason));","\t}","}","","module.exports = DocumentRenderer;",""],"l":{"3":1,"4":1,"13":0,"22":0,"24":0,"33":0,"35":0,"37":0,"38":0,"40":0,"42":0,"46":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/base/DocumentRendererBase.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/base/DocumentRendererBase.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1},"b":{"1":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":12},"end":{"line":13,"column":22}}},"2":{"name":"(anonymous_2)","line":65,"loc":{"start":{"line":65,"column":25},"end":{"line":65,"column":28}}}},"statementMap":{"1":{"start":{"line":20,"column":2},"end":{"line":20,"column":33}},"2":{"start":{"line":27,"column":2},"end":{"line":27,"column":59}},"3":{"start":{"line":34,"column":2},"end":{"line":34,"column":61}},"4":{"start":{"line":40,"column":2},"end":{"line":40,"column":47}},"5":{"start":{"line":42,"column":2},"end":{"line":42,"column":53}},"6":{"start":{"line":49,"column":2},"end":{"line":57,"column":58}},"7":{"start":{"line":54,"column":4},"end":{"line":54,"column":25}},"8":{"start":{"line":55,"column":4},"end":{"line":55,"column":33}},"9":{"start":{"line":57,"column":20},"end":{"line":57,"column":56}},"10":{"start":{"line":66,"column":2},"end":{"line":68,"column":21}},"11":{"start":{"line":72,"column":0},"end":{"line":72,"column":38}}},"branchMap":{"1":{"line":66,"type":"cond-expr","locations":[{"start":{"line":67,"column":3},"end":{"line":67,"column":16}},{"start":{"line":68,"column":3},"end":{"line":68,"column":20}}]}},"code":["'use strict';","","/**"," * Implements the basic Cookie Wrapper class for both server"," * and browser environments."," */","class DocumentRendererBase {","","\t/**","\t * Creates a new instance of the basic document renderer.","\t * @param {ServiceLocator} locator The locator for resolving dependencies.","\t */","\tconstructor(locator) {","","\t\t/**","\t\t * Current service locator.","\t\t * @type {ServiceLocator}","\t\t * @protected","\t\t */","\t\tthis._serviceLocator = locator;","","\t\t/**","\t\t * Current context factory.","\t\t * @type {ContextFactory}","\t\t * @protected","\t\t */","\t\tthis._contextFactory = locator.resolve('contextFactory');","","\t\t/**","\t\t * Current component loader.","\t\t * @type {ComponentLoader}","\t\t * @protected","\t\t */","\t\tthis._componentLoader = locator.resolve('componentLoader');","","\t\t/**","\t\t * Current event bus.","\t\t * @param  {EventEmitter}","\t\t */","\t\tthis._eventBus = locator.resolve('eventBus');","","\t\tconst storeLoader = locator.resolve('storeLoader');","","\t\t/**","\t\t * Current module loading promise.","\t\t * @type {Promise}","\t\t * @protected","\t\t */","\t\tthis._loading = Promise.all([","\t\t\tthis._componentLoader.load(),","\t\t\tstoreLoader.load()","\t\t])","\t\t\t.then(() => {","\t\t\t\tthis._loading = null;","\t\t\t\tthis._eventBus.emit('ready');","\t\t\t})","\t\t\t.catch(reason => this._eventBus.emit('error', reason));","\t}","","\t/**","\t * Gets a promise for the state when Catberry will be able to handle requests.","\t * @returns {Promise} Promise for nothing.","\t * @protected","\t */","\t_getPromiseForReadyState() {","\t\treturn this._loading ?","\t\t\tthis._loading :","\t\t\tPromise.resolve();","\t}","}","","module.exports = DocumentRendererBase;",""],"l":{"20":0,"27":0,"34":0,"40":0,"42":0,"49":0,"54":0,"55":0,"57":0,"66":0,"72":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/streams/ComponentReadable.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/streams/ComponentReadable.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":1,"198":0,"199":1,"200":0,"201":1,"202":0,"203":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0,0,0,0,0,0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0,0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"fnMap":{"1":{"name":"(anonymous_1)","line":26,"loc":{"start":{"line":26,"column":12},"end":{"line":26,"column":31}}},"2":{"name":"(anonymous_2)","line":76,"loc":{"start":{"line":76,"column":11},"end":{"line":76,"column":18}}},"3":{"name":"(anonymous_3)","line":91,"loc":{"start":{"line":91,"column":15},"end":{"line":91,"column":18}}},"4":{"name":"(anonymous_4)","line":114,"loc":{"start":{"line":114,"column":23},"end":{"line":114,"column":36}}},"5":{"name":"(anonymous_5)","line":165,"loc":{"start":{"line":165,"column":6},"end":{"line":165,"column":9}}},"6":{"name":"(anonymous_6)","line":230,"loc":{"start":{"line":230,"column":10},"end":{"line":230,"column":22}}},"7":{"name":"(anonymous_7)","line":282,"loc":{"start":{"line":282,"column":17},"end":{"line":282,"column":27}}},"8":{"name":"(anonymous_8)","line":341,"loc":{"start":{"line":341,"column":22},"end":{"line":341,"column":39}}},"9":{"name":"(anonymous_9)","line":376,"loc":{"start":{"line":376,"column":21},"end":{"line":376,"column":31}}},"10":{"name":"(anonymous_10)","line":410,"loc":{"start":{"line":410,"column":20},"end":{"line":410,"column":23}}},"11":{"name":"nullStub","line":458,"loc":{"start":{"line":458,"column":0},"end":{"line":458,"column":20}}},"12":{"name":"promiseStub","line":466,"loc":{"start":{"line":466,"column":0},"end":{"line":466,"column":23}}},"13":{"name":"arrayStub","line":474,"loc":{"start":{"line":474,"column":0},"end":{"line":474,"column":21}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":33}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":37}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":56}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":56}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":54}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":69}},"7":{"start":{"line":9,"column":0},"end":{"line":9,"column":44}},"8":{"start":{"line":10,"column":0},"end":{"line":10,"column":63}},"9":{"start":{"line":11,"column":0},"end":{"line":11,"column":38}},"10":{"start":{"line":13,"column":0},"end":{"line":13,"column":24}},"11":{"start":{"line":14,"column":0},"end":{"line":14,"column":48}},"12":{"start":{"line":15,"column":0},"end":{"line":15,"column":30}},"13":{"start":{"line":17,"column":0},"end":{"line":17,"column":50}},"14":{"start":{"line":27,"column":2},"end":{"line":27,"column":17}},"15":{"start":{"line":34,"column":2},"end":{"line":34,"column":26}},"16":{"start":{"line":41,"column":2},"end":{"line":41,"column":24}},"17":{"start":{"line":48,"column":2},"end":{"line":48,"column":41}},"18":{"start":{"line":55,"column":2},"end":{"line":55,"column":25}},"19":{"start":{"line":62,"column":2},"end":{"line":62,"column":26}},"20":{"start":{"line":69,"column":2},"end":{"line":69,"column":27}},"21":{"start":{"line":77,"column":2},"end":{"line":77,"column":32}},"22":{"start":{"line":78,"column":2},"end":{"line":78,"column":19}},"23":{"start":{"line":79,"column":2},"end":{"line":79,"column":22}},"24":{"start":{"line":80,"column":2},"end":{"line":82,"column":3}},"25":{"start":{"line":81,"column":3},"end":{"line":81,"column":31}},"26":{"start":{"line":83,"column":2},"end":{"line":83,"column":52}},"27":{"start":{"line":84,"column":2},"end":{"line":84,"column":41}},"28":{"start":{"line":85,"column":2},"end":{"line":85,"column":15}},"29":{"start":{"line":93,"column":2},"end":{"line":95,"column":3}},"30":{"start":{"line":94,"column":3},"end":{"line":94,"column":10}},"31":{"start":{"line":96,"column":2},"end":{"line":99,"column":5}},"32":{"start":{"line":101,"column":2},"end":{"line":104,"column":3}},"33":{"start":{"line":102,"column":3},"end":{"line":103,"column":41}},"34":{"start":{"line":103,"column":18},"end":{"line":103,"column":39}},"35":{"start":{"line":115,"column":2},"end":{"line":117,"column":3}},"36":{"start":{"line":116,"column":3},"end":{"line":116,"column":15}},"37":{"start":{"line":119,"column":2},"end":{"line":122,"column":3}},"38":{"start":{"line":120,"column":3},"end":{"line":120,"column":71}},"39":{"start":{"line":121,"column":3},"end":{"line":121,"column":62}},"40":{"start":{"line":124,"column":2},"end":{"line":124,"column":79}},"41":{"start":{"line":125,"column":2},"end":{"line":125,"column":71}},"42":{"start":{"line":126,"column":2},"end":{"line":126,"column":63}},"43":{"start":{"line":128,"column":2},"end":{"line":139,"column":3}},"44":{"start":{"line":129,"column":3},"end":{"line":131,"column":4}},"45":{"start":{"line":130,"column":4},"end":{"line":130,"column":16}},"46":{"start":{"line":132,"column":3},"end":{"line":132,"column":43}},"47":{"start":{"line":133,"column":9},"end":{"line":139,"column":3}},"48":{"start":{"line":134,"column":3},"end":{"line":137,"column":4}},"49":{"start":{"line":136,"column":4},"end":{"line":136,"column":16}},"50":{"start":{"line":138,"column":3},"end":{"line":138,"column":39}},"51":{"start":{"line":141,"column":2},"end":{"line":141,"column":60}},"52":{"start":{"line":142,"column":2},"end":{"line":144,"column":3}},"53":{"start":{"line":143,"column":3},"end":{"line":143,"column":15}},"54":{"start":{"line":146,"column":2},"end":{"line":146,"column":56}},"55":{"start":{"line":148,"column":2},"end":{"line":148,"column":48}},"56":{"start":{"line":149,"column":2},"end":{"line":149,"column":61}},"57":{"start":{"line":151,"column":2},"end":{"line":157,"column":6}},"58":{"start":{"line":153,"column":4},"end":{"line":155,"column":5}},"59":{"start":{"line":154,"column":5},"end":{"line":154,"column":32}},"60":{"start":{"line":156,"column":4},"end":{"line":156,"column":16}},"61":{"start":{"line":166,"column":2},"end":{"line":169,"column":3}},"62":{"start":{"line":167,"column":3},"end":{"line":167,"column":17}},"63":{"start":{"line":168,"column":3},"end":{"line":168,"column":10}},"64":{"start":{"line":171,"column":2},"end":{"line":174,"column":3}},"65":{"start":{"line":172,"column":3},"end":{"line":172,"column":19}},"66":{"start":{"line":173,"column":3},"end":{"line":173,"column":10}},"67":{"start":{"line":176,"column":2},"end":{"line":176,"column":18}},"68":{"start":{"line":177,"column":2},"end":{"line":211,"column":3}},"69":{"start":{"line":178,"column":3},"end":{"line":178,"column":46}},"70":{"start":{"line":180,"column":3},"end":{"line":183,"column":4}},"71":{"start":{"line":181,"column":4},"end":{"line":181,"column":30}},"72":{"start":{"line":182,"column":4},"end":{"line":182,"column":13}},"73":{"start":{"line":185,"column":3},"end":{"line":185,"column":54}},"74":{"start":{"line":186,"column":3},"end":{"line":189,"column":4}},"75":{"start":{"line":187,"column":4},"end":{"line":187,"column":30}},"76":{"start":{"line":188,"column":4},"end":{"line":188,"column":13}},"77":{"start":{"line":190,"column":3},"end":{"line":190,"column":69}},"78":{"start":{"line":192,"column":3},"end":{"line":195,"column":4}},"79":{"start":{"line":193,"column":4},"end":{"line":193,"column":30}},"80":{"start":{"line":194,"column":4},"end":{"line":194,"column":13}},"81":{"start":{"line":199,"column":3},"end":{"line":205,"column":4}},"82":{"start":{"line":200,"column":4},"end":{"line":200,"column":62}},"83":{"start":{"line":201,"column":4},"end":{"line":204,"column":7}},"84":{"start":{"line":207,"column":3},"end":{"line":207,"column":29}},"85":{"start":{"line":209,"column":3},"end":{"line":209,"column":91}},"86":{"start":{"line":209,"column":68},"end":{"line":209,"column":89}},"87":{"start":{"line":210,"column":3},"end":{"line":210,"column":9}},"88":{"start":{"line":213,"column":2},"end":{"line":216,"column":3}},"89":{"start":{"line":214,"column":3},"end":{"line":214,"column":21}},"90":{"start":{"line":215,"column":3},"end":{"line":215,"column":10}},"91":{"start":{"line":218,"column":2},"end":{"line":218,"column":30}},"92":{"start":{"line":220,"column":2},"end":{"line":222,"column":3}},"93":{"start":{"line":221,"column":3},"end":{"line":221,"column":30}},"94":{"start":{"line":231,"column":2},"end":{"line":231,"column":39}},"95":{"start":{"line":232,"column":2},"end":{"line":236,"column":4}},"96":{"start":{"line":238,"column":2},"end":{"line":238,"column":29}},"97":{"start":{"line":239,"column":2},"end":{"line":239,"column":29}},"98":{"start":{"line":242,"column":2},"end":{"line":273,"column":3}},"99":{"start":{"line":243,"column":3},"end":{"line":243,"column":33}},"100":{"start":{"line":244,"column":3},"end":{"line":272,"column":4}},"101":{"start":{"line":246,"column":5},"end":{"line":248,"column":21}},"102":{"start":{"line":249,"column":5},"end":{"line":249,"column":11}},"103":{"start":{"line":251,"column":5},"end":{"line":253,"column":21}},"104":{"start":{"line":254,"column":5},"end":{"line":254,"column":42}},"105":{"start":{"line":255,"column":5},"end":{"line":255,"column":39}},"106":{"start":{"line":256,"column":5},"end":{"line":256,"column":11}},"107":{"start":{"line":260,"column":5},"end":{"line":262,"column":62}},"108":{"start":{"line":263,"column":5},"end":{"line":263,"column":55}},"109":{"start":{"line":264,"column":5},"end":{"line":264,"column":11}},"110":{"start":{"line":266,"column":5},"end":{"line":266,"column":29}},"111":{"start":{"line":267,"column":5},"end":{"line":267,"column":11}},"112":{"start":{"line":269,"column":5},"end":{"line":269,"column":16}},"113":{"start":{"line":271,"column":5},"end":{"line":271,"column":17}},"114":{"start":{"line":283,"column":2},"end":{"line":283,"column":49}},"115":{"start":{"line":284,"column":2},"end":{"line":284,"column":45}},"116":{"start":{"line":286,"column":2},"end":{"line":288,"column":3}},"117":{"start":{"line":287,"column":3},"end":{"line":287,"column":30}},"118":{"start":{"line":290,"column":2},"end":{"line":290,"column":80}},"119":{"start":{"line":292,"column":2},"end":{"line":297,"column":3}},"120":{"start":{"line":293,"column":3},"end":{"line":293,"column":57}},"121":{"start":{"line":296,"column":3},"end":{"line":296,"column":84}},"122":{"start":{"line":296,"column":44},"end":{"line":296,"column":82}},"123":{"start":{"line":299,"column":2},"end":{"line":299,"column":71}},"124":{"start":{"line":301,"column":2},"end":{"line":301,"column":39}},"125":{"start":{"line":302,"column":2},"end":{"line":305,"column":4}},"126":{"start":{"line":307,"column":2},"end":{"line":307,"column":82}},"127":{"start":{"line":308,"column":2},"end":{"line":308,"column":70}},"128":{"start":{"line":309,"column":2},"end":{"line":309,"column":62}},"129":{"start":{"line":311,"column":2},"end":{"line":311,"column":60}},"130":{"start":{"line":313,"column":2},"end":{"line":332,"column":65}},"131":{"start":{"line":317,"column":4},"end":{"line":317,"column":53}},"132":{"start":{"line":318,"column":4},"end":{"line":318,"column":50}},"133":{"start":{"line":323,"column":4},"end":{"line":323,"column":51}},"134":{"start":{"line":324,"column":4},"end":{"line":324,"column":67}},"135":{"start":{"line":326,"column":4},"end":{"line":326,"column":64}},"136":{"start":{"line":328,"column":4},"end":{"line":329,"column":54}},"137":{"start":{"line":330,"column":4},"end":{"line":330,"column":31}},"138":{"start":{"line":332,"column":20},"end":{"line":332,"column":63}},"139":{"start":{"line":344,"column":2},"end":{"line":344,"column":54}},"140":{"start":{"line":345,"column":2},"end":{"line":345,"column":45}},"141":{"start":{"line":347,"column":2},"end":{"line":356,"column":3}},"142":{"start":{"line":350,"column":3},"end":{"line":350,"column":47}},"143":{"start":{"line":351,"column":3},"end":{"line":355,"column":4}},"144":{"start":{"line":352,"column":4},"end":{"line":352,"column":76}},"145":{"start":{"line":354,"column":4},"end":{"line":354,"column":14}},"146":{"start":{"line":358,"column":2},"end":{"line":364,"column":3}},"147":{"start":{"line":359,"column":3},"end":{"line":363,"column":7}},"148":{"start":{"line":359,"column":44},"end":{"line":359,"column":81}},"149":{"start":{"line":361,"column":5},"end":{"line":361,"column":50}},"150":{"start":{"line":362,"column":5},"end":{"line":362,"column":15}},"151":{"start":{"line":366,"column":2},"end":{"line":366,"column":46}},"152":{"start":{"line":367,"column":2},"end":{"line":367,"column":12}},"153":{"start":{"line":377,"column":2},"end":{"line":377,"column":47}},"154":{"start":{"line":378,"column":2},"end":{"line":378,"column":61}},"155":{"start":{"line":379,"column":2},"end":{"line":379,"column":65}},"156":{"start":{"line":381,"column":2},"end":{"line":381,"column":34}},"157":{"start":{"line":382,"column":2},"end":{"line":382,"column":56}},"158":{"start":{"line":383,"column":2},"end":{"line":383,"column":43}},"159":{"start":{"line":386,"column":2},"end":{"line":386,"column":47}},"160":{"start":{"line":387,"column":2},"end":{"line":387,"column":52}},"161":{"start":{"line":388,"column":2},"end":{"line":388,"column":54}},"162":{"start":{"line":389,"column":2},"end":{"line":389,"column":56}},"163":{"start":{"line":390,"column":2},"end":{"line":390,"column":53}},"164":{"start":{"line":391,"column":2},"end":{"line":391,"column":57}},"165":{"start":{"line":394,"column":2},"end":{"line":394,"column":49}},"166":{"start":{"line":395,"column":2},"end":{"line":395,"column":48}},"167":{"start":{"line":398,"column":2},"end":{"line":399,"column":57}},"168":{"start":{"line":399,"column":9},"end":{"line":399,"column":56}},"169":{"start":{"line":400,"column":2},"end":{"line":401,"column":77}},"170":{"start":{"line":401,"column":19},"end":{"line":401,"column":76}},"171":{"start":{"line":403,"column":2},"end":{"line":403,"column":41}},"172":{"start":{"line":411,"column":2},"end":{"line":413,"column":3}},"173":{"start":{"line":412,"column":3},"end":{"line":412,"column":10}},"174":{"start":{"line":414,"column":2},"end":{"line":414,"column":25}},"175":{"start":{"line":416,"column":2},"end":{"line":416,"column":54}},"176":{"start":{"line":417,"column":2},"end":{"line":417,"column":54}},"177":{"start":{"line":419,"column":2},"end":{"line":428,"column":3}},"178":{"start":{"line":420,"column":3},"end":{"line":422,"column":6}},"179":{"start":{"line":423,"column":3},"end":{"line":423,"column":44}},"180":{"start":{"line":424,"column":3},"end":{"line":424,"column":55}},"181":{"start":{"line":425,"column":3},"end":{"line":425,"column":27}},"182":{"start":{"line":426,"column":3},"end":{"line":426,"column":19}},"183":{"start":{"line":427,"column":3},"end":{"line":427,"column":10}},"184":{"start":{"line":430,"column":2},"end":{"line":435,"column":3}},"185":{"start":{"line":431,"column":3},"end":{"line":431,"column":51}},"186":{"start":{"line":432,"column":3},"end":{"line":432,"column":27}},"187":{"start":{"line":433,"column":3},"end":{"line":433,"column":36}},"188":{"start":{"line":434,"column":3},"end":{"line":434,"column":10}},"189":{"start":{"line":437,"column":2},"end":{"line":440,"column":4}},"190":{"start":{"line":441,"column":2},"end":{"line":443,"column":3}},"191":{"start":{"line":442,"column":3},"end":{"line":442,"column":59}},"192":{"start":{"line":444,"column":2},"end":{"line":444,"column":35}},"193":{"start":{"line":445,"column":2},"end":{"line":445,"column":39}},"194":{"start":{"line":447,"column":2},"end":{"line":450,"column":3}},"195":{"start":{"line":448,"column":3},"end":{"line":448,"column":32}},"196":{"start":{"line":449,"column":3},"end":{"line":449,"column":26}},"197":{"start":{"line":458,"column":0},"end":{"line":460,"column":1}},"198":{"start":{"line":459,"column":1},"end":{"line":459,"column":13}},"199":{"start":{"line":466,"column":0},"end":{"line":468,"column":1}},"200":{"start":{"line":467,"column":1},"end":{"line":467,"column":30}},"201":{"start":{"line":474,"column":0},"end":{"line":476,"column":1}},"202":{"start":{"line":475,"column":1},"end":{"line":475,"column":11}},"203":{"start":{"line":478,"column":0},"end":{"line":478,"column":35}}},"branchMap":{"1":{"line":93,"type":"if","locations":[{"start":{"line":93,"column":2},"end":{"line":93,"column":2}},{"start":{"line":93,"column":2},"end":{"line":93,"column":2}}]},"2":{"line":93,"type":"binary-expr","locations":[{"start":{"line":93,"column":6},"end":{"line":93,"column":22}},{"start":{"line":93,"column":26},"end":{"line":93,"column":58}}]},"3":{"line":101,"type":"if","locations":[{"start":{"line":101,"column":2},"end":{"line":101,"column":2}},{"start":{"line":101,"column":2},"end":{"line":101,"column":2}}]},"4":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":2},"end":{"line":115,"column":2}},{"start":{"line":115,"column":2},"end":{"line":115,"column":2}}]},"5":{"line":119,"type":"if","locations":[{"start":{"line":119,"column":2},"end":{"line":119,"column":2}},{"start":{"line":119,"column":2},"end":{"line":119,"column":2}}]},"6":{"line":121,"type":"cond-expr","locations":[{"start":{"line":121,"column":25},"end":{"line":121,"column":54}},{"start":{"line":121,"column":57},"end":{"line":121,"column":61}}]},"7":{"line":128,"type":"if","locations":[{"start":{"line":128,"column":2},"end":{"line":128,"column":2}},{"start":{"line":128,"column":2},"end":{"line":128,"column":2}}]},"8":{"line":129,"type":"if","locations":[{"start":{"line":129,"column":3},"end":{"line":129,"column":3}},{"start":{"line":129,"column":3},"end":{"line":129,"column":3}}]},"9":{"line":133,"type":"if","locations":[{"start":{"line":133,"column":9},"end":{"line":133,"column":9}},{"start":{"line":133,"column":9},"end":{"line":133,"column":9}}]},"10":{"line":134,"type":"if","locations":[{"start":{"line":134,"column":3},"end":{"line":134,"column":3}},{"start":{"line":134,"column":3},"end":{"line":134,"column":3}}]},"11":{"line":134,"type":"binary-expr","locations":[{"start":{"line":134,"column":7},"end":{"line":134,"column":35}},{"start":{"line":135,"column":4},"end":{"line":135,"column":44}}]},"12":{"line":142,"type":"if","locations":[{"start":{"line":142,"column":2},"end":{"line":142,"column":2}},{"start":{"line":142,"column":2},"end":{"line":142,"column":2}}]},"13":{"line":153,"type":"if","locations":[{"start":{"line":153,"column":4},"end":{"line":153,"column":4}},{"start":{"line":153,"column":4},"end":{"line":153,"column":4}}]},"14":{"line":166,"type":"if","locations":[{"start":{"line":166,"column":2},"end":{"line":166,"column":2}},{"start":{"line":166,"column":2},"end":{"line":166,"column":2}}]},"15":{"line":171,"type":"if","locations":[{"start":{"line":171,"column":2},"end":{"line":171,"column":2}},{"start":{"line":171,"column":2},"end":{"line":171,"column":2}}]},"16":{"line":171,"type":"binary-expr","locations":[{"start":{"line":171,"column":6},"end":{"line":171,"column":35}},{"start":{"line":171,"column":39},"end":{"line":171,"column":55}}]},"17":{"line":180,"type":"if","locations":[{"start":{"line":180,"column":3},"end":{"line":180,"column":3}},{"start":{"line":180,"column":3},"end":{"line":180,"column":3}}]},"18":{"line":186,"type":"if","locations":[{"start":{"line":186,"column":3},"end":{"line":186,"column":3}},{"start":{"line":186,"column":3},"end":{"line":186,"column":3}}]},"19":{"line":192,"type":"if","locations":[{"start":{"line":192,"column":3},"end":{"line":192,"column":3}},{"start":{"line":192,"column":3},"end":{"line":192,"column":3}}]},"20":{"line":199,"type":"if","locations":[{"start":{"line":199,"column":3},"end":{"line":199,"column":3}},{"start":{"line":199,"column":3},"end":{"line":199,"column":3}}]},"21":{"line":213,"type":"if","locations":[{"start":{"line":213,"column":2},"end":{"line":213,"column":2}},{"start":{"line":213,"column":2},"end":{"line":213,"column":2}}]},"22":{"line":220,"type":"if","locations":[{"start":{"line":220,"column":2},"end":{"line":220,"column":2}},{"start":{"line":220,"column":2},"end":{"line":220,"column":2}}]},"23":{"line":220,"type":"binary-expr","locations":[{"start":{"line":220,"column":6},"end":{"line":220,"column":38}},{"start":{"line":220,"column":42},"end":{"line":220,"column":71}}]},"24":{"line":244,"type":"switch","locations":[{"start":{"line":245,"column":4},"end":{"line":249,"column":11}},{"start":{"line":250,"column":4},"end":{"line":256,"column":11}},{"start":{"line":257,"column":4},"end":{"line":257,"column":63}},{"start":{"line":258,"column":4},"end":{"line":258,"column":63}},{"start":{"line":259,"column":4},"end":{"line":264,"column":11}},{"start":{"line":265,"column":4},"end":{"line":267,"column":11}},{"start":{"line":268,"column":4},"end":{"line":269,"column":16}},{"start":{"line":270,"column":4},"end":{"line":271,"column":17}}]},"25":{"line":286,"type":"if","locations":[{"start":{"line":286,"column":2},"end":{"line":286,"column":2}},{"start":{"line":286,"column":2},"end":{"line":286,"column":2}}]},"26":{"line":317,"type":"binary-expr","locations":[{"start":{"line":317,"column":18},"end":{"line":317,"column":29}},{"start":{"line":317,"column":33},"end":{"line":317,"column":52}}]},"27":{"line":328,"type":"cond-expr","locations":[{"start":{"line":329,"column":5},"end":{"line":329,"column":48}},{"start":{"line":329,"column":51},"end":{"line":329,"column":53}}]},"28":{"line":328,"type":"binary-expr","locations":[{"start":{"line":328,"column":25},"end":{"line":328,"column":36}},{"start":{"line":328,"column":40},"end":{"line":328,"column":47}}]},"29":{"line":347,"type":"if","locations":[{"start":{"line":347,"column":2},"end":{"line":347,"column":2}},{"start":{"line":347,"column":2},"end":{"line":347,"column":2}}]},"30":{"line":347,"type":"binary-expr","locations":[{"start":{"line":347,"column":6},"end":{"line":347,"column":16}},{"start":{"line":347,"column":20},"end":{"line":347,"column":42}},{"start":{"line":348,"column":3},"end":{"line":348,"column":52}},{"start":{"line":349,"column":3},"end":{"line":349,"column":48}}]},"31":{"line":358,"type":"if","locations":[{"start":{"line":358,"column":2},"end":{"line":358,"column":2}},{"start":{"line":358,"column":2},"end":{"line":358,"column":2}}]},"32":{"line":411,"type":"if","locations":[{"start":{"line":411,"column":2},"end":{"line":411,"column":2}},{"start":{"line":411,"column":2},"end":{"line":411,"column":2}}]},"33":{"line":419,"type":"if","locations":[{"start":{"line":419,"column":2},"end":{"line":419,"column":2}},{"start":{"line":419,"column":2},"end":{"line":419,"column":2}}]},"34":{"line":430,"type":"if","locations":[{"start":{"line":430,"column":2},"end":{"line":430,"column":2}},{"start":{"line":430,"column":2},"end":{"line":430,"column":2}}]},"35":{"line":441,"type":"if","locations":[{"start":{"line":441,"column":2},"end":{"line":441,"column":2}},{"start":{"line":441,"column":2},"end":{"line":441,"column":2}}]},"36":{"line":447,"type":"if","locations":[{"start":{"line":447,"column":2},"end":{"line":447,"column":2}},{"start":{"line":447,"column":2},"end":{"line":447,"column":2}}]}},"code":["'use strict';","","const stream = require('stream');","const entities = require('entities');","const moduleHelper = require('../helpers/moduleHelper');","const hrTimeHelper = require('../helpers/hrTimeHelper');","const errorHelper = require('../helpers/errorHelper');","const HTMLTagTokenizer = require('./../tokenizers/HTMLTagTokenizer');","const tagTokenizer = new HTMLTagTokenizer();","const HTMLTokenizer = require('./../tokenizers/HTMLTokenizer');","const tokenizer = new HTMLTokenizer();","","const BODY_TAG = 'body';","const CONTENT_TYPE = 'text/html; charset=utf-8';","const POWERED_BY = 'Catberry';","","const HTML_ENTITY_REFERENCE_REGEXP = /\\&#?\\w+;/ig;","","class ComponentReadable extends stream.Readable {","","\t/**","\t * Creates a new instance of the parser duplex stream.","\t * @param {Object} context Rendering parameters.","\t * @param {Object?} options Stream options.","\t */","\tconstructor(context, options) {","\t\tsuper(options);","","\t\t/**","\t\t * Current rendering context.","\t\t * @type {Object}","\t\t * @private","\t\t */","\t\tthis._context = context;","","\t\t/**","\t\t * Current queue of found tags.","\t\t * @type {Array}","\t\t * @private","\t\t */","\t\tthis._tokenQueue = [];","","\t\t/**","\t\t * Current promise if tag is processing asynchronously.","\t\t * @type {Promise}","\t\t * @private","\t\t */","\t\tthis._processingFoundTagPromise = null;","","\t\t/**","\t\t * Current HTML delayed for response.","\t\t * @type {string}","\t\t * @private","\t\t */","\t\tthis._delayedHTML = '';","","\t\t/**","\t\t * Is delayed HTML flushed to the response.","\t\t * @type {boolean}","\t\t * @private","\t\t */","\t\tthis._isFlushed = false;","","\t\t/**","\t\t * Is rendering process canceled.","\t\t * @type {boolean}","\t\t * @private","\t\t */","\t\tthis._isCanceled = false;","\t}","","\t/**","\t * Handles the HTML from found tag handler.","\t * @param {string} html HTML.","\t */","\trenderHTML(html) {","\t\ttokenizer.setHTMLString(html);","\t\tconst queue = [];","\t\tvar tokenDescriptor;","\t\twhile ((tokenDescriptor = tokenizer.next()).value !== null) {","\t\t\tqueue.push(tokenDescriptor);","\t\t}","\t\tthis._tokenQueue = queue.concat(this._tokenQueue);","\t\tthis._processingFoundTagPromise = null;","\t\tthis.read(0);","\t}","","\t/**","\t * Starts rendering the document template.","\t */","\trenderDocument() {","\t\t// if we did not render anything then start from root template","\t\tif (this._isCanceled || this._context.isDocumentRendered) {","\t\t\treturn;","\t\t}","\t\tthis._processingFoundTagPromise = this._foundComponentHandler({","\t\t\tname: moduleHelper.DOCUMENT_COMPONENT_NAME,","\t\t\tattributes: Object.create(null)","\t\t});","","\t\tif (this._processingFoundTagPromise) {","\t\t\tthis._processingFoundTagPromise = this._processingFoundTagPromise","\t\t\t\t.then(html => this.renderHTML(html));","\t\t}","\t}","","\t/**","\t * Handles found component tags.","\t * @param {Object} tagDetails Object with tag details.","\t * @returns {Promise<string>|null} Replacement stream of HTML.","\t * @private","\t */","\t/* eslint complexity: 0 */","\t_foundComponentHandler(tagDetails) {","\t\tif (this._isCanceled) {","\t\t\treturn null;","\t\t}","","\t\tif (tagDetails.name === BODY_TAG) {","\t\t\tconst inlineScript = this._context.routingContext.getInlineScript();","\t\t\treturn inlineScript ? Promise.resolve(inlineScript) : null;","\t\t}","","\t\tconst componentName = moduleHelper.getOriginalComponentName(tagDetails.name);","\t\tconst isDocument = moduleHelper.isDocumentComponent(tagDetails.name);","\t\tconst isHead = moduleHelper.isHeadComponent(tagDetails.name);","","\t\tif (isDocument) {","\t\t\tif (this._context.isDocumentRendered) {","\t\t\t\treturn null;","\t\t\t}","\t\t\tthis._context.isDocumentRendered = true;","\t\t} else if (isHead) {","\t\t\tif (this._context.isHeadRendered ||","\t\t\t\t!this._context.components[componentName]) {","\t\t\t\treturn null;","\t\t\t}","\t\t\tthis._context.isHeadRendered = true;","\t\t}","","\t\tconst component = this._context.components[componentName];","\t\tif (!component) {","\t\t\treturn null;","\t\t}","","\t\tconst componentContext = Object.create(this._context);","","\t\tcomponentContext.currentComponent = component;","\t\tcomponentContext.currentAttributes = tagDetails.attributes;","","\t\treturn this._renderComponent(componentContext)","\t\t\t.then(html => {","\t\t\t\tif (!isDocument) {","\t\t\t\t\tthis._initializeResponse();","\t\t\t\t}","\t\t\t\treturn html;","\t\t\t});","\t}","","\t/**","\t * Reads the next chunk of data from this stream.","\t * @private","\t */","\t/* jshint maxcomplexity:false */","\t_read() {","\t\tif (this._processingFoundTagPromise) {","\t\t\tthis.push('');","\t\t\treturn;","\t\t}","","\t\tif (this._tokenQueue.length === 0 || this._isCanceled) {","\t\t\tthis.push(null);","\t\t\treturn;","\t\t}","","\t\tvar toPush = '';","\t\twhile (this._tokenQueue.length > 0) {","\t\t\tconst tokenItem = this._tokenQueue.shift();","","\t\t\tif (tokenItem.state !== HTMLTokenizer.STATES.COMPONENT) {","\t\t\t\ttoPush += tokenItem.value;","\t\t\t\tcontinue;","\t\t\t}","","\t\t\tconst tagDetails = this._parseTag(tokenItem.value);","\t\t\tif (!tagDetails) {","\t\t\t\ttoPush += tokenItem.value;","\t\t\t\tcontinue;","\t\t\t}","\t\t\tconst processingPromise = this._foundComponentHandler(tagDetails);","","\t\t\tif (!processingPromise) {","\t\t\t\ttoPush += tokenItem.value;","\t\t\t\tcontinue;","\t\t\t}","","\t\t\t// we should open self-closed component tags","\t\t\t// to set content into them","\t\t\tif (tagDetails.isSelfClosed) {","\t\t\t\ttokenItem.value = tokenItem.value.replace(/\\/\\w*>$/, '>');","\t\t\t\tthis._tokenQueue.unshift({","\t\t\t\t\ttoken: HTMLTokenizer.STATES.CONTENT,","\t\t\t\t\tvalue: `</${tagDetails.name}>`","\t\t\t\t});","\t\t\t}","","\t\t\ttoPush += tokenItem.value;","","\t\t\tthis._processingFoundTagPromise = processingPromise.then(html => this.renderHTML(html));","\t\t\tbreak;","\t\t}","","\t\tif (this._isFlushed) {","\t\t\tthis.push(toPush);","\t\t\treturn;","\t\t}","","\t\tthis._delayedHTML += toPush;","","\t\tif (!this._processingFoundTagPromise && this._tokenQueue.length === 0) {","\t\t\tthis._initializeResponse();","\t\t}","\t}","","\t/**","\t * Parses the entire HTML tag.","\t * @param {string} tagString Found tag token.","\t * @returns {Object} Tag details.","\t */","\t_parseTag(tagString) {","\t\ttagTokenizer.setTagString(tagString);","\t\tconst tag = {","\t\t\tname: '',","\t\t\tattributes: Object.create(null),","\t\t\tisSelfClosed: false","\t\t};","","\t\tvar lastAttributeName = '';","\t\tvar current, currentString;","","\t\t/* eslint no-constant-condition: 0 */","\t\twhile (true) {","\t\t\tcurrent = tagTokenizer.next();","\t\t\tswitch (current.state) {","\t\t\t\tcase HTMLTagTokenizer.STATES.TAG_NAME:","\t\t\t\t\ttag.name = tagString","\t\t\t\t\t\t.substring(current.start, current.end)","\t\t\t\t\t\t.toLowerCase();","\t\t\t\t\tbreak;","\t\t\t\tcase HTMLTagTokenizer.STATES.ATTRIBUTE_NAME:","\t\t\t\t\tcurrentString = tagString","\t\t\t\t\t\t.substring(current.start, current.end)","\t\t\t\t\t\t.toLowerCase();","\t\t\t\t\ttag.attributes[currentString] = true;","\t\t\t\t\tlastAttributeName = currentString;","\t\t\t\t\tbreak;","\t\t\t\tcase HTMLTagTokenizer.STATES.ATTRIBUTE_VALUE_DOUBLE_QUOTED:","\t\t\t\tcase HTMLTagTokenizer.STATES.ATTRIBUTE_VALUE_SINGLE_QUOTED:","\t\t\t\tcase HTMLTagTokenizer.STATES.ATTRIBUTE_VALUE_UNQUOTED:","\t\t\t\t\tcurrentString = tagString","\t\t\t\t\t\t.substring(current.start, current.end)","\t\t\t\t\t\t.replace(HTML_ENTITY_REFERENCE_REGEXP, entities.decode);","\t\t\t\t\ttag.attributes[lastAttributeName] = currentString;","\t\t\t\t\tbreak;","\t\t\t\tcase HTMLTagTokenizer.STATES.SELF_CLOSING_START_TAG_STATE:","\t\t\t\t\ttag.isSelfClosed = true;","\t\t\t\t\tbreak;","\t\t\t\tcase HTMLTagTokenizer.STATES.TAG_CLOSE:","\t\t\t\t\treturn tag;","\t\t\t\tcase HTMLTagTokenizer.STATES.ILLEGAL:","\t\t\t\t\treturn null;","\t\t\t}","\t\t}","\t}","","\t/**","\t * Renders the component.","\t * @param {Object} context Component's rendering context.","\t * @returns {Promise<string>} HTML.","\t * @private","\t */","\t_renderComponent(context) {","\t\tconst locator = context.routingContext.locator;","\t\tconst component = context.currentComponent;","","\t\tif (typeof (component.constructor) !== 'function') {","\t\t\treturn Promise.resolve('');","\t\t}","","\t\tcomponent.constructor.prototype.$context = this._getComponentContext(context);","","\t\ttry {","\t\t\tcontext.instance = new component.constructor(locator);","\t\t} catch (e) {","","\t\t\treturn moduleHelper.getSafePromise(() => this._handleComponentError(context, e));","\t\t}","","\t\tcontext.instance.$context = component.constructor.prototype.$context;","","\t\tconst startTime = hrTimeHelper.get();","\t\tconst eventArgs = {","\t\t\tname: component.name,","\t\t\tcontext: context.instance.$context","\t\t};","","\t\tconst renderMethod = moduleHelper.getMethodToInvoke(context.instance, 'render');","\t\tconst isDocument = moduleHelper.isDocumentComponent(component.name);","\t\tconst isHead = moduleHelper.isHeadComponent(component.name);","","\t\tthis._context.eventBus.emit('componentRender', eventArgs);","","\t\treturn moduleHelper.getSafePromise(renderMethod)","\t\t\t// if data context has been returned","\t\t\t// then render template","\t\t\t.then(dataContext => {","\t\t\t\tdataContext = dataContext || Object.create(null);","\t\t\t\treturn component.template.render(dataContext);","\t\t\t})","\t\t\t// if template has been rendered","\t\t\t// component has been successfully rendered then return html","\t\t\t.then(html => {","\t\t\t\teventArgs.hrTime = hrTimeHelper.get(startTime);","\t\t\t\teventArgs.time = hrTimeHelper.toMilliseconds(eventArgs.hrTime);","","\t\t\t\tthis._context.eventBus.emit('componentRendered', eventArgs);","","\t\t\t\tconst inlineScript = !isDocument && !isHead ?","\t\t\t\t\tcontext.instance.$context.getInlineScript() : '';","\t\t\t\treturn inlineScript + html;","\t\t\t})","\t\t\t.catch(reason => this._handleComponentError(context, reason));","\t}","","\t/**","\t * Handles a rendering error.","\t * @param {Object} context Rendering context.","\t * @param {Error} error Rendering error.","\t * @private","\t */","\t_handleComponentError(context, error) {","\t\t// if application in debug mode then render","\t\t// error text in component","\t\tconst isRelease = Boolean(context.config.isRelease);","\t\tconst component = context.currentComponent;","","\t\tif (!isRelease && error instanceof Error &&","\t\t\t!moduleHelper.isDocumentComponent(component.name) &&","\t\t\t!moduleHelper.isHeadComponent(component.name)) {","\t\t\tthis._context.eventBus.emit('error', error);","\t\t\ttry {","\t\t\t\treturn errorHelper.prettyPrint(error, context.routingContext.userAgent);","\t\t\t} catch (e) {","\t\t\t\treturn '';","\t\t\t}","\t\t}","","\t\tif (component.errorTemplate) {","\t\t\treturn moduleHelper.getSafePromise(() => component.errorTemplate.render(error))","\t\t\t\t.catch(reason => {","\t\t\t\t\tthis._context.eventBus.emit('error', reason);","\t\t\t\t\treturn '';","\t\t\t\t});","\t\t}","","\t\tthis._context.eventBus.emit('error', error);","\t\treturn '';","\t}","","\t/**","\t * Gets the component's context using basic context.","\t * @param {Object} context Rendering context.","\t * @returns {Object} Component context.","\t * @private","\t */","\t_getComponentContext(context) {","\t\tconst attributes = context.currentAttributes;","\t\tconst storeName = attributes[moduleHelper.ATTRIBUTE_STORE];","\t\tconst componentContext = Object.create(context.routingContext);","","\t\tcomponentContext.element = null;","\t\tcomponentContext.name = context.currentComponent.name;","\t\tcomponentContext.attributes = attributes;","","\t\t// search methods","\t\tcomponentContext.getComponentById = nullStub;","\t\tcomponentContext.getComponentByElement = nullStub;","\t\tcomponentContext.getComponentsByTagName = arrayStub;","\t\tcomponentContext.getComponentsByClassName = arrayStub;","\t\tcomponentContext.queryComponentSelector = nullStub;","\t\tcomponentContext.queryComponentSelectorAll = arrayStub;","","\t\t// create/remove","\t\tcomponentContext.createComponent = promiseStub;","\t\tcomponentContext.collectGarbage = promiseStub;","","\t\t// store methods","\t\tcomponentContext.getStoreData =","\t\t\t() => context.storeDispatcher.getStoreData(storeName);","\t\tcomponentContext.sendAction =","\t\t\t(name, args) => context.storeDispatcher.sendAction(storeName, name, args);","","\t\treturn Object.freeze(componentContext);","\t}","","\t/**","\t * Initializes a HTTP response with the required code and headers.","\t * @private","\t */","\t_initializeResponse() {","\t\tif (this._isFlushed) {","\t\t\treturn;","\t\t}","\t\tthis._isFlushed = true;","","\t\tconst routingContext = this._context.routingContext;","\t\tconst response = routingContext.middleware.response;","","\t\tif (routingContext.actions.redirectedTo) {","\t\t\tresponse.writeHead(routingContext.actions.redirectionStatusCode, {","\t\t\t\tLocation: routingContext.actions.redirectedTo","\t\t\t});","\t\t\troutingContext.actions.redirectedTo = '';","\t\t\troutingContext.actions.redirectionStatusCode = null;","\t\t\tthis._isCanceled = true;","\t\t\tthis.push(null);","\t\t\treturn;","\t\t}","","\t\tif (routingContext.actions.isNotFoundCalled) {","\t\t\troutingContext.actions.isNotFoundCalled = false;","\t\t\tthis._isCanceled = true;","\t\t\troutingContext.middleware.next();","\t\t\treturn;","\t\t}","","\t\tconst headers = {","\t\t\t'Content-Type': CONTENT_TYPE,","\t\t\t'X-Powered-By': POWERED_BY","\t\t};","\t\tif (routingContext.cookie.setCookie.length > 0) {","\t\t\theaders['Set-Cookie'] = routingContext.cookie.setCookie;","\t\t}","\t\tresponse.writeHead(200, headers);","\t\troutingContext.cookie.setCookie = [];","","\t\tif (this._delayedHTML) {","\t\t\tthis.push(this._delayedHTML);","\t\t\tthis._delayedHTML = '';","\t\t}","\t}","}","","/**"," * Does nothing as a stub method."," * @returns {null} Always null."," */","function nullStub() {","\treturn null;","}","","/**"," * Does nothing as a stub method."," * @returns {Promise} Always a promise for null."," */","function promiseStub() {","\treturn Promise.resolve(null);","}","","/**"," * Does nothing as a stub method."," * @returns {Array} Always an empty array."," */","function arrayStub() {","\treturn [];","}","","module.exports = ComponentReadable;",""],"l":{"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"13":1,"14":1,"15":1,"17":1,"27":0,"34":0,"41":0,"48":0,"55":0,"62":0,"69":0,"77":0,"78":0,"79":0,"80":0,"81":0,"83":0,"84":0,"85":0,"93":0,"94":0,"96":0,"101":0,"102":0,"103":0,"115":0,"116":0,"119":0,"120":0,"121":0,"124":0,"125":0,"126":0,"128":0,"129":0,"130":0,"132":0,"133":0,"134":0,"136":0,"138":0,"141":0,"142":0,"143":0,"146":0,"148":0,"149":0,"151":0,"153":0,"154":0,"156":0,"166":0,"167":0,"168":0,"171":0,"172":0,"173":0,"176":0,"177":0,"178":0,"180":0,"181":0,"182":0,"185":0,"186":0,"187":0,"188":0,"190":0,"192":0,"193":0,"194":0,"199":0,"200":0,"201":0,"207":0,"209":0,"210":0,"213":0,"214":0,"215":0,"218":0,"220":0,"221":0,"231":0,"232":0,"238":0,"239":0,"242":0,"243":0,"244":0,"246":0,"249":0,"251":0,"254":0,"255":0,"256":0,"260":0,"263":0,"264":0,"266":0,"267":0,"269":0,"271":0,"283":0,"284":0,"286":0,"287":0,"290":0,"292":0,"293":0,"296":0,"299":0,"301":0,"302":0,"307":0,"308":0,"309":0,"311":0,"313":0,"317":0,"318":0,"323":0,"324":0,"326":0,"328":0,"330":0,"332":0,"344":0,"345":0,"347":0,"350":0,"351":0,"352":0,"354":0,"358":0,"359":0,"361":0,"362":0,"366":0,"367":0,"377":0,"378":0,"379":0,"381":0,"382":0,"383":0,"386":0,"387":0,"388":0,"389":0,"390":0,"391":0,"394":0,"395":0,"398":0,"399":0,"400":0,"401":0,"403":0,"411":0,"412":0,"414":0,"416":0,"417":0,"419":0,"420":0,"423":0,"424":0,"425":0,"426":0,"427":0,"430":0,"431":0,"432":0,"433":0,"434":0,"437":0,"441":0,"442":0,"444":0,"445":0,"447":0,"448":0,"449":0,"458":1,"459":0,"466":1,"467":0,"474":1,"475":0,"478":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/helpers/errorHelper.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/helpers/errorHelper.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":1,"7":0,"8":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"escape","line":41,"loc":{"start":{"line":41,"column":0},"end":{"line":41,"column":23}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":57}},"2":{"start":{"line":5,"column":0},"end":{"line":34,"column":2}},"3":{"start":{"line":14,"column":2},"end":{"line":16,"column":3}},"4":{"start":{"line":15,"column":3},"end":{"line":15,"column":13}},"5":{"start":{"line":17,"column":2},"end":{"line":32,"column":2}},"6":{"start":{"line":41,"column":0},"end":{"line":50,"column":1}},"7":{"start":{"line":42,"column":1},"end":{"line":42,"column":29}},"8":{"start":{"line":43,"column":1},"end":{"line":49,"column":30}}},"branchMap":{"1":{"line":14,"type":"if","locations":[{"start":{"line":14,"column":2},"end":{"line":14,"column":2}},{"start":{"line":14,"column":2},"end":{"line":14,"column":2}}]},"2":{"line":14,"type":"binary-expr","locations":[{"start":{"line":14,"column":6},"end":{"line":14,"column":12}},{"start":{"line":14,"column":16},"end":{"line":14,"column":43}}]},"3":{"line":20,"type":"binary-expr","locations":[{"start":{"line":20,"column":3},"end":{"line":20,"column":12}},{"start":{"line":20,"column":16},"end":{"line":20,"column":33}}]},"4":{"line":42,"type":"binary-expr","locations":[{"start":{"line":42,"column":16},"end":{"line":42,"column":21}},{"start":{"line":42,"column":25},"end":{"line":42,"column":27}}]}},"code":["'use strict';","","const ERROR_MESSAGE_REGEXP = /^(?:[\\w$]+): (?:.+)\\r?\\n/i;","","module.exports = {","","\t/**","\t * Prints an error with pretty formatting.","\t * @param {Error} error The error to print.","\t * @param {string} userAgent The user agent information.","\t * @returns {string} HTML text with all information about the error.","\t */","\tprettyPrint: (error, userAgent) => {","\t\tif (!error || typeof (error) !== 'object') {","\t\t\treturn '';","\t\t}","\t\treturn `","<div style=\"background-color: white; font-size: 12pt;\">","\t${(new Date()).toUTCString()};<br/>","\t${userAgent || 'Unknown browser'};<br/>","\tCatberry@9.0.0 (","\t<a href=\"https://github.com/catberry/catberry/issues\" target=\"_blank\">","\t\treport an issue","\t</a>)","\t<br/><br/>","\t<span style=\"color: red; font-size: 16pt; font-weight: bold;\">","\t\t${escape(error.name)}: ${escape(error.message)}","\t</span>","\t<br/><br/>","\t${escape(error.stack).replace(ERROR_MESSAGE_REGEXP, '')}","</div>","`;","\t}","};","","/**"," * Escapes the error text."," * @param {string} value The error text to escape."," * @returns {string} The escaped and formatted string."," */","function escape(value) {","\tvalue = String(value || '');","\treturn value","\t\t.replace(/&/g, '&amp;')","\t\t.replace(/</g, '&lt;')","\t\t.replace(/>/g, '&gt;')","\t\t.replace(/\\\"/g, '&quot;')","\t\t.replace(/\\'/g, '&#39;')","\t\t.replace(/\\r?\\n/g, '<br/>');","}",""],"l":{"3":1,"5":1,"14":0,"15":0,"17":0,"41":1,"42":0,"43":0}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/tokenizers/HTMLTagTokenizer.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/tokenizers/HTMLTagTokenizer.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":1},"b":{"1":[0,0,0,0,0,0,0,0,0,0,0,0,0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0,0,0,0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0,0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0,0,0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0,0,0,0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0,0,0,0],"37":[0,0],"38":[0,0],"39":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},"fnMap":{"1":{"name":"(anonymous_1)","line":31,"loc":{"start":{"line":31,"column":12},"end":{"line":31,"column":15}}},"2":{"name":"(anonymous_2)","line":65,"loc":{"start":{"line":65,"column":18},"end":{"line":65,"column":21}}},"3":{"name":"(anonymous_3)","line":73,"loc":{"start":{"line":73,"column":13},"end":{"line":73,"column":23}}},"4":{"name":"(anonymous_4)","line":85,"loc":{"start":{"line":85,"column":5},"end":{"line":85,"column":8}}},"5":{"name":"(anonymous_5)","line":147,"loc":{"start":{"line":147,"column":15},"end":{"line":147,"column":18}}},"6":{"name":"(anonymous_6)","line":159,"loc":{"start":{"line":159,"column":13},"end":{"line":159,"column":16}}},"7":{"name":"(anonymous_7)","line":177,"loc":{"start":{"line":177,"column":13},"end":{"line":177,"column":16}}},"8":{"name":"(anonymous_8)","line":212,"loc":{"start":{"line":212,"column":25},"end":{"line":212,"column":28}}},"9":{"name":"(anonymous_9)","line":227,"loc":{"start":{"line":227,"column":25},"end":{"line":227,"column":28}}},"10":{"name":"(anonymous_10)","line":258,"loc":{"start":{"line":258,"column":19},"end":{"line":258,"column":22}}},"11":{"name":"(anonymous_11)","line":302,"loc":{"start":{"line":302,"column":24},"end":{"line":302,"column":27}}},"12":{"name":"(anonymous_12)","line":336,"loc":{"start":{"line":336,"column":26},"end":{"line":336,"column":29}}},"13":{"name":"(anonymous_13)","line":373,"loc":{"start":{"line":373,"column":32},"end":{"line":373,"column":35}}},"14":{"name":"(anonymous_14)","line":399,"loc":{"start":{"line":399,"column":32},"end":{"line":399,"column":35}}},"15":{"name":"(anonymous_15)","line":425,"loc":{"start":{"line":425,"column":28},"end":{"line":425,"column":31}}},"16":{"name":"(anonymous_16)","line":462,"loc":{"start":{"line":462,"column":31},"end":{"line":462,"column":34}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":18,"column":2}},"2":{"start":{"line":19,"column":0},"end":{"line":19,"column":22}},"3":{"start":{"line":21,"column":0},"end":{"line":21,"column":61}},"4":{"start":{"line":22,"column":0},"end":{"line":22,"column":36}},"5":{"start":{"line":38,"column":2},"end":{"line":38,"column":20}},"6":{"start":{"line":45,"column":2},"end":{"line":45,"column":25}},"7":{"start":{"line":52,"column":2},"end":{"line":52,"column":23}},"8":{"start":{"line":59,"column":2},"end":{"line":59,"column":33}},"9":{"start":{"line":66,"column":2},"end":{"line":66,"column":16}},"10":{"start":{"line":74,"column":2},"end":{"line":74,"column":25}},"11":{"start":{"line":75,"column":2},"end":{"line":75,"column":25}},"12":{"start":{"line":76,"column":2},"end":{"line":76,"column":23}},"13":{"start":{"line":77,"column":2},"end":{"line":77,"column":33}},"14":{"start":{"line":86,"column":2},"end":{"line":86,"column":35}},"15":{"start":{"line":87,"column":2},"end":{"line":87,"column":35}},"16":{"start":{"line":89,"column":2},"end":{"line":135,"column":3}},"17":{"start":{"line":91,"column":4},"end":{"line":91,"column":24}},"18":{"start":{"line":92,"column":4},"end":{"line":92,"column":10}},"19":{"start":{"line":94,"column":4},"end":{"line":94,"column":24}},"20":{"start":{"line":95,"column":4},"end":{"line":95,"column":10}},"21":{"start":{"line":97,"column":4},"end":{"line":97,"column":36}},"22":{"start":{"line":98,"column":4},"end":{"line":98,"column":10}},"23":{"start":{"line":100,"column":4},"end":{"line":100,"column":36}},"24":{"start":{"line":101,"column":4},"end":{"line":101,"column":10}},"25":{"start":{"line":103,"column":4},"end":{"line":103,"column":30}},"26":{"start":{"line":104,"column":4},"end":{"line":104,"column":10}},"27":{"start":{"line":106,"column":4},"end":{"line":106,"column":35}},"28":{"start":{"line":107,"column":4},"end":{"line":107,"column":10}},"29":{"start":{"line":109,"column":4},"end":{"line":109,"column":37}},"30":{"start":{"line":110,"column":4},"end":{"line":110,"column":10}},"31":{"start":{"line":112,"column":4},"end":{"line":112,"column":43}},"32":{"start":{"line":113,"column":4},"end":{"line":113,"column":10}},"33":{"start":{"line":115,"column":4},"end":{"line":115,"column":43}},"34":{"start":{"line":116,"column":4},"end":{"line":116,"column":10}},"35":{"start":{"line":118,"column":4},"end":{"line":118,"column":39}},"36":{"start":{"line":119,"column":4},"end":{"line":119,"column":10}},"37":{"start":{"line":121,"column":4},"end":{"line":121,"column":42}},"38":{"start":{"line":122,"column":4},"end":{"line":122,"column":10}},"39":{"start":{"line":125,"column":4},"end":{"line":129,"column":6}},"40":{"start":{"line":131,"column":4},"end":{"line":133,"column":20}},"41":{"start":{"line":134,"column":4},"end":{"line":134,"column":23}},"42":{"start":{"line":137,"column":2},"end":{"line":141,"column":4}},"43":{"start":{"line":148,"column":2},"end":{"line":153,"column":3}},"44":{"start":{"line":152,"column":3},"end":{"line":152,"column":24}},"45":{"start":{"line":160,"column":2},"end":{"line":160,"column":23}},"46":{"start":{"line":161,"column":2},"end":{"line":161,"column":40}},"47":{"start":{"line":162,"column":2},"end":{"line":162,"column":48}},"48":{"start":{"line":164,"column":2},"end":{"line":167,"column":3}},"49":{"start":{"line":165,"column":3},"end":{"line":165,"column":40}},"50":{"start":{"line":166,"column":3},"end":{"line":166,"column":10}},"51":{"start":{"line":171,"column":2},"end":{"line":171,"column":38}},"52":{"start":{"line":178,"column":2},"end":{"line":178,"column":23}},"53":{"start":{"line":179,"column":2},"end":{"line":179,"column":40}},"54":{"start":{"line":180,"column":2},"end":{"line":204,"column":3}},"55":{"start":{"line":181,"column":3},"end":{"line":181,"column":49}},"56":{"start":{"line":182,"column":3},"end":{"line":185,"column":4}},"57":{"start":{"line":183,"column":4},"end":{"line":183,"column":54}},"58":{"start":{"line":184,"column":4},"end":{"line":184,"column":11}},"59":{"start":{"line":187,"column":3},"end":{"line":190,"column":4}},"60":{"start":{"line":188,"column":4},"end":{"line":188,"column":61}},"61":{"start":{"line":189,"column":4},"end":{"line":189,"column":11}},"62":{"start":{"line":192,"column":3},"end":{"line":195,"column":4}},"63":{"start":{"line":193,"column":4},"end":{"line":193,"column":42}},"64":{"start":{"line":194,"column":4},"end":{"line":194,"column":11}},"65":{"start":{"line":197,"column":3},"end":{"line":200,"column":4}},"66":{"start":{"line":198,"column":4},"end":{"line":198,"column":40}},"67":{"start":{"line":199,"column":4},"end":{"line":199,"column":11}},"68":{"start":{"line":202,"column":3},"end":{"line":202,"column":24}},"69":{"start":{"line":203,"column":3},"end":{"line":203,"column":41}},"70":{"start":{"line":206,"column":2},"end":{"line":206,"column":38}},"71":{"start":{"line":213,"column":2},"end":{"line":213,"column":23}},"72":{"start":{"line":214,"column":2},"end":{"line":214,"column":40}},"73":{"start":{"line":215,"column":2},"end":{"line":215,"column":48}},"74":{"start":{"line":216,"column":2},"end":{"line":219,"column":3}},"75":{"start":{"line":217,"column":3},"end":{"line":217,"column":41}},"76":{"start":{"line":218,"column":3},"end":{"line":218,"column":10}},"77":{"start":{"line":221,"column":2},"end":{"line":221,"column":38}},"78":{"start":{"line":228,"column":2},"end":{"line":228,"column":23}},"79":{"start":{"line":229,"column":2},"end":{"line":229,"column":24}},"80":{"start":{"line":230,"column":2},"end":{"line":230,"column":40}},"81":{"start":{"line":232,"column":2},"end":{"line":232,"column":48}},"82":{"start":{"line":233,"column":2},"end":{"line":236,"column":3}},"83":{"start":{"line":234,"column":3},"end":{"line":234,"column":60}},"84":{"start":{"line":235,"column":3},"end":{"line":235,"column":10}},"85":{"start":{"line":237,"column":2},"end":{"line":240,"column":3}},"86":{"start":{"line":238,"column":3},"end":{"line":238,"column":41}},"87":{"start":{"line":239,"column":3},"end":{"line":239,"column":10}},"88":{"start":{"line":242,"column":2},"end":{"line":250,"column":3}},"89":{"start":{"line":248,"column":3},"end":{"line":248,"column":39}},"90":{"start":{"line":249,"column":3},"end":{"line":249,"column":10}},"91":{"start":{"line":252,"column":2},"end":{"line":252,"column":45}},"92":{"start":{"line":259,"column":2},"end":{"line":259,"column":23}},"93":{"start":{"line":260,"column":2},"end":{"line":260,"column":40}},"94":{"start":{"line":262,"column":2},"end":{"line":294,"column":3}},"95":{"start":{"line":263,"column":3},"end":{"line":263,"column":49}},"96":{"start":{"line":264,"column":3},"end":{"line":267,"column":4}},"97":{"start":{"line":265,"column":4},"end":{"line":265,"column":53}},"98":{"start":{"line":266,"column":4},"end":{"line":266,"column":11}},"99":{"start":{"line":269,"column":3},"end":{"line":272,"column":4}},"100":{"start":{"line":270,"column":4},"end":{"line":270,"column":61}},"101":{"start":{"line":271,"column":4},"end":{"line":271,"column":11}},"102":{"start":{"line":274,"column":3},"end":{"line":277,"column":4}},"103":{"start":{"line":275,"column":4},"end":{"line":275,"column":55}},"104":{"start":{"line":276,"column":4},"end":{"line":276,"column":11}},"105":{"start":{"line":279,"column":3},"end":{"line":282,"column":4}},"106":{"start":{"line":280,"column":4},"end":{"line":280,"column":42}},"107":{"start":{"line":281,"column":4},"end":{"line":281,"column":11}},"108":{"start":{"line":284,"column":3},"end":{"line":290,"column":4}},"109":{"start":{"line":288,"column":4},"end":{"line":288,"column":40}},"110":{"start":{"line":289,"column":4},"end":{"line":289,"column":11}},"111":{"start":{"line":292,"column":3},"end":{"line":292,"column":24}},"112":{"start":{"line":293,"column":3},"end":{"line":293,"column":41}},"113":{"start":{"line":296,"column":2},"end":{"line":296,"column":38}},"114":{"start":{"line":303,"column":2},"end":{"line":303,"column":23}},"115":{"start":{"line":304,"column":2},"end":{"line":304,"column":24}},"116":{"start":{"line":305,"column":2},"end":{"line":305,"column":40}},"117":{"start":{"line":307,"column":2},"end":{"line":307,"column":48}},"118":{"start":{"line":308,"column":2},"end":{"line":311,"column":3}},"119":{"start":{"line":309,"column":3},"end":{"line":309,"column":60}},"120":{"start":{"line":310,"column":3},"end":{"line":310,"column":10}},"121":{"start":{"line":312,"column":2},"end":{"line":315,"column":3}},"122":{"start":{"line":313,"column":3},"end":{"line":313,"column":54}},"123":{"start":{"line":314,"column":3},"end":{"line":314,"column":10}},"124":{"start":{"line":316,"column":2},"end":{"line":319,"column":3}},"125":{"start":{"line":317,"column":3},"end":{"line":317,"column":41}},"126":{"start":{"line":318,"column":3},"end":{"line":318,"column":10}},"127":{"start":{"line":321,"column":2},"end":{"line":328,"column":3}},"128":{"start":{"line":326,"column":3},"end":{"line":326,"column":39}},"129":{"start":{"line":327,"column":3},"end":{"line":327,"column":10}},"130":{"start":{"line":330,"column":2},"end":{"line":330,"column":45}},"131":{"start":{"line":337,"column":2},"end":{"line":337,"column":23}},"132":{"start":{"line":338,"column":2},"end":{"line":338,"column":24}},"133":{"start":{"line":339,"column":2},"end":{"line":339,"column":40}},"134":{"start":{"line":341,"column":2},"end":{"line":341,"column":48}},"135":{"start":{"line":343,"column":2},"end":{"line":348,"column":3}},"136":{"start":{"line":344,"column":3},"end":{"line":344,"column":24}},"137":{"start":{"line":345,"column":3},"end":{"line":345,"column":41}},"138":{"start":{"line":346,"column":3},"end":{"line":346,"column":61}},"139":{"start":{"line":347,"column":3},"end":{"line":347,"column":10}},"140":{"start":{"line":350,"column":2},"end":{"line":355,"column":3}},"141":{"start":{"line":351,"column":3},"end":{"line":351,"column":24}},"142":{"start":{"line":352,"column":3},"end":{"line":352,"column":41}},"143":{"start":{"line":353,"column":3},"end":{"line":353,"column":61}},"144":{"start":{"line":354,"column":3},"end":{"line":354,"column":10}},"145":{"start":{"line":357,"column":2},"end":{"line":365,"column":3}},"146":{"start":{"line":363,"column":3},"end":{"line":363,"column":39}},"147":{"start":{"line":364,"column":3},"end":{"line":364,"column":10}},"148":{"start":{"line":367,"column":2},"end":{"line":367,"column":55}},"149":{"start":{"line":374,"column":2},"end":{"line":374,"column":40}},"150":{"start":{"line":376,"column":2},"end":{"line":391,"column":3}},"151":{"start":{"line":378,"column":3},"end":{"line":378,"column":49}},"152":{"start":{"line":379,"column":3},"end":{"line":382,"column":4}},"153":{"start":{"line":380,"column":4},"end":{"line":380,"column":61}},"154":{"start":{"line":381,"column":4},"end":{"line":381,"column":11}},"155":{"start":{"line":384,"column":3},"end":{"line":387,"column":4}},"156":{"start":{"line":385,"column":4},"end":{"line":385,"column":40}},"157":{"start":{"line":386,"column":4},"end":{"line":386,"column":11}},"158":{"start":{"line":389,"column":3},"end":{"line":389,"column":24}},"159":{"start":{"line":390,"column":3},"end":{"line":390,"column":41}},"160":{"start":{"line":393,"column":2},"end":{"line":393,"column":38}},"161":{"start":{"line":400,"column":2},"end":{"line":400,"column":40}},"162":{"start":{"line":402,"column":2},"end":{"line":417,"column":3}},"163":{"start":{"line":404,"column":3},"end":{"line":404,"column":49}},"164":{"start":{"line":405,"column":3},"end":{"line":408,"column":4}},"165":{"start":{"line":406,"column":4},"end":{"line":406,"column":61}},"166":{"start":{"line":407,"column":4},"end":{"line":407,"column":11}},"167":{"start":{"line":410,"column":3},"end":{"line":413,"column":4}},"168":{"start":{"line":411,"column":4},"end":{"line":411,"column":40}},"169":{"start":{"line":412,"column":4},"end":{"line":412,"column":11}},"170":{"start":{"line":415,"column":3},"end":{"line":415,"column":24}},"171":{"start":{"line":416,"column":3},"end":{"line":416,"column":41}},"172":{"start":{"line":419,"column":2},"end":{"line":419,"column":38}},"173":{"start":{"line":426,"column":2},"end":{"line":426,"column":23}},"174":{"start":{"line":427,"column":2},"end":{"line":427,"column":40}},"175":{"start":{"line":429,"column":2},"end":{"line":454,"column":3}},"176":{"start":{"line":431,"column":3},"end":{"line":431,"column":49}},"177":{"start":{"line":433,"column":3},"end":{"line":436,"column":4}},"178":{"start":{"line":434,"column":4},"end":{"line":434,"column":54}},"179":{"start":{"line":435,"column":4},"end":{"line":435,"column":11}},"180":{"start":{"line":438,"column":3},"end":{"line":441,"column":4}},"181":{"start":{"line":439,"column":4},"end":{"line":439,"column":42}},"182":{"start":{"line":440,"column":4},"end":{"line":440,"column":11}},"183":{"start":{"line":443,"column":3},"end":{"line":450,"column":4}},"184":{"start":{"line":448,"column":4},"end":{"line":448,"column":40}},"185":{"start":{"line":449,"column":4},"end":{"line":449,"column":11}},"186":{"start":{"line":452,"column":3},"end":{"line":452,"column":24}},"187":{"start":{"line":453,"column":3},"end":{"line":453,"column":41}},"188":{"start":{"line":456,"column":2},"end":{"line":456,"column":38}},"189":{"start":{"line":463,"column":2},"end":{"line":463,"column":23}},"190":{"start":{"line":464,"column":2},"end":{"line":464,"column":40}},"191":{"start":{"line":466,"column":2},"end":{"line":466,"column":48}},"192":{"start":{"line":468,"column":2},"end":{"line":471,"column":3}},"193":{"start":{"line":469,"column":3},"end":{"line":469,"column":53}},"194":{"start":{"line":470,"column":3},"end":{"line":470,"column":10}},"195":{"start":{"line":473,"column":2},"end":{"line":476,"column":3}},"196":{"start":{"line":474,"column":3},"end":{"line":474,"column":60}},"197":{"start":{"line":475,"column":3},"end":{"line":475,"column":10}},"198":{"start":{"line":478,"column":2},"end":{"line":481,"column":3}},"199":{"start":{"line":479,"column":3},"end":{"line":479,"column":41}},"200":{"start":{"line":480,"column":3},"end":{"line":480,"column":10}},"201":{"start":{"line":483,"column":2},"end":{"line":483,"column":38}},"202":{"start":{"line":487,"column":0},"end":{"line":487,"column":34}}},"branchMap":{"1":{"line":89,"type":"switch","locations":[{"start":{"line":90,"column":3},"end":{"line":92,"column":10}},{"start":{"line":93,"column":3},"end":{"line":95,"column":10}},{"start":{"line":96,"column":3},"end":{"line":98,"column":10}},{"start":{"line":99,"column":3},"end":{"line":101,"column":10}},{"start":{"line":102,"column":3},"end":{"line":104,"column":10}},{"start":{"line":105,"column":3},"end":{"line":107,"column":10}},{"start":{"line":108,"column":3},"end":{"line":110,"column":10}},{"start":{"line":111,"column":3},"end":{"line":113,"column":10}},{"start":{"line":114,"column":3},"end":{"line":116,"column":10}},{"start":{"line":117,"column":3},"end":{"line":119,"column":10}},{"start":{"line":120,"column":3},"end":{"line":122,"column":10}},{"start":{"line":123,"column":3},"end":{"line":123,"column":23}},{"start":{"line":124,"column":3},"end":{"line":129,"column":6}},{"start":{"line":130,"column":3},"end":{"line":134,"column":23}}]},"2":{"line":131,"type":"cond-expr","locations":[{"start":{"line":132,"column":5},"end":{"line":132,"column":20}},{"start":{"line":133,"column":5},"end":{"line":133,"column":19}}]},"3":{"line":149,"type":"binary-expr","locations":[{"start":{"line":149,"column":3},"end":{"line":149,"column":43}},{"start":{"line":150,"column":3},"end":{"line":150,"column":57}}]},"4":{"line":164,"type":"if","locations":[{"start":{"line":164,"column":2},"end":{"line":164,"column":2}},{"start":{"line":164,"column":2},"end":{"line":164,"column":2}}]},"5":{"line":182,"type":"if","locations":[{"start":{"line":182,"column":3},"end":{"line":182,"column":3}},{"start":{"line":182,"column":3},"end":{"line":182,"column":3}}]},"6":{"line":187,"type":"if","locations":[{"start":{"line":187,"column":3},"end":{"line":187,"column":3}},{"start":{"line":187,"column":3},"end":{"line":187,"column":3}}]},"7":{"line":192,"type":"if","locations":[{"start":{"line":192,"column":3},"end":{"line":192,"column":3}},{"start":{"line":192,"column":3},"end":{"line":192,"column":3}}]},"8":{"line":197,"type":"if","locations":[{"start":{"line":197,"column":3},"end":{"line":197,"column":3}},{"start":{"line":197,"column":3},"end":{"line":197,"column":3}}]},"9":{"line":216,"type":"if","locations":[{"start":{"line":216,"column":2},"end":{"line":216,"column":2}},{"start":{"line":216,"column":2},"end":{"line":216,"column":2}}]},"10":{"line":233,"type":"if","locations":[{"start":{"line":233,"column":2},"end":{"line":233,"column":2}},{"start":{"line":233,"column":2},"end":{"line":233,"column":2}}]},"11":{"line":237,"type":"if","locations":[{"start":{"line":237,"column":2},"end":{"line":237,"column":2}},{"start":{"line":237,"column":2},"end":{"line":237,"column":2}}]},"12":{"line":242,"type":"if","locations":[{"start":{"line":242,"column":2},"end":{"line":242,"column":2}},{"start":{"line":242,"column":2},"end":{"line":242,"column":2}}]},"13":{"line":242,"type":"binary-expr","locations":[{"start":{"line":242,"column":6},"end":{"line":242,"column":23}},{"start":{"line":243,"column":3},"end":{"line":243,"column":15}},{"start":{"line":244,"column":3},"end":{"line":244,"column":16}},{"start":{"line":245,"column":3},"end":{"line":245,"column":15}},{"start":{"line":246,"column":3},"end":{"line":246,"column":15}},{"start":{"line":247,"column":3},"end":{"line":247,"column":44}}]},"14":{"line":264,"type":"if","locations":[{"start":{"line":264,"column":3},"end":{"line":264,"column":3}},{"start":{"line":264,"column":3},"end":{"line":264,"column":3}}]},"15":{"line":269,"type":"if","locations":[{"start":{"line":269,"column":3},"end":{"line":269,"column":3}},{"start":{"line":269,"column":3},"end":{"line":269,"column":3}}]},"16":{"line":274,"type":"if","locations":[{"start":{"line":274,"column":3},"end":{"line":274,"column":3}},{"start":{"line":274,"column":3},"end":{"line":274,"column":3}}]},"17":{"line":279,"type":"if","locations":[{"start":{"line":279,"column":3},"end":{"line":279,"column":3}},{"start":{"line":279,"column":3},"end":{"line":279,"column":3}}]},"18":{"line":284,"type":"if","locations":[{"start":{"line":284,"column":3},"end":{"line":284,"column":3}},{"start":{"line":284,"column":3},"end":{"line":284,"column":3}}]},"19":{"line":284,"type":"binary-expr","locations":[{"start":{"line":284,"column":7},"end":{"line":284,"column":24}},{"start":{"line":285,"column":4},"end":{"line":285,"column":16}},{"start":{"line":286,"column":4},"end":{"line":286,"column":17}},{"start":{"line":287,"column":4},"end":{"line":287,"column":16}}]},"20":{"line":308,"type":"if","locations":[{"start":{"line":308,"column":2},"end":{"line":308,"column":2}},{"start":{"line":308,"column":2},"end":{"line":308,"column":2}}]},"21":{"line":312,"type":"if","locations":[{"start":{"line":312,"column":2},"end":{"line":312,"column":2}},{"start":{"line":312,"column":2},"end":{"line":312,"column":2}}]},"22":{"line":316,"type":"if","locations":[{"start":{"line":316,"column":2},"end":{"line":316,"column":2}},{"start":{"line":316,"column":2},"end":{"line":316,"column":2}}]},"23":{"line":321,"type":"if","locations":[{"start":{"line":321,"column":2},"end":{"line":321,"column":2}},{"start":{"line":321,"column":2},"end":{"line":321,"column":2}}]},"24":{"line":321,"type":"binary-expr","locations":[{"start":{"line":321,"column":6},"end":{"line":321,"column":23}},{"start":{"line":322,"column":3},"end":{"line":322,"column":15}},{"start":{"line":323,"column":3},"end":{"line":323,"column":16}},{"start":{"line":324,"column":3},"end":{"line":324,"column":15}},{"start":{"line":325,"column":3},"end":{"line":325,"column":44}}]},"25":{"line":343,"type":"if","locations":[{"start":{"line":343,"column":2},"end":{"line":343,"column":2}},{"start":{"line":343,"column":2},"end":{"line":343,"column":2}}]},"26":{"line":350,"type":"if","locations":[{"start":{"line":350,"column":2},"end":{"line":350,"column":2}},{"start":{"line":350,"column":2},"end":{"line":350,"column":2}}]},"27":{"line":357,"type":"if","locations":[{"start":{"line":357,"column":2},"end":{"line":357,"column":2}},{"start":{"line":357,"column":2},"end":{"line":357,"column":2}}]},"28":{"line":357,"type":"binary-expr","locations":[{"start":{"line":357,"column":6},"end":{"line":357,"column":23}},{"start":{"line":358,"column":3},"end":{"line":358,"column":15}},{"start":{"line":359,"column":3},"end":{"line":359,"column":15}},{"start":{"line":360,"column":3},"end":{"line":360,"column":15}},{"start":{"line":361,"column":3},"end":{"line":361,"column":15}},{"start":{"line":362,"column":3},"end":{"line":362,"column":44}}]},"29":{"line":379,"type":"if","locations":[{"start":{"line":379,"column":3},"end":{"line":379,"column":3}},{"start":{"line":379,"column":3},"end":{"line":379,"column":3}}]},"30":{"line":384,"type":"if","locations":[{"start":{"line":384,"column":3},"end":{"line":384,"column":3}},{"start":{"line":384,"column":3},"end":{"line":384,"column":3}}]},"31":{"line":405,"type":"if","locations":[{"start":{"line":405,"column":3},"end":{"line":405,"column":3}},{"start":{"line":405,"column":3},"end":{"line":405,"column":3}}]},"32":{"line":410,"type":"if","locations":[{"start":{"line":410,"column":3},"end":{"line":410,"column":3}},{"start":{"line":410,"column":3},"end":{"line":410,"column":3}}]},"33":{"line":433,"type":"if","locations":[{"start":{"line":433,"column":3},"end":{"line":433,"column":3}},{"start":{"line":433,"column":3},"end":{"line":433,"column":3}}]},"34":{"line":438,"type":"if","locations":[{"start":{"line":438,"column":3},"end":{"line":438,"column":3}},{"start":{"line":438,"column":3},"end":{"line":438,"column":3}}]},"35":{"line":443,"type":"if","locations":[{"start":{"line":443,"column":3},"end":{"line":443,"column":3}},{"start":{"line":443,"column":3},"end":{"line":443,"column":3}}]},"36":{"line":443,"type":"binary-expr","locations":[{"start":{"line":443,"column":7},"end":{"line":443,"column":24}},{"start":{"line":444,"column":4},"end":{"line":444,"column":17}},{"start":{"line":445,"column":4},"end":{"line":445,"column":16}},{"start":{"line":446,"column":4},"end":{"line":446,"column":16}},{"start":{"line":447,"column":4},"end":{"line":447,"column":16}}]},"37":{"line":468,"type":"if","locations":[{"start":{"line":468,"column":2},"end":{"line":468,"column":2}},{"start":{"line":468,"column":2},"end":{"line":468,"column":2}}]},"38":{"line":473,"type":"if","locations":[{"start":{"line":473,"column":2},"end":{"line":473,"column":2}},{"start":{"line":473,"column":2},"end":{"line":473,"column":2}}]},"39":{"line":478,"type":"if","locations":[{"start":{"line":478,"column":2},"end":{"line":478,"column":2}},{"start":{"line":478,"column":2},"end":{"line":478,"column":2}}]}},"code":["'use strict';","","const STATES = {","\tILLEGAL: -1,","\tNO: 0,","\tTAG_OPEN: 1,","\tTAG_NAME: 2,","\tBEFORE_ATTRIBUTE_NAME: 3,","\tATTRIBUTE_NAME: 4,","\tAFTER_ATTRIBUTE_NAME: 5,","\tBEFORE_ATTRIBUTE_VALUE: 6,","\tATTRIBUTE_VALUE_DOUBLE_QUOTED: 7,","\tATTRIBUTE_VALUE_SINGLE_QUOTED: 8,","\tATTRIBUTE_VALUE_UNQUOTED: 9,","\tAFTER_ATTRIBUTE_VALUE_QUOTED: 10,","\tSELF_CLOSING_START_TAG_STATE: 11,","\tTAG_CLOSE: 12","};","Object.freeze(STATES);","","const WHITESPACE_TEST = /^[\\u0009\\u000A\\u000C\\u000D\\u0020]$/;","const ASCII_LETTERS_TEST = /[a-z]/i;","","class HTMLTagTokenizer {","","\t/**","\t * Creates a new instance of the HTML tag tokenizer.","\t * It was developed using this specification:","\t * http://www.w3.org/TR/2011/WD-html5-20110113/tokenization.html","\t */","\tconstructor() {","","\t\t/**","\t\t * Current source code of constructor.","\t\t * @type {string}","\t\t * @private","\t\t */","\t\tthis._source = '';","","\t\t/**","\t\t * Current index in source code.","\t\t * @type {number}","\t\t * @private","\t\t */","\t\tthis._currentIndex = 0;","","\t\t/**","\t\t * Current index in source code.","\t\t * @type {number}","\t\t * @private","\t\t */","\t\tthis._currentEnd = 0;","","\t\t/**","\t\t * Current state.","\t\t * @type {number}","\t\t * @private","\t\t */","\t\tthis._currentState = STATES.NO;","\t}","","\t/**","\t * Gets the state constants map.","\t */","\tstatic get STATES() {","\t\treturn STATES;","\t}","","\t/**","\t * Sets the tag string to tokenize.","\t * @param {string} tagHTML Tag HTML string.","\t */","\tsetTagString(tagHTML) {","\t\tthis._source = tagHTML;","\t\tthis._currentIndex = 0;","\t\tthis._currentEnd = 0;","\t\tthis._currentState = STATES.NO;","\t}","","\t/**","\t * Gets a next token in source.","\t * @returns {{state: (number), start: number, end: number}}","\t */","\t/* eslint complexity: 0 */","\tnext() {","\t\tconst start = this._currentIndex;","\t\tconst state = this._currentState;","","\t\tswitch (this._currentState) {","\t\t\tcase STATES.TAG_OPEN:","\t\t\t\tthis.tagOpenState();","\t\t\t\tbreak;","\t\t\tcase STATES.TAG_NAME:","\t\t\t\tthis.tagNameState();","\t\t\t\tbreak;","\t\t\tcase STATES.SELF_CLOSING_START_TAG_STATE:","\t\t\t\tthis.selfClosingStartTagState();","\t\t\t\tbreak;","\t\t\tcase STATES.BEFORE_ATTRIBUTE_NAME:","\t\t\t\tthis.beforeAttributeNameState();","\t\t\t\tbreak;","\t\t\tcase STATES.ATTRIBUTE_NAME:","\t\t\t\tthis.attributeNameState();","\t\t\t\tbreak;","\t\t\tcase STATES.AFTER_ATTRIBUTE_NAME:","\t\t\t\tthis.afterAttributeNameState();","\t\t\t\tbreak;","\t\t\tcase STATES.BEFORE_ATTRIBUTE_VALUE:","\t\t\t\tthis.beforeAttributeValueState();","\t\t\t\tbreak;","\t\t\tcase STATES.ATTRIBUTE_VALUE_DOUBLE_QUOTED:","\t\t\t\tthis.attributeValueDoubleQuotedState();","\t\t\t\tbreak;","\t\t\tcase STATES.ATTRIBUTE_VALUE_SINGLE_QUOTED:","\t\t\t\tthis.attributeValueSingleQuotedState();","\t\t\t\tbreak;","\t\t\tcase STATES.ATTRIBUTE_VALUE_UNQUOTED:","\t\t\t\tthis.attributeValueUnquotedState();","\t\t\t\tbreak;","\t\t\tcase STATES.AFTER_ATTRIBUTE_VALUE_QUOTED:","\t\t\t\tthis.afterAttributeValueQuotedState();","\t\t\t\tbreak;","\t\t\tcase STATES.ILLEGAL:","\t\t\tcase STATES.TAG_CLOSE:","\t\t\t\treturn {","\t\t\t\t\tstate,","\t\t\t\t\tstart,","\t\t\t\t\tend: start + 1","\t\t\t\t};","\t\t\tdefault:","\t\t\t\tthis._currentState = this._source[start] === '<' ?","\t\t\t\t\tSTATES.TAG_OPEN :","\t\t\t\t\tSTATES.ILLEGAL;","\t\t\t\treturn this.next();","\t\t}","","\t\treturn {","\t\t\tstate,","\t\t\tstart,","\t\t\tend: this._currentEnd","\t\t};","\t}","","\t/**","\t * Skips all whitespace characters.","\t */","\tskipWhitespace() {","\t\twhile (","\t\t\tthis._currentIndex < this._source.length &&","\t\t\tWHITESPACE_TEST.test(this._source[this._currentIndex])","\t\t) {","\t\t\tthis._currentIndex++;","\t\t}","\t}","","\t/**","\t * Describes the \"Tag open state\".","\t */","\ttagOpenState() {","\t\tthis._currentIndex++;","\t\tthis._currentEnd = this._currentIndex;","\t\tconst next = this._source[this._currentIndex];","","\t\tif (ASCII_LETTERS_TEST.test(next)) {","\t\t\tthis._currentState = STATES.TAG_NAME;","\t\t\treturn;","\t\t}","","\t\t// this parser does not support the \"Markup declaration open state\" and","\t\t// \"End tag open state\"","\t\tthis._currentState = STATES.ILLEGAL;","\t}","","\t/**","\t * Describes the \"Tag name state\".","\t */","\ttagNameState() {","\t\tthis._currentIndex++;","\t\tthis._currentEnd = this._currentIndex;","\t\twhile (this._currentIndex < this._source.length) {","\t\t\tconst next = this._source[this._currentIndex];","\t\t\tif (WHITESPACE_TEST.test(next)) {","\t\t\t\tthis._currentState = STATES.BEFORE_ATTRIBUTE_NAME;","\t\t\t\treturn;","\t\t\t}","","\t\t\tif (next === '/') {","\t\t\t\tthis._currentState = STATES.SELF_CLOSING_START_TAG_STATE;","\t\t\t\treturn;","\t\t\t}","","\t\t\tif (next === '>') {","\t\t\t\tthis._currentState = STATES.TAG_CLOSE;","\t\t\t\treturn;","\t\t\t}","","\t\t\tif (next === '\\u0000') {","\t\t\t\tthis._currentState = STATES.ILLEGAL;","\t\t\t\treturn;","\t\t\t}","","\t\t\tthis._currentIndex++;","\t\t\tthis._currentEnd = this._currentIndex;","\t\t}","","\t\tthis._currentState = STATES.ILLEGAL;","\t}","","\t/**","\t * Describes the \"Self-closing start tag state\".","\t */","\tselfClosingStartTagState() {","\t\tthis._currentIndex++;","\t\tthis._currentEnd = this._currentIndex;","\t\tconst next = this._source[this._currentIndex];","\t\tif (next === '>') {","\t\t\tthis._currentState = STATES.TAG_CLOSE;","\t\t\treturn;","\t\t}","","\t\tthis._currentState = STATES.ILLEGAL;","\t}","","\t/**","\t * Describes the \"Before attribute value state\".","\t */","\tbeforeAttributeNameState() {","\t\tthis._currentIndex++;","\t\tthis.skipWhitespace();","\t\tthis._currentEnd = this._currentIndex;","","\t\tconst next = this._source[this._currentIndex];","\t\tif (next === '/') {","\t\t\tthis._currentState = STATES.SELF_CLOSING_START_TAG_STATE;","\t\t\treturn;","\t\t}","\t\tif (next === '>') {","\t\t\tthis._currentState = STATES.TAG_CLOSE;","\t\t\treturn;","\t\t}","","\t\tif (next === '\\u0000' ||","\t\t\tnext === '\"' ||","\t\t\tnext === '\\'' ||","\t\t\tnext === '<' ||","\t\t\tnext === '=' ||","\t\t\tthis._currentIndex >= this._source.length) {","\t\t\tthis._currentState = STATES.ILLEGAL;","\t\t\treturn;","\t\t}","","\t\tthis._currentState = STATES.ATTRIBUTE_NAME;","\t}","","\t/**","\t * Describes the \"Attribute name state\".","\t */","\tattributeNameState() {","\t\tthis._currentIndex++;","\t\tthis._currentEnd = this._currentIndex;","","\t\twhile (this._currentIndex < this._source.length) {","\t\t\tconst next = this._source[this._currentIndex];","\t\t\tif (WHITESPACE_TEST.test(next)) {","\t\t\t\tthis._currentState = STATES.AFTER_ATTRIBUTE_NAME;","\t\t\t\treturn;","\t\t\t}","","\t\t\tif (next === '/') {","\t\t\t\tthis._currentState = STATES.SELF_CLOSING_START_TAG_STATE;","\t\t\t\treturn;","\t\t\t}","","\t\t\tif (next === '=') {","\t\t\t\tthis._currentState = STATES.BEFORE_ATTRIBUTE_VALUE;","\t\t\t\treturn;","\t\t\t}","","\t\t\tif (next === '>') {","\t\t\t\tthis._currentState = STATES.TAG_CLOSE;","\t\t\t\treturn;","\t\t\t}","","\t\t\tif (next === '\\u0000' ||","\t\t\t\tnext === '\"' ||","\t\t\t\tnext === '\\'' ||","\t\t\t\tnext === '<') {","\t\t\t\tthis._currentState = STATES.ILLEGAL;","\t\t\t\treturn;","\t\t\t}","","\t\t\tthis._currentIndex++;","\t\t\tthis._currentEnd = this._currentIndex;","\t\t}","","\t\tthis._currentState = STATES.ILLEGAL;","\t}","","\t/**","\t * Describes the \"After attribute value state\".","\t */","\tafterAttributeNameState() {","\t\tthis._currentIndex++;","\t\tthis.skipWhitespace();","\t\tthis._currentEnd = this._currentIndex;","","\t\tconst next = this._source[this._currentIndex];","\t\tif (next === '/') {","\t\t\tthis._currentState = STATES.SELF_CLOSING_START_TAG_STATE;","\t\t\treturn;","\t\t}","\t\tif (next === '=') {","\t\t\tthis._currentState = STATES.BEFORE_ATTRIBUTE_VALUE;","\t\t\treturn;","\t\t}","\t\tif (next === '>') {","\t\t\tthis._currentState = STATES.TAG_CLOSE;","\t\t\treturn;","\t\t}","","\t\tif (next === '\\u0000' ||","\t\t\tnext === '\"' ||","\t\t\tnext === '\\'' ||","\t\t\tnext === '<' ||","\t\t\tthis._currentIndex >= this._source.length) {","\t\t\tthis._currentState = STATES.ILLEGAL;","\t\t\treturn;","\t\t}","","\t\tthis._currentState = STATES.ATTRIBUTE_NAME;","\t}","","\t/**","\t * Describes the \"Before attribute value state\".","\t */","\tbeforeAttributeValueState() {","\t\tthis._currentIndex++;","\t\tthis.skipWhitespace();","\t\tthis._currentEnd = this._currentIndex;","","\t\tconst next = this._source[this._currentIndex];","","\t\tif (next === '\"') {","\t\t\tthis._currentIndex++;","\t\t\tthis._currentEnd = this._currentIndex;","\t\t\tthis._currentState = STATES.ATTRIBUTE_VALUE_DOUBLE_QUOTED;","\t\t\treturn;","\t\t}","","\t\tif (next === '\\'') {","\t\t\tthis._currentIndex++;","\t\t\tthis._currentEnd = this._currentIndex;","\t\t\tthis._currentState = STATES.ATTRIBUTE_VALUE_SINGLE_QUOTED;","\t\t\treturn;","\t\t}","","\t\tif (next === '\\u0000' ||","\t\t\tnext === '>' ||","\t\t\tnext === '<' ||","\t\t\tnext === '=' ||","\t\t\tnext === '`' ||","\t\t\tthis._currentIndex >= this._source.length) {","\t\t\tthis._currentState = STATES.ILLEGAL;","\t\t\treturn;","\t\t}","","\t\tthis._currentState = STATES.ATTRIBUTE_VALUE_UNQUOTED;","\t}","","\t/**","\t * Describes the \"Attribute value (double-quoted) state\".","\t */","\tattributeValueDoubleQuotedState() {","\t\tthis._currentEnd = this._currentIndex;","","\t\twhile (this._currentIndex < this._source.length) {","\t\t\t// character reference in attribute value state is not supported","\t\t\tconst next = this._source[this._currentIndex];","\t\t\tif (next === '\"') {","\t\t\t\tthis._currentState = STATES.AFTER_ATTRIBUTE_VALUE_QUOTED;","\t\t\t\treturn;","\t\t\t}","","\t\t\tif (next === '\\u0000') {","\t\t\t\tthis._currentState = STATES.ILLEGAL;","\t\t\t\treturn;","\t\t\t}","","\t\t\tthis._currentIndex++;","\t\t\tthis._currentEnd = this._currentIndex;","\t\t}","","\t\tthis._currentState = STATES.ILLEGAL;","\t}","","\t/**","\t * Describes the \"Attribute value (single-quoted) state\".","\t */","\tattributeValueSingleQuotedState() {","\t\tthis._currentEnd = this._currentIndex;","","\t\twhile (this._currentIndex < this._source.length) {","\t\t\t// character reference in attribute value state is not supported","\t\t\tconst next = this._source[this._currentIndex];","\t\t\tif (next === '\\'') {","\t\t\t\tthis._currentState = STATES.AFTER_ATTRIBUTE_VALUE_QUOTED;","\t\t\t\treturn;","\t\t\t}","","\t\t\tif (next === '\\u0000') {","\t\t\t\tthis._currentState = STATES.ILLEGAL;","\t\t\t\treturn;","\t\t\t}","","\t\t\tthis._currentIndex++;","\t\t\tthis._currentEnd = this._currentIndex;","\t\t}","","\t\tthis._currentState = STATES.ILLEGAL;","\t}","","\t/**","\t * Describes the \"Attribute value (unquoted) state\".","\t */","\tattributeValueUnquotedState() {","\t\tthis._currentIndex++;","\t\tthis._currentEnd = this._currentIndex;","","\t\twhile (this._currentIndex < this._source.length) {","\t\t\t// character reference in attribute value state is not supported","\t\t\tconst next = this._source[this._currentIndex];","","\t\t\tif (WHITESPACE_TEST.test(next)) {","\t\t\t\tthis._currentState = STATES.BEFORE_ATTRIBUTE_NAME;","\t\t\t\treturn;","\t\t\t}","","\t\t\tif (next === '>') {","\t\t\t\tthis._currentState = STATES.TAG_CLOSE;","\t\t\t\treturn;","\t\t\t}","","\t\t\tif (next === '\\u0000' ||","\t\t\t\tnext === '\\'' ||","\t\t\t\tnext === '<' ||","\t\t\t\tnext === '=' ||","\t\t\t\tnext === '`') {","\t\t\t\tthis._currentState = STATES.ILLEGAL;","\t\t\t\treturn;","\t\t\t}","","\t\t\tthis._currentIndex++;","\t\t\tthis._currentEnd = this._currentIndex;","\t\t}","","\t\tthis._currentState = STATES.ILLEGAL;","\t}","","\t/**","\t * Describes the \"After attribute value (quoted) state\".","\t */","\tafterAttributeValueQuotedState() {","\t\tthis._currentIndex++;","\t\tthis._currentEnd = this._currentIndex;","","\t\tconst next = this._source[this._currentIndex];","","\t\tif (WHITESPACE_TEST.test(next)) {","\t\t\tthis._currentState = STATES.BEFORE_ATTRIBUTE_NAME;","\t\t\treturn;","\t\t}","","\t\tif (next === '/') {","\t\t\tthis._currentState = STATES.SELF_CLOSING_START_TAG_STATE;","\t\t\treturn;","\t\t}","","\t\tif (next === '>') {","\t\t\tthis._currentState = STATES.TAG_CLOSE;","\t\t\treturn;","\t\t}","","\t\tthis._currentState = STATES.ILLEGAL;","\t}","}","","module.exports = HTMLTagTokenizer;",""],"l":{"3":1,"19":1,"21":1,"22":1,"38":1,"45":1,"52":1,"59":1,"66":0,"74":0,"75":0,"76":0,"77":0,"86":0,"87":0,"89":0,"91":0,"92":0,"94":0,"95":0,"97":0,"98":0,"100":0,"101":0,"103":0,"104":0,"106":0,"107":0,"109":0,"110":0,"112":0,"113":0,"115":0,"116":0,"118":0,"119":0,"121":0,"122":0,"125":0,"131":0,"134":0,"137":0,"148":0,"152":0,"160":0,"161":0,"162":0,"164":0,"165":0,"166":0,"171":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"187":0,"188":0,"189":0,"192":0,"193":0,"194":0,"197":0,"198":0,"199":0,"202":0,"203":0,"206":0,"213":0,"214":0,"215":0,"216":0,"217":0,"218":0,"221":0,"228":0,"229":0,"230":0,"232":0,"233":0,"234":0,"235":0,"237":0,"238":0,"239":0,"242":0,"248":0,"249":0,"252":0,"259":0,"260":0,"262":0,"263":0,"264":0,"265":0,"266":0,"269":0,"270":0,"271":0,"274":0,"275":0,"276":0,"279":0,"280":0,"281":0,"284":0,"288":0,"289":0,"292":0,"293":0,"296":0,"303":0,"304":0,"305":0,"307":0,"308":0,"309":0,"310":0,"312":0,"313":0,"314":0,"316":0,"317":0,"318":0,"321":0,"326":0,"327":0,"330":0,"337":0,"338":0,"339":0,"341":0,"343":0,"344":0,"345":0,"346":0,"347":0,"350":0,"351":0,"352":0,"353":0,"354":0,"357":0,"363":0,"364":0,"367":0,"374":0,"376":0,"378":0,"379":0,"380":0,"381":0,"384":0,"385":0,"386":0,"389":0,"390":0,"393":0,"400":0,"402":0,"404":0,"405":0,"406":0,"407":0,"410":0,"411":0,"412":0,"415":0,"416":0,"419":0,"426":0,"427":0,"429":0,"431":0,"433":0,"434":0,"435":0,"438":0,"439":0,"440":0,"443":0,"448":0,"449":0,"452":0,"453":0,"456":0,"463":0,"464":0,"466":0,"468":0,"469":0,"470":0,"473":0,"474":0,"475":0,"478":0,"479":0,"480":0,"483":0,"487":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/tokenizers/HTMLTokenizer.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/tokenizers/HTMLTokenizer.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":1},"b":{"1":[0,0,0,0,0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"fnMap":{"1":{"name":"(anonymous_1)","line":21,"loc":{"start":{"line":21,"column":12},"end":{"line":21,"column":15}}},"2":{"name":"(anonymous_2)","line":48,"loc":{"start":{"line":48,"column":18},"end":{"line":48,"column":21}}},"3":{"name":"(anonymous_3)","line":56,"loc":{"start":{"line":56,"column":14},"end":{"line":56,"column":21}}},"4":{"name":"(anonymous_4)","line":66,"loc":{"start":{"line":66,"column":5},"end":{"line":66,"column":8}}},"5":{"name":"(anonymous_5)","line":103,"loc":{"start":{"line":103,"column":8},"end":{"line":103,"column":11}}},"6":{"name":"(anonymous_6)","line":135,"loc":{"start":{"line":135,"column":10},"end":{"line":135,"column":13}}},"7":{"name":"(anonymous_7)","line":151,"loc":{"start":{"line":151,"column":8},"end":{"line":151,"column":11}}},"8":{"name":"(anonymous_8)","line":166,"loc":{"start":{"line":166,"column":8},"end":{"line":166,"column":11}}},"9":{"name":"(anonymous_9)","line":192,"loc":{"start":{"line":192,"column":17},"end":{"line":192,"column":20}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":10,"column":2}},"2":{"start":{"line":11,"column":0},"end":{"line":11,"column":22}},"3":{"start":{"line":13,"column":0},"end":{"line":13,"column":77}},"4":{"start":{"line":14,"column":0},"end":{"line":14,"column":37}},"5":{"start":{"line":28,"column":2},"end":{"line":28,"column":20}},"6":{"start":{"line":35,"column":2},"end":{"line":35,"column":25}},"7":{"start":{"line":42,"column":2},"end":{"line":42,"column":38}},"8":{"start":{"line":49,"column":2},"end":{"line":49,"column":16}},"9":{"start":{"line":57,"column":2},"end":{"line":57,"column":22}},"10":{"start":{"line":58,"column":2},"end":{"line":58,"column":25}},"11":{"start":{"line":59,"column":2},"end":{"line":59,"column":38}},"12":{"start":{"line":67,"column":2},"end":{"line":67,"column":35}},"13":{"start":{"line":68,"column":2},"end":{"line":68,"column":35}},"14":{"start":{"line":70,"column":2},"end":{"line":92,"column":3}},"15":{"start":{"line":72,"column":4},"end":{"line":72,"column":19}},"16":{"start":{"line":73,"column":4},"end":{"line":73,"column":10}},"17":{"start":{"line":75,"column":4},"end":{"line":75,"column":21}},"18":{"start":{"line":76,"column":4},"end":{"line":76,"column":10}},"19":{"start":{"line":78,"column":4},"end":{"line":78,"column":19}},"20":{"start":{"line":79,"column":4},"end":{"line":79,"column":10}},"21":{"start":{"line":81,"column":4},"end":{"line":84,"column":6}},"22":{"start":{"line":86,"column":4},"end":{"line":86,"column":40}},"23":{"start":{"line":87,"column":4},"end":{"line":87,"column":25}},"24":{"start":{"line":88,"column":4},"end":{"line":88,"column":10}},"25":{"start":{"line":90,"column":4},"end":{"line":90,"column":19}},"26":{"start":{"line":91,"column":4},"end":{"line":91,"column":23}},"27":{"start":{"line":94,"column":2},"end":{"line":97,"column":4}},"28":{"start":{"line":104,"column":2},"end":{"line":107,"column":3}},"29":{"start":{"line":105,"column":3},"end":{"line":105,"column":35}},"30":{"start":{"line":106,"column":3},"end":{"line":106,"column":10}},"31":{"start":{"line":110,"column":2},"end":{"line":127,"column":3}},"32":{"start":{"line":112,"column":3},"end":{"line":121,"column":4}},"33":{"start":{"line":113,"column":4},"end":{"line":117,"column":5}},"34":{"start":{"line":115,"column":5},"end":{"line":115,"column":41}},"35":{"start":{"line":116,"column":5},"end":{"line":116,"column":12}},"36":{"start":{"line":119,"column":4},"end":{"line":119,"column":40}},"37":{"start":{"line":120,"column":4},"end":{"line":120,"column":11}},"38":{"start":{"line":123,"column":3},"end":{"line":126,"column":4}},"39":{"start":{"line":124,"column":4},"end":{"line":124,"column":42}},"40":{"start":{"line":125,"column":4},"end":{"line":125,"column":11}},"41":{"start":{"line":129,"column":2},"end":{"line":129,"column":38}},"42":{"start":{"line":136,"column":2},"end":{"line":136,"column":26}},"43":{"start":{"line":137,"column":2},"end":{"line":144,"column":3}},"44":{"start":{"line":138,"column":3},"end":{"line":142,"column":4}},"45":{"start":{"line":139,"column":4},"end":{"line":139,"column":25}},"46":{"start":{"line":140,"column":4},"end":{"line":140,"column":40}},"47":{"start":{"line":141,"column":4},"end":{"line":141,"column":11}},"48":{"start":{"line":143,"column":3},"end":{"line":143,"column":24}},"49":{"start":{"line":145,"column":2},"end":{"line":145,"column":38}},"50":{"start":{"line":152,"column":2},"end":{"line":152,"column":23}},"51":{"start":{"line":153,"column":2},"end":{"line":159,"column":3}},"52":{"start":{"line":154,"column":3},"end":{"line":157,"column":4}},"53":{"start":{"line":155,"column":4},"end":{"line":155,"column":40}},"54":{"start":{"line":156,"column":4},"end":{"line":156,"column":11}},"55":{"start":{"line":158,"column":3},"end":{"line":158,"column":24}},"56":{"start":{"line":160,"column":2},"end":{"line":160,"column":34}},"57":{"start":{"line":167,"column":2},"end":{"line":167,"column":26}},"58":{"start":{"line":169,"column":2},"end":{"line":184,"column":3}},"59":{"start":{"line":170,"column":3},"end":{"line":182,"column":4}},"60":{"start":{"line":171,"column":4},"end":{"line":174,"column":5}},"61":{"start":{"line":172,"column":5},"end":{"line":172,"column":41}},"62":{"start":{"line":173,"column":5},"end":{"line":173,"column":12}},"63":{"start":{"line":176,"column":4},"end":{"line":181,"column":5}},"64":{"start":{"line":178,"column":5},"end":{"line":178,"column":29}},"65":{"start":{"line":179,"column":5},"end":{"line":179,"column":41}},"66":{"start":{"line":180,"column":5},"end":{"line":180,"column":12}},"67":{"start":{"line":183,"column":3},"end":{"line":183,"column":24}},"68":{"start":{"line":185,"column":2},"end":{"line":185,"column":38}},"69":{"start":{"line":193,"column":2},"end":{"line":195,"column":4}},"70":{"start":{"line":196,"column":2},"end":{"line":196,"column":52}},"71":{"start":{"line":200,"column":0},"end":{"line":200,"column":31}}},"branchMap":{"1":{"line":70,"type":"switch","locations":[{"start":{"line":71,"column":3},"end":{"line":73,"column":10}},{"start":{"line":74,"column":3},"end":{"line":76,"column":10}},{"start":{"line":77,"column":3},"end":{"line":79,"column":10}},{"start":{"line":80,"column":3},"end":{"line":84,"column":6}},{"start":{"line":85,"column":3},"end":{"line":88,"column":10}},{"start":{"line":89,"column":3},"end":{"line":91,"column":23}}]},"2":{"line":104,"type":"if","locations":[{"start":{"line":104,"column":2},"end":{"line":104,"column":2}},{"start":{"line":104,"column":2},"end":{"line":104,"column":2}}]},"3":{"line":110,"type":"if","locations":[{"start":{"line":110,"column":2},"end":{"line":110,"column":2}},{"start":{"line":110,"column":2},"end":{"line":110,"column":2}}]},"4":{"line":112,"type":"if","locations":[{"start":{"line":112,"column":3},"end":{"line":112,"column":3}},{"start":{"line":112,"column":3},"end":{"line":112,"column":3}}]},"5":{"line":113,"type":"if","locations":[{"start":{"line":113,"column":4},"end":{"line":113,"column":4}},{"start":{"line":113,"column":4},"end":{"line":113,"column":4}}]},"6":{"line":113,"type":"binary-expr","locations":[{"start":{"line":113,"column":8},"end":{"line":113,"column":52}},{"start":{"line":114,"column":5},"end":{"line":114,"column":49}}]},"7":{"line":123,"type":"if","locations":[{"start":{"line":123,"column":3},"end":{"line":123,"column":3}},{"start":{"line":123,"column":3},"end":{"line":123,"column":3}}]},"8":{"line":138,"type":"if","locations":[{"start":{"line":138,"column":3},"end":{"line":138,"column":3}},{"start":{"line":138,"column":3},"end":{"line":138,"column":3}}]},"9":{"line":154,"type":"if","locations":[{"start":{"line":154,"column":3},"end":{"line":154,"column":3}},{"start":{"line":154,"column":3},"end":{"line":154,"column":3}}]},"10":{"line":170,"type":"if","locations":[{"start":{"line":170,"column":3},"end":{"line":170,"column":3}},{"start":{"line":170,"column":3},"end":{"line":170,"column":3}}]},"11":{"line":171,"type":"if","locations":[{"start":{"line":171,"column":4},"end":{"line":171,"column":4}},{"start":{"line":171,"column":4},"end":{"line":171,"column":4}}]},"12":{"line":176,"type":"if","locations":[{"start":{"line":176,"column":4},"end":{"line":176,"column":4}},{"start":{"line":176,"column":4},"end":{"line":176,"column":4}}]},"13":{"line":176,"type":"binary-expr","locations":[{"start":{"line":176,"column":8},"end":{"line":176,"column":52}},{"start":{"line":177,"column":5},"end":{"line":177,"column":49}}]}},"code":["'use strict';","","const STATES = {","\tILLEGAL: -1,","\tINITIAL: 0,","\tCONTENT: 1,","\tCOMPONENT: 2,","\tCOMMENT: 3,","\tEND: 4","};","Object.freeze(STATES);","","const COMPONENT_TAG_NAME_REGEXP = /^<((cat-)|((document|head|body)[\\s/>]))/i;","const COMPONENT_NAME_MIN_LENGTH = 10;","","class HTMLTokenizer {","","\t/**","\t * Creates a new instance of the simplified streaming HTML tokenizer.","\t */","\tconstructor() {","","\t\t/**","\t\t * Current token buffer.","\t\t * @type {string}","\t\t * @private","\t\t */","\t\tthis._source = '';","","\t\t/**","\t\t * Current index in buffer.","\t\t * @type {number}","\t\t * @private","\t\t */","\t\tthis._currentIndex = 0;","","\t\t/**","\t\t * Current token identifier.","\t\t * @type {number}","\t\t * @private","\t\t */","\t\tthis._currentState = STATES.INITIAL;","\t}","","\t/**","\t * Gets the state constants map.","\t */","\tstatic get STATES() {","\t\treturn STATES;","\t}","","\t/**","\t * Sets a HTML string to the tokenizer.","\t * @param {string} html HTML string.","\t */","\tsetHTMLString(html) {","\t\tthis._source = html;","\t\tthis._currentIndex = 0;","\t\tthis._currentState = STATES.INITIAL;","\t}","","\t/**","\t * Gets a next token.","\t * @returns {{state: number, value: string}} Token descriptor.","\t */","\tnext() {","\t\tconst start = this._currentIndex;","\t\tconst state = this._currentState;","","\t\tswitch (this._currentState) {","\t\t\tcase STATES.CONTENT:","\t\t\t\tthis.content();","\t\t\t\tbreak;","\t\t\tcase STATES.COMPONENT:","\t\t\t\tthis.component();","\t\t\t\tbreak;","\t\t\tcase STATES.COMMENT:","\t\t\t\tthis.comment();","\t\t\t\tbreak;","\t\t\tcase STATES.END:","\t\t\t\treturn {","\t\t\t\t\tstate,","\t\t\t\t\tvalue: null","\t\t\t\t};","\t\t\tcase STATES.ILLEGAL:","\t\t\t\tthis._currentState = STATES.INITIAL;","\t\t\t\tthis._currentIndex++;","\t\t\t\tbreak;","\t\t\tdefault:","\t\t\t\tthis.initial();","\t\t\t\treturn this.next();","\t\t}","","\t\treturn {","\t\t\tstate,","\t\t\tvalue: this._source.substring(start, this._currentIndex)","\t\t};","\t}","","\t/**","\t * Switches machine to the \"data\" state.","\t */","\tinitial() {","\t\tif (this._currentIndex >= this._source.length) {","\t\t\tthis._currentState = STATES.END;","\t\t\treturn;","\t\t}","","\t\t// maybe comment or component","\t\tif (this._source[this._currentIndex] === '<') {","\t\t\t// comment","\t\t\tif (this._source[this._currentIndex + 1] === '!') {","\t\t\t\tif (this._source[this._currentIndex + 2] === '-' &&","\t\t\t\t\tthis._source[this._currentIndex + 3] === '-') {","\t\t\t\t\tthis._currentState = STATES.COMMENT;","\t\t\t\t\treturn;","\t\t\t\t}","","\t\t\t\tthis._currentState = STATES.CONTENT;","\t\t\t\treturn;","\t\t\t}","","\t\t\tif (this.checkIfComponent()) {","\t\t\t\tthis._currentState = STATES.COMPONENT;","\t\t\t\treturn;","\t\t\t}","\t\t}","","\t\tthis._currentState = STATES.CONTENT;","\t}","","\t/**","\t * Switches machine to the \"tag\" state.","\t */","\tcomponent() {","\t\tthis._currentIndex += 5;","\t\twhile (this._currentIndex < this._source.length) {","\t\t\tif (this._source[this._currentIndex] === '>') {","\t\t\t\tthis._currentIndex++;","\t\t\t\tthis._currentState = STATES.INITIAL;","\t\t\t\treturn;","\t\t\t}","\t\t\tthis._currentIndex++;","\t\t}","\t\tthis._currentState = STATES.ILLEGAL;","\t}","","\t/**","\t * Switches machine to the \"content\" state.","\t */","\tcontent() {","\t\tthis._currentIndex++;","\t\twhile (this._currentIndex < this._source.length) {","\t\t\tif (this._source[this._currentIndex] === '<') {","\t\t\t\tthis._currentState = STATES.INITIAL;","\t\t\t\treturn;","\t\t\t}","\t\t\tthis._currentIndex++;","\t\t}","\t\tthis._currentState = STATES.END;","\t}","","\t/**","\t * Switches machine to the \"comment\" state.","\t */","\tcomment() {","\t\tthis._currentIndex += 4;","","\t\twhile (this._currentIndex < this._source.length) {","\t\t\tif (this._source[this._currentIndex] === '-') {","\t\t\t\tif (this._currentIndex + 2 >= this._source.length) {","\t\t\t\t\tthis._currentState = STATES.ILLEGAL;","\t\t\t\t\treturn;","\t\t\t\t}","","\t\t\t\tif (this._source[this._currentIndex + 1] === '-' &&","\t\t\t\t\tthis._source[this._currentIndex + 2] === '>') {","\t\t\t\t\tthis._currentIndex += 3;","\t\t\t\t\tthis._currentState = STATES.INITIAL;","\t\t\t\t\treturn;","\t\t\t\t}","\t\t\t}","\t\t\tthis._currentIndex++;","\t\t}","\t\tthis._currentState = STATES.ILLEGAL;","\t}","","\t/**","\t * Checks if following HTML is a component.","\t * @returns {boolean} Is it a component?","\t */","\tcheckIfComponent() {","\t\tconst testString = this._source.substr(","\t\t\tthis._currentIndex, COMPONENT_NAME_MIN_LENGTH","\t\t);","\t\treturn COMPONENT_TAG_NAME_REGEXP.test(testString);","\t}","}","","module.exports = HTMLTokenizer;",""],"l":{"3":1,"11":1,"13":1,"14":1,"28":1,"35":1,"42":1,"49":0,"57":0,"58":0,"59":0,"67":0,"68":0,"70":0,"72":0,"73":0,"75":0,"76":0,"78":0,"79":0,"81":0,"86":0,"87":0,"88":0,"90":0,"91":0,"94":0,"104":0,"105":0,"106":0,"110":0,"112":0,"113":0,"115":0,"116":0,"119":0,"120":0,"123":0,"124":0,"125":0,"129":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"143":0,"145":0,"152":0,"153":0,"154":0,"155":0,"156":0,"158":0,"160":0,"167":0,"169":0,"170":0,"171":0,"172":0,"173":0,"176":0,"178":0,"179":0,"180":0,"183":0,"185":0,"193":0,"196":0,"200":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/RequestRouter.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/RequestRouter.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":14,"loc":{"start":{"line":14,"column":12},"end":{"line":14,"column":22}}},"2":{"name":"(anonymous_2)","line":57,"loc":{"start":{"line":57,"column":6},"end":{"line":57,"column":32}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":55}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":44}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":28}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":40}},"5":{"start":{"line":21,"column":2},"end":{"line":21,"column":63}},"6":{"start":{"line":28,"column":2},"end":{"line":28,"column":57}},"7":{"start":{"line":35,"column":2},"end":{"line":35,"column":59}},"8":{"start":{"line":41,"column":2},"end":{"line":41,"column":47}},"9":{"start":{"line":48,"column":2},"end":{"line":48,"column":33}},"10":{"start":{"line":58,"column":2},"end":{"line":60,"column":3}},"11":{"start":{"line":59,"column":3},"end":{"line":59,"column":19}},"12":{"start":{"line":62,"column":2},"end":{"line":65,"column":3}},"13":{"start":{"line":63,"column":3},"end":{"line":63,"column":10}},"14":{"start":{"line":64,"column":3},"end":{"line":64,"column":10}},"15":{"start":{"line":67,"column":2},"end":{"line":67,"column":25}},"16":{"start":{"line":68,"column":2},"end":{"line":72,"column":3}},"17":{"start":{"line":69,"column":3},"end":{"line":69,"column":35}},"18":{"start":{"line":71,"column":3},"end":{"line":71,"column":24}},"19":{"start":{"line":73,"column":2},"end":{"line":77,"column":3}},"20":{"start":{"line":74,"column":3},"end":{"line":74,"column":47}},"21":{"start":{"line":76,"column":3},"end":{"line":76,"column":24}},"22":{"start":{"line":79,"column":2},"end":{"line":79,"column":24}},"23":{"start":{"line":80,"column":2},"end":{"line":80,"column":21}},"24":{"start":{"line":81,"column":2},"end":{"line":85,"column":3}},"25":{"start":{"line":82,"column":3},"end":{"line":82,"column":60}},"26":{"start":{"line":83,"column":3},"end":{"line":83,"column":59}},"27":{"start":{"line":84,"column":3},"end":{"line":84,"column":55}},"28":{"start":{"line":87,"column":2},"end":{"line":87,"column":60}},"29":{"start":{"line":88,"column":2},"end":{"line":91,"column":3}},"30":{"start":{"line":89,"column":3},"end":{"line":89,"column":10}},"31":{"start":{"line":90,"column":3},"end":{"line":90,"column":10}},"32":{"start":{"line":93,"column":2},"end":{"line":101,"column":5}},"33":{"start":{"line":102,"column":2},"end":{"line":102,"column":53}},"34":{"start":{"line":103,"column":2},"end":{"line":103,"column":46}},"35":{"start":{"line":104,"column":2},"end":{"line":104,"column":32}},"36":{"start":{"line":105,"column":2},"end":{"line":105,"column":30}},"37":{"start":{"line":106,"column":2},"end":{"line":106,"column":47}},"38":{"start":{"line":107,"column":2},"end":{"line":107,"column":41}},"39":{"start":{"line":109,"column":2},"end":{"line":109,"column":92}},"40":{"start":{"line":111,"column":2},"end":{"line":116,"column":5}},"41":{"start":{"line":112,"column":3},"end":{"line":112,"column":62}},"42":{"start":{"line":113,"column":3},"end":{"line":113,"column":63}},"43":{"start":{"line":115,"column":3},"end":{"line":115,"column":111}},"44":{"start":{"line":118,"column":2},"end":{"line":118,"column":55}},"45":{"start":{"line":122,"column":0},"end":{"line":122,"column":31}}},"branchMap":{"1":{"line":58,"type":"if","locations":[{"start":{"line":58,"column":2},"end":{"line":58,"column":2}},{"start":{"line":58,"column":2},"end":{"line":58,"column":2}}]},"2":{"line":62,"type":"if","locations":[{"start":{"line":62,"column":2},"end":{"line":62,"column":2}},{"start":{"line":62,"column":2},"end":{"line":62,"column":2}}]},"3":{"line":81,"type":"if","locations":[{"start":{"line":81,"column":2},"end":{"line":81,"column":2}},{"start":{"line":81,"column":2},"end":{"line":81,"column":2}}]},"4":{"line":83,"type":"binary-expr","locations":[{"start":{"line":83,"column":22},"end":{"line":83,"column":51}},{"start":{"line":83,"column":55},"end":{"line":83,"column":57}}]},"5":{"line":84,"type":"binary-expr","locations":[{"start":{"line":84,"column":25},"end":{"line":84,"column":47}},{"start":{"line":84,"column":51},"end":{"line":84,"column":53}}]},"6":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":2},"end":{"line":88,"column":2}},{"start":{"line":88,"column":2},"end":{"line":88,"column":2}}]}},"code":["'use strict';","","const hrTimeHelper = require('./helpers/hrTimeHelper');","const catberryURI = require('catberry-uri');","const URI = catberryURI.URI;","const Authority = catberryURI.Authority;","","class RequestRouter {","","\t/**","\t * Creates a new instance of the request router.","\t * @param {ServiceLocator} locator Service locator for resolving dependencies.","\t */","\tconstructor(locator) {","","\t\t/**","\t\t * Current page renderer.","\t\t * @type {DocumentRenderer}","\t\t * @private","\t\t */","\t\tthis._documentRenderer = locator.resolve('documentRenderer');","","\t\t/**","\t\t * Current state provider.","\t\t * @type {StateProvider}","\t\t * @private","\t\t */","\t\tthis._stateProvider = locator.resolve('stateProvider');","","\t\t/**","\t\t * Current context factory.","\t\t * @type {ContextFactory}","\t\t * @private","\t\t */","\t\tthis._contextFactory = locator.resolve('contextFactory');","","\t\t/**","\t\t * Current event bus.","\t\t * @type {EventEmitter}","\t\t */","\t\tthis._eventBus = locator.resolve('eventBus');","","\t\t/**","\t\t * Current service locator.","\t\t * @type {ServiceLocator}","\t\t * @private","\t\t */","\t\tthis._serviceLocator = locator;","\t}","","\t/**","\t * Creates a routing context, gets the application state and passes it to the renderer.","\t * @param {http.IncomingMessage} request HTTP request.","\t * @param {http.ServerResponse} response HTTP response.","\t * @param {Function?} next Next function for the middleware.","\t */","\troute(request, response, next) {","\t\tif (!(next instanceof Function)) {","\t\t\tnext = () => {};","\t\t}","","\t\tif (request.method !== 'GET') {","\t\t\tnext();","\t\t\treturn;","\t\t}","","\t\tvar location, referrer;","\t\ttry {","\t\t\tlocation = new URI(request.url);","\t\t} catch (e) {","\t\t\tlocation = new URI();","\t\t}","\t\ttry {","\t\t\treferrer = new URI(request.headers.referer);","\t\t} catch (e) {","\t\t\treferrer = new URI();","\t\t}","","\t\tvar cookieString = '';","\t\tvar userAgent = '';","\t\tif (request.headers) {","\t\t\tlocation.authority = new Authority(request.headers.host);","\t\t\tuserAgent = String(request.headers['user-agent'] || '');","\t\t\tcookieString = String(request.headers.cookie || '');","\t\t}","","\t\tconst state = this._stateProvider.getStateByUri(location);","\t\tif (!state) {","\t\t\tnext();","\t\t\treturn;","\t\t}","","\t\tconst routingContext = this._contextFactory.create({","\t\t\treferrer,","\t\t\tlocation,","\t\t\tuserAgent,","\t\t\tmiddleware: {","\t\t\t\tresponse,","\t\t\t\tnext","\t\t\t}","\t\t});","\t\troutingContext.cookie.initWithString(cookieString);","\t\tconst requestStartTime = hrTimeHelper.get();","\t\tconst method = request.method;","\t\tconst uriPath = request.url;","\t\tconst address = request.socket.remoteAddress;","\t\tconst port = request.socket.remotePort;","","\t\tthis._eventBus.emit('trace', `Request to ${method} \"${uriPath}\" from ${address}:${port}`);","","\t\tresponse.on('finish', () => {","\t\t\tconst requestDuration = hrTimeHelper.get(requestStartTime);","\t\t\tconst timeMessage = hrTimeHelper.toMessage(requestDuration);","","\t\t\tthis._eventBus.emit('trace', `Response from ${method} \"${uriPath}\" to ${address}:${port} (${timeMessage})`);","\t\t});","","\t\tthis._documentRenderer.render(state, routingContext);","\t}","}","","module.exports = RequestRouter;",""],"l":{"3":1,"4":1,"5":1,"6":1,"21":0,"28":0,"35":0,"41":0,"48":0,"58":0,"59":0,"62":0,"63":0,"64":0,"67":0,"68":0,"69":0,"71":0,"73":0,"74":0,"76":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"87":0,"88":0,"89":0,"90":0,"93":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"109":0,"111":0,"112":0,"113":0,"115":0,"118":0,"122":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/ContextFactory.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/ContextFactory.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":1},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":11,"loc":{"start":{"line":11,"column":12},"end":{"line":11,"column":22}}},"2":{"name":"(anonymous_2)","line":28,"loc":{"start":{"line":28,"column":7},"end":{"line":28,"column":20}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":59}},"2":{"start":{"line":18,"column":2},"end":{"line":18,"column":33}},"3":{"start":{"line":29,"column":2},"end":{"line":29,"column":72}},"4":{"start":{"line":30,"column":2},"end":{"line":30,"column":45}},"5":{"start":{"line":31,"column":2},"end":{"line":32,"column":81}},"6":{"start":{"line":32,"column":19},"end":{"line":32,"column":79}},"7":{"start":{"line":33,"column":2},"end":{"line":33,"column":17}},"8":{"start":{"line":37,"column":0},"end":{"line":37,"column":32}}},"branchMap":{},"code":["'use strict';","","const propertyHelper = require('./helpers/propertyHelper');","","class ContextFactory {","","\t/**","\t * Creates a new instance of the context factory.","\t * @param {ServiceLocator} locator Locator for resolving dependencies.","\t */","\tconstructor(locator) {","","\t\t/**","\t\t * Current service locator.","\t\t * @type {ServiceLocator}","\t\t * @private","\t\t */","\t\tthis._serviceLocator = locator;","\t}","","\t/**","\t * Creates a new context for modules.","\t * @param {Object} additional Additional parameters.","\t * @param {URI} additional.referrer Current referrer.","\t * @param {URI} additional.location Current location.","\t * @param {string} additional.userAgent Current user agent.","\t */","\tcreate(additional) {","\t\tconst apiProvider = this._serviceLocator.resolve('moduleApiProvider');","\t\tconst context = Object.create(apiProvider);","\t\tObject.keys(additional)","\t\t\t.forEach(key => propertyHelper.defineReadOnly(context, key, additional[key]));","\t\treturn context;","\t}","}","","module.exports = ContextFactory;",""],"l":{"3":1,"18":0,"29":0,"30":0,"31":0,"32":0,"33":0,"37":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/Catberry.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/Catberry.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":1},"b":{},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"(anonymous_1)","line":10,"loc":{"start":{"line":10,"column":12},"end":{"line":10,"column":15}}},"2":{"name":"(anonymous_2)","line":25,"loc":{"start":{"line":25,"column":14},"end":{"line":25,"column":17}}},"3":{"name":"(anonymous_3)","line":34,"loc":{"start":{"line":34,"column":6},"end":{"line":34,"column":9}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":52}},"2":{"start":{"line":11,"column":2},"end":{"line":11,"column":10}},"3":{"start":{"line":18,"column":2},"end":{"line":18,"column":22}},"4":{"start":{"line":26,"column":2},"end":{"line":26,"column":55}},"5":{"start":{"line":27,"column":2},"end":{"line":27,"column":47}},"6":{"start":{"line":35,"column":2},"end":{"line":35,"column":63}},"7":{"start":{"line":36,"column":2},"end":{"line":36,"column":25}},"8":{"start":{"line":40,"column":0},"end":{"line":40,"column":26}}},"branchMap":{},"code":["'use strict';","","const CatberryBase = require('./base/CatberryBase');","","class Catberry extends CatberryBase {","","\t/**","\t * Creates a new instance of the server-side Catberry.","\t */","\tconstructor() {","\t\tsuper();","","\t\t/**","\t\t * Current request router.","\t\t * @type {RequestRouter}","\t\t * @private","\t\t */","\t\tthis._router = null;","\t}","","\t/**","\t * Gets the connect/express middleware.","\t * @returns {Function} Middleware function.","\t */","\tgetMiddleware() {","\t\tthis._router = this.locator.resolve('requestRouter');","\t\treturn this._router.route.bind(this._router);","\t}","","\t/**","\t * Builds the browser bundle.","\t * @returns {Promise} Promise for nothing.","\t */","\tbuild() {","\t\tconst builder = this.locator.resolve('browserBundleBuilder');","\t\treturn builder.build();","\t}","}","","module.exports = Catberry;",""],"l":{"3":1,"11":0,"18":0,"26":0,"27":0,"35":0,"36":0,"40":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/base/CatberryBase.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/base/CatberryBase.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":1},"b":{},"f":{"1":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":12},"end":{"line":13,"column":15}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":51}},"2":{"start":{"line":19,"column":2},"end":{"line":19,"column":38}},"3":{"start":{"line":24,"column":2},"end":{"line":24,"column":25}},"4":{"start":{"line":30,"column":2},"end":{"line":30,"column":21}},"5":{"start":{"line":32,"column":2},"end":{"line":32,"column":64}},"6":{"start":{"line":33,"column":2},"end":{"line":33,"column":50}},"7":{"start":{"line":37,"column":0},"end":{"line":37,"column":30}}},"branchMap":{},"code":["'use strict';","","const ServiceLocator = require('catberry-locator');","","/**"," * Implements the basic Catberry class for both server and browser environments."," */","class CatberryBase {","","\t/**","\t * Creates a new instance of the basic Catberry application module.","\t */","\tconstructor() {","","\t\t/**","\t\t * Current service locator.","\t\t * @type {ServiceLocator}","\t\t */","\t\tthis.locator = new ServiceLocator();","","\t\t/**","\t\t * Current version of Catberry.","\t\t */","\t\tthis.version = '9.0.0';","","\t\t/**","\t\t * Current object with events.","\t\t * @type {ModuleApiProvider}","\t\t */","\t\tthis.events = null;","","\t\tthis.locator.registerInstance('serviceLocator', this.locator);","\t\tthis.locator.registerInstance('catberry', this);","\t}","}","","module.exports = CatberryBase;",""],"l":{"3":1,"19":0,"24":0,"30":0,"32":0,"33":0,"37":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry-locator/lib/ServiceLocator.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry-locator/lib/ServiceLocator.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"fnMap":{"1":{"name":"(anonymous_1)","line":11,"loc":{"start":{"line":11,"column":12},"end":{"line":11,"column":15}}},"2":{"name":"(anonymous_2)","line":30,"loc":{"start":{"line":30,"column":9},"end":{"line":30,"column":45}}},"3":{"name":"(anonymous_3)","line":48,"loc":{"start":{"line":48,"column":17},"end":{"line":48,"column":34}}},"4":{"name":"(anonymous_4)","line":64,"loc":{"start":{"line":64,"column":8},"end":{"line":64,"column":15}}},"5":{"name":"(anonymous_5)","line":76,"loc":{"start":{"line":76,"column":11},"end":{"line":76,"column":18}}},"6":{"name":"(anonymous_6)","line":87,"loc":{"start":{"line":87,"column":11},"end":{"line":87,"column":18}}},"7":{"name":"(anonymous_7)","line":98,"loc":{"start":{"line":98,"column":4},"end":{"line":98,"column":11}}},"8":{"name":"(anonymous_8)","line":110,"loc":{"start":{"line":110,"column":16},"end":{"line":110,"column":31}}},"9":{"name":"(anonymous_9)","line":130,"loc":{"start":{"line":130,"column":24},"end":{"line":130,"column":31}}},"10":{"name":"(anonymous_10)","line":142,"loc":{"start":{"line":142,"column":15},"end":{"line":142,"column":22}}},"11":{"name":"(anonymous_11)","line":156,"loc":{"start":{"line":156,"column":20},"end":{"line":156,"column":43}}},"12":{"name":"(anonymous_12)","line":168,"loc":{"start":{"line":168,"column":18},"end":{"line":168,"column":25}}}},"statementMap":{"1":{"start":{"line":18,"column":2},"end":{"line":18,"column":44}},"2":{"start":{"line":31,"column":2},"end":{"line":31,"column":49}},"3":{"start":{"line":32,"column":2},"end":{"line":32,"column":31}},"4":{"start":{"line":34,"column":2},"end":{"line":34,"column":37}},"5":{"start":{"line":36,"column":2},"end":{"line":40,"column":5}},"6":{"start":{"line":49,"column":2},"end":{"line":49,"column":31}},"7":{"start":{"line":50,"column":2},"end":{"line":50,"column":37}},"8":{"start":{"line":52,"column":2},"end":{"line":56,"column":5}},"9":{"start":{"line":65,"column":2},"end":{"line":65,"column":31}},"10":{"start":{"line":66,"column":2},"end":{"line":66,"column":28}},"11":{"start":{"line":67,"column":2},"end":{"line":67,"column":57}},"12":{"start":{"line":68,"column":2},"end":{"line":68,"column":49}},"13":{"start":{"line":77,"column":2},"end":{"line":77,"column":31}},"14":{"start":{"line":78,"column":2},"end":{"line":78,"column":28}},"15":{"start":{"line":79,"column":2},"end":{"line":80,"column":60}},"16":{"start":{"line":80,"column":24},"end":{"line":80,"column":58}},"17":{"start":{"line":88,"column":2},"end":{"line":88,"column":31}},"18":{"start":{"line":89,"column":2},"end":{"line":89,"column":33}},"19":{"start":{"line":99,"column":2},"end":{"line":99,"column":31}},"20":{"start":{"line":101,"column":2},"end":{"line":101,"column":79}},"21":{"start":{"line":111,"column":2},"end":{"line":113,"column":3}},"22":{"start":{"line":112,"column":3},"end":{"line":112,"column":38}},"23":{"start":{"line":116,"column":2},"end":{"line":116,"column":57}},"24":{"start":{"line":118,"column":2},"end":{"line":120,"column":3}},"25":{"start":{"line":119,"column":3},"end":{"line":119,"column":42}},"26":{"start":{"line":122,"column":2},"end":{"line":122,"column":18}},"27":{"start":{"line":131,"column":2},"end":{"line":133,"column":3}},"28":{"start":{"line":132,"column":3},"end":{"line":132,"column":10}},"29":{"start":{"line":134,"column":2},"end":{"line":134,"column":33}},"30":{"start":{"line":143,"column":2},"end":{"line":146,"column":3}},"31":{"start":{"line":145,"column":3},"end":{"line":145,"column":10}},"32":{"start":{"line":147,"column":2},"end":{"line":147,"column":51}},"33":{"start":{"line":157,"column":2},"end":{"line":159,"column":3}},"34":{"start":{"line":158,"column":3},"end":{"line":158,"column":10}},"35":{"start":{"line":161,"column":2},"end":{"line":161,"column":71}},"36":{"start":{"line":169,"column":2},"end":{"line":171,"column":3}},"37":{"start":{"line":170,"column":3},"end":{"line":170,"column":10}},"38":{"start":{"line":173,"column":2},"end":{"line":173,"column":60}},"39":{"start":{"line":177,"column":0},"end":{"line":177,"column":32}}},"branchMap":{"1":{"line":101,"type":"binary-expr","locations":[{"start":{"line":101,"column":10},"end":{"line":101,"column":37}},{"start":{"line":101,"column":41},"end":{"line":101,"column":77}}]},"2":{"line":111,"type":"if","locations":[{"start":{"line":111,"column":2},"end":{"line":111,"column":2}},{"start":{"line":111,"column":2},"end":{"line":111,"column":2}}]},"3":{"line":111,"type":"binary-expr","locations":[{"start":{"line":111,"column":6},"end":{"line":111,"column":30}},{"start":{"line":111,"column":34},"end":{"line":111,"column":70}}]},"4":{"line":118,"type":"if","locations":[{"start":{"line":118,"column":2},"end":{"line":118,"column":2}},{"start":{"line":118,"column":2},"end":{"line":118,"column":2}}]},"5":{"line":131,"type":"if","locations":[{"start":{"line":131,"column":2},"end":{"line":131,"column":2}},{"start":{"line":131,"column":2},"end":{"line":131,"column":2}}]},"6":{"line":143,"type":"if","locations":[{"start":{"line":143,"column":2},"end":{"line":143,"column":2}},{"start":{"line":143,"column":2},"end":{"line":143,"column":2}}]},"7":{"line":143,"type":"binary-expr","locations":[{"start":{"line":143,"column":6},"end":{"line":143,"column":33}},{"start":{"line":144,"column":3},"end":{"line":144,"column":39}}]},"8":{"line":157,"type":"if","locations":[{"start":{"line":157,"column":2},"end":{"line":157,"column":2}},{"start":{"line":157,"column":2},"end":{"line":157,"column":2}}]},"9":{"line":169,"type":"if","locations":[{"start":{"line":169,"column":2},"end":{"line":169,"column":2}},{"start":{"line":169,"column":2},"end":{"line":169,"column":2}}]}},"code":["'use strict';","","/**"," * Implements a Service Locator pattern."," */","class ServiceLocator {","","\t/**","\t * Creates a new instance of the service locator class.","\t */","\tconstructor() {","","\t\t/**","\t\t * Current type registrations.","\t\t * @type {Object}","\t\t * @private","\t\t */","\t\tthis._registrations = Object.create(null);","\t}","","\t/**","\t * Registers a new type name in the service locator.","\t * @param {string} type The type name used as a key for resolving instances.","\t * @param {Function} implementation The implementation (constructor or class)","\t * which creates instances of the specified type name.","\t * @param {boolean?} isSingleton If true then the only instance will","\t * be created on the first \"resolve\" call and next calls will","\t * return this instance.","\t */","\tregister(type, implementation, isSingleton) {","\t\tthis._throwIfNotFunction(type, implementation);","\t\tthis._throwIfNotString(type);","","\t\tthis._initializeRegistration(type);","","\t\tthis._registrations[type].unshift({","\t\t\tImplementation: implementation,","\t\t\tisSingleton: Boolean(isSingleton),","\t\t\tsingleInstance: null","\t\t});","\t}","","\t/**","\t * Registers a single instance for the specified type.","\t * @param {string} type The type name for resolving the instance.","\t * @param {Object} instance The instance to register.","\t */","\tregisterInstance(type, instance) {","\t\tthis._throwIfNotString(type);","\t\tthis._initializeRegistration(type);","","\t\tthis._registrations[type].unshift({","\t\t\tImplementation: instance.constructor,","\t\t\tisSingleton: true,","\t\t\tsingleInstance: instance","\t\t});","\t}","","\t/**","\t * Resolves the last registered implementation by the type name.","\t * @param {string} type The type name to resolve.","\t * @returns {Object} The instance of the specified type name.","\t */","\tresolve(type) {","\t\tthis._throwIfNotString(type);","\t\tthis._throwIfNoType(type);","\t\tconst firstRegistration = this._registrations[type][0];","\t\treturn this._createInstance(firstRegistration);","\t}","","\t/**","\t * Resolves all registered implementations by the type name.","\t * @param {string} type The type name for resolving instances.","\t * @returns {Array} The list of instances of the specified type name.","\t */","\tresolveAll(type) {","\t\tthis._throwIfNotString(type);","\t\tthis._throwIfNoType(type);","\t\treturn this._registrations[type]","\t\t\t.map(registration => this._createInstance(registration));","\t}","","\t/**","\t * Unregisters all registrations of the specified type name.","\t * @param {string} type The type name for deleting the registrations.","\t */","\tunregister(type) {","\t\tthis._throwIfNotString(type);","\t\tthis._registrations[type] = [];","\t}","","\t/**","\t * The function checks whether a type exists and if there is at least one instance","\t *","\t * @param {string} type The type name","\t * @returns {boolean}","\t */","\thas(type) {","\t\tthis._throwIfNotString(type);","","\t\treturn (type in this._registrations && this._registrations[type].length > 0);","\t}","","\t/**","\t * Creates an instance for the specified registration descriptor.","\t * @param {Object} registration The registration descriptor object.","\t * @returns {Object} The instance of the implementation found in","\t * the specified registration descriptor.","\t */","\t_createInstance(registration) {","\t\tif (registration.isSingleton && registration.singleInstance !== null) {","\t\t\treturn registration.singleInstance;","\t\t}","","\t\t// inject Service Locator as the only argument of the constructor.","\t\tconst instance = new registration.Implementation(this);","","\t\tif (registration.isSingleton) {","\t\t\tregistration.singleInstance = instance;","\t\t}","","\t\treturn instance;","\t}","","\t/**","\t * Initializes a registration list for the specified type name.","\t * @param {string} type The type name for the registration list.","\t * @private","\t */","\t_initializeRegistration(type) {","\t\tif (type in this._registrations) {","\t\t\treturn;","\t\t}","\t\tthis._registrations[type] = [];","\t}","","\t/**","\t * Throws an error if the specified registration is not found.","\t * @param {string} type The type name to check.","\t * @private","\t */","\t_throwIfNoType(type) {","\t\tif (type in this._registrations &&","\t\t\tthis._registrations[type].length > 0) {","\t\t\treturn;","\t\t}","\t\tthrow new Error(`Type \"${type}\" not registered`);","\t}","","\t/**","\t * Throws an error if the specified implementation is not a function.","\t * @param {string} type The type name of the implementation.","\t * @param {Function} Implementation The implementation to check.","\t * @private","\t */","\t_throwIfNotFunction(type, Implementation) {","\t\tif (Implementation instanceof Function) {","\t\t\treturn;","\t\t}","","\t\tthrow new Error(`Constructor for type ${type} should be a function`);","\t}","","\t/**","\t * Throws an error if the specified type name is not a string.","\t * @param {string} type Type name to check.","\t */","\t_throwIfNotString(type) {","\t\tif (typeof (type) === 'string') {","\t\t\treturn;","\t\t}","","\t\tthrow new Error(`Type name \"${type}\" should be a string`);","\t}","}","","module.exports = ServiceLocator;",""],"l":{"18":0,"31":0,"32":0,"34":0,"36":0,"49":0,"50":0,"52":0,"65":0,"66":0,"67":0,"68":0,"77":0,"78":0,"79":0,"80":0,"88":0,"89":0,"99":0,"101":0,"111":0,"112":0,"116":0,"118":0,"119":0,"122":0,"131":0,"132":0,"134":0,"143":0,"145":0,"147":0,"157":0,"158":0,"161":0,"169":0,"170":0,"173":0,"177":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/browser/Bootstrapper.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/browser/Bootstrapper.js","s":{"1":2,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"b":{},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"(anonymous_1)","line":14,"loc":{"start":{"line":14,"column":12},"end":{"line":14,"column":15}}},"2":{"name":"(anonymous_2)","line":23,"loc":{"start":{"line":23,"column":10},"end":{"line":23,"column":34}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":42}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":65}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":58}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":67}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":49}},"6":{"start":{"line":15,"column":2},"end":{"line":15,"column":18}},"7":{"start":{"line":24,"column":2},"end":{"line":24,"column":41}},"8":{"start":{"line":26,"column":2},"end":{"line":26,"column":61}},"9":{"start":{"line":27,"column":2},"end":{"line":27,"column":65}},"10":{"start":{"line":28,"column":2},"end":{"line":28,"column":57}},"11":{"start":{"line":30,"column":2},"end":{"line":30,"column":45}},"12":{"start":{"line":34,"column":0},"end":{"line":34,"column":36}}},"branchMap":{},"code":["'use strict';","","const Catberry = require('./Catberry.js');","const BootstrapperBase = require('../lib/base/BootstrapperBase');","const StoreDispatcher = require('../lib/StoreDispatcher');","const ModuleApiProvider = require('./providers/ModuleApiProvider');","const CookieWrapper = require('./CookieWrapper');","","class Bootstrapper extends BootstrapperBase {","","\t/**","\t * Creates a new instance of the browser Catberry's bootstrapper.","\t */","\tconstructor() {","\t\tsuper(Catberry);","\t}","","\t/**","\t * Configures a Catberry's service locator.","\t * @param {Object} configObject The application config object.","\t * @param {ServiceLocator} locator The service locator to configure.","\t */","\tconfigure(configObject, locator) {","\t\tsuper.configure(configObject, locator);","","\t\tlocator.register('storeDispatcher', StoreDispatcher, true);","\t\tlocator.register('moduleApiProvider', ModuleApiProvider, true);","\t\tlocator.register('cookieWrapper', CookieWrapper, true);","","\t\tlocator.registerInstance('window', window);","\t}","}","","module.exports = new Bootstrapper();",""],"l":{"3":2,"4":0,"5":0,"6":0,"7":0,"15":0,"24":0,"26":0,"27":0,"28":0,"30":0,"34":0}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/browser/Catberry.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/browser/Catberry.js","s":{"1":4,"2":4,"3":4,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"(anonymous_1)","line":16,"loc":{"start":{"line":16,"column":12},"end":{"line":16,"column":15}}},"2":{"name":"(anonymous_2)","line":30,"loc":{"start":{"line":30,"column":13},"end":{"line":30,"column":16}}},"3":{"name":"(anonymous_3)","line":51,"loc":{"start":{"line":51,"column":15},"end":{"line":51,"column":18}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":57}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":35}},"3":{"start":{"line":7,"column":0},"end":{"line":9,"column":1}},"4":{"start":{"line":8,"column":1},"end":{"line":8,"column":26}},"5":{"start":{"line":17,"column":2},"end":{"line":17,"column":10}},"6":{"start":{"line":24,"column":2},"end":{"line":24,"column":22}},"7":{"start":{"line":31,"column":2},"end":{"line":31,"column":51}},"8":{"start":{"line":32,"column":2},"end":{"line":33,"column":98}},"9":{"start":{"line":33,"column":31},"end":{"line":33,"column":96}},"10":{"start":{"line":35,"column":2},"end":{"line":36,"column":98}},"11":{"start":{"line":36,"column":31},"end":{"line":36,"column":96}},"12":{"start":{"line":38,"column":2},"end":{"line":39,"column":68}},"13":{"start":{"line":39,"column":21},"end":{"line":39,"column":66}},"14":{"start":{"line":41,"column":2},"end":{"line":42,"column":80}},"15":{"start":{"line":42,"column":25},"end":{"line":42,"column":78}},"16":{"start":{"line":44,"column":2},"end":{"line":44,"column":55}},"17":{"start":{"line":52,"column":2},"end":{"line":54,"column":3}},"18":{"start":{"line":53,"column":3},"end":{"line":53,"column":28}},"19":{"start":{"line":56,"column":2},"end":{"line":66,"column":5}},"20":{"start":{"line":57,"column":3},"end":{"line":65,"column":6}},"21":{"start":{"line":58,"column":4},"end":{"line":64,"column":5}},"22":{"start":{"line":59,"column":5},"end":{"line":59,"column":25}},"23":{"start":{"line":60,"column":5},"end":{"line":60,"column":28}},"24":{"start":{"line":61,"column":5},"end":{"line":61,"column":15}},"25":{"start":{"line":63,"column":5},"end":{"line":63,"column":15}},"26":{"start":{"line":70,"column":0},"end":{"line":70,"column":26}}},"branchMap":{"1":{"line":7,"type":"if","locations":[{"start":{"line":7,"column":0},"end":{"line":7,"column":0}},{"start":{"line":7,"column":0},"end":{"line":7,"column":0}}]},"2":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":2},"end":{"line":52,"column":2}},{"start":{"line":52,"column":2},"end":{"line":52,"column":2}}]}},"code":["'use strict';","","const CatberryBase = require('../lib/base/CatberryBase');","","const Promise = require('promise');","// if browser still does not have promises then add it.","if (!('Promise' in window)) {","\twindow.Promise = Promise;","}","","class Catberry extends CatberryBase {","","\t/**","\t * Creates new instance of the browser version of Catberry.","\t */","\tconstructor() {","\t\tsuper();","","\t\t/**","\t\t * Current request router.","\t\t * @type {RequestRouter}","\t\t * @private","\t\t */","\t\tthis._router = null;","\t}","","\t/**","\t * Wraps current HTML document with Catberry event handlers.","\t */","\twrapDocument() {","\t\tconst appDefinitions = require('appDefinitions');","\t\tappDefinitions.routeDefinitions","\t\t\t.forEach(routeDefinition => this.locator.registerInstance('routeDefinition', routeDefinition));","","\t\tappDefinitions.routeDescriptors","\t\t\t.forEach(routeDescriptor => this.locator.registerInstance('routeDescriptor', routeDescriptor));","","\t\tappDefinitions.stores","\t\t\t.forEach(store => this.locator.registerInstance('store', store));","","\t\tappDefinitions.components","\t\t\t.forEach(component => this.locator.registerInstance('component', component));","","\t\tthis._router = this.locator.resolve('requestRouter');","\t}","","\t/**","\t * Starts Catberry application when DOM is ready.","\t * @returns {Promise} Promise for nothing.","\t */","\tstartWhenReady() {","\t\tif (window.catberry) {","\t\t\treturn Promise.resolve();","\t\t}","","\t\treturn new Promise((fulfill, reject) => {","\t\t\twindow.document.addEventListener('DOMContentLoaded', () => {","\t\t\t\ttry {","\t\t\t\t\tthis.wrapDocument();","\t\t\t\t\twindow.catberry = this;","\t\t\t\t\tfulfill();","\t\t\t\t} catch (e) {","\t\t\t\t\treject(e);","\t\t\t\t}","\t\t\t});","\t\t});","\t}","}","","module.exports = Catberry;",""],"l":{"3":4,"5":4,"7":4,"8":0,"17":0,"24":0,"31":0,"32":0,"33":0,"35":0,"36":0,"38":0,"39":0,"41":0,"42":0,"44":0,"52":0,"53":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"63":0,"70":0}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/browser/CookieWrapper.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/browser/CookieWrapper.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":1},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"(anonymous_1)","line":11,"loc":{"start":{"line":11,"column":12},"end":{"line":11,"column":22}}},"2":{"name":"(anonymous_2)","line":26,"loc":{"start":{"line":26,"column":16},"end":{"line":26,"column":19}}},"3":{"name":"(anonymous_3)","line":45,"loc":{"start":{"line":45,"column":4},"end":{"line":45,"column":18}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":67}},"2":{"start":{"line":12,"column":2},"end":{"line":12,"column":10}},"3":{"start":{"line":19,"column":2},"end":{"line":19,"column":43}},"4":{"start":{"line":27,"column":2},"end":{"line":29,"column":6}},"5":{"start":{"line":46,"column":2},"end":{"line":46,"column":57}},"6":{"start":{"line":47,"column":2},"end":{"line":47,"column":40}},"7":{"start":{"line":48,"column":2},"end":{"line":48,"column":16}},"8":{"start":{"line":52,"column":0},"end":{"line":52,"column":31}}},"branchMap":{"1":{"line":27,"type":"cond-expr","locations":[{"start":{"line":28,"column":3},"end":{"line":28,"column":42}},{"start":{"line":29,"column":3},"end":{"line":29,"column":5}}]}},"code":["'use strict';","","const CookieWrapperBase = require('../lib/base/CookieWrapperBase');","","class CookieWrapper extends CookieWrapperBase {","","\t/**","\t * Creates a new instance of the browser cookie wrapper.","\t * @param {ServiceLocator} locator The service locator for resolving dependencies.","\t */","\tconstructor(locator) {","\t\tsuper();","","\t\t/**","\t\t * Current browser window.","\t\t * @type {Window}","\t\t * @private","\t\t */","\t\tthis._window = locator.resolve('window');","\t}","","\t/**","\t * Gets current cookie string.","\t * @returns {string} Cookie string.","\t */","\tgetCookieString() {","\t\treturn this._window.document.cookie ?","\t\t\tthis._window.document.cookie.toString() :","\t\t\t'';","\t}","","\t/**","\t * Sets cookie to this wrapper.","\t * @param {Object} cookieSetup Cookie setup object.","\t * @param {string} cookieSetup.key Cookie key.","\t * @param {string} cookieSetup.value Cookie value.","\t * @param {number?} cookieSetup.maxAge Max cookie age in seconds.","\t * @param {Date?} cookieSetup.expires Expire date.","\t * @param {string?} cookieSetup.path URI path for cookie.","\t * @param {string?} cookieSetup.domain Cookie domain.","\t * @param {boolean?} cookieSetup.secure Is cookie secured.","\t * @param {boolean?} cookieSetup.httpOnly Is cookie HTTP only.","\t * @returns {string} Cookie setup string.","\t */","\tset(cookieSetup) {","\t\tconst cookie = this._convertToCookieSetup(cookieSetup);","\t\tthis._window.document.cookie = cookie;","\t\treturn cookie;","\t}","}","","module.exports = CookieWrapper;",""],"l":{"3":1,"12":0,"19":0,"27":0,"46":0,"47":0,"48":0,"52":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/browser/DocumentRenderer.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/browser/DocumentRenderer.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"204":0,"205":0,"206":0,"207":0,"208":0,"209":0,"210":0,"211":0,"212":0,"213":0,"214":0,"215":0,"216":0,"217":0,"218":0,"219":0,"220":0,"221":0,"222":0,"223":0,"224":0,"225":0,"226":0,"227":0,"228":0,"229":0,"230":0,"231":0,"232":0,"233":0,"234":0,"235":0,"236":0,"237":0,"238":0,"239":0,"240":0,"241":0,"242":0,"243":0,"244":0,"245":0,"246":0,"247":0,"248":0,"249":0,"250":0,"251":0,"252":0,"253":0,"254":0,"255":0,"256":0,"257":0,"258":0,"259":0,"260":0,"261":0,"262":0,"263":0,"264":0,"265":0,"266":0,"267":0,"268":0,"269":0,"270":0,"271":0,"272":0,"273":0,"274":0,"275":0,"276":0,"277":0,"278":0,"279":0,"280":0,"281":0,"282":0,"283":0,"284":0,"285":0,"286":0,"287":0,"288":0,"289":0,"290":0,"291":0,"292":0,"293":0,"294":0,"295":0,"296":0,"297":0,"298":0,"299":0,"300":0,"301":0,"302":0,"303":0,"304":0,"305":0,"306":0,"307":0,"308":0,"309":0,"310":0,"311":0,"312":0,"313":0,"314":0,"315":0,"316":0,"317":0,"318":0,"319":0,"320":0,"321":0,"322":0,"323":0,"324":0,"325":0,"326":0,"327":0,"328":0,"329":0,"330":0,"331":0,"332":0,"333":0,"334":0,"335":0,"336":0,"337":0,"338":0,"339":0,"340":0,"341":0,"342":0,"343":0,"344":0,"345":0,"346":0,"347":0,"348":0,"349":0,"350":0,"351":0,"352":0,"353":0,"354":0,"355":0,"356":0,"357":0,"358":0,"359":0,"360":0,"361":0,"362":0,"363":0,"364":0,"365":0,"366":0,"367":0,"368":0,"369":0,"370":0,"371":0,"372":0,"373":0,"374":0,"375":0,"376":0,"377":0,"378":0,"379":0,"380":0,"381":0,"382":0,"383":0,"384":0,"385":0,"386":0,"387":0,"388":0,"389":0,"390":0,"391":0,"392":0,"393":0,"394":0,"395":0,"396":0,"397":0,"398":0,"399":0,"400":0,"401":0,"402":0,"403":0,"404":0,"405":0,"406":0,"407":0,"408":0,"409":0,"410":0,"411":0,"412":0,"413":0,"414":0,"415":0,"416":0,"417":0,"418":0,"419":0,"420":1,"421":0,"422":0,"423":0,"424":0,"425":1,"426":0,"427":0,"428":0,"429":0,"430":1,"431":0,"432":0,"433":0,"434":0,"435":0,"436":0,"437":0,"438":0,"439":0,"440":0,"441":0,"442":0,"443":0,"444":0,"445":0,"446":0,"447":0,"448":0,"449":1,"450":0,"451":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0,0,0],"48":[0,0],"49":[0,0],"50":[0,0],"51":[0,0],"52":[0,0],"53":[0,0],"54":[0,0],"55":[0,0],"56":[0,0],"57":[0,0],"58":[0,0],"59":[0,0],"60":[0,0],"61":[0,0],"62":[0,0],"63":[0,0],"64":[0,0],"65":[0,0],"66":[0,0],"67":[0,0],"68":[0,0],"69":[0,0],"70":[0,0],"71":[0,0],"72":[0,0],"73":[0,0],"74":[0,0],"75":[0,0],"76":[0,0],"77":[0,0],"78":[0,0],"79":[0,0],"80":[0,0],"81":[0,0,0,0,0,0],"82":[0,0,0],"83":[0,0],"84":[0,0,0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0},"fnMap":{"1":{"name":"(anonymous_1)","line":40,"loc":{"start":{"line":40,"column":12},"end":{"line":40,"column":22}}},"2":{"name":"(anonymous_2)","line":133,"loc":{"start":{"line":133,"column":14},"end":{"line":133,"column":38}}},"3":{"name":"(anonymous_3)","line":156,"loc":{"start":{"line":156,"column":7},"end":{"line":156,"column":31}}},"4":{"name":"(anonymous_4)","line":185,"loc":{"start":{"line":185,"column":16},"end":{"line":185,"column":44}}},"5":{"name":"(anonymous_5)","line":291,"loc":{"start":{"line":291,"column":17},"end":{"line":291,"column":22}}},"6":{"name":"(anonymous_6)","line":302,"loc":{"start":{"line":302,"column":23},"end":{"line":302,"column":51}}},"7":{"name":"(anonymous_7)","line":314,"loc":{"start":{"line":314,"column":26},"end":{"line":314,"column":54}}},"8":{"name":"(anonymous_8)","line":326,"loc":{"start":{"line":326,"column":23},"end":{"line":326,"column":50}}},"9":{"name":"(anonymous_9)","line":338,"loc":{"start":{"line":338,"column":25},"end":{"line":338,"column":54}}},"10":{"name":"(anonymous_10)","line":349,"loc":{"start":{"line":349,"column":22},"end":{"line":349,"column":32}}},"11":{"name":"(anonymous_11)","line":366,"loc":{"start":{"line":366,"column":15},"end":{"line":366,"column":18}}},"12":{"name":"(anonymous_12)","line":406,"loc":{"start":{"line":406,"column":16},"end":{"line":406,"column":38}}},"13":{"name":"(anonymous_13)","line":440,"loc":{"start":{"line":440,"column":25},"end":{"line":440,"column":44}}},"14":{"name":"(anonymous_14)","line":459,"loc":{"start":{"line":459,"column":26},"end":{"line":459,"column":36}}},"15":{"name":"(anonymous_15)","line":474,"loc":{"start":{"line":474,"column":25},"end":{"line":474,"column":35}}},"16":{"name":"(anonymous_16)","line":487,"loc":{"start":{"line":487,"column":11},"end":{"line":487,"column":39}}},"17":{"name":"(anonymous_17)","line":502,"loc":{"start":{"line":502,"column":17},"end":{"line":502,"column":27}}},"18":{"name":"(anonymous_18)","line":537,"loc":{"start":{"line":537,"column":21},"end":{"line":537,"column":26}}},"19":{"name":"(anonymous_19)","line":549,"loc":{"start":{"line":549,"column":15},"end":{"line":549,"column":25}}},"20":{"name":"(anonymous_20)","line":606,"loc":{"start":{"line":606,"column":22},"end":{"line":606,"column":56}}},"21":{"name":"(anonymous_21)","line":647,"loc":{"start":{"line":647,"column":18},"end":{"line":647,"column":63}}},"22":{"name":"(anonymous_22)","line":663,"loc":{"start":{"line":663,"column":20},"end":{"line":663,"column":42}}},"23":{"name":"(anonymous_23)","line":676,"loc":{"start":{"line":676,"column":19},"end":{"line":676,"column":25}}},"24":{"name":"(anonymous_24)","line":688,"loc":{"start":{"line":688,"column":25},"end":{"line":688,"column":36}}},"25":{"name":"(anonymous_25)","line":708,"loc":{"start":{"line":708,"column":20},"end":{"line":708,"column":51}}},"26":{"name":"(anonymous_26)","line":725,"loc":{"start":{"line":725,"column":22},"end":{"line":725,"column":41}}},"27":{"name":"(anonymous_27)","line":757,"loc":{"start":{"line":757,"column":19},"end":{"line":757,"column":47}}},"28":{"name":"(anonymous_28)","line":783,"loc":{"start":{"line":783,"column":23},"end":{"line":783,"column":26}}},"29":{"name":"(anonymous_29)","line":861,"loc":{"start":{"line":861,"column":11},"end":{"line":861,"column":27}}},"30":{"name":"(anonymous_30)","line":899,"loc":{"start":{"line":899,"column":15},"end":{"line":899,"column":25}}},"31":{"name":"(anonymous_31)","line":923,"loc":{"start":{"line":923,"column":21},"end":{"line":923,"column":43}}},"32":{"name":"(anonymous_32)","line":961,"loc":{"start":{"line":961,"column":21},"end":{"line":961,"column":42}}},"33":{"name":"(anonymous_33)","line":1024,"loc":{"start":{"line":1024,"column":20},"end":{"line":1024,"column":40}}},"34":{"name":"(anonymous_34)","line":1126,"loc":{"start":{"line":1126,"column":24},"end":{"line":1126,"column":40}}},"35":{"name":"(anonymous_35)","line":1147,"loc":{"start":{"line":1147,"column":7},"end":{"line":1147,"column":17}}},"36":{"name":"(anonymous_36)","line":1173,"loc":{"start":{"line":1173,"column":18},"end":{"line":1173,"column":28}}},"37":{"name":"attributesToObject","line":1192,"loc":{"start":{"line":1192,"column":0},"end":{"line":1192,"column":40}}},"38":{"name":"matches","line":1207,"loc":{"start":{"line":1207,"column":0},"end":{"line":1207,"column":51}}},"39":{"name":"createCustomEvent","line":1219,"loc":{"start":{"line":1219,"column":0},"end":{"line":1219,"column":55}}},"40":{"name":"isTagImmutable","line":1258,"loc":{"start":{"line":1258,"column":0},"end":{"line":1258,"column":33}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":37}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":29}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":58}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":60}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":60}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":73}},"7":{"start":{"line":10,"column":0},"end":{"line":13,"column":2}},"8":{"start":{"line":14,"column":0},"end":{"line":19,"column":2}},"9":{"start":{"line":22,"column":0},"end":{"line":32,"column":2}},"10":{"start":{"line":41,"column":2},"end":{"line":41,"column":17}},"11":{"start":{"line":48,"column":2},"end":{"line":48,"column":49}},"12":{"start":{"line":55,"column":2},"end":{"line":55,"column":48}},"13":{"start":{"line":62,"column":2},"end":{"line":62,"column":48}},"14":{"start":{"line":69,"column":2},"end":{"line":69,"column":51}},"15":{"start":{"line":74,"column":2},"end":{"line":74,"column":43}},"16":{"start":{"line":81,"column":2},"end":{"line":81,"column":43}},"17":{"start":{"line":88,"column":2},"end":{"line":88,"column":61}},"18":{"start":{"line":95,"column":2},"end":{"line":95,"column":31}},"19":{"start":{"line":102,"column":2},"end":{"line":102,"column":27}},"20":{"start":{"line":109,"column":2},"end":{"line":109,"column":31}},"21":{"start":{"line":116,"column":2},"end":{"line":116,"column":37}},"22":{"start":{"line":118,"column":2},"end":{"line":124,"column":5}},"23":{"start":{"line":119,"column":3},"end":{"line":119,"column":48}},"24":{"start":{"line":120,"column":3},"end":{"line":122,"column":4}},"25":{"start":{"line":121,"column":4},"end":{"line":121,"column":11}},"26":{"start":{"line":123,"column":3},"end":{"line":123,"column":33}},"27":{"start":{"line":134,"column":2},"end":{"line":147,"column":6}},"28":{"start":{"line":136,"column":4},"end":{"line":136,"column":49}},"29":{"start":{"line":137,"column":4},"end":{"line":137,"column":65}},"30":{"start":{"line":140,"column":4},"end":{"line":140,"column":68}},"31":{"start":{"line":141,"column":4},"end":{"line":141,"column":66}},"32":{"start":{"line":142,"column":4},"end":{"line":142,"column":77}},"33":{"start":{"line":142,"column":30},"end":{"line":142,"column":76}},"34":{"start":{"line":143,"column":4},"end":{"line":143,"column":75}},"35":{"start":{"line":145,"column":15},"end":{"line":147,"column":4}},"36":{"start":{"line":157,"column":2},"end":{"line":160,"column":4}},"37":{"start":{"line":161,"column":2},"end":{"line":163,"column":3}},"38":{"start":{"line":162,"column":3},"end":{"line":162,"column":32}},"39":{"start":{"line":167,"column":2},"end":{"line":167,"column":31}},"40":{"start":{"line":169,"column":2},"end":{"line":175,"column":6}},"41":{"start":{"line":171,"column":15},"end":{"line":171,"column":44}},"42":{"start":{"line":172,"column":20},"end":{"line":172,"column":56}},"43":{"start":{"line":174,"column":4},"end":{"line":174,"column":34}},"44":{"start":{"line":177,"column":2},"end":{"line":177,"column":31}},"45":{"start":{"line":186,"column":2},"end":{"line":283,"column":6}},"46":{"start":{"line":188,"column":4},"end":{"line":188,"column":36}},"47":{"start":{"line":189,"column":4},"end":{"line":189,"column":81}},"48":{"start":{"line":191,"column":4},"end":{"line":194,"column":5}},"49":{"start":{"line":192,"column":5},"end":{"line":192,"column":57}},"50":{"start":{"line":193,"column":5},"end":{"line":193,"column":41}},"51":{"start":{"line":196,"column":4},"end":{"line":196,"column":54}},"52":{"start":{"line":197,"column":4},"end":{"line":197,"column":65}},"53":{"start":{"line":198,"column":4},"end":{"line":200,"column":5}},"54":{"start":{"line":199,"column":5},"end":{"line":199,"column":17}},"55":{"start":{"line":202,"column":4},"end":{"line":202,"column":44}},"56":{"start":{"line":204,"column":4},"end":{"line":204,"column":48}},"57":{"start":{"line":205,"column":4},"end":{"line":211,"column":5}},"58":{"start":{"line":206,"column":5},"end":{"line":207,"column":52}},"59":{"start":{"line":208,"column":5},"end":{"line":208,"column":64}},"60":{"start":{"line":209,"column":5},"end":{"line":209,"column":66}},"61":{"start":{"line":210,"column":5},"end":{"line":210,"column":45}},"62":{"start":{"line":213,"column":4},"end":{"line":216,"column":6}},"63":{"start":{"line":218,"column":4},"end":{"line":218,"column":42}},"64":{"start":{"line":220,"column":4},"end":{"line":220,"column":41}},"65":{"start":{"line":221,"column":4},"end":{"line":221,"column":54}},"66":{"start":{"line":223,"column":4},"end":{"line":282,"column":60}},"67":{"start":{"line":227,"column":6},"end":{"line":229,"column":7}},"68":{"start":{"line":228,"column":7},"end":{"line":228,"column":17}},"69":{"start":{"line":231,"column":6},"end":{"line":231,"column":56}},"70":{"start":{"line":233,"column":22},"end":{"line":233,"column":58}},"71":{"start":{"line":235,"column":6},"end":{"line":235,"column":78}},"72":{"start":{"line":236,"column":6},"end":{"line":236,"column":55}},"73":{"start":{"line":238,"column":26},"end":{"line":238,"column":64}},"74":{"start":{"line":239,"column":22},"end":{"line":239,"column":73}},"75":{"start":{"line":241,"column":6},"end":{"line":241,"column":56}},"76":{"start":{"line":242,"column":6},"end":{"line":244,"column":7}},"77":{"start":{"line":243,"column":7},"end":{"line":243,"column":17}},"78":{"start":{"line":246,"column":6},"end":{"line":246,"column":50}},"79":{"start":{"line":247,"column":6},"end":{"line":247,"column":34}},"80":{"start":{"line":249,"column":6},"end":{"line":252,"column":7}},"81":{"start":{"line":250,"column":7},"end":{"line":250,"column":44}},"82":{"start":{"line":251,"column":7},"end":{"line":251,"column":17}},"83":{"start":{"line":254,"column":6},"end":{"line":259,"column":9}},"84":{"start":{"line":256,"column":8},"end":{"line":258,"column":9}},"85":{"start":{"line":261,"column":6},"end":{"line":264,"column":68}},"86":{"start":{"line":264,"column":21},"end":{"line":264,"column":66}},"87":{"start":{"line":266,"column":6},"end":{"line":266,"column":35}},"88":{"start":{"line":269,"column":6},"end":{"line":269,"column":53}},"89":{"start":{"line":270,"column":6},"end":{"line":270,"column":69}},"90":{"start":{"line":271,"column":6},"end":{"line":271,"column":58}},"91":{"start":{"line":272,"column":6},"end":{"line":272,"column":42}},"92":{"start":{"line":277,"column":6},"end":{"line":279,"column":7}},"93":{"start":{"line":278,"column":7},"end":{"line":278,"column":14}},"94":{"start":{"line":280,"column":6},"end":{"line":280,"column":54}},"95":{"start":{"line":282,"column":22},"end":{"line":282,"column":58}},"96":{"start":{"line":292,"column":2},"end":{"line":292,"column":59}},"97":{"start":{"line":293,"column":2},"end":{"line":293,"column":45}},"98":{"start":{"line":303,"column":2},"end":{"line":304,"column":60}},"99":{"start":{"line":305,"column":2},"end":{"line":305,"column":68}},"100":{"start":{"line":315,"column":2},"end":{"line":316,"column":60}},"101":{"start":{"line":317,"column":2},"end":{"line":317,"column":74}},"102":{"start":{"line":327,"column":2},"end":{"line":328,"column":60}},"103":{"start":{"line":329,"column":2},"end":{"line":329,"column":77}},"104":{"start":{"line":339,"column":2},"end":{"line":340,"column":60}},"105":{"start":{"line":341,"column":2},"end":{"line":341,"column":81}},"106":{"start":{"line":350,"column":2},"end":{"line":352,"column":3}},"107":{"start":{"line":351,"column":3},"end":{"line":351,"column":15}},"108":{"start":{"line":353,"column":2},"end":{"line":353,"column":48}},"109":{"start":{"line":354,"column":2},"end":{"line":356,"column":3}},"110":{"start":{"line":355,"column":3},"end":{"line":355,"column":15}},"111":{"start":{"line":357,"column":2},"end":{"line":357,"column":46}},"112":{"start":{"line":367,"column":2},"end":{"line":397,"column":6}},"113":{"start":{"line":369,"column":4},"end":{"line":372,"column":6}},"114":{"start":{"line":374,"column":4},"end":{"line":394,"column":8}},"115":{"start":{"line":377,"column":6},"end":{"line":379,"column":7}},"116":{"start":{"line":378,"column":7},"end":{"line":378,"column":14}},"117":{"start":{"line":381,"column":6},"end":{"line":381,"column":48}},"118":{"start":{"line":382,"column":6},"end":{"line":393,"column":7}},"119":{"start":{"line":384,"column":7},"end":{"line":387,"column":8}},"120":{"start":{"line":385,"column":8},"end":{"line":385,"column":36}},"121":{"start":{"line":386,"column":8},"end":{"line":386,"column":14}},"122":{"start":{"line":389,"column":7},"end":{"line":391,"column":8}},"123":{"start":{"line":390,"column":8},"end":{"line":390,"column":14}},"124":{"start":{"line":392,"column":7},"end":{"line":392,"column":39}},"125":{"start":{"line":396,"column":4},"end":{"line":396,"column":51}},"126":{"start":{"line":407,"column":2},"end":{"line":411,"column":3}},"127":{"start":{"line":408,"column":3},"end":{"line":410,"column":5}},"128":{"start":{"line":412,"column":2},"end":{"line":412,"column":49}},"129":{"start":{"line":414,"column":2},"end":{"line":432,"column":6}},"130":{"start":{"line":416,"column":4},"end":{"line":416,"column":68}},"131":{"start":{"line":417,"column":4},"end":{"line":417,"column":73}},"132":{"start":{"line":419,"column":4},"end":{"line":423,"column":5}},"133":{"start":{"line":422,"column":5},"end":{"line":422,"column":82}},"134":{"start":{"line":425,"column":4},"end":{"line":425,"column":79}},"135":{"start":{"line":426,"column":4},"end":{"line":426,"column":69}},"136":{"start":{"line":427,"column":4},"end":{"line":428,"column":95}},"137":{"start":{"line":428,"column":31},"end":{"line":428,"column":93}},"138":{"start":{"line":430,"column":4},"end":{"line":431,"column":26}},"139":{"start":{"line":431,"column":17},"end":{"line":431,"column":24}},"140":{"start":{"line":441,"column":2},"end":{"line":450,"column":6}},"141":{"start":{"line":445,"column":4},"end":{"line":447,"column":5}},"142":{"start":{"line":446,"column":5},"end":{"line":446,"column":12}},"143":{"start":{"line":449,"column":4},"end":{"line":449,"column":34}},"144":{"start":{"line":460,"column":2},"end":{"line":462,"column":3}},"145":{"start":{"line":461,"column":3},"end":{"line":461,"column":28}},"146":{"start":{"line":463,"column":2},"end":{"line":463,"column":35}},"147":{"start":{"line":464,"column":2},"end":{"line":465,"column":56}},"148":{"start":{"line":464,"column":73},"end":{"line":464,"column":111}},"149":{"start":{"line":465,"column":15},"end":{"line":465,"column":54}},"150":{"start":{"line":475,"column":2},"end":{"line":475,"column":34}},"151":{"start":{"line":476,"column":2},"end":{"line":477,"column":46}},"152":{"start":{"line":477,"column":15},"end":{"line":477,"column":44}},"153":{"start":{"line":488,"column":2},"end":{"line":492,"column":4}},"154":{"start":{"line":489,"column":3},"end":{"line":489,"column":40}},"155":{"start":{"line":490,"column":3},"end":{"line":490,"column":42}},"156":{"start":{"line":491,"column":3},"end":{"line":491,"column":46}},"157":{"start":{"line":493,"column":2},"end":{"line":493,"column":82}},"158":{"start":{"line":503,"column":2},"end":{"line":503,"column":34}},"159":{"start":{"line":504,"column":2},"end":{"line":504,"column":48}},"160":{"start":{"line":506,"column":2},"end":{"line":508,"column":3}},"161":{"start":{"line":507,"column":3},"end":{"line":507,"column":28}},"162":{"start":{"line":509,"column":2},"end":{"line":519,"column":3}},"163":{"start":{"line":510,"column":3},"end":{"line":517,"column":7}},"164":{"start":{"line":512,"column":5},"end":{"line":516,"column":7}},"165":{"start":{"line":518,"column":3},"end":{"line":518,"column":38}},"166":{"start":{"line":521,"column":2},"end":{"line":521,"column":74}},"167":{"start":{"line":522,"column":2},"end":{"line":529,"column":58}},"168":{"start":{"line":524,"column":4},"end":{"line":527,"column":7}},"169":{"start":{"line":529,"column":20},"end":{"line":529,"column":56}},"170":{"start":{"line":538,"column":2},"end":{"line":538,"column":37}},"171":{"start":{"line":539,"column":2},"end":{"line":539,"column":38}},"172":{"start":{"line":540,"column":2},"end":{"line":540,"column":37}},"173":{"start":{"line":550,"column":2},"end":{"line":550,"column":34}},"174":{"start":{"line":551,"column":2},"end":{"line":551,"column":48}},"175":{"start":{"line":552,"column":2},"end":{"line":554,"column":3}},"176":{"start":{"line":553,"column":3},"end":{"line":553,"column":28}},"177":{"start":{"line":556,"column":2},"end":{"line":556,"column":70}},"178":{"start":{"line":557,"column":2},"end":{"line":596,"column":6}},"179":{"start":{"line":559,"column":4},"end":{"line":565,"column":5}},"180":{"start":{"line":560,"column":5},"end":{"line":563,"column":8}},"181":{"start":{"line":564,"column":5},"end":{"line":564,"column":12}},"182":{"start":{"line":566,"column":4},"end":{"line":566,"column":54}},"183":{"start":{"line":567,"column":4},"end":{"line":591,"column":8}},"184":{"start":{"line":569,"column":6},"end":{"line":569,"column":42}},"185":{"start":{"line":570,"column":6},"end":{"line":572,"column":7}},"186":{"start":{"line":571,"column":7},"end":{"line":571,"column":14}},"187":{"start":{"line":573,"column":6},"end":{"line":573,"column":51}},"188":{"start":{"line":574,"column":6},"end":{"line":581,"column":10}},"189":{"start":{"line":576,"column":8},"end":{"line":576,"column":54}},"190":{"start":{"line":577,"column":8},"end":{"line":579,"column":9}},"191":{"start":{"line":578,"column":9},"end":{"line":578,"column":16}},"192":{"start":{"line":580,"column":8},"end":{"line":580,"column":60}},"193":{"start":{"line":582,"column":6},"end":{"line":585,"column":8}},"194":{"start":{"line":586,"column":6},"end":{"line":590,"column":8}},"195":{"start":{"line":592,"column":4},"end":{"line":595,"column":7}},"196":{"start":{"line":607,"column":2},"end":{"line":607,"column":50}},"197":{"start":{"line":608,"column":2},"end":{"line":636,"column":4}},"198":{"start":{"line":609,"column":3},"end":{"line":609,"column":30}},"199":{"start":{"line":610,"column":3},"end":{"line":610,"column":67}},"200":{"start":{"line":610,"column":58},"end":{"line":610,"column":65}},"201":{"start":{"line":611,"column":3},"end":{"line":611,"column":55}},"202":{"start":{"line":612,"column":3},"end":{"line":618,"column":6}},"203":{"start":{"line":613,"column":4},"end":{"line":616,"column":5}},"204":{"start":{"line":614,"column":5},"end":{"line":614,"column":49}},"205":{"start":{"line":615,"column":5},"end":{"line":615,"column":17}},"206":{"start":{"line":617,"column":4},"end":{"line":617,"column":17}},"207":{"start":{"line":620,"column":3},"end":{"line":622,"column":4}},"208":{"start":{"line":621,"column":4},"end":{"line":621,"column":11}},"209":{"start":{"line":626,"column":3},"end":{"line":635,"column":4}},"210":{"start":{"line":627,"column":4},"end":{"line":627,"column":33}},"211":{"start":{"line":628,"column":4},"end":{"line":628,"column":52}},"212":{"start":{"line":629,"column":4},"end":{"line":631,"column":6}},"213":{"start":{"line":632,"column":4},"end":{"line":634,"column":5}},"214":{"start":{"line":633,"column":5},"end":{"line":633,"column":11}},"215":{"start":{"line":648,"column":2},"end":{"line":654,"column":5}},"216":{"start":{"line":649,"column":3},"end":{"line":651,"column":4}},"217":{"start":{"line":650,"column":4},"end":{"line":650,"column":17}},"218":{"start":{"line":652,"column":3},"end":{"line":652,"column":29}},"219":{"start":{"line":653,"column":3},"end":{"line":653,"column":15}},"220":{"start":{"line":664,"column":2},"end":{"line":666,"column":3}},"221":{"start":{"line":665,"column":3},"end":{"line":665,"column":16}},"222":{"start":{"line":667,"column":2},"end":{"line":667,"column":79}},"223":{"start":{"line":677,"column":2},"end":{"line":679,"column":56}},"224":{"start":{"line":689,"column":2},"end":{"line":689,"column":21}},"225":{"start":{"line":690,"column":2},"end":{"line":696,"column":6}},"226":{"start":{"line":692,"column":4},"end":{"line":692,"column":58}},"227":{"start":{"line":693,"column":4},"end":{"line":695,"column":5}},"228":{"start":{"line":694,"column":5},"end":{"line":694,"column":29}},"229":{"start":{"line":697,"column":2},"end":{"line":697,"column":17}},"230":{"start":{"line":709,"column":2},"end":{"line":711,"column":3}},"231":{"start":{"line":710,"column":3},"end":{"line":710,"column":28}},"232":{"start":{"line":713,"column":2},"end":{"line":713,"column":32}},"233":{"start":{"line":714,"column":2},"end":{"line":714,"column":75}},"234":{"start":{"line":715,"column":2},"end":{"line":716,"column":29}},"235":{"start":{"line":716,"column":15},"end":{"line":716,"column":27}},"236":{"start":{"line":726,"column":2},"end":{"line":726,"column":22}},"237":{"start":{"line":727,"column":2},"end":{"line":727,"column":23}},"238":{"start":{"line":730,"column":2},"end":{"line":745,"column":3}},"239":{"start":{"line":731,"column":3},"end":{"line":731,"column":50}},"240":{"start":{"line":732,"column":3},"end":{"line":734,"column":4}},"241":{"start":{"line":733,"column":4},"end":{"line":733,"column":13}},"242":{"start":{"line":736,"column":3},"end":{"line":744,"column":6}},"243":{"start":{"line":738,"column":4},"end":{"line":741,"column":5}},"244":{"start":{"line":739,"column":5},"end":{"line":739,"column":30}},"245":{"start":{"line":740,"column":5},"end":{"line":740,"column":12}},"246":{"start":{"line":743,"column":4},"end":{"line":743,"column":32}},"247":{"start":{"line":746,"column":2},"end":{"line":746,"column":18}},"248":{"start":{"line":758,"column":2},"end":{"line":758,"column":38}},"249":{"start":{"line":760,"column":2},"end":{"line":775,"column":20}},"250":{"start":{"line":763,"column":4},"end":{"line":765,"column":5}},"251":{"start":{"line":764,"column":5},"end":{"line":764,"column":15}},"252":{"start":{"line":767,"column":4},"end":{"line":771,"column":5}},"253":{"start":{"line":768,"column":5},"end":{"line":768,"column":77}},"254":{"start":{"line":769,"column":11},"end":{"line":771,"column":5}},"255":{"start":{"line":770,"column":5},"end":{"line":770,"column":50}},"256":{"start":{"line":773,"column":4},"end":{"line":773,"column":14}},"257":{"start":{"line":775,"column":16},"end":{"line":775,"column":18}},"258":{"start":{"line":784,"column":2},"end":{"line":786,"column":3}},"259":{"start":{"line":785,"column":3},"end":{"line":785,"column":28}},"260":{"start":{"line":789,"column":2},"end":{"line":791,"column":4}},"261":{"start":{"line":792,"column":2},"end":{"line":800,"column":3}},"262":{"start":{"line":793,"column":3},"end":{"line":793,"column":71}},"263":{"start":{"line":794,"column":3},"end":{"line":797,"column":4}},"264":{"start":{"line":795,"column":4},"end":{"line":795,"column":35}},"265":{"start":{"line":796,"column":4},"end":{"line":796,"column":29}},"266":{"start":{"line":798,"column":3},"end":{"line":798,"column":45}},"267":{"start":{"line":799,"column":3},"end":{"line":799,"column":28}},"268":{"start":{"line":802,"column":2},"end":{"line":802,"column":26}},"269":{"start":{"line":805,"column":2},"end":{"line":827,"column":3}},"270":{"start":{"line":806,"column":3},"end":{"line":806,"column":67}},"271":{"start":{"line":807,"column":3},"end":{"line":810,"column":5}},"272":{"start":{"line":812,"column":3},"end":{"line":814,"column":6}},"273":{"start":{"line":813,"column":4},"end":{"line":813,"column":44}},"274":{"start":{"line":817,"column":3},"end":{"line":817,"column":70}},"275":{"start":{"line":818,"column":3},"end":{"line":825,"column":7}},"276":{"start":{"line":820,"column":5},"end":{"line":820,"column":51}},"277":{"start":{"line":821,"column":5},"end":{"line":824,"column":7}},"278":{"start":{"line":826,"column":3},"end":{"line":826,"column":32}},"279":{"start":{"line":829,"column":2},"end":{"line":829,"column":64}},"280":{"start":{"line":830,"column":2},"end":{"line":833,"column":3}},"281":{"start":{"line":831,"column":3},"end":{"line":831,"column":28}},"282":{"start":{"line":832,"column":3},"end":{"line":832,"column":28}},"283":{"start":{"line":835,"column":2},"end":{"line":835,"column":51}},"284":{"start":{"line":837,"column":2},"end":{"line":837,"column":71}},"285":{"start":{"line":838,"column":2},"end":{"line":841,"column":5}},"286":{"start":{"line":839,"column":3},"end":{"line":839,"column":54}},"287":{"start":{"line":840,"column":3},"end":{"line":840,"column":55}},"288":{"start":{"line":843,"column":2},"end":{"line":849,"column":6}},"289":{"start":{"line":844,"column":20},"end":{"line":844,"column":56}},"290":{"start":{"line":846,"column":4},"end":{"line":846,"column":29}},"291":{"start":{"line":847,"column":4},"end":{"line":847,"column":58}},"292":{"start":{"line":848,"column":4},"end":{"line":848,"column":41}},"293":{"start":{"line":862,"column":2},"end":{"line":864,"column":3}},"294":{"start":{"line":863,"column":3},"end":{"line":863,"column":10}},"295":{"start":{"line":866,"column":2},"end":{"line":866,"column":38}},"296":{"start":{"line":869,"column":2},"end":{"line":879,"column":3}},"297":{"start":{"line":870,"column":3},"end":{"line":870,"column":38}},"298":{"start":{"line":871,"column":3},"end":{"line":875,"column":4}},"299":{"start":{"line":872,"column":4},"end":{"line":872,"column":30}},"300":{"start":{"line":873,"column":4},"end":{"line":873,"column":8}},"301":{"start":{"line":874,"column":4},"end":{"line":874,"column":13}},"302":{"start":{"line":878,"column":3},"end":{"line":878,"column":48}},"303":{"start":{"line":881,"column":2},"end":{"line":890,"column":3}},"304":{"start":{"line":882,"column":3},"end":{"line":882,"column":39}},"305":{"start":{"line":883,"column":3},"end":{"line":885,"column":4}},"306":{"start":{"line":884,"column":4},"end":{"line":884,"column":13}},"307":{"start":{"line":886,"column":3},"end":{"line":886,"column":29}},"308":{"start":{"line":889,"column":3},"end":{"line":889,"column":7}},"309":{"start":{"line":902,"column":2},"end":{"line":902,"column":24}},"310":{"start":{"line":904,"column":2},"end":{"line":911,"column":3}},"311":{"start":{"line":906,"column":4},"end":{"line":906,"column":60}},"312":{"start":{"line":907,"column":4},"end":{"line":907,"column":10}},"313":{"start":{"line":909,"column":4},"end":{"line":909,"column":58}},"314":{"start":{"line":910,"column":4},"end":{"line":910,"column":10}},"315":{"start":{"line":913,"column":2},"end":{"line":913,"column":108}},"316":{"start":{"line":924,"column":2},"end":{"line":951,"column":6}},"317":{"start":{"line":926,"column":4},"end":{"line":926,"column":82}},"318":{"start":{"line":927,"column":4},"end":{"line":929,"column":5}},"319":{"start":{"line":928,"column":5},"end":{"line":928,"column":17}},"320":{"start":{"line":931,"column":4},"end":{"line":931,"column":36}},"321":{"start":{"line":932,"column":4},"end":{"line":932,"column":71}},"322":{"start":{"line":933,"column":4},"end":{"line":935,"column":6}},"323":{"start":{"line":937,"column":4},"end":{"line":937,"column":68}},"324":{"start":{"line":938,"column":4},"end":{"line":938,"column":64}},"325":{"start":{"line":939,"column":4},"end":{"line":939,"column":42}},"326":{"start":{"line":940,"column":4},"end":{"line":940,"column":44}},"327":{"start":{"line":942,"column":4},"end":{"line":944,"column":6}},"328":{"start":{"line":945,"column":4},"end":{"line":949,"column":7}},"329":{"start":{"line":950,"column":4},"end":{"line":950,"column":40}},"330":{"start":{"line":962,"column":2},"end":{"line":962,"column":71}},"331":{"start":{"line":963,"column":2},"end":{"line":963,"column":70}},"332":{"start":{"line":966,"column":2},"end":{"line":966,"column":44}},"333":{"start":{"line":968,"column":2},"end":{"line":977,"column":5}},"334":{"start":{"line":970,"column":15},"end":{"line":970,"column":29}},"335":{"start":{"line":974,"column":15},"end":{"line":974,"column":53}},"336":{"start":{"line":979,"column":2},"end":{"line":979,"column":37}},"337":{"start":{"line":982,"column":2},"end":{"line":983,"column":35}},"338":{"start":{"line":983,"column":9},"end":{"line":983,"column":34}},"339":{"start":{"line":985,"column":2},"end":{"line":986,"column":50}},"340":{"start":{"line":986,"column":14},"end":{"line":986,"column":49}},"341":{"start":{"line":988,"column":2},"end":{"line":989,"column":69}},"342":{"start":{"line":989,"column":24},"end":{"line":989,"column":68}},"343":{"start":{"line":991,"column":2},"end":{"line":992,"column":75}},"344":{"start":{"line":992,"column":26},"end":{"line":992,"column":74}},"345":{"start":{"line":994,"column":2},"end":{"line":995,"column":71}},"346":{"start":{"line":995,"column":25},"end":{"line":995,"column":70}},"347":{"start":{"line":997,"column":2},"end":{"line":998,"column":74}},"348":{"start":{"line":998,"column":25},"end":{"line":998,"column":73}},"349":{"start":{"line":1001,"column":2},"end":{"line":1002,"column":45}},"350":{"start":{"line":1002,"column":3},"end":{"line":1002,"column":44}},"351":{"start":{"line":1003,"column":2},"end":{"line":1003,"column":64}},"352":{"start":{"line":1003,"column":42},"end":{"line":1003,"column":63}},"353":{"start":{"line":1006,"column":2},"end":{"line":1009,"column":4}},"354":{"start":{"line":1007,"column":3},"end":{"line":1007,"column":79}},"355":{"start":{"line":1008,"column":3},"end":{"line":1008,"column":63}},"356":{"start":{"line":1010,"column":2},"end":{"line":1013,"column":4}},"357":{"start":{"line":1011,"column":3},"end":{"line":1011,"column":79}},"358":{"start":{"line":1012,"column":3},"end":{"line":1012,"column":73}},"359":{"start":{"line":1015,"column":2},"end":{"line":1015,"column":41}},"360":{"start":{"line":1025,"column":2},"end":{"line":1025,"column":90}},"361":{"start":{"line":1026,"column":2},"end":{"line":1026,"column":66}},"362":{"start":{"line":1027,"column":2},"end":{"line":1027,"column":48}},"363":{"start":{"line":1028,"column":2},"end":{"line":1028,"column":44}},"364":{"start":{"line":1029,"column":2},"end":{"line":1029,"column":39}},"365":{"start":{"line":1030,"column":2},"end":{"line":1030,"column":19}},"366":{"start":{"line":1033,"column":2},"end":{"line":1042,"column":6}},"367":{"start":{"line":1035,"column":4},"end":{"line":1035,"column":36}},"368":{"start":{"line":1036,"column":4},"end":{"line":1037,"column":75}},"369":{"start":{"line":1038,"column":4},"end":{"line":1040,"column":5}},"370":{"start":{"line":1039,"column":5},"end":{"line":1039,"column":12}},"371":{"start":{"line":1041,"column":4},"end":{"line":1041,"column":44}},"372":{"start":{"line":1044,"column":2},"end":{"line":1047,"column":3}},"373":{"start":{"line":1045,"column":3},"end":{"line":1045,"column":60}},"374":{"start":{"line":1046,"column":3},"end":{"line":1046,"column":42}},"375":{"start":{"line":1049,"column":2},"end":{"line":1106,"column":6}},"376":{"start":{"line":1051,"column":4},"end":{"line":1053,"column":5}},"377":{"start":{"line":1052,"column":5},"end":{"line":1052,"column":12}},"378":{"start":{"line":1056,"column":4},"end":{"line":1056,"column":43}},"379":{"start":{"line":1058,"column":4},"end":{"line":1105,"column":7}},"380":{"start":{"line":1059,"column":5},"end":{"line":1061,"column":6}},"381":{"start":{"line":1060,"column":6},"end":{"line":1060,"column":13}},"382":{"start":{"line":1063,"column":5},"end":{"line":1063,"column":31}},"383":{"start":{"line":1064,"column":5},"end":{"line":1064,"column":32}},"384":{"start":{"line":1065,"column":5},"end":{"line":1065,"column":43}},"385":{"start":{"line":1066,"column":5},"end":{"line":1068,"column":6}},"386":{"start":{"line":1067,"column":6},"end":{"line":1067,"column":13}},"387":{"start":{"line":1069,"column":5},"end":{"line":1069,"column":35}},"388":{"start":{"line":1071,"column":5},"end":{"line":1097,"column":6}},"389":{"start":{"line":1072,"column":6},"end":{"line":1072,"column":46}},"390":{"start":{"line":1076,"column":6},"end":{"line":1076,"column":49}},"391":{"start":{"line":1077,"column":6},"end":{"line":1079,"column":7}},"392":{"start":{"line":1078,"column":7},"end":{"line":1078,"column":14}},"393":{"start":{"line":1081,"column":6},"end":{"line":1081,"column":82}},"394":{"start":{"line":1082,"column":6},"end":{"line":1082,"column":94}},"395":{"start":{"line":1085,"column":6},"end":{"line":1087,"column":7}},"396":{"start":{"line":1086,"column":7},"end":{"line":1086,"column":16}},"397":{"start":{"line":1091,"column":6},"end":{"line":1093,"column":7}},"398":{"start":{"line":1092,"column":7},"end":{"line":1092,"column":16}},"399":{"start":{"line":1095,"column":6},"end":{"line":1095,"column":29}},"400":{"start":{"line":1096,"column":6},"end":{"line":1096,"column":29}},"401":{"start":{"line":1100,"column":5},"end":{"line":1102,"column":6}},"402":{"start":{"line":1101,"column":6},"end":{"line":1101,"column":13}},"403":{"start":{"line":1103,"column":5},"end":{"line":1103,"column":33}},"404":{"start":{"line":1104,"column":5},"end":{"line":1104,"column":26}},"405":{"start":{"line":1108,"column":2},"end":{"line":1108,"column":15}},"406":{"start":{"line":1127,"column":2},"end":{"line":1127,"column":66}},"407":{"start":{"line":1129,"column":2},"end":{"line":1139,"column":4}},"408":{"start":{"line":1148,"column":2},"end":{"line":1150,"column":3}},"409":{"start":{"line":1149,"column":3},"end":{"line":1149,"column":33}},"410":{"start":{"line":1152,"column":2},"end":{"line":1154,"column":3}},"411":{"start":{"line":1153,"column":3},"end":{"line":1153,"column":29}},"412":{"start":{"line":1157,"column":2},"end":{"line":1163,"column":3}},"413":{"start":{"line":1158,"column":3},"end":{"line":1158,"column":50}},"414":{"start":{"line":1160,"column":3},"end":{"line":1162,"column":4}},"415":{"start":{"line":1161,"column":4},"end":{"line":1161,"column":51}},"416":{"start":{"line":1164,"column":2},"end":{"line":1164,"column":44}},"417":{"start":{"line":1174,"column":2},"end":{"line":1181,"column":4}},"418":{"start":{"line":1180,"column":16},"end":{"line":1180,"column":56}},"419":{"start":{"line":1183,"column":2},"end":{"line":1183,"column":30}},"420":{"start":{"line":1192,"column":0},"end":{"line":1198,"column":1}},"421":{"start":{"line":1193,"column":1},"end":{"line":1193,"column":36}},"422":{"start":{"line":1194,"column":1},"end":{"line":1196,"column":4}},"423":{"start":{"line":1195,"column":2},"end":{"line":1195,"column":39}},"424":{"start":{"line":1197,"column":1},"end":{"line":1197,"column":15}},"425":{"start":{"line":1207,"column":0},"end":{"line":1211,"column":1}},"426":{"start":{"line":1208,"column":1},"end":{"line":1208,"column":91}},"427":{"start":{"line":1209,"column":1},"end":{"line":1209,"column":58}},"428":{"start":{"line":1210,"column":1},"end":{"line":1210,"column":69}},"429":{"start":{"line":1210,"column":51},"end":{"line":1210,"column":67}},"430":{"start":{"line":1219,"column":0},"end":{"line":1251,"column":1}},"431":{"start":{"line":1220,"column":1},"end":{"line":1220,"column":39}},"432":{"start":{"line":1221,"column":1},"end":{"line":1221,"column":17}},"433":{"start":{"line":1222,"column":1},"end":{"line":1222,"column":23}},"434":{"start":{"line":1225,"column":1},"end":{"line":1227,"column":2}},"435":{"start":{"line":1226,"column":2},"end":{"line":1226,"column":17}},"436":{"start":{"line":1228,"column":1},"end":{"line":1242,"column":4}},"437":{"start":{"line":1229,"column":2},"end":{"line":1234,"column":3}},"438":{"start":{"line":1230,"column":3},"end":{"line":1232,"column":5}},"439":{"start":{"line":1231,"column":15},"end":{"line":1231,"column":37}},"440":{"start":{"line":1233,"column":3},"end":{"line":1233,"column":10}},"441":{"start":{"line":1236,"column":2},"end":{"line":1241,"column":4}},"442":{"start":{"line":1237,"column":14},"end":{"line":1237,"column":24}},"443":{"start":{"line":1239,"column":4},"end":{"line":1239,"column":23}},"444":{"start":{"line":1244,"column":1},"end":{"line":1246,"column":3}},"445":{"start":{"line":1247,"column":1},"end":{"line":1247,"column":47}},"446":{"start":{"line":1248,"column":1},"end":{"line":1248,"column":23}},"447":{"start":{"line":1249,"column":1},"end":{"line":1249,"column":25}},"448":{"start":{"line":1250,"column":1},"end":{"line":1250,"column":17}},"449":{"start":{"line":1258,"column":0},"end":{"line":1265,"column":1}},"450":{"start":{"line":1261,"column":1},"end":{"line":1264,"column":47}},"451":{"start":{"line":1267,"column":0},"end":{"line":1267,"column":34}}},"branchMap":{"1":{"line":120,"type":"if","locations":[{"start":{"line":120,"column":3},"end":{"line":120,"column":3}},{"start":{"line":120,"column":3},"end":{"line":120,"column":3}}]},"2":{"line":161,"type":"if","locations":[{"start":{"line":161,"column":2},"end":{"line":161,"column":2}},{"start":{"line":161,"column":2},"end":{"line":161,"column":2}}]},"3":{"line":191,"type":"if","locations":[{"start":{"line":191,"column":4},"end":{"line":191,"column":4}},{"start":{"line":191,"column":4},"end":{"line":191,"column":4}}]},"4":{"line":198,"type":"if","locations":[{"start":{"line":198,"column":4},"end":{"line":198,"column":4}},{"start":{"line":198,"column":4},"end":{"line":198,"column":4}}]},"5":{"line":205,"type":"if","locations":[{"start":{"line":205,"column":4},"end":{"line":205,"column":4}},{"start":{"line":205,"column":4},"end":{"line":205,"column":4}}]},"6":{"line":227,"type":"if","locations":[{"start":{"line":227,"column":6},"end":{"line":227,"column":6}},{"start":{"line":227,"column":6},"end":{"line":227,"column":6}}]},"7":{"line":227,"type":"binary-expr","locations":[{"start":{"line":227,"column":10},"end":{"line":227,"column":43}},{"start":{"line":227,"column":47},"end":{"line":227,"column":59}}]},"8":{"line":242,"type":"if","locations":[{"start":{"line":242,"column":6},"end":{"line":242,"column":6}},{"start":{"line":242,"column":6},"end":{"line":242,"column":6}}]},"9":{"line":242,"type":"binary-expr","locations":[{"start":{"line":242,"column":10},"end":{"line":242,"column":21}},{"start":{"line":242,"column":25},"end":{"line":242,"column":31}}]},"10":{"line":249,"type":"if","locations":[{"start":{"line":249,"column":6},"end":{"line":249,"column":6}},{"start":{"line":249,"column":6},"end":{"line":249,"column":6}}]},"11":{"line":256,"type":"binary-expr","locations":[{"start":{"line":256,"column":8},"end":{"line":256,"column":32}},{"start":{"line":256,"column":36},"end":{"line":258,"column":9}}]},"12":{"line":277,"type":"if","locations":[{"start":{"line":277,"column":6},"end":{"line":277,"column":6}},{"start":{"line":277,"column":6},"end":{"line":277,"column":6}}]},"13":{"line":277,"type":"binary-expr","locations":[{"start":{"line":277,"column":10},"end":{"line":277,"column":43}},{"start":{"line":277,"column":47},"end":{"line":277,"column":59}}]},"14":{"line":303,"type":"cond-expr","locations":[{"start":{"line":304,"column":3},"end":{"line":304,"column":35}},{"start":{"line":304,"column":38},"end":{"line":304,"column":59}}]},"15":{"line":315,"type":"cond-expr","locations":[{"start":{"line":316,"column":3},"end":{"line":316,"column":35}},{"start":{"line":316,"column":38},"end":{"line":316,"column":59}}]},"16":{"line":327,"type":"cond-expr","locations":[{"start":{"line":328,"column":3},"end":{"line":328,"column":35}},{"start":{"line":328,"column":38},"end":{"line":328,"column":59}}]},"17":{"line":339,"type":"cond-expr","locations":[{"start":{"line":340,"column":3},"end":{"line":340,"column":35}},{"start":{"line":340,"column":38},"end":{"line":340,"column":59}}]},"18":{"line":350,"type":"if","locations":[{"start":{"line":350,"column":2},"end":{"line":350,"column":2}},{"start":{"line":350,"column":2},"end":{"line":350,"column":2}}]},"19":{"line":354,"type":"if","locations":[{"start":{"line":354,"column":2},"end":{"line":354,"column":2}},{"start":{"line":354,"column":2},"end":{"line":354,"column":2}}]},"20":{"line":357,"type":"binary-expr","locations":[{"start":{"line":357,"column":9},"end":{"line":357,"column":37}},{"start":{"line":357,"column":41},"end":{"line":357,"column":45}}]},"21":{"line":377,"type":"if","locations":[{"start":{"line":377,"column":6},"end":{"line":377,"column":6}},{"start":{"line":377,"column":6},"end":{"line":377,"column":6}}]},"22":{"line":384,"type":"if","locations":[{"start":{"line":384,"column":7},"end":{"line":384,"column":7}},{"start":{"line":384,"column":7},"end":{"line":384,"column":7}}]},"23":{"line":389,"type":"if","locations":[{"start":{"line":389,"column":7},"end":{"line":389,"column":7}},{"start":{"line":389,"column":7},"end":{"line":389,"column":7}}]},"24":{"line":407,"type":"if","locations":[{"start":{"line":407,"column":2},"end":{"line":407,"column":2}},{"start":{"line":407,"column":2},"end":{"line":407,"column":2}}]},"25":{"line":412,"type":"binary-expr","locations":[{"start":{"line":412,"column":15},"end":{"line":412,"column":25}},{"start":{"line":412,"column":29},"end":{"line":412,"column":48}}]},"26":{"line":419,"type":"if","locations":[{"start":{"line":419,"column":4},"end":{"line":419,"column":4}},{"start":{"line":419,"column":4},"end":{"line":419,"column":4}}]},"27":{"line":419,"type":"binary-expr","locations":[{"start":{"line":419,"column":8},"end":{"line":419,"column":51}},{"start":{"line":420,"column":5},"end":{"line":420,"column":52}},{"start":{"line":421,"column":5},"end":{"line":421,"column":35}}]},"28":{"line":445,"type":"if","locations":[{"start":{"line":445,"column":4},"end":{"line":445,"column":4}},{"start":{"line":445,"column":4},"end":{"line":445,"column":4}}]},"29":{"line":460,"type":"if","locations":[{"start":{"line":460,"column":2},"end":{"line":460,"column":2}},{"start":{"line":460,"column":2},"end":{"line":460,"column":2}}]},"30":{"line":506,"type":"if","locations":[{"start":{"line":506,"column":2},"end":{"line":506,"column":2}},{"start":{"line":506,"column":2},"end":{"line":506,"column":2}}]},"31":{"line":509,"type":"if","locations":[{"start":{"line":509,"column":2},"end":{"line":509,"column":2}},{"start":{"line":509,"column":2},"end":{"line":509,"column":2}}]},"32":{"line":526,"type":"binary-expr","locations":[{"start":{"line":526,"column":9},"end":{"line":526,"column":19}},{"start":{"line":526,"column":23},"end":{"line":526,"column":27}}]},"33":{"line":552,"type":"if","locations":[{"start":{"line":552,"column":2},"end":{"line":552,"column":2}},{"start":{"line":552,"column":2},"end":{"line":552,"column":2}}]},"34":{"line":559,"type":"if","locations":[{"start":{"line":559,"column":4},"end":{"line":559,"column":4}},{"start":{"line":559,"column":4},"end":{"line":559,"column":4}}]},"35":{"line":559,"type":"binary-expr","locations":[{"start":{"line":559,"column":8},"end":{"line":559,"column":17}},{"start":{"line":559,"column":21},"end":{"line":559,"column":51}}]},"36":{"line":562,"type":"binary-expr","locations":[{"start":{"line":562,"column":10},"end":{"line":562,"column":20}},{"start":{"line":562,"column":24},"end":{"line":562,"column":28}}]},"37":{"line":570,"type":"if","locations":[{"start":{"line":570,"column":6},"end":{"line":570,"column":6}},{"start":{"line":570,"column":6},"end":{"line":570,"column":6}}]},"38":{"line":577,"type":"if","locations":[{"start":{"line":577,"column":8},"end":{"line":577,"column":8}},{"start":{"line":577,"column":8},"end":{"line":577,"column":8}}]},"39":{"line":594,"type":"binary-expr","locations":[{"start":{"line":594,"column":9},"end":{"line":594,"column":19}},{"start":{"line":594,"column":23},"end":{"line":594,"column":27}}]},"40":{"line":613,"type":"if","locations":[{"start":{"line":613,"column":4},"end":{"line":613,"column":4}},{"start":{"line":613,"column":4},"end":{"line":613,"column":4}}]},"41":{"line":620,"type":"if","locations":[{"start":{"line":620,"column":3},"end":{"line":620,"column":3}},{"start":{"line":620,"column":3},"end":{"line":620,"column":3}}]},"42":{"line":620,"type":"binary-expr","locations":[{"start":{"line":620,"column":7},"end":{"line":620,"column":16}},{"start":{"line":620,"column":20},"end":{"line":620,"column":34}}]},"43":{"line":626,"type":"binary-expr","locations":[{"start":{"line":626,"column":10},"end":{"line":626,"column":28}},{"start":{"line":626,"column":32},"end":{"line":626,"column":57}}]},"44":{"line":632,"type":"if","locations":[{"start":{"line":632,"column":4},"end":{"line":632,"column":4}},{"start":{"line":632,"column":4},"end":{"line":632,"column":4}}]},"45":{"line":649,"type":"if","locations":[{"start":{"line":649,"column":3},"end":{"line":649,"column":3}},{"start":{"line":649,"column":3},"end":{"line":649,"column":3}}]},"46":{"line":664,"type":"if","locations":[{"start":{"line":664,"column":2},"end":{"line":664,"column":2}},{"start":{"line":664,"column":2},"end":{"line":664,"column":2}}]},"47":{"line":677,"type":"binary-expr","locations":[{"start":{"line":677,"column":9},"end":{"line":677,"column":12}},{"start":{"line":677,"column":16},"end":{"line":677,"column":28}},{"start":{"line":678,"column":3},"end":{"line":678,"column":37}},{"start":{"line":679,"column":3},"end":{"line":679,"column":55}}]},"48":{"line":693,"type":"if","locations":[{"start":{"line":693,"column":4},"end":{"line":693,"column":4}},{"start":{"line":693,"column":4},"end":{"line":693,"column":4}}]},"49":{"line":709,"type":"if","locations":[{"start":{"line":709,"column":2},"end":{"line":709,"column":2}},{"start":{"line":709,"column":2},"end":{"line":709,"column":2}}]},"50":{"line":732,"type":"if","locations":[{"start":{"line":732,"column":3},"end":{"line":732,"column":3}},{"start":{"line":732,"column":3},"end":{"line":732,"column":3}}]},"51":{"line":738,"type":"if","locations":[{"start":{"line":738,"column":4},"end":{"line":738,"column":4}},{"start":{"line":738,"column":4},"end":{"line":738,"column":4}}]},"52":{"line":763,"type":"if","locations":[{"start":{"line":763,"column":4},"end":{"line":763,"column":4}},{"start":{"line":763,"column":4},"end":{"line":763,"column":4}}]},"53":{"line":767,"type":"if","locations":[{"start":{"line":767,"column":4},"end":{"line":767,"column":4}},{"start":{"line":767,"column":4},"end":{"line":767,"column":4}}]},"54":{"line":767,"type":"binary-expr","locations":[{"start":{"line":767,"column":8},"end":{"line":767,"column":31}},{"start":{"line":767,"column":35},"end":{"line":767,"column":57}}]},"55":{"line":769,"type":"if","locations":[{"start":{"line":769,"column":11},"end":{"line":769,"column":11}},{"start":{"line":769,"column":11},"end":{"line":769,"column":11}}]},"56":{"line":784,"type":"if","locations":[{"start":{"line":784,"column":2},"end":{"line":784,"column":2}},{"start":{"line":784,"column":2},"end":{"line":784,"column":2}}]},"57":{"line":792,"type":"if","locations":[{"start":{"line":792,"column":2},"end":{"line":792,"column":2}},{"start":{"line":792,"column":2},"end":{"line":792,"column":2}}]},"58":{"line":794,"type":"if","locations":[{"start":{"line":794,"column":3},"end":{"line":794,"column":3}},{"start":{"line":794,"column":3},"end":{"line":794,"column":3}}]},"59":{"line":805,"type":"if","locations":[{"start":{"line":805,"column":2},"end":{"line":805,"column":2}},{"start":{"line":805,"column":2},"end":{"line":805,"column":2}}]},"60":{"line":830,"type":"if","locations":[{"start":{"line":830,"column":2},"end":{"line":830,"column":2}},{"start":{"line":830,"column":2},"end":{"line":830,"column":2}}]},"61":{"line":862,"type":"if","locations":[{"start":{"line":862,"column":2},"end":{"line":862,"column":2}},{"start":{"line":862,"column":2},"end":{"line":862,"column":2}}]},"62":{"line":871,"type":"if","locations":[{"start":{"line":871,"column":3},"end":{"line":871,"column":3}},{"start":{"line":871,"column":3},"end":{"line":871,"column":3}}]},"63":{"line":883,"type":"if","locations":[{"start":{"line":883,"column":3},"end":{"line":883,"column":3}},{"start":{"line":883,"column":3},"end":{"line":883,"column":3}}]},"64":{"line":904,"type":"switch","locations":[{"start":{"line":905,"column":3},"end":{"line":907,"column":10}},{"start":{"line":908,"column":3},"end":{"line":910,"column":10}}]},"65":{"line":927,"type":"if","locations":[{"start":{"line":927,"column":4},"end":{"line":927,"column":4}},{"start":{"line":927,"column":4},"end":{"line":927,"column":4}}]},"66":{"line":1038,"type":"if","locations":[{"start":{"line":1038,"column":4},"end":{"line":1038,"column":4}},{"start":{"line":1038,"column":4},"end":{"line":1038,"column":4}}]},"67":{"line":1044,"type":"if","locations":[{"start":{"line":1044,"column":2},"end":{"line":1044,"column":2}},{"start":{"line":1044,"column":2},"end":{"line":1044,"column":2}}]},"68":{"line":1044,"type":"binary-expr","locations":[{"start":{"line":1044,"column":6},"end":{"line":1044,"column":32}},{"start":{"line":1044,"column":36},"end":{"line":1044,"column":82}}]},"69":{"line":1051,"type":"if","locations":[{"start":{"line":1051,"column":4},"end":{"line":1051,"column":4}},{"start":{"line":1051,"column":4},"end":{"line":1051,"column":4}}]},"70":{"line":1059,"type":"if","locations":[{"start":{"line":1059,"column":5},"end":{"line":1059,"column":5}},{"start":{"line":1059,"column":5},"end":{"line":1059,"column":5}}]},"71":{"line":1066,"type":"if","locations":[{"start":{"line":1066,"column":5},"end":{"line":1066,"column":5}},{"start":{"line":1066,"column":5},"end":{"line":1066,"column":5}}]},"72":{"line":1077,"type":"if","locations":[{"start":{"line":1077,"column":6},"end":{"line":1077,"column":6}},{"start":{"line":1077,"column":6},"end":{"line":1077,"column":6}}]},"73":{"line":1085,"type":"if","locations":[{"start":{"line":1085,"column":6},"end":{"line":1085,"column":6}},{"start":{"line":1085,"column":6},"end":{"line":1085,"column":6}}]},"74":{"line":1085,"type":"binary-expr","locations":[{"start":{"line":1085,"column":10},"end":{"line":1085,"column":23}},{"start":{"line":1085,"column":27},"end":{"line":1085,"column":59}}]},"75":{"line":1091,"type":"if","locations":[{"start":{"line":1091,"column":6},"end":{"line":1091,"column":6}},{"start":{"line":1091,"column":6},"end":{"line":1091,"column":6}}]},"76":{"line":1100,"type":"if","locations":[{"start":{"line":1100,"column":5},"end":{"line":1100,"column":5}},{"start":{"line":1100,"column":5},"end":{"line":1100,"column":5}}]},"77":{"line":1138,"type":"cond-expr","locations":[{"start":{"line":1138,"column":26},"end":{"line":1138,"column":65}},{"start":{"line":1138,"column":68},"end":{"line":1138,"column":70}}]},"78":{"line":1148,"type":"if","locations":[{"start":{"line":1148,"column":2},"end":{"line":1148,"column":2}},{"start":{"line":1148,"column":2},"end":{"line":1148,"column":2}}]},"79":{"line":1152,"type":"if","locations":[{"start":{"line":1152,"column":2},"end":{"line":1152,"column":2}},{"start":{"line":1152,"column":2},"end":{"line":1152,"column":2}}]},"80":{"line":1157,"type":"if","locations":[{"start":{"line":1157,"column":2},"end":{"line":1157,"column":2}},{"start":{"line":1157,"column":2},"end":{"line":1157,"column":2}}]},"81":{"line":1175,"type":"binary-expr","locations":[{"start":{"line":1175,"column":3},"end":{"line":1175,"column":18}},{"start":{"line":1176,"column":3},"end":{"line":1176,"column":32}},{"start":{"line":1177,"column":3},"end":{"line":1177,"column":29}},{"start":{"line":1178,"column":3},"end":{"line":1178,"column":27}},{"start":{"line":1179,"column":3},"end":{"line":1179,"column":28}},{"start":{"line":1180,"column":4},"end":{"line":1180,"column":56}}]},"82":{"line":1208,"type":"binary-expr","locations":[{"start":{"line":1208,"column":23},"end":{"line":1208,"column":39}},{"start":{"line":1208,"column":43},"end":{"line":1208,"column":64}},{"start":{"line":1208,"column":68},"end":{"line":1208,"column":90}}]},"83":{"line":1229,"type":"if","locations":[{"start":{"line":1229,"column":2},"end":{"line":1229,"column":2}},{"start":{"line":1229,"column":2},"end":{"line":1229,"column":2}}]},"84":{"line":1261,"type":"binary-expr","locations":[{"start":{"line":1261,"column":8},"end":{"line":1261,"column":45}},{"start":{"line":1262,"column":2},"end":{"line":1262,"column":38}},{"start":{"line":1263,"column":2},"end":{"line":1263,"column":37}},{"start":{"line":1264,"column":2},"end":{"line":1264,"column":46}}]}},"code":["'use strict';","","const morphdom = require('morphdom');","const uuid = require('uuid');","const errorHelper = require('../lib/helpers/errorHelper');","const moduleHelper = require('../lib/helpers/moduleHelper');","const hrTimeHelper = require('../lib/helpers/hrTimeHelper');","const DocumentRendererBase = require('../lib/base/DocumentRendererBase');","","const SPECIAL_IDS = {","\t$$head: '$$head',","\t$$document: '$$document'","};","const TAG_NAMES = {","\tHEAD: 'HEAD',","\tSTYLE: 'STYLE',","\tSCRIPT: 'SCRIPT',","\tLINK: 'LINK'","};","","// http://www.w3.org/TR/2015/WD-uievents-20150319/#event-types-list","const NON_BUBBLING_EVENTS = {","\tabort: true,","\tblur: true,","\terror: true,","\tfocus: true,","\tload: true,","\tmouseenter: true,","\tmouseleave: true,","\tresize: true,","\tunload: true","};","","class DocumentRenderer extends DocumentRendererBase {","","\t/**","\t * Creates a new instance of the document renderer.","\t * @param {ServiceLocator} locator Locator for resolving dependencies.","\t */","\tconstructor(locator) {","\t\tsuper(locator);","","\t\t/**","\t\t * Current set of component instances by unique keys.","\t\t * @type {Object}","\t\t * @private","\t\t */","\t\tthis._componentInstances = Object.create(null);","","\t\t/**","\t\t * Current set of component elements by unique keys.","\t\t * @type {Object}","\t\t * @private","\t\t */","\t\tthis._componentElements = Object.create(null);","","\t\t/**","\t\t * Current set of component bindings by unique keys.","\t\t * @type {Object}","\t\t * @private","\t\t */","\t\tthis._componentBindings = Object.create(null);","","\t\t/**","\t\t * Current set of changed stores.","\t\t * @type {Object}","\t\t * @private","\t\t */","\t\tthis._currentChangedStores = Object.create(null);","","\t\t/**","\t\t * Current browser's window.","\t\t */","\t\tthis._window = locator.resolve('window');","","\t\t/**","\t\t * Current application config.","\t\t * @type {Object}","\t\t * @private","\t\t */","\t\tthis._config = locator.resolve('config');","","\t\t/**","\t\t * Current store dispatcher.","\t\t * @type {StoreDispatcher}","\t\t * @protected","\t\t */","\t\tthis._storeDispatcher = locator.resolve('storeDispatcher');","","\t\t/**","\t\t * Current promise for rendered page.","\t\t * @type {Promise}","\t\t * @private","\t\t */","\t\tthis._renderedPromise = null;","","\t\t/**","\t\t * Current state of updating components.","\t\t * @type {boolean}","\t\t * @private","\t\t */","\t\tthis._isUpdating = false;","","\t\t/**","\t\t * Current awaiting routing.","\t\t * @type {{state: Object, routingContext: Object}}","\t\t * @private","\t\t */","\t\tthis._awaitingRouting = null;","","\t\t/**","\t\t * Current routing context.","\t\t * @type {Object}","\t\t * @private","\t\t */","\t\tthis._currentRoutingContext = null;","","\t\tthis._eventBus.on('storeChanged', storeName => {","\t\t\tthis._currentChangedStores[storeName] = true;","\t\t\tif (this._isStateChanging) {","\t\t\t\treturn;","\t\t\t}","\t\t\tthis._updateStoreComponents();","\t\t});","\t}","","\t/**","\t * Sets the initial state of the application.","\t * @param {Object} state New state of the application.","\t * @param {Object} routingContext Routing context.","\t * @returns {Promise} Promise for nothing.","\t */","\tinitWithState(state, routingContext) {","\t\treturn this._getPromiseForReadyState()","\t\t\t.then(() => {","\t\t\t\tthis._currentRoutingContext = routingContext;","\t\t\t\treturn this._storeDispatcher.setState(state, routingContext);","\t\t\t})","\t\t\t.then(() => {","\t\t\t\tconst components = this._componentLoader.getComponentsByNames();","\t\t\t\tconst documentElement = this._window.document.documentElement;","\t\t\t\tconst action = element => this._initializeComponent(element, components);","\t\t\t\treturn this._traverseComponents([documentElement], components, action);","\t\t\t})","\t\t\t.then(() => this._eventBus.emit(","\t\t\t\t'documentRendered', this._currentRoutingContext","\t\t\t));","\t}","","\t/**","\t * Renders a new state of the application.","\t * @param {Object} state New state of the application.","\t * @param {Object} routingContext Routing context.","\t * @returns {Promise} Promise for nothing.","\t */","\trender(state, routingContext) {","\t\tthis._awaitingRouting = {","\t\t\tstate,","\t\t\troutingContext","\t\t};","\t\tif (this._isStateChanging) {","\t\t\treturn this._renderedPromise;","\t\t}","","\t\t// we should set this flag to avoid \"storeChanged\"","\t\t// event handling for now","\t\tthis._isStateChanging = true;","","\t\tthis._renderedPromise = this._getPromiseForReadyState()","\t\t\t// and then we update all components of these stores in a batch.","\t\t\t.then(() => this._updateStoreComponents())","\t\t\t.catch(reason => this._eventBus.emit('error', reason))","\t\t\t.then(() => {","\t\t\t\tthis._isStateChanging = false;","\t\t\t});","","\t\treturn this._renderedPromise;","\t}","","\t/**","\t * Renders a component into the HTML element.","\t * @param {Element} element HTML element of the component.","\t * @param {Object?} renderingContext Rendering context for group rendering.","\t */","\trenderComponent(element, renderingContext) {","\t\treturn this._getPromiseForReadyState()","\t\t\t.then(() => {","\t\t\t\tconst id = this._getId(element);","\t\t\t\tconst componentName = moduleHelper.getOriginalComponentName(element.tagName);","","\t\t\t\tif (!renderingContext) {","\t\t\t\t\trenderingContext = this._createRenderingContext([]);","\t\t\t\t\trenderingContext.rootIds[id] = true;","\t\t\t\t}","","\t\t\t\tconst hadChildren = (element.children.length > 0);","\t\t\t\tconst component = renderingContext.components[componentName];","\t\t\t\tif (!component) {","\t\t\t\t\treturn null;","\t\t\t\t}","","\t\t\t\trenderingContext.renderedIds[id] = true;","","\t\t\t\tlet instance = this._componentInstances[id];","\t\t\t\tif (!instance) {","\t\t\t\t\tcomponent.constructor.prototype.$context =","\t\t\t\t\t\tthis._getComponentContext(component, element);","\t\t\t\t\tinstance = new component.constructor(this._serviceLocator);","\t\t\t\t\tinstance.$context = component.constructor.prototype.$context;","\t\t\t\t\tthis._componentInstances[id] = instance;","\t\t\t\t}","","\t\t\t\tconst eventArgs = {","\t\t\t\t\tname: componentName,","\t\t\t\t\tcontext: instance.$context","\t\t\t\t};","","\t\t\t\tthis._componentElements[id] = element;","","\t\t\t\tconst startTime = hrTimeHelper.get();","\t\t\t\tthis._eventBus.emit('componentRender', eventArgs);","","\t\t\t\treturn Promise.resolve()","\t\t\t\t\t.then(() => {","\t\t\t\t\t\t// we need unbind the whole hierarchy only at","\t\t\t\t\t\t// the beginning and not for new elements","\t\t\t\t\t\tif (!(id in renderingContext.rootIds) || !hadChildren) {","\t\t\t\t\t\t\treturn [];","\t\t\t\t\t\t}","","\t\t\t\t\t\treturn this._unbindAll(element, renderingContext);","\t\t\t\t\t})","\t\t\t\t\t.catch(reason => this._eventBus.emit('error', reason))","\t\t\t\t\t.then(() => {","\t\t\t\t\t\tconst renderMethod = moduleHelper.getMethodToInvoke(instance, 'render');","\t\t\t\t\t\treturn moduleHelper.getSafePromise(renderMethod);","\t\t\t\t\t})","\t\t\t\t\t.then(dataContext => component.template.render(dataContext))","\t\t\t\t\t.catch(reason => this._handleRenderError(element, component, reason))","\t\t\t\t\t.then(html => {","\t\t\t\t\t\tconst isHead = element.tagName === TAG_NAMES.HEAD;","\t\t\t\t\t\tif (html === '' && isHead) {","\t\t\t\t\t\t\treturn [];","\t\t\t\t\t\t}","","\t\t\t\t\t\tconst tmpElement = element.cloneNode(false);","\t\t\t\t\t\ttmpElement.innerHTML = html;","","\t\t\t\t\t\tif (isHead) {","\t\t\t\t\t\t\tthis._mergeHead(element, tmpElement);","\t\t\t\t\t\t\treturn [];","\t\t\t\t\t\t}","","\t\t\t\t\t\tmorphdom(element, tmpElement, {","\t\t\t\t\t\t\tonBeforeElChildrenUpdated: foundElement =>","\t\t\t\t\t\t\t\tfoundElement === element || !this._isComponentElement(","\t\t\t\t\t\t\t\t\trenderingContext.components, foundElement","\t\t\t\t\t\t\t\t)","\t\t\t\t\t\t});","","\t\t\t\t\t\tconst promises = this._findNestedComponents(","\t\t\t\t\t\t\telement, renderingContext.components","\t\t\t\t\t\t)","\t\t\t\t\t\t\t.map(child => this.renderComponent(child, renderingContext));","","\t\t\t\t\t\treturn Promise.all(promises);","\t\t\t\t\t})","\t\t\t\t\t.then(() => {","\t\t\t\t\t\teventArgs.hrTime = hrTimeHelper.get(startTime);","\t\t\t\t\t\teventArgs.time = hrTimeHelper.toMilliseconds(eventArgs.hrTime);","\t\t\t\t\t\tthis._eventBus.emit('componentRendered', eventArgs);","\t\t\t\t\t\treturn this._bindComponent(element);","\t\t\t\t\t})","\t\t\t\t\t.then(() => {","\t\t\t\t\t\t// collecting garbage only when","\t\t\t\t\t\t// the entire rendering is finished","\t\t\t\t\t\tif (!(id in renderingContext.rootIds) || !hadChildren) {","\t\t\t\t\t\t\treturn;","\t\t\t\t\t\t}","\t\t\t\t\t\tthis._collectRenderingGarbage(renderingContext);","\t\t\t\t\t})","\t\t\t\t\t.catch(reason => this._eventBus.emit('error', reason));","\t\t\t});","\t}","","\t/**","\t * Gets a component instance by ID.","\t * @param {string} id Component's element ID.","\t * @returns {Object|null} Component instance.","\t */","\tgetComponentById(id) {","\t\tconst element = this._window.document.getElementById(id);","\t\treturn this.getComponentByElement(element);","\t}","","\t/**","\t * Does query for a component by the selector.","\t * @param {string} selector Selector for the query.","\t * @param {Object?} parentComponent Parent component object.","\t * @returns {Object} The found component object.","\t */","\tqueryComponentSelector(selector, parentComponent) {","\t\tconst parent = this._isComponentObject(parentComponent) ?","\t\t\tparentComponent.$context.element : this._window.document;","\t\treturn this.getComponentByElement(parent.querySelector(selector));","\t}","","\t/**","\t * Does query for all components by the selector.","\t * @param {string} selector Selector for the query.","\t * @param {Object?} parentComponent Parent component object.","\t * @returns {Array} The found component object list.","\t */","\tqueryComponentSelectorAll(selector, parentComponent) {","\t\tconst parent = this._isComponentObject(parentComponent) ?","\t\t\tparentComponent.$context.element : this._window.document;","\t\treturn this._mapElementsToComponents(parent.querySelectorAll(selector));","\t}","","\t/**","\t * Gets all components by the tag name.","\t * @param {string} tagName Tag name of the components.","\t * @param {Object?} parentComponent Parent component object.","\t * @returns {Array} The found component object list.","\t */","\tgetComponentsByTagName(tagName, parentComponent) {","\t\tconst parent = this._isComponentObject(parentComponent) ?","\t\t\tparentComponent.$context.element : this._window.document;","\t\treturn this._mapElementsToComponents(parent.getElementsByTagName(tagName));","\t}","","\t/**","\t * Gets all components by the class name.","\t * @param {string} className Class name of the components.","\t * @param {Object?} parentComponent Parent component object.","\t * @returns {Array} The found component object list.","\t */","\tgetComponentsByClassName(className, parentComponent) {","\t\tconst parent = this._isComponentObject(parentComponent) ?","\t\t\tparentComponent.$context.element : this._window.document;","\t\treturn this._mapElementsToComponents(parent.getElementsByClassName(className));","\t}","","\t/**","\t * Gets component instance by a DOM element.","\t * @param {Element} element Component's Element.","\t * @returns {Object|null} Component instance.","\t */","\tgetComponentByElement(element) {","\t\tif (!element) {","\t\t\treturn null;","\t\t}","\t\tconst id = element[moduleHelper.COMPONENT_ID];","\t\tif (!id) {","\t\t\treturn null;","\t\t}","\t\treturn this._componentInstances[id] || null;","\t}","","\t/**","\t * Checks that every instance of the component has an element on the page and","\t * removes all references to those components which were removed from DOM.","\t * @returns {Promise} Promise for nothing.","\t */","\t/* eslint max-nested-callbacks: 0 */","\tcollectGarbage() {","\t\treturn this._getPromiseForReadyState()","\t\t\t.then(() => {","\t\t\t\tconst context = {","\t\t\t\t\troots: [],","\t\t\t\t\tcomponents: this._componentLoader.getComponentsByNames()","\t\t\t\t};","","\t\t\t\tObject.keys(this._componentElements)","\t\t\t\t\t.forEach(id => {","\t\t\t\t\t\t// we should not remove special elements like HEAD","\t\t\t\t\t\tif (SPECIAL_IDS.hasOwnProperty(id)) {","\t\t\t\t\t\t\treturn;","\t\t\t\t\t\t}","","\t\t\t\t\t\tlet current = this._componentElements[id];","\t\t\t\t\t\twhile (current !== this._window.document.documentElement) {","\t\t\t\t\t\t\t// the component is situated in a detached DOM subtree","\t\t\t\t\t\t\tif (current.parentElement === null) {","\t\t\t\t\t\t\t\tcontext.roots.push(current);","\t\t\t\t\t\t\t\tbreak;","\t\t\t\t\t\t\t}","\t\t\t\t\t\t\t// the component is another component's descendant","\t\t\t\t\t\t\tif (this._isComponentElement(context.components, current.parentElement)) {","\t\t\t\t\t\t\t\tbreak;","\t\t\t\t\t\t\t}","\t\t\t\t\t\t\tcurrent = current.parentElement;","\t\t\t\t\t\t}","\t\t\t\t\t});","","\t\t\t\treturn this._removeDetachedComponents(context);","\t\t\t});","\t}","","\t/**","\t * Creates and renders a component element.","\t * @param {string} tagName Name of the HTML tag.","\t * @param {Object?} attributes Element attributes.","\t * @returns {Promise<Element>} Promise for HTML element with the rendered component.","\t */","\tcreateComponent(tagName, attributes) {","\t\tif (typeof (tagName) !== 'string') {","\t\t\treturn Promise.reject(","\t\t\t\tnew Error('The tag name must be a string')","\t\t\t);","\t\t}","\t\tattributes = attributes || Object.create(null);","","\t\treturn this._getPromiseForReadyState()","\t\t\t.then(() => {","\t\t\t\tconst components = this._componentLoader.getComponentsByNames();","\t\t\t\tconst componentName = moduleHelper.getOriginalComponentName(tagName);","","\t\t\t\tif (moduleHelper.isHeadComponent(componentName) ||","\t\t\t\t\tmoduleHelper.isDocumentComponent(componentName) ||","\t\t\t\t\t!(componentName in components)) {","\t\t\t\t\treturn Promise.reject(new Error(`Component for tag \"${tagName}\" not found`));","\t\t\t\t}","","\t\t\t\tconst safeTagName = moduleHelper.getTagNameForComponentName(componentName);","\t\t\t\tconst element = this._window.document.createElement(safeTagName);","\t\t\t\tObject.keys(attributes)","\t\t\t\t\t.forEach(attributeName => element.setAttribute(attributeName, attributes[attributeName]));","","\t\t\t\treturn this.renderComponent(element)","\t\t\t\t\t.then(() => element);","\t\t\t});","\t}","","\t/**","\t * Clears all references to removed components during the rendering process.","\t * @param {Object} renderingContext Context of rendering.","\t * @private","\t */","\t_collectRenderingGarbage(renderingContext) {","\t\tObject.keys(renderingContext.unboundIds)","\t\t\t.forEach(id => {","\t\t\t\t// this component has been rendered again and we do not need to","\t\t\t\t// remove it.","\t\t\t\tif (id in renderingContext.renderedIds) {","\t\t\t\t\treturn;","\t\t\t\t}","","\t\t\t\tthis._removeComponentById(id);","\t\t\t});","\t}","","\t/**","\t * Removes detached subtrees from the components set.","\t * @param {{roots: Array, components: Object}} context Operation context.","\t * @returns {Promise} Promise for finished removal","\t * @private","\t */","\t_removeDetachedComponents(context) {","\t\tif (context.roots.length === 0) {","\t\t\treturn Promise.resolve();","\t\t}","\t\tconst root = context.roots.pop();","\t\treturn this._traverseComponents([root], context.components, element => this._removeDetachedComponent(element))","\t\t\t.then(() => this._removeDetachedComponents(context));","\t}","","\t/**","\t * Removes detached component.","\t * @param {Element} element Element of the detached component.","\t * @returns {Promise} Promise for the removed component.","\t * @private","\t */","\t_removeDetachedComponent(element) {","\t\tconst id = this._getId(element);","\t\treturn this._unbindComponent(element)","\t\t\t.then(() => this._removeComponentById(id));","\t}","","\t/**","\t * Unbinds all event handlers from the specified component and all it's descendants.","\t * @param {Element} element Component HTML element.","\t * @param {Object} renderingContext Context of rendering.","\t * @returns {Promise} Promise for nothing.","\t * @private","\t */","\t_unbindAll(element, renderingContext) {","\t\tconst action = innerElement => {","\t\t\tconst id = this._getId(innerElement);","\t\t\trenderingContext.unboundIds[id] = true;","\t\t\treturn this._unbindComponent(innerElement);","\t\t};","\t\treturn this._traverseComponents([element], renderingContext.components, action);","\t}","","\t/**","\t * Unbinds all event handlers from the specified component.","\t * @param {Element} element Component HTML element.","\t * @returns {Promise} Promise for nothing.","\t * @private","\t */","\t_unbindComponent(element) {","\t\tconst id = this._getId(element);","\t\tconst instance = this._componentInstances[id];","","\t\tif (!instance) {","\t\t\treturn Promise.resolve();","\t\t}","\t\tif (id in this._componentBindings) {","\t\t\tObject.keys(this._componentBindings[id])","\t\t\t\t.forEach(eventName => {","\t\t\t\t\telement.removeEventListener(","\t\t\t\t\t\teventName,","\t\t\t\t\t\tthis._componentBindings[id][eventName].handler,","\t\t\t\t\t\tNON_BUBBLING_EVENTS.hasOwnProperty(eventName)","\t\t\t\t\t);","\t\t\t\t});","\t\t\tdelete this._componentBindings[id];","\t\t}","","\t\tconst unbindMethod = moduleHelper.getMethodToInvoke(instance, 'unbind');","\t\treturn moduleHelper.getSafePromise(unbindMethod)","\t\t\t.then(() => {","\t\t\t\tthis._eventBus.emit('componentUnbound', {","\t\t\t\t\telement,","\t\t\t\t\tid: element.id || null","\t\t\t\t});","\t\t\t})","\t\t\t.catch(reason => this._eventBus.emit('error', reason));","\t}","","\t/**","\t * Removes a component from the current list.","\t * @param {string} id Component's ID","\t * @private","\t */","\t_removeComponentById(id) {","\t\tdelete this._componentElements[id];","\t\tdelete this._componentInstances[id];","\t\tdelete this._componentBindings[id];","\t}","","\t/**","\t * Binds all required event handlers to the component.","\t * @param {Element} element Component's HTML element.","\t * @returns {Promise} Promise for nothing.","\t * @private","\t */","\t_bindComponent(element) {","\t\tconst id = this._getId(element);","\t\tconst instance = this._componentInstances[id];","\t\tif (!instance) {","\t\t\treturn Promise.resolve();","\t\t}","","\t\tconst bindMethod = moduleHelper.getMethodToInvoke(instance, 'bind');","\t\treturn moduleHelper.getSafePromise(bindMethod)","\t\t\t.then(bindings => {","\t\t\t\tif (!bindings || typeof (bindings) !== 'object') {","\t\t\t\t\tthis._eventBus.emit('componentBound', {","\t\t\t\t\t\telement,","\t\t\t\t\t\tid: element.id || null","\t\t\t\t\t});","\t\t\t\t\treturn;","\t\t\t\t}","\t\t\t\tthis._componentBindings[id] = Object.create(null);","\t\t\t\tObject.keys(bindings)","\t\t\t\t\t.forEach(eventName => {","\t\t\t\t\t\teventName = eventName.toLowerCase();","\t\t\t\t\t\tif (eventName in this._componentBindings[id]) {","\t\t\t\t\t\t\treturn;","\t\t\t\t\t\t}","\t\t\t\t\t\tconst selectorHandlers = Object.create(null);","\t\t\t\t\t\tObject.keys(bindings[eventName])","\t\t\t\t\t\t\t.forEach(selector => {","\t\t\t\t\t\t\t\tconst handler = bindings[eventName][selector];","\t\t\t\t\t\t\t\tif (typeof (handler) !== 'function') {","\t\t\t\t\t\t\t\t\treturn;","\t\t\t\t\t\t\t\t}","\t\t\t\t\t\t\t\tselectorHandlers[selector] = handler.bind(instance);","\t\t\t\t\t\t\t});","\t\t\t\t\t\tthis._componentBindings[id][eventName] = {","\t\t\t\t\t\t\thandler: this._createBindingHandler(element, selectorHandlers),","\t\t\t\t\t\t\tselectorHandlers","\t\t\t\t\t\t};","\t\t\t\t\t\telement.addEventListener(","\t\t\t\t\t\t\teventName,","\t\t\t\t\t\t\tthis._componentBindings[id][eventName].handler,","\t\t\t\t\t\t\tNON_BUBBLING_EVENTS.hasOwnProperty(eventName)","\t\t\t\t\t\t);","\t\t\t\t\t});","\t\t\t\tthis._eventBus.emit('componentBound', {","\t\t\t\t\telement,","\t\t\t\t\tid: element.id || null","\t\t\t\t});","\t\t\t});","\t}","","\t/**","\t * Creates a universal event handler for delegated events.","\t * @param {Element} componentRoot Root element of the component.","\t * @param {Object} selectorHandlers Map of event handlers by their CSS selectors.","\t * @returns {Function} Universal event handler for delegated events.","\t * @private","\t */","\t_createBindingHandler(componentRoot, selectorHandlers) {","\t\tconst selectors = Object.keys(selectorHandlers);","\t\treturn event => {","\t\t\tvar element = event.target;","\t\t\tconst dispatchedEvent = createCustomEvent(event, () => element);","\t\t\tvar targetMatches = this._getMatchesMethod(element);","\t\t\tvar isHandled = selectors.some(selector => {","\t\t\t\tif (targetMatches(selector)) {","\t\t\t\t\tselectorHandlers[selector](dispatchedEvent);","\t\t\t\t\treturn true;","\t\t\t\t}","\t\t\t\treturn false;","\t\t\t});","","\t\t\tif (isHandled || !event.bubbles) {","\t\t\t\treturn;","\t\t\t}","","\t\t\t// we can't use parentElement here, because","\t\t\t// internal SVG elements don't have this property in IE","\t\t\twhile (element.parentNode && element !== componentRoot) {","\t\t\t\telement = element.parentNode;","\t\t\t\ttargetMatches = this._getMatchesMethod(element);","\t\t\t\tisHandled = this._tryDispatchEvent(","\t\t\t\t\tselectors, targetMatches, selectorHandlers, dispatchedEvent","\t\t\t\t);","\t\t\t\tif (isHandled) {","\t\t\t\t\tbreak;","\t\t\t\t}","\t\t\t}","\t\t};","\t}","","\t/**","\t * Tries to dispatch an event.","\t * @param {Array} selectors The list of supported selectors.","\t * @param {Function} matchPredicate The function to check if selector matches.","\t * @param {Object} handlers The set of handlers for events.","\t * @param {Event} event The DOM event object.","\t * @private","\t */","\t_tryDispatchEvent(selectors, matchPredicate, handlers, event) {","\t\treturn selectors.some(selector => {","\t\t\tif (!matchPredicate(selector)) {","\t\t\t\treturn false;","\t\t\t}","\t\t\thandlers[selector](event);","\t\t\treturn true;","\t\t});","\t}","","\t/**","\t * Checks if the element is a component.","\t * @param {Object} components Current components.","\t * @param {Element} element DOM element.","\t * @private","\t */","\t_isComponentElement(components, element) {","\t\tif (!moduleHelper.isComponentNode(element)) {","\t\t\treturn false;","\t\t}","\t\treturn moduleHelper.getOriginalComponentName(element.nodeName) in components;","\t}","","\t/**","\t * Checks if the specified object is a component.","\t * @param {Object} obj The component object.","\t * @returns {boolean}","\t * @private","\t */","\t_isComponentObject(obj) {","\t\treturn obj && obj.$context &&","\t\t\ttypeof (obj.$context) === 'object' &&","\t\t\tobj.$context.element instanceof this._window.Element;","\t}","","\t/**","\t * Maps found elements to component objects filtering non-component elements.","\t * @param {HTMLCollection|NodeList} elements Elements collection.","\t * @returns {Array} Array of the component objects.","\t * @private","\t */","\t_mapElementsToComponents(elements) {","\t\tconst results = [];","\t\tArray.prototype.forEach","\t\t\t.call(elements, element => {","\t\t\t\tconst component = this.getComponentByElement(element);","\t\t\t\tif (component) {","\t\t\t\t\tresults.push(component);","\t\t\t\t}","\t\t\t});","\t\treturn results;","\t}","","\t/**","\t * Does asynchronous traversal through the components hierarchy.","\t * @param {Array} elements Elements to start the search.","\t * @param {Object} components Current set of components.","\t * @param {function} action Action for every component.","\t * @returns {Promise} Promise for the finished traversal.","\t * @private","\t */","\t_traverseComponents(elements, components, action) {","\t\tif (elements.length === 0) {","\t\t\treturn Promise.resolve();","\t\t}","","\t\tconst root = elements.shift();","\t\telements = elements.concat(this._findNestedComponents(root, components));","\t\treturn this._traverseComponents(elements, components, action)","\t\t\t.then(() => action(root));","\t}","","\t/**","\t * Finds all descendant components of the specified component root.","\t * @param {Element} root Root component's HTML root to begin search with.","\t * @param {Object} components Map of components by their names.","\t * @private","\t */","\t_findNestedComponents(root, components) {","\t\tconst elements = [];","\t\tconst queue = [root];","","\t\t// does breadth-first search inside the root element","\t\twhile (queue.length > 0) {","\t\t\tconst currentChildren = queue.shift().children;","\t\t\tif (!currentChildren) {","\t\t\t\tcontinue;","\t\t\t}","","\t\t\tArray.prototype.forEach.call(currentChildren, currentChild => {","\t\t\t\t// and they should be components","\t\t\t\tif (!this._isComponentElement(components, currentChild)) {","\t\t\t\t\tqueue.push(currentChild);","\t\t\t\t\treturn;","\t\t\t\t}","","\t\t\t\telements.push(currentChild);","\t\t\t});","\t\t}","\t\treturn elements;","\t}","","\t/**","\t * Handles an error while rendering.","\t * @param {Element} element Component's HTML element.","\t * @param {Object} component Component's instance.","\t * @param {Error} error Error to handle.","\t * @returns {Promise<string>} Promise for HTML string.","\t * @private","\t */","\t_handleRenderError(element, component, error) {","\t\tthis._eventBus.emit('error', error);","","\t\treturn Promise.resolve()","\t\t\t.then(() => {","\t\t\t\t// do not corrupt existed HEAD when error occurs","\t\t\t\tif (element.tagName === TAG_NAMES.HEAD) {","\t\t\t\t\treturn '';","\t\t\t\t}","","\t\t\t\tif (!this._config.isRelease && error instanceof Error) {","\t\t\t\t\treturn errorHelper.prettyPrint(error, this._window.navigator.userAgent);","\t\t\t\t} else if (component.errorTemplate) {","\t\t\t\t\treturn component.errorTemplate.render(error);","\t\t\t\t}","","\t\t\t\treturn '';","\t\t\t})","\t\t\t.catch(() => '');","\t}","","\t/**","\t * Updates all components that depend on the current set of changed stores.","\t * @returns {Promise} Promise for nothing.","\t * @private","\t */","\t_updateStoreComponents() {","\t\tif (this._isUpdating) {","\t\t\treturn Promise.resolve();","\t\t}","","\t\t// if document component is changed we should reload the page","\t\tconst documentStore = this._window.document.documentElement.getAttribute(","\t\t\tmoduleHelper.ATTRIBUTE_STORE","\t\t);","\t\tif (documentStore in this._currentChangedStores) {","\t\t\tconst newLocation = this._currentRoutingContext.location.toString();","\t\t\tif (newLocation === this._window.location.toString()) {","\t\t\t\tthis._window.location.reload();","\t\t\t\treturn Promise.resolve();","\t\t\t}","\t\t\tthis._window.location.assign(newLocation);","\t\t\treturn Promise.resolve();","\t\t}","","\t\tthis._isUpdating = true;","","\t\t// if we have awaiting routing we should apply state to the stores","\t\tif (this._awaitingRouting) {","\t\t\tconst components = this._componentLoader.getComponentsByNames();","\t\t\tconst changedByState = this._storeDispatcher.setState(","\t\t\t\tthis._awaitingRouting.state,","\t\t\t\tthis._awaitingRouting.routingContext","\t\t\t);","","\t\t\tchangedByState.forEach(name => {","\t\t\t\tthis._currentChangedStores[name] = true;","\t\t\t});","","\t\t\t// we should update contexts of the components with the new routing context","\t\t\tthis._currentRoutingContext = this._awaitingRouting.routingContext;","\t\t\tObject.keys(this._componentInstances)","\t\t\t\t.forEach(id => {","\t\t\t\t\tconst instance = this._componentInstances[id];","\t\t\t\t\tinstance.$context = this._getComponentContext(","\t\t\t\t\t\tcomponents[instance.$context.name],","\t\t\t\t\t\tinstance.$context.element","\t\t\t\t\t);","\t\t\t\t});","\t\t\tthis._awaitingRouting = null;","\t\t}","","\t\tconst changedStores = Object.keys(this._currentChangedStores);","\t\tif (changedStores.length === 0) {","\t\t\tthis._isUpdating = false;","\t\t\treturn Promise.resolve();","\t\t}","","\t\tthis._currentChangedStores = Object.create(null);","","\t\tconst renderingContext = this._createRenderingContext(changedStores);","\t\tconst promises = renderingContext.roots.map(root => {","\t\t\trenderingContext.rootIds[this._getId(root)] = true;","\t\t\treturn this.renderComponent(root, renderingContext);","\t\t});","","\t\treturn Promise.all(promises)","\t\t\t.catch(reason => this._eventBus.emit('error', reason))","\t\t\t.then(() => {","\t\t\t\tthis._isUpdating = false;","\t\t\t\tthis._eventBus.emit('documentUpdated', changedStores);","\t\t\t\treturn this._updateStoreComponents();","\t\t\t});","\t}","","\t/**","\t * Merges new and existed head elements and applies only difference.","\t * The problem here is that we can't re-create or change script and style tags,","\t * because it causes blinking and JavaScript re-initialization. Therefore such","\t * element must be immutable in the HEAD.","\t * @param {Node} head HEAD DOM element.","\t * @param {Node} newHead New HEAD element.","\t * @private","\t */","\t_mergeHead(head, newHead) {","\t\tif (!newHead) {","\t\t\treturn;","\t\t}","","\t\tconst headSet = Object.create(null);","","\t\t// remove all nodes from the current HEAD except immutable ones","\t\tfor (let i = 0; i < head.childNodes.length; i++) {","\t\t\tconst current = head.childNodes[i];","\t\t\tif (!isTagImmutable(current)) {","\t\t\t\thead.removeChild(current);","\t\t\t\ti--;","\t\t\t\tcontinue;","\t\t\t}","\t\t\t// we need to collect keys for immutable elements to handle","\t\t\t// attributes reordering","\t\t\theadSet[this._getElementKey(current)] = true;","\t\t}","","\t\tfor (let i = 0; i < newHead.children.length; i++) {","\t\t\tconst current = newHead.children[i];","\t\t\tif (this._getElementKey(current) in headSet) {","\t\t\t\tcontinue;","\t\t\t}","\t\t\thead.appendChild(current);","\t\t\t// when we append existing child to another parent it removes","\t\t\t// the node from a previous parent","\t\t\ti--;","\t\t}","\t}","","\t/**","\t * Gets an unique element key using element's attributes and its content.","\t * @param {Element} element HTML element.","\t * @returns {string} Unique key for the element.","\t * @private","\t */","\t_getElementKey(element) {","\t\t// some immutable elements have several valuable attributes","\t\t// these attributes define the element identity","\t\tconst attributes = [];","","\t\tswitch (element.nodeName) {","\t\t\tcase TAG_NAMES.LINK:","\t\t\t\tattributes.push(`href=${element.getAttribute('href')}`);","\t\t\t\tbreak;","\t\t\tcase TAG_NAMES.SCRIPT:","\t\t\t\tattributes.push(`src=${element.getAttribute('src')}`);","\t\t\t\tbreak;","\t\t}","","\t\treturn `<${element.nodeName} ${attributes.sort().join(' ')}>${element.textContent}</${element.nodeName}>`;","\t}","","\t/**","\t * Initializes the element as a component.","\t * @param {Element} element The component's element.","\t * @param {Object} components Current set of components.","\t * @returns {Promise} Promise for the done initialization.","\t * @private","\t */","\t_initializeComponent(element, components) {","\t\treturn Promise.resolve()","\t\t\t.then(() => {","\t\t\t\tconst componentName = moduleHelper.getOriginalComponentName(element.nodeName);","\t\t\t\tif (!(componentName in components)) {","\t\t\t\t\treturn null;","\t\t\t\t}","","\t\t\t\tconst id = this._getId(element);","\t\t\t\tconst ComponentConstructor = components[componentName].constructor;","\t\t\t\tComponentConstructor.prototype.$context = this._getComponentContext(","\t\t\t\t\tcomponents[componentName], element","\t\t\t\t);","","\t\t\t\tconst instance = new ComponentConstructor(this._serviceLocator);","\t\t\t\tinstance.$context = ComponentConstructor.prototype.$context;","\t\t\t\tthis._componentElements[id] = element;","\t\t\t\tthis._componentInstances[id] = instance;","\t\t\t\t// initialize the store of the component","\t\t\t\tthis._storeDispatcher.getStore(","\t\t\t\t\telement.getAttribute(moduleHelper.ATTRIBUTE_STORE)","\t\t\t\t);","\t\t\t\tthis._eventBus.emit('componentRendered', {","\t\t\t\t\tname: componentName,","\t\t\t\t\tattributes: instance.$context.attributes,","\t\t\t\t\tcontext: instance.$context","\t\t\t\t});","\t\t\t\treturn this._bindComponent(element);","\t\t\t});","\t}","","\t/**","\t * Gets a component context using the basic context.","\t * @param {Object} component Component details.","\t * @param {Element} element DOM element of the component.","\t * @returns {Object} Component's context.","\t * @private","\t */","\t_getComponentContext(component, element) {","\t\tconst storeName = element.getAttribute(moduleHelper.ATTRIBUTE_STORE);","\t\tconst componentContext = Object.create(this._currentRoutingContext);","","\t\t// initialize the store of the component","\t\tthis._storeDispatcher.getStore(storeName);","","\t\tObject.defineProperties(componentContext, {","\t\t\tname: {","\t\t\t\tget: () => component.name,","\t\t\t\tenumerable: true","\t\t\t},","\t\t\tattributes: {","\t\t\t\tget: () => attributesToObject(element.attributes),","\t\t\t\tenumerable: true","\t\t\t}","\t\t});","","\t\tcomponentContext.element = element;","","\t\t// search methods","\t\tcomponentContext.getComponentById =","\t\t\tid => this.getComponentById(id);","","\t\tcomponentContext.getComponentByElement =","\t\t\telement => this.getComponentByElement(element);","","\t\tcomponentContext.getComponentsByTagName =","\t\t\t(tagName, parent) => this.getComponentsByTagName(tagName, parent);","","\t\tcomponentContext.getComponentsByClassName =","\t\t\t(className, parent) => this.getComponentsByClassName(className, parent);","","\t\tcomponentContext.queryComponentSelector =","\t\t\t(selector, parent) => this.queryComponentSelector(selector, parent);","","\t\tcomponentContext.queryComponentSelectorAll =","\t\t\t(selector, parent) => this.queryComponentSelectorAll(selector, parent);","","\t\t// create/remove","\t\tcomponentContext.createComponent = (tagName, attributes) =>","\t\t\tthis.createComponent(tagName, attributes);","\t\tcomponentContext.collectGarbage = () => this.collectGarbage();","","\t\t// store methods","\t\tcomponentContext.getStoreData = () => {","\t\t\tconst currentStoreName = element.getAttribute(moduleHelper.ATTRIBUTE_STORE);","\t\t\treturn this._storeDispatcher.getStoreData(currentStoreName);","\t\t};","\t\tcomponentContext.sendAction = (name, args) => {","\t\t\tconst currentStoreName = element.getAttribute(moduleHelper.ATTRIBUTE_STORE);","\t\t\treturn this._storeDispatcher.sendAction(currentStoreName, name, args);","\t\t};","","\t\treturn Object.freeze(componentContext);","\t}","","\t/**","\t * Finds all rendering roots on the page for all changed stores.","\t * @param {Array} changedStoreNames List of changed store's names.","\t * @returns {Array<Element>} HTML elements that are rendering roots.","\t * @private","\t */","\t_findRenderingRoots(changedStoreNames) {","\t\tconst headStore = this._window.document.head.getAttribute(moduleHelper.ATTRIBUTE_STORE);","\t\tconst components = this._componentLoader.getComponentsByNames();","\t\tconst componentElements = Object.create(null);","\t\tconst storeNamesSet = Object.create(null);","\t\tconst rootsSet = Object.create(null);","\t\tconst roots = [];","","\t\t// we should find all components and then look for roots","\t\tchangedStoreNames","\t\t\t.forEach(storeName => {","\t\t\t\tstoreNamesSet[storeName] = true;","\t\t\t\tconst elements = this._window.document","\t\t\t\t\t.querySelectorAll(`[${moduleHelper.ATTRIBUTE_STORE}=\"${storeName}\"]`);","\t\t\t\tif (elements.length === 0) {","\t\t\t\t\treturn;","\t\t\t\t}","\t\t\t\tcomponentElements[storeName] = elements;","\t\t\t});","","\t\tif (headStore in storeNamesSet && moduleHelper.HEAD_COMPONENT_NAME in components) {","\t\t\trootsSet[this._getId(this._window.document.head)] = true;","\t\t\troots.push(this._window.document.head);","\t\t}","","\t\tchangedStoreNames","\t\t\t.forEach(storeName => {","\t\t\t\tif (!(storeName in componentElements)) {","\t\t\t\t\treturn;","\t\t\t\t}","","\t\t\t\t// we can optimize and don't go the same path twice","\t\t\t\tconst visitedIds = Object.create(null);","","\t\t\t\tArray.prototype.forEach.call(componentElements[storeName], current => {","\t\t\t\t\tif (!moduleHelper.isComponentNode(current)) {","\t\t\t\t\t\treturn;","\t\t\t\t\t}","","\t\t\t\t\tlet currentRoot = current;","\t\t\t\t\tlet lastRoot = currentRoot;","\t\t\t\t\tlet lastRootId = this._getId(current);","\t\t\t\t\tif (lastRootId in visitedIds) {","\t\t\t\t\t\treturn;","\t\t\t\t\t}","\t\t\t\t\tvisitedIds[lastRootId] = true;","","\t\t\t\t\twhile (currentRoot.parentElement) {","\t\t\t\t\t\tcurrentRoot = currentRoot.parentElement;","","\t\t\t\t\t\t// if we go the same route we visited before we can","\t\t\t\t\t\t// proceed with the next element","\t\t\t\t\t\tconst currentId = this._getId(currentRoot);","\t\t\t\t\t\tif (currentId in visitedIds) {","\t\t\t\t\t\t\treturn;","\t\t\t\t\t\t}","","\t\t\t\t\t\tconst currentStore = currentRoot.getAttribute(moduleHelper.ATTRIBUTE_STORE);","\t\t\t\t\t\tconst currentComponentName = moduleHelper.getOriginalComponentName(currentRoot.tagName);","","\t\t\t\t\t\t// store did not change state","\t\t\t\t\t\tif (!currentStore || !(currentStore in storeNamesSet)) {","\t\t\t\t\t\t\tcontinue;","\t\t\t\t\t\t}","","\t\t\t\t\t\t// this component element does not have an","\t\t\t\t\t\t// implementation, skipping....","\t\t\t\t\t\tif (!(currentComponentName in components)) {","\t\t\t\t\t\t\tcontinue;","\t\t\t\t\t\t}","","\t\t\t\t\t\tlastRoot = currentRoot;","\t\t\t\t\t\tlastRootId = currentId;","\t\t\t\t\t}","","\t\t\t\t\t// we don't want the same root element twice","\t\t\t\t\tif (lastRootId in rootsSet) {","\t\t\t\t\t\treturn;","\t\t\t\t\t}","\t\t\t\t\trootsSet[lastRootId] = true;","\t\t\t\t\troots.push(lastRoot);","\t\t\t\t});","\t\t\t});","","\t\treturn roots;","\t}","","\t/**","\t * Creates a rendering context.","\t * @param {Array?} changedStores Names of changed stores.","\t * @returns {{","\t *   config: Object,","\t *   renderedIds: {},","\t *   unboundIds: {},","\t *   isHeadRendered: boolean,","\t *   bindMethods: Array,","\t *   routingContext: Object,","\t *   components: Object,","\t *   roots: Array.<Element>","\t * }} The context object.","\t * @private","\t */","\t_createRenderingContext(changedStores) {","\t\tconst components = this._componentLoader.getComponentsByNames();","","\t\treturn {","\t\t\tconfig: this._config,","\t\t\trenderedIds: Object.create(null),","\t\t\tunboundIds: Object.create(null),","\t\t\tisHeadRendered: false,","\t\t\tbindMethods: [],","\t\t\troutingContext: this._currentRoutingContext,","\t\t\tcomponents,","\t\t\trootIds: Object.create(null),","\t\t\troots: changedStores ? this._findRenderingRoots(changedStores) : []","\t\t};","\t}","","\t/**","\t * Gets an ID of the element.","\t * @param {Element} element HTML element of the component.","\t * @returns {string} ID.","\t */","\t_getId(element) {","\t\tif (element === this._window.document.documentElement) {","\t\t\treturn SPECIAL_IDS.$$document;","\t\t}","","\t\tif (element === this._window.document.head) {","\t\t\treturn SPECIAL_IDS.$$head;","\t\t}","","\t\t// if the element does not have an ID we create it","\t\tif (!element[moduleHelper.COMPONENT_ID]) {","\t\t\telement[moduleHelper.COMPONENT_ID] = uuid.v4();","\t\t\t// deal with possible collisions","\t\t\twhile (element[moduleHelper.COMPONENT_ID] in this._componentInstances) {","\t\t\t\telement[moduleHelper.COMPONENT_ID] = uuid.v4();","\t\t\t}","\t\t}","\t\treturn element[moduleHelper.COMPONENT_ID];","\t}","","\t/**","\t * Gets a cross-browser \"matches\" method for the element.","\t * @param {Element} element HTML element.","\t * @returns {Function} \"matches\" method.","\t * @private","\t */","\t_getMatchesMethod(element) {","\t\tconst method = (","\t\t\telement.matches ||","\t\t\telement.webkitMatchesSelector ||","\t\t\telement.mozMatchesSelector ||","\t\t\telement.oMatchesSelector ||","\t\t\telement.msMatchesSelector ||","\t\t\t(selector => matches(this._window, element, selector))","\t\t);","","\t\treturn method.bind(element);","\t}","}","","/**"," * Converts NamedNodeMap of Attr items to the key-value object map."," * @param {NamedNodeMap} attributes List of Element attributes."," * @returns {Object} Map of attribute values by their names."," */","function attributesToObject(attributes) {","\tconst result = Object.create(null);","\tArray.prototype.forEach.call(attributes, current => {","\t\tresult[current.name] = current.value;","\t});","\treturn result;","}","","/**"," * Matches the specified element to the selector (fallback)."," * @param {Window} currentWindow Current browser window."," * @param {Element} element DOM element."," * @param {string} selector Selector for matching."," * @returns {boolean} Does the element match."," */","function matches(currentWindow, element, selector) {","\tconst ownerDocument = element.document || element.ownerDocument || currentWindow.document;","\tconst matched = ownerDocument.querySelectorAll(selector);","\treturn Array.prototype.some.call(matched, item => item === element);","}","","/**"," * Creates an imitation of the original Event object but with specified currentTarget."," * @param {Event} event Original event object."," * @param {Function} currentTargetGetter Getter for the currentTarget."," * @returns {Event} Wrapped event."," */","function createCustomEvent(event, currentTargetGetter) {","\tconst catEvent = Object.create(event);","\tconst keys = [];","\tconst properties = {};","","\t/* eslint guard-for-in: 0 */","\tfor (const key in event) {","\t\tkeys.push(key);","\t}","\tkeys.forEach(key => {","\t\tif (typeof (event[key]) === 'function') {","\t\t\tproperties[key] = {","\t\t\t\tget: () => event[key].bind(event)","\t\t\t};","\t\t\treturn;","\t\t}","","\t\tproperties[key] = {","\t\t\tget: () => event[key],","\t\t\tset: value => {","\t\t\t\tevent[key] = value;","\t\t\t}","\t\t};","\t});","","\tproperties.currentTarget = {","\t\tget: currentTargetGetter","\t};","\tObject.defineProperties(catEvent, properties);","\tObject.seal(catEvent);","\tObject.freeze(catEvent);","\treturn catEvent;","}","","/**"," * Checks if we can mutate the specified HTML tag."," * @param {Element} element The DOM element."," * @returns {boolean} true if element should not be mutated."," */","function isTagImmutable(element) {","\t// these 3 kinds of tags once loaded can not be removed","\t// otherwise it will cause style or script reloading","\treturn element.nodeName === TAG_NAMES.SCRIPT ||","\t\telement.nodeName === TAG_NAMES.STYLE ||","\t\telement.nodeName === TAG_NAMES.LINK &&","\t\telement.getAttribute('rel') === 'stylesheet';","}","","module.exports = DocumentRenderer;",""],"l":{"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"10":1,"14":1,"22":1,"41":0,"48":0,"55":0,"62":0,"69":0,"74":0,"81":0,"88":0,"95":0,"102":0,"109":0,"116":0,"118":0,"119":0,"120":0,"121":0,"123":0,"134":0,"136":0,"137":0,"140":0,"141":0,"142":0,"143":0,"145":0,"157":0,"161":0,"162":0,"167":0,"169":0,"171":0,"172":0,"174":0,"177":0,"186":0,"188":0,"189":0,"191":0,"192":0,"193":0,"196":0,"197":0,"198":0,"199":0,"202":0,"204":0,"205":0,"206":0,"208":0,"209":0,"210":0,"213":0,"218":0,"220":0,"221":0,"223":0,"227":0,"228":0,"231":0,"233":0,"235":0,"236":0,"238":0,"239":0,"241":0,"242":0,"243":0,"246":0,"247":0,"249":0,"250":0,"251":0,"254":0,"256":0,"261":0,"264":0,"266":0,"269":0,"270":0,"271":0,"272":0,"277":0,"278":0,"280":0,"282":0,"292":0,"293":0,"303":0,"305":0,"315":0,"317":0,"327":0,"329":0,"339":0,"341":0,"350":0,"351":0,"353":0,"354":0,"355":0,"357":0,"367":0,"369":0,"374":0,"377":0,"378":0,"381":0,"382":0,"384":0,"385":0,"386":0,"389":0,"390":0,"392":0,"396":0,"407":0,"408":0,"412":0,"414":0,"416":0,"417":0,"419":0,"422":0,"425":0,"426":0,"427":0,"428":0,"430":0,"431":0,"441":0,"445":0,"446":0,"449":0,"460":0,"461":0,"463":0,"464":0,"465":0,"475":0,"476":0,"477":0,"488":0,"489":0,"490":0,"491":0,"493":0,"503":0,"504":0,"506":0,"507":0,"509":0,"510":0,"512":0,"518":0,"521":0,"522":0,"524":0,"529":0,"538":0,"539":0,"540":0,"550":0,"551":0,"552":0,"553":0,"556":0,"557":0,"559":0,"560":0,"564":0,"566":0,"567":0,"569":0,"570":0,"571":0,"573":0,"574":0,"576":0,"577":0,"578":0,"580":0,"582":0,"586":0,"592":0,"607":0,"608":0,"609":0,"610":0,"611":0,"612":0,"613":0,"614":0,"615":0,"617":0,"620":0,"621":0,"626":0,"627":0,"628":0,"629":0,"632":0,"633":0,"648":0,"649":0,"650":0,"652":0,"653":0,"664":0,"665":0,"667":0,"677":0,"689":0,"690":0,"692":0,"693":0,"694":0,"697":0,"709":0,"710":0,"713":0,"714":0,"715":0,"716":0,"726":0,"727":0,"730":0,"731":0,"732":0,"733":0,"736":0,"738":0,"739":0,"740":0,"743":0,"746":0,"758":0,"760":0,"763":0,"764":0,"767":0,"768":0,"769":0,"770":0,"773":0,"775":0,"784":0,"785":0,"789":0,"792":0,"793":0,"794":0,"795":0,"796":0,"798":0,"799":0,"802":0,"805":0,"806":0,"807":0,"812":0,"813":0,"817":0,"818":0,"820":0,"821":0,"826":0,"829":0,"830":0,"831":0,"832":0,"835":0,"837":0,"838":0,"839":0,"840":0,"843":0,"844":0,"846":0,"847":0,"848":0,"862":0,"863":0,"866":0,"869":0,"870":0,"871":0,"872":0,"873":0,"874":0,"878":0,"881":0,"882":0,"883":0,"884":0,"886":0,"889":0,"902":0,"904":0,"906":0,"907":0,"909":0,"910":0,"913":0,"924":0,"926":0,"927":0,"928":0,"931":0,"932":0,"933":0,"937":0,"938":0,"939":0,"940":0,"942":0,"945":0,"950":0,"962":0,"963":0,"966":0,"968":0,"970":0,"974":0,"979":0,"982":0,"983":0,"985":0,"986":0,"988":0,"989":0,"991":0,"992":0,"994":0,"995":0,"997":0,"998":0,"1001":0,"1002":0,"1003":0,"1006":0,"1007":0,"1008":0,"1010":0,"1011":0,"1012":0,"1015":0,"1025":0,"1026":0,"1027":0,"1028":0,"1029":0,"1030":0,"1033":0,"1035":0,"1036":0,"1038":0,"1039":0,"1041":0,"1044":0,"1045":0,"1046":0,"1049":0,"1051":0,"1052":0,"1056":0,"1058":0,"1059":0,"1060":0,"1063":0,"1064":0,"1065":0,"1066":0,"1067":0,"1069":0,"1071":0,"1072":0,"1076":0,"1077":0,"1078":0,"1081":0,"1082":0,"1085":0,"1086":0,"1091":0,"1092":0,"1095":0,"1096":0,"1100":0,"1101":0,"1103":0,"1104":0,"1108":0,"1127":0,"1129":0,"1148":0,"1149":0,"1152":0,"1153":0,"1157":0,"1158":0,"1160":0,"1161":0,"1164":0,"1174":0,"1180":0,"1183":0,"1192":1,"1193":0,"1194":0,"1195":0,"1197":0,"1207":1,"1208":0,"1209":0,"1210":0,"1219":1,"1220":0,"1221":0,"1222":0,"1225":0,"1226":0,"1228":0,"1229":0,"1230":0,"1231":0,"1233":0,"1236":0,"1237":0,"1239":0,"1244":0,"1247":0,"1248":0,"1249":0,"1250":0,"1258":1,"1261":0,"1267":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/browser/RequestRouter.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/browser/RequestRouter.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":1,"82":0,"83":0,"84":0,"85":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0,0,0,0],"23":[0,0],"24":[0,0,0],"25":[0,0],"26":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":17,"loc":{"start":{"line":17,"column":12},"end":{"line":17,"column":22}}},"2":{"name":"(anonymous_2)","line":105,"loc":{"start":{"line":105,"column":3},"end":{"line":105,"column":37}}},"3":{"name":"(anonymous_3)","line":165,"loc":{"start":{"line":165,"column":13},"end":{"line":165,"column":21}}},"4":{"name":"(anonymous_4)","line":193,"loc":{"start":{"line":193,"column":14},"end":{"line":193,"column":17}}},"5":{"name":"(anonymous_5)","line":229,"loc":{"start":{"line":229,"column":18},"end":{"line":229,"column":35}}},"6":{"name":"(anonymous_6)","line":256,"loc":{"start":{"line":256,"column":13},"end":{"line":256,"column":21}}},"7":{"name":"closestLink","line":266,"loc":{"start":{"line":266,"column":0},"end":{"line":266,"column":30}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":40}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":28}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":35}},"4":{"start":{"line":7,"column":0},"end":{"line":7,"column":39}},"5":{"start":{"line":8,"column":0},"end":{"line":8,"column":23}},"6":{"start":{"line":9,"column":0},"end":{"line":9,"column":29}},"7":{"start":{"line":24,"column":2},"end":{"line":24,"column":47}},"8":{"start":{"line":31,"column":2},"end":{"line":31,"column":43}},"9":{"start":{"line":38,"column":2},"end":{"line":38,"column":63}},"10":{"start":{"line":45,"column":2},"end":{"line":45,"column":57}},"11":{"start":{"line":52,"column":2},"end":{"line":52,"column":59}},"12":{"start":{"line":59,"column":2},"end":{"line":60,"column":54}},"13":{"start":{"line":63,"column":2},"end":{"line":63,"column":23}},"14":{"start":{"line":70,"column":2},"end":{"line":70,"column":61}},"15":{"start":{"line":78,"column":2},"end":{"line":78,"column":66}},"16":{"start":{"line":85,"column":2},"end":{"line":85,"column":35}},"17":{"start":{"line":92,"column":2},"end":{"line":92,"column":22}},"18":{"start":{"line":94,"column":2},"end":{"line":95,"column":47}},"19":{"start":{"line":95,"column":20},"end":{"line":95,"column":45}},"20":{"start":{"line":108,"column":2},"end":{"line":156,"column":3}},"21":{"start":{"line":109,"column":3},"end":{"line":109,"column":81}},"22":{"start":{"line":110,"column":3},"end":{"line":110,"column":52}},"23":{"start":{"line":112,"column":3},"end":{"line":113,"column":47}},"24":{"start":{"line":114,"column":3},"end":{"line":115,"column":44}},"25":{"start":{"line":119,"column":3},"end":{"line":124,"column":4}},"26":{"start":{"line":122,"column":4},"end":{"line":122,"column":52}},"27":{"start":{"line":123,"column":4},"end":{"line":123,"column":29}},"28":{"start":{"line":128,"column":3},"end":{"line":129,"column":40}},"29":{"start":{"line":130,"column":3},"end":{"line":131,"column":43}},"30":{"start":{"line":133,"column":3},"end":{"line":137,"column":4}},"31":{"start":{"line":134,"column":4},"end":{"line":134,"column":33}},"32":{"start":{"line":135,"column":4},"end":{"line":135,"column":63}},"33":{"start":{"line":136,"column":4},"end":{"line":136,"column":29}},"34":{"start":{"line":139,"column":3},"end":{"line":139,"column":64}},"35":{"start":{"line":140,"column":3},"end":{"line":143,"column":4}},"36":{"start":{"line":141,"column":4},"end":{"line":141,"column":52}},"37":{"start":{"line":142,"column":4},"end":{"line":142,"column":29}},"38":{"start":{"line":145,"column":3},"end":{"line":145,"column":23}},"39":{"start":{"line":146,"column":3},"end":{"line":146,"column":35}},"40":{"start":{"line":147,"column":3},"end":{"line":147,"column":32}},"41":{"start":{"line":149,"column":3},"end":{"line":151,"column":4}},"42":{"start":{"line":150,"column":4},"end":{"line":150,"column":65}},"43":{"start":{"line":153,"column":3},"end":{"line":153,"column":35}},"44":{"start":{"line":155,"column":3},"end":{"line":155,"column":28}},"45":{"start":{"line":166,"column":2},"end":{"line":186,"column":6}},"46":{"start":{"line":169,"column":4},"end":{"line":172,"column":5}},"47":{"start":{"line":170,"column":5},"end":{"line":170,"column":36}},"48":{"start":{"line":171,"column":5},"end":{"line":171,"column":17}},"49":{"start":{"line":174,"column":4},"end":{"line":178,"column":7}},"50":{"start":{"line":180,"column":4},"end":{"line":183,"column":5}},"51":{"start":{"line":181,"column":5},"end":{"line":181,"column":37}},"52":{"start":{"line":182,"column":5},"end":{"line":182,"column":72}},"53":{"start":{"line":185,"column":4},"end":{"line":185,"column":64}},"54":{"start":{"line":194,"column":2},"end":{"line":196,"column":3}},"55":{"start":{"line":195,"column":3},"end":{"line":195,"column":10}},"56":{"start":{"line":201,"column":2},"end":{"line":205,"column":4}},"57":{"start":{"line":202,"column":3},"end":{"line":204,"column":47}},"58":{"start":{"line":203,"column":16},"end":{"line":203,"column":63}},"59":{"start":{"line":204,"column":21},"end":{"line":204,"column":46}},"60":{"start":{"line":207,"column":2},"end":{"line":220,"column":5}},"61":{"start":{"line":208,"column":3},"end":{"line":210,"column":4}},"62":{"start":{"line":209,"column":4},"end":{"line":209,"column":11}},"63":{"start":{"line":211,"column":3},"end":{"line":219,"column":4}},"64":{"start":{"line":212,"column":4},"end":{"line":212,"column":48}},"65":{"start":{"line":214,"column":4},"end":{"line":214,"column":43}},"66":{"start":{"line":215,"column":4},"end":{"line":217,"column":5}},"67":{"start":{"line":216,"column":5},"end":{"line":216,"column":12}},"68":{"start":{"line":218,"column":4},"end":{"line":218,"column":40}},"69":{"start":{"line":230,"column":2},"end":{"line":230,"column":70}},"70":{"start":{"line":231,"column":2},"end":{"line":233,"column":3}},"71":{"start":{"line":232,"column":3},"end":{"line":232,"column":10}},"72":{"start":{"line":236,"column":2},"end":{"line":239,"column":3}},"73":{"start":{"line":238,"column":3},"end":{"line":238,"column":10}},"74":{"start":{"line":241,"column":2},"end":{"line":241,"column":67}},"75":{"start":{"line":242,"column":2},"end":{"line":244,"column":3}},"76":{"start":{"line":243,"column":3},"end":{"line":243,"column":10}},"77":{"start":{"line":246,"column":2},"end":{"line":246,"column":25}},"78":{"start":{"line":247,"column":2},"end":{"line":248,"column":47}},"79":{"start":{"line":248,"column":20},"end":{"line":248,"column":45}},"80":{"start":{"line":257,"column":2},"end":{"line":257,"column":38}},"81":{"start":{"line":266,"column":0},"end":{"line":272,"column":1}},"82":{"start":{"line":267,"column":1},"end":{"line":270,"column":2}},"83":{"start":{"line":269,"column":2},"end":{"line":269,"column":31}},"84":{"start":{"line":271,"column":1},"end":{"line":271,"column":68}},"85":{"start":{"line":274,"column":0},"end":{"line":274,"column":31}}},"branchMap":{"1":{"line":59,"type":"binary-expr","locations":[{"start":{"line":59,"column":29},"end":{"line":59,"column":49}},{"start":{"line":60,"column":3},"end":{"line":60,"column":53}}]},"2":{"line":112,"type":"cond-expr","locations":[{"start":{"line":113,"column":4},"end":{"line":113,"column":39}},{"start":{"line":113,"column":42},"end":{"line":113,"column":46}}]},"3":{"line":114,"type":"cond-expr","locations":[{"start":{"line":115,"column":4},"end":{"line":115,"column":36}},{"start":{"line":115,"column":39},"end":{"line":115,"column":43}}]},"4":{"line":119,"type":"if","locations":[{"start":{"line":119,"column":3},"end":{"line":119,"column":3}},{"start":{"line":119,"column":3},"end":{"line":119,"column":3}}]},"5":{"line":119,"type":"binary-expr","locations":[{"start":{"line":119,"column":7},"end":{"line":119,"column":32}},{"start":{"line":120,"column":4},"end":{"line":120,"column":48}},{"start":{"line":121,"column":4},"end":{"line":121,"column":37}}]},"6":{"line":128,"type":"cond-expr","locations":[{"start":{"line":129,"column":4},"end":{"line":129,"column":32}},{"start":{"line":129,"column":35},"end":{"line":129,"column":39}}]},"7":{"line":130,"type":"cond-expr","locations":[{"start":{"line":131,"column":4},"end":{"line":131,"column":35}},{"start":{"line":131,"column":38},"end":{"line":131,"column":42}}]},"8":{"line":133,"type":"if","locations":[{"start":{"line":133,"column":3},"end":{"line":133,"column":3}},{"start":{"line":133,"column":3},"end":{"line":133,"column":3}}]},"9":{"line":133,"type":"binary-expr","locations":[{"start":{"line":133,"column":7},"end":{"line":133,"column":47}},{"start":{"line":133,"column":51},"end":{"line":133,"column":76}}]},"10":{"line":135,"type":"binary-expr","locations":[{"start":{"line":135,"column":33},"end":{"line":135,"column":56}},{"start":{"line":135,"column":60},"end":{"line":135,"column":62}}]},"11":{"line":140,"type":"if","locations":[{"start":{"line":140,"column":3},"end":{"line":140,"column":3}},{"start":{"line":140,"column":3},"end":{"line":140,"column":3}}]},"12":{"line":149,"type":"if","locations":[{"start":{"line":149,"column":3},"end":{"line":149,"column":3}},{"start":{"line":149,"column":3},"end":{"line":149,"column":3}}]},"13":{"line":169,"type":"if","locations":[{"start":{"line":169,"column":4},"end":{"line":169,"column":4}},{"start":{"line":169,"column":4},"end":{"line":169,"column":4}}]},"14":{"line":175,"type":"binary-expr","locations":[{"start":{"line":175,"column":15},"end":{"line":175,"column":29}},{"start":{"line":175,"column":33},"end":{"line":175,"column":63}}]},"15":{"line":180,"type":"if","locations":[{"start":{"line":180,"column":4},"end":{"line":180,"column":4}},{"start":{"line":180,"column":4},"end":{"line":180,"column":4}}]},"16":{"line":194,"type":"if","locations":[{"start":{"line":194,"column":2},"end":{"line":194,"column":2}},{"start":{"line":194,"column":2},"end":{"line":194,"column":2}}]},"17":{"line":208,"type":"if","locations":[{"start":{"line":208,"column":3},"end":{"line":208,"column":3}},{"start":{"line":208,"column":3},"end":{"line":208,"column":3}}]},"18":{"line":211,"type":"if","locations":[{"start":{"line":211,"column":3},"end":{"line":211,"column":3}},{"start":{"line":211,"column":3},"end":{"line":211,"column":3}}]},"19":{"line":215,"type":"if","locations":[{"start":{"line":215,"column":4},"end":{"line":215,"column":4}},{"start":{"line":215,"column":4},"end":{"line":215,"column":4}}]},"20":{"line":231,"type":"if","locations":[{"start":{"line":231,"column":2},"end":{"line":231,"column":2}},{"start":{"line":231,"column":2},"end":{"line":231,"column":2}}]},"21":{"line":236,"type":"if","locations":[{"start":{"line":236,"column":2},"end":{"line":236,"column":2}},{"start":{"line":236,"column":2},"end":{"line":236,"column":2}}]},"22":{"line":236,"type":"binary-expr","locations":[{"start":{"line":236,"column":6},"end":{"line":236,"column":40}},{"start":{"line":237,"column":3},"end":{"line":237,"column":16}},{"start":{"line":237,"column":20},"end":{"line":237,"column":32}},{"start":{"line":237,"column":36},"end":{"line":237,"column":50}},{"start":{"line":237,"column":54},"end":{"line":237,"column":67}}]},"23":{"line":242,"type":"if","locations":[{"start":{"line":242,"column":2},"end":{"line":242,"column":2}},{"start":{"line":242,"column":2},"end":{"line":242,"column":2}}]},"24":{"line":267,"type":"binary-expr","locations":[{"start":{"line":267,"column":8},"end":{"line":267,"column":15}},{"start":{"line":267,"column":19},"end":{"line":267,"column":50}},{"start":{"line":268,"column":2},"end":{"line":268,"column":36}}]},"25":{"line":271,"type":"cond-expr","locations":[{"start":{"line":271,"column":53},"end":{"line":271,"column":60}},{"start":{"line":271,"column":63},"end":{"line":271,"column":67}}]},"26":{"line":271,"type":"binary-expr","locations":[{"start":{"line":271,"column":8},"end":{"line":271,"column":15}},{"start":{"line":271,"column":19},"end":{"line":271,"column":50}}]}},"code":["'use strict';","","const URI = require('catberry-uri').URI;","","const MOUSE_PRIMARY_KEY = 0;","const HREF_ATTRIBUTE_NAME = 'href';","const TARGET_ATTRIBUTE_NAME = 'target';","const A_TAG_NAME = 'A';","const BODY_TAG_NAME = 'BODY';","","class RequestRouter {","","\t/**","\t * Creates a new instance of the browser request router.","\t * @param {ServiceLocator} locator The service locator for resolving dependencies.","\t */","\tconstructor(locator) {","","\t\t/**","\t\t * Current event bus.","\t\t * @type {EventEmitter}","\t\t * @private","\t\t */","\t\tthis._eventBus = locator.resolve('eventBus');","","\t\t/**","\t\t * Current browser window.","\t\t * @type {Window}","\t\t * @private","\t\t */","\t\tthis._window = locator.resolve('window');","","\t\t/**","\t\t * Current document renderer.","\t\t * @type {DocumentRenderer}","\t\t * @private","\t\t */","\t\tthis._documentRenderer = locator.resolve('documentRenderer');","","\t\t/**","\t\t * Current state provider.","\t\t * @type {StateProvider}","\t\t * @private","\t\t */","\t\tthis._stateProvider = locator.resolve('stateProvider');","","\t\t/**","\t\t * Current context factory.","\t\t * @type {ContextFactory}","\t\t * @private","\t\t */","\t\tthis._contextFactory = locator.resolve('contextFactory');","","\t\t/**","\t\t * True if current browser supports history API.","\t\t * @type {boolean}","\t\t * @private","\t\t */","\t\tthis._isHistorySupported = this._window.history &&","\t\t\tthis._window.history.pushState instanceof Function;","","\t\t// add event handlers","\t\tthis._wrapDocument();","","\t\t/**","\t\t * Current location.","\t\t * @type {URI}","\t\t * @private","\t\t */","\t\tthis._location = new URI(this._window.location.toString());","","\t\t// set initial state from current URI","\t\t/**","\t\t * Current state.","\t\t * @type {Object}","\t\t * @private","\t\t */","\t\tthis._state = this._stateProvider.getStateByUri(this._location);","","\t\t/**","\t\t * Current initialization flag.","\t\t * @type {boolean}","\t\t * @private","\t\t */","\t\tthis._isStateInitialized = false;","","\t\t/**","\t\t * Current referrer.","\t\t * @type {URI}","\t\t * @private","\t\t */","\t\tthis._referrer = '';","","\t\tthis._changeState(this._state)","\t\t\t.catch(reason => this._handleError(reason));","\t}","","\t/**","\t * Sets an application state for the specified URI.","\t * @param {string} locationString URI to go.","\t * @param {boolean?} isHistoryAction If it's a back or forward history action.","\t * @returns {Promise} Promise for nothing.","\t */","\t/* eslint complexity: 0 */","\tgo(locationString, isHistoryAction) {","","\t\t// we must immediately change the URL, therefore this method is synchronous","\t\ttry {","\t\t\tconst newLocation = (new URI(locationString)).resolveRelative(this._location);","\t\t\tconst newLocationString = newLocation.toString();","","\t\t\tconst currentAuthority = this._location.authority ?","\t\t\t\tthis._location.authority.toString() : null;","\t\t\tconst newAuthority = newLocation.authority ?","\t\t\t\tnewLocation.authority.toString() : null;","","\t\t\t// we must check if history API is supported or if this is an external link","\t\t\t// before mapping URI to internal application state","\t\t\tif (!this._isHistorySupported ||","\t\t\t\tnewLocation.scheme !== this._location.scheme ||","\t\t\t\tnewAuthority !== currentAuthority) {","\t\t\t\tthis._window.location.assign(newLocationString);","\t\t\t\treturn Promise.resolve();","\t\t\t}","","\t\t\t// if only URI fragment is changed we don't need to update","\t\t\t// the whole state of the app","\t\t\tconst newQuery = newLocation.query ?","\t\t\t\tnewLocation.query.toString() : null;","\t\t\tconst currentQuery = this._location.query ?","\t\t\t\tthis._location.query.toString() : null;","","\t\t\tif (newLocation.path === this._location.path &&\tnewQuery === currentQuery) {","\t\t\t\tthis._location = newLocation;","\t\t\t\tthis._window.location.hash = this._location.fragment || '';","\t\t\t\treturn Promise.resolve();","\t\t\t}","","\t\t\tconst state = this._stateProvider.getStateByUri(newLocation);","\t\t\tif (!state) {","\t\t\t\tthis._window.location.assign(newLocationString);","\t\t\t\treturn Promise.resolve();","\t\t\t}","","\t\t\tthis._state = state;","\t\t\tthis._referrer = this._location;","\t\t\tthis._location = newLocation;","","\t\t\tif (!isHistoryAction) {","\t\t\t\tthis._window.history.pushState(state, '', newLocationString);","\t\t\t}","","\t\t\treturn this._changeState(state);","\t\t} catch (e) {","\t\t\treturn Promise.reject(e);","\t\t}","\t}","","\t/**","\t * Changes the current application state with the new location.","\t * @param {Object} state New state.","\t * @returns {Promise} Promise for nothing.","\t * @private","\t */","\t_changeState(state) {","\t\treturn Promise.resolve()","\t\t\t.then(() => {","\t\t\t\t// for \"not found\" state","\t\t\t\tif (state === null) {","\t\t\t\t\tthis._window.location.reload();","\t\t\t\t\treturn null;","\t\t\t\t}","","\t\t\t\tconst routingContext = this._contextFactory.create({","\t\t\t\t\treferrer: this._referrer || this._window.document.referrer,","\t\t\t\t\tlocation: this._location,","\t\t\t\t\tuserAgent: this._window.navigator.userAgent","\t\t\t\t});","","\t\t\t\tif (!this._isStateInitialized) {","\t\t\t\t\tthis._isStateInitialized = true;","\t\t\t\t\treturn this._documentRenderer.initWithState(state, routingContext);","\t\t\t\t}","","\t\t\t\treturn this._documentRenderer.render(state, routingContext);","\t\t\t});","\t}","","\t/**","\t * Wraps the document with required events to route requests.","\t * @private","\t */","\t_wrapDocument() {","\t\tif (!this._isHistorySupported) {","\t\t\treturn;","\t\t}","","\t\t// because now location was not change yet and","\t\t// different browsers handle `popstate` differently","\t\t// we need to do route in next iteration of event loop","\t\tthis._window.addEventListener('popstate', () =>","\t\t\tPromise.resolve()","\t\t\t\t.then(() => this.go(this._window.location.toString(), true))","\t\t\t\t.catch(reason => this._handleError(reason))","\t\t);","","\t\tthis._window.document.body.addEventListener('click', event => {","\t\t\tif (event.defaultPrevented) {","\t\t\t\treturn;","\t\t\t}","\t\t\tif (event.target.tagName === A_TAG_NAME) {","\t\t\t\tthis._linkClickHandler(event, event.target);","\t\t\t} else {","\t\t\t\tconst link = closestLink(event.target);","\t\t\t\tif (!link) {","\t\t\t\t\treturn;","\t\t\t\t}","\t\t\t\tthis._linkClickHandler(event, link);","\t\t\t}","\t\t});","\t}","","\t/**","\t * Handles a link click on the page.","\t * @param {Event} event Event-related object.","\t * @param {Element} element Link element.","\t * @private","\t */","\t_linkClickHandler(event, element) {","\t\tconst targetAttribute = element.getAttribute(TARGET_ATTRIBUTE_NAME);","\t\tif (targetAttribute) {","\t\t\treturn;","\t\t}","","\t\t// if middle mouse button was clicked","\t\tif (event.button !== MOUSE_PRIMARY_KEY ||","\t\t\tevent.ctrlKey || event.altKey || event.shiftKey || event.metaKey) {","\t\t\treturn;","\t\t}","","\t\tconst locationString = element.getAttribute(HREF_ATTRIBUTE_NAME);","\t\tif (!locationString) {","\t\t\treturn;","\t\t}","","\t\tevent.preventDefault();","\t\tthis.go(locationString)","\t\t\t.catch(reason => this._handleError(reason));","\t}","","\t/**","\t * Handles all errors.","\t * @param {Error} error Error to handle.","\t * @private","\t */","\t_handleError(error) {","\t\tthis._eventBus.emit('error', error);","\t}","}","","/**"," * Finds the closest ascending \"A\" element node."," * @param {Node} element DOM element."," * @returns {Node|null} The closest \"A\" element or null."," */","function closestLink(element) {","\twhile (element && element.nodeName !== A_TAG_NAME &&","\t\telement.nodeName !== BODY_TAG_NAME) {","\t\telement = element.parentNode;","\t}","\treturn element && element.nodeName === A_TAG_NAME ? element : null;","}","","module.exports = RequestRouter;",""],"l":{"3":1,"5":1,"6":1,"7":1,"8":1,"9":1,"24":0,"31":0,"38":0,"45":0,"52":0,"59":0,"63":0,"70":0,"78":0,"85":0,"92":0,"94":0,"95":0,"108":0,"109":0,"110":0,"112":0,"114":0,"119":0,"122":0,"123":0,"128":0,"130":0,"133":0,"134":0,"135":0,"136":0,"139":0,"140":0,"141":0,"142":0,"145":0,"146":0,"147":0,"149":0,"150":0,"153":0,"155":0,"166":0,"169":0,"170":0,"171":0,"174":0,"180":0,"181":0,"182":0,"185":0,"194":0,"195":0,"201":0,"202":0,"203":0,"204":0,"207":0,"208":0,"209":0,"211":0,"212":0,"214":0,"215":0,"216":0,"218":0,"230":0,"231":0,"232":0,"236":0,"238":0,"241":0,"242":0,"243":0,"246":0,"247":0,"248":0,"257":0,"266":1,"267":0,"269":0,"271":0,"274":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/appDefinitions.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/lib/appDefinitions.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1},"b":{"1":[1,0],"2":[1,0]},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":8,"column":0},"end":{"line":12,"column":2}},"2":{"start":{"line":14,"column":0},"end":{"line":18,"column":2}},"3":{"start":{"line":20,"column":0},"end":{"line":20,"column":52}},"4":{"start":{"line":21,"column":0},"end":{"line":21,"column":42}},"5":{"start":{"line":23,"column":0},"end":{"line":28,"column":2}}},"branchMap":{"1":{"line":20,"type":"binary-expr","locations":[{"start":{"line":20,"column":25},"end":{"line":20,"column":45}},{"start":{"line":20,"column":49},"end":{"line":20,"column":51}}]},"2":{"line":21,"type":"binary-expr","locations":[{"start":{"line":21,"column":25},"end":{"line":21,"column":35}},{"start":{"line":21,"column":39},"end":{"line":21,"column":41}}]}},"code":["/**"," * This file is a template and it is used only for some string replaces"," * by BrowserBundleBuilder module. It does not work by itself."," */","","'use strict';","","const stores = [","","/** __stores **/","","];","","const components = [","","/** __components **/","","];","","const routeDefinitions = '__routeDefinitions' || [];","const routeDescriptors = '__routes' || [];","","module.exports = {","\tstores,","\tcomponents,","\trouteDefinitions,","\trouteDescriptors","};",""],"l":{"8":1,"14":1,"20":1,"21":1,"23":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/browser/helpers/hrTimeHelper.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/browser/helpers/hrTimeHelper.js","s":{"1":1,"2":0},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":25,"column":2}},"2":{"start":{"line":24,"column":27},"end":{"line":24,"column":72}}},"branchMap":{},"code":["'use strict';","","module.exports = {","","\t/**","\t * Gets the high resolution time or the difference between","\t * previous and current time.","\t * @param {Array?} Previous high resolution timestamp.","\t * @returns {Array} The high resolution time.","\t */","\tget: require('browser-process-hrtime'),","","\t/**","\t * Converts the high resolution timestamp to text message.","\t * @param {Array}","\t * @returns {string} Time message.","\t */","\ttoMessage: require('pretty-hrtime'),","","\t/**","\t * Converts high resolution time to milliseconds number.","\t * @param {Array} hrTime High resolution time tuple.","\t */","\ttoMilliseconds: hrTime => hrTime[0] * 1e3 + Math.round(hrTime[1] / 1e6)","};",""],"l":{"3":1,"24":0}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/browser/loaders/ComponentLoader.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/browser/loaders/ComponentLoader.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0,0],"8":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":13,"loc":{"start":{"line":13,"column":12},"end":{"line":13,"column":22}}},"2":{"name":"(anonymous_2)","line":56,"loc":{"start":{"line":56,"column":5},"end":{"line":56,"column":8}}},"3":{"name":"(anonymous_3)","line":95,"loc":{"start":{"line":95,"column":18},"end":{"line":95,"column":37}}},"4":{"name":"(anonymous_4)","line":127,"loc":{"start":{"line":127,"column":21},"end":{"line":127,"column":24}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":63}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":67}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":56}},"4":{"start":{"line":14,"column":2},"end":{"line":14,"column":26}},"5":{"start":{"line":15,"column":2},"end":{"line":19,"column":3}},"6":{"start":{"line":16,"column":3},"end":{"line":16,"column":66}},"7":{"start":{"line":18,"column":3},"end":{"line":18,"column":28}},"8":{"start":{"line":20,"column":2},"end":{"line":20,"column":38}},"9":{"start":{"line":27,"column":2},"end":{"line":27,"column":33}},"10":{"start":{"line":34,"column":2},"end":{"line":34,"column":47}},"11":{"start":{"line":41,"column":2},"end":{"line":42,"column":45}},"12":{"start":{"line":49,"column":2},"end":{"line":49,"column":32}},"13":{"start":{"line":57,"column":2},"end":{"line":59,"column":3}},"14":{"start":{"line":58,"column":3},"end":{"line":58,"column":50}},"15":{"start":{"line":61,"column":2},"end":{"line":61,"column":47}},"16":{"start":{"line":63,"column":2},"end":{"line":86,"column":6}},"17":{"start":{"line":64,"column":15},"end":{"line":64,"column":59}},"18":{"start":{"line":65,"column":16},"end":{"line":65,"column":18}},"19":{"start":{"line":67,"column":4},"end":{"line":67,"column":33}},"20":{"start":{"line":69,"column":4},"end":{"line":74,"column":7}},"21":{"start":{"line":70,"column":5},"end":{"line":72,"column":6}},"22":{"start":{"line":71,"column":6},"end":{"line":71,"column":13}},"23":{"start":{"line":73,"column":5},"end":{"line":73,"column":66}},"24":{"start":{"line":75,"column":4},"end":{"line":75,"column":42}},"25":{"start":{"line":78,"column":4},"end":{"line":83,"column":7}},"26":{"start":{"line":79,"column":5},"end":{"line":81,"column":6}},"27":{"start":{"line":80,"column":6},"end":{"line":80,"column":13}},"28":{"start":{"line":82,"column":5},"end":{"line":82,"column":56}},"29":{"start":{"line":84,"column":4},"end":{"line":84,"column":59}},"30":{"start":{"line":85,"column":4},"end":{"line":85,"column":34}},"31":{"start":{"line":96,"column":2},"end":{"line":96,"column":50}},"32":{"start":{"line":98,"column":2},"end":{"line":120,"column":6}},"33":{"start":{"line":100,"column":4},"end":{"line":102,"column":5}},"34":{"start":{"line":101,"column":5},"end":{"line":101,"column":106}},"35":{"start":{"line":103,"column":4},"end":{"line":103,"column":43}},"36":{"start":{"line":104,"column":4},"end":{"line":104,"column":96}},"37":{"start":{"line":105,"column":4},"end":{"line":105,"column":106}},"38":{"start":{"line":107,"column":4},"end":{"line":110,"column":5}},"39":{"start":{"line":109,"column":5},"end":{"line":109,"column":98}},"40":{"start":{"line":112,"column":4},"end":{"line":112,"column":48}},"41":{"start":{"line":114,"column":4},"end":{"line":114,"column":54}},"42":{"start":{"line":115,"column":4},"end":{"line":115,"column":21}},"43":{"start":{"line":118,"column":4},"end":{"line":118,"column":41}},"44":{"start":{"line":119,"column":4},"end":{"line":119,"column":16}},"45":{"start":{"line":128,"column":2},"end":{"line":128,"column":55}},"46":{"start":{"line":132,"column":0},"end":{"line":132,"column":33}}},"branchMap":{"1":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":2},"end":{"line":57,"column":2}},{"start":{"line":57,"column":2},"end":{"line":57,"column":2}}]},"2":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":5},"end":{"line":70,"column":5}},{"start":{"line":70,"column":5},"end":{"line":70,"column":5}}]},"3":{"line":70,"type":"binary-expr","locations":[{"start":{"line":70,"column":9},"end":{"line":70,"column":19}},{"start":{"line":70,"column":23},"end":{"line":70,"column":54}}]},"4":{"line":79,"type":"if","locations":[{"start":{"line":79,"column":5},"end":{"line":79,"column":5}},{"start":{"line":79,"column":5},"end":{"line":79,"column":5}}]},"5":{"line":100,"type":"if","locations":[{"start":{"line":100,"column":4},"end":{"line":100,"column":4}},{"start":{"line":100,"column":4},"end":{"line":100,"column":4}}]},"6":{"line":107,"type":"if","locations":[{"start":{"line":107,"column":4},"end":{"line":107,"column":4}},{"start":{"line":107,"column":4},"end":{"line":107,"column":4}}]},"7":{"line":107,"type":"binary-expr","locations":[{"start":{"line":107,"column":8},"end":{"line":107,"column":35}},{"start":{"line":108,"column":7},"end":{"line":108,"column":42}},{"start":{"line":108,"column":46},"end":{"line":108,"column":78}}]},"8":{"line":128,"type":"binary-expr","locations":[{"start":{"line":128,"column":9},"end":{"line":128,"column":31}},{"start":{"line":128,"column":35},"end":{"line":128,"column":54}}]}},"code":["'use strict';","","const moduleHelper = require('../../lib/helpers/moduleHelper');","const templateHelper = require('../../lib/helpers/templateHelper');","const LoaderBase = require('../../lib/base/LoaderBase');","","class ComponentLoader extends LoaderBase {","","\t/**","\t * Creates a new instance of the component loader.","\t * @param {ServiceLocator} locator The service locator for resolving dependencies.","\t */","\tconstructor(locator) {","\t\tvar componentTransforms;","\t\ttry {","\t\t\tcomponentTransforms = locator.resolveAll('componentTransform');","\t\t} catch (e) {","\t\t\tcomponentTransforms = [];","\t\t}","\t\tsuper(locator, componentTransforms);","","\t\t/**","\t\t * Current service locator.","\t\t * @type {ServiceLocator}","\t\t * @private","\t\t */","\t\tthis._serviceLocator = locator;","","\t\t/**","\t\t * Current event bus.","\t\t * @type {EventEmitter}","\t\t * @private","\t\t */","\t\tthis._eventBus = locator.resolve('eventBus');","","\t\t/**","\t\t * Current template provider map.","\t\t * @type {Object}","\t\t * @private","\t\t */","\t\tthis._templateProvidersByNames = templateHelper","\t\t\t.resolveTemplateProvidersByNames(locator);","","\t\t/**","\t\t * Current map of loaded components by names.","\t\t * @type {Object} Map of components by names.","\t\t * @private","\t\t */","\t\tthis._loadedComponents = null;","\t}","","\t/**","\t * Loads components inside the browser bundle.","\t * @returns {Promise<Object>} The promise for loaded components.","\t */","\tload() {","\t\tif (this._loadedComponents) {","\t\t\treturn Promise.resolve(this._loadedComponents);","\t\t}","","\t\tthis._loadedComponents = Object.create(null);","","\t\treturn Promise.resolve()","\t\t\t.then(() => this._serviceLocator.resolveAll('component'))","\t\t\t.catch(() => [])","\t\t\t.then(components => {","\t\t\t\tconst componentPromises = [];","\t\t\t\t// the list is a stack, we should reverse it","\t\t\t\tcomponents.forEach(component => {","\t\t\t\t\tif (!component || typeof (component) !== 'object') {","\t\t\t\t\t\treturn;","\t\t\t\t\t}","\t\t\t\t\tcomponentPromises.unshift(this._processComponent(component));","\t\t\t\t});","\t\t\t\treturn Promise.all(componentPromises);","\t\t\t})","\t\t\t.then(components => {","\t\t\t\tcomponents.forEach(component => {","\t\t\t\t\tif (!component) {","\t\t\t\t\t\treturn;","\t\t\t\t\t}","\t\t\t\t\tthis._loadedComponents[component.name] = component;","\t\t\t\t});","\t\t\t\tthis._eventBus.emit('allComponentsLoaded', components);","\t\t\t\treturn this._loadedComponents;","\t\t\t});","\t}","","\t/**","\t * Processes a component and applies required operations.","\t * @param {Object} componentDetails The loaded component details.","\t * @returns {Promise<Object>} The promise for the component object.","\t * @private","\t */","\t_processComponent(componentDetails) {","\t\tvar component = Object.create(componentDetails);","","\t\treturn this._applyTransforms(component)","\t\t\t.then(transformed => {","\t\t\t\tif (!transformed) {","\t\t\t\t\tthrow new Error(`Transformation for the \"${componentDetails.name}\" component returned a bad result`);","\t\t\t\t}","\t\t\t\tcomponent = Object.create(transformed);","\t\t\t\tcomponent.templateProvider = this._templateProvidersByNames[component.templateProviderName];","\t\t\t\tcomponent.errorTemplateProvider = this._templateProvidersByNames[component.errorTemplateProviderName];","","\t\t\t\tif (!component.templateProvider &&","\t\t\t\t\t\t(component.errorTemplateProviderName && !component.errorTemplateProvider)) {","\t\t\t\t\tthrow new Error(`Template provider required by the component \"${component.name}\" not found`);","\t\t\t\t}","","\t\t\t\ttemplateHelper.registerTemplates(component);","","\t\t\t\tthis._eventBus.emit('componentLoaded', component);","\t\t\t\treturn component;","\t\t\t})","\t\t\t.catch(reason => {","\t\t\t\tthis._eventBus.emit('error', reason);","\t\t\t\treturn null;","\t\t\t});","\t}","","\t/**","\t * Gets a map of components by their names.","\t * @returns {Object} The map of the components by their names.","\t */","\tgetComponentsByNames() {","\t\treturn this._loadedComponents || Object.create(null);","\t}","}","","module.exports = ComponentLoader;",""],"l":{"3":1,"4":1,"5":1,"14":0,"15":0,"16":0,"18":0,"20":0,"27":0,"34":0,"41":0,"49":0,"57":0,"58":0,"61":0,"63":0,"64":0,"65":0,"67":0,"69":0,"70":0,"71":0,"73":0,"75":0,"78":0,"79":0,"80":0,"82":0,"84":0,"85":0,"96":0,"98":0,"100":0,"101":0,"103":0,"104":0,"105":0,"107":0,"109":0,"112":0,"114":0,"115":0,"118":0,"119":0,"128":0,"132":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/browser/loaders/StoreLoader.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/browser/loaders/StoreLoader.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":11,"loc":{"start":{"line":11,"column":12},"end":{"line":11,"column":22}}},"2":{"name":"(anonymous_2)","line":46,"loc":{"start":{"line":46,"column":5},"end":{"line":46,"column":8}}},"3":{"name":"(anonymous_3)","line":85,"loc":{"start":{"line":85,"column":10},"end":{"line":85,"column":25}}},"4":{"name":"(anonymous_4)","line":104,"loc":{"start":{"line":104,"column":17},"end":{"line":104,"column":20}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":56}},"2":{"start":{"line":12,"column":2},"end":{"line":12,"column":22}},"3":{"start":{"line":13,"column":2},"end":{"line":17,"column":3}},"4":{"start":{"line":14,"column":3},"end":{"line":14,"column":58}},"5":{"start":{"line":16,"column":3},"end":{"line":16,"column":24}},"6":{"start":{"line":18,"column":2},"end":{"line":18,"column":34}},"7":{"start":{"line":25,"column":2},"end":{"line":25,"column":33}},"8":{"start":{"line":32,"column":2},"end":{"line":32,"column":47}},"9":{"start":{"line":39,"column":2},"end":{"line":39,"column":28}},"10":{"start":{"line":47,"column":2},"end":{"line":49,"column":3}},"11":{"start":{"line":48,"column":3},"end":{"line":48,"column":46}},"12":{"start":{"line":51,"column":2},"end":{"line":51,"column":43}},"13":{"start":{"line":53,"column":2},"end":{"line":76,"column":6}},"14":{"start":{"line":54,"column":15},"end":{"line":54,"column":55}},"15":{"start":{"line":55,"column":16},"end":{"line":55,"column":18}},"16":{"start":{"line":57,"column":4},"end":{"line":57,"column":29}},"17":{"start":{"line":59,"column":4},"end":{"line":64,"column":7}},"18":{"start":{"line":60,"column":5},"end":{"line":62,"column":6}},"19":{"start":{"line":61,"column":6},"end":{"line":61,"column":13}},"20":{"start":{"line":63,"column":5},"end":{"line":63,"column":50}},"21":{"start":{"line":65,"column":4},"end":{"line":65,"column":38}},"22":{"start":{"line":68,"column":4},"end":{"line":73,"column":7}},"23":{"start":{"line":69,"column":5},"end":{"line":71,"column":6}},"24":{"start":{"line":70,"column":6},"end":{"line":70,"column":13}},"25":{"start":{"line":72,"column":5},"end":{"line":72,"column":44}},"26":{"start":{"line":74,"column":4},"end":{"line":74,"column":63}},"27":{"start":{"line":75,"column":4},"end":{"line":75,"column":47}},"28":{"start":{"line":86,"column":2},"end":{"line":97,"column":6}},"29":{"start":{"line":88,"column":4},"end":{"line":90,"column":5}},"30":{"start":{"line":89,"column":5},"end":{"line":89,"column":98}},"31":{"start":{"line":91,"column":4},"end":{"line":91,"column":52}},"32":{"start":{"line":92,"column":4},"end":{"line":92,"column":23}},"33":{"start":{"line":95,"column":4},"end":{"line":95,"column":41}},"34":{"start":{"line":96,"column":4},"end":{"line":96,"column":16}},"35":{"start":{"line":105,"column":2},"end":{"line":105,"column":51}},"36":{"start":{"line":109,"column":0},"end":{"line":109,"column":29}}},"branchMap":{"1":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":2},"end":{"line":47,"column":2}},{"start":{"line":47,"column":2},"end":{"line":47,"column":2}}]},"2":{"line":60,"type":"if","locations":[{"start":{"line":60,"column":5},"end":{"line":60,"column":5}},{"start":{"line":60,"column":5},"end":{"line":60,"column":5}}]},"3":{"line":60,"type":"binary-expr","locations":[{"start":{"line":60,"column":9},"end":{"line":60,"column":15}},{"start":{"line":60,"column":19},"end":{"line":60,"column":46}}]},"4":{"line":69,"type":"if","locations":[{"start":{"line":69,"column":5},"end":{"line":69,"column":5}},{"start":{"line":69,"column":5},"end":{"line":69,"column":5}}]},"5":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":4},"end":{"line":88,"column":4}},{"start":{"line":88,"column":4},"end":{"line":88,"column":4}}]},"6":{"line":105,"type":"binary-expr","locations":[{"start":{"line":105,"column":9},"end":{"line":105,"column":27}},{"start":{"line":105,"column":31},"end":{"line":105,"column":50}}]}},"code":["'use strict';","","const LoaderBase = require('../../lib/base/LoaderBase');","","class StoreLoader extends LoaderBase {","","\t/**","\t * Creates a new instance of the store loader.","\t * @param {ServiceLocator} locator The service locator for resolving stores.","\t */","\tconstructor(locator) {","\t\tvar storeTransforms;","\t\ttry {","\t\t\tstoreTransforms = locator.resolveAll('storeTransform');","\t\t} catch (e) {","\t\t\tstoreTransforms = [];","\t\t}","\t\tsuper(locator, storeTransforms);","","\t\t/**","\t\t * Current service locator.","\t\t * @type {ServiceLocator}","\t\t * @private","\t\t */","\t\tthis._serviceLocator = locator;","","\t\t/**","\t\t * Current event bus.","\t\t * @type {EventEmitter}","\t\t * @private","\t\t */","\t\tthis._eventBus = locator.resolve('eventBus');","","\t\t/**","\t\t * Current set of loaded stores.","\t\t * @type {Object}","\t\t * @private","\t\t */","\t\tthis._loadedStores = null;","\t}","","\t/**","\t * Loads all stores inside the browser bundle.","\t * @returns {Promise<Object>} The promise loaded stores.","\t */","\tload() {","\t\tif (this._loadedStores) {","\t\t\treturn Promise.resolve(this._loadedStores);","\t\t}","","\t\tthis._loadedStores = Object.create(null);","","\t\treturn Promise.resolve()","\t\t\t.then(() => this._serviceLocator.resolveAll('store'))","\t\t\t.catch(() => [])","\t\t\t.then(stores => {","\t\t\t\tconst storePromises = [];","\t\t\t\t// the list is a stack, we should reverse it","\t\t\t\tstores.forEach(store => {","\t\t\t\t\tif (!store || typeof (store) !== 'object') {","\t\t\t\t\t\treturn;","\t\t\t\t\t}","\t\t\t\t\tstorePromises.unshift(this._getStore(store));","\t\t\t\t});","\t\t\t\treturn Promise.all(storePromises);","\t\t\t})","\t\t\t.then(stores => {","\t\t\t\tstores.forEach(store => {","\t\t\t\t\tif (!store) {","\t\t\t\t\t\treturn;","\t\t\t\t\t}","\t\t\t\t\tthis._loadedStores[store.name] = store;","\t\t\t\t});","\t\t\t\tthis._eventBus.emit('allStoresLoaded', this._loadedStores);","\t\t\t\treturn Promise.resolve(this._loadedStores);","\t\t\t});","\t}","","\t/**","\t * Gets astore from store details.","\t * @param {Object} storeDetails The store details.","\t * @returns {Promise<Object>} The promise for the store.","\t * @private","\t */","\t_getStore(storeDetails) {","\t\treturn this._applyTransforms(storeDetails)","\t\t\t.then(transformed => {","\t\t\t\tif (!transformed) {","\t\t\t\t\tthrow new Error(`Transformation for the \"${storeDetails.name}\" store returned a bad result`);","\t\t\t\t}","\t\t\t\tthis._eventBus.emit('storeLoaded', transformed);","\t\t\t\treturn transformed;","\t\t\t})","\t\t\t.catch(reason => {","\t\t\t\tthis._eventBus.emit('error', reason);","\t\t\t\treturn null;","\t\t\t});","\t}","","\t/**","\t * Gets a stores map by their names.","\t * @returns {Object} The map of stores by their names.","\t */","\tgetStoresByNames() {","\t\treturn this._loadedStores || Object.create(null);","\t}","}","","module.exports = StoreLoader;",""],"l":{"3":1,"12":0,"13":0,"14":0,"16":0,"18":0,"25":0,"32":0,"39":0,"47":0,"48":0,"51":0,"53":0,"54":0,"55":0,"57":0,"59":0,"60":0,"61":0,"63":0,"65":0,"68":0,"69":0,"70":0,"72":0,"74":0,"75":0,"86":0,"88":0,"89":0,"91":0,"92":0,"95":0,"96":0,"105":0,"109":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/browser/providers/ModuleApiProvider.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/browser/providers/ModuleApiProvider.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":1},"b":{},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":22}}},"2":{"name":"(anonymous_2)","line":20,"loc":{"start":{"line":20,"column":14},"end":{"line":20,"column":17}}},"3":{"name":"(anonymous_3)","line":28,"loc":{"start":{"line":28,"column":13},"end":{"line":28,"column":16}}},"4":{"name":"(anonymous_4)","line":36,"loc":{"start":{"line":36,"column":9},"end":{"line":36,"column":12}}},"5":{"name":"(anonymous_5)","line":47,"loc":{"start":{"line":47,"column":9},"end":{"line":47,"column":21}}},"6":{"name":"(anonymous_6)","line":56,"loc":{"start":{"line":56,"column":14},"end":{"line":56,"column":17}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":67}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":78}},"3":{"start":{"line":13,"column":2},"end":{"line":13,"column":17}},"4":{"start":{"line":21,"column":2},"end":{"line":21,"column":14}},"5":{"start":{"line":29,"column":2},"end":{"line":29,"column":15}},"6":{"start":{"line":37,"column":2},"end":{"line":37,"column":48}},"7":{"start":{"line":38,"column":2},"end":{"line":38,"column":27}},"8":{"start":{"line":39,"column":2},"end":{"line":39,"column":27}},"9":{"start":{"line":48,"column":2},"end":{"line":48,"column":62}},"10":{"start":{"line":49,"column":2},"end":{"line":49,"column":37}},"11":{"start":{"line":57,"column":2},"end":{"line":57,"column":48}},"12":{"start":{"line":58,"column":2},"end":{"line":58,"column":50}},"13":{"start":{"line":59,"column":2},"end":{"line":59,"column":28}},"14":{"start":{"line":60,"column":2},"end":{"line":60,"column":44}},"15":{"start":{"line":61,"column":2},"end":{"line":61,"column":27}},"16":{"start":{"line":65,"column":0},"end":{"line":65,"column":35}}},"branchMap":{},"code":["'use strict';","","const propertyHelper = require('../../lib/helpers/propertyHelper');","const ModuleApiProviderBase = require('../../lib/base/ModuleApiProviderBase');","","class ModuleApiProvider extends ModuleApiProviderBase {","","\t/**","\t * Creates a new instance of the module API provider.","\t * @param {ServiceLocator} locator The service locator for resolving dependencies.","\t */","\tconstructor(locator) {","\t\tsuper(locator);","\t}","","\t/**","\t * Returns true because works in a browser.","\t * @returns {boolean}","\t */","\tget isBrowser() {","\t\treturn true;","\t}","","\t/**","\t * Returns false because works in a browser.","\t * @returns {boolean}","\t */","\tget isServer() {","\t\treturn false;","\t}","","\t/**","\t * Reloads the page for handling \"not found\" error.","\t * @returns {Promise} Promise for nothing.","\t */","\tnotFound() {","\t\tconst window = this.locator.resolve('window');","\t\twindow.location.reload();","\t\treturn Promise.resolve();","\t}","","\t/**","\t * Redirects current page to specified URI.","\t * @param {string} uriString URI to redirect.","\t * @returns {Promise} Promise for nothing.","\t */","\tredirect(uriString) {","\t\tconst requestRouter = this.locator.resolve('requestRouter');","\t\treturn requestRouter.go(uriString);","\t}","","\t/**","\t * Clears current location URI's fragment.","\t * @returns {Promise} Promise for nothing.","\t */","\tclearFragment() {","\t\tconst window = this.locator.resolve('window');","\t\tconst position = window.document.body.scrollTop;","\t\twindow.location.hash = '';","\t\twindow.document.body.scrollTop = position;","\t\treturn Promise.resolve();","\t}","}","","module.exports = ModuleApiProvider;",""],"l":{"3":1,"4":1,"13":0,"21":0,"29":0,"37":0,"38":0,"39":0,"48":0,"49":0,"57":0,"58":0,"59":0,"60":0,"61":0,"65":1}},"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/browser/providers/StateProvider.js":{"path":"/home/travis/build/npmtest/node-npmtest-catberry/node_modules/catberry/browser/providers/StateProvider.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0,0]},"f":{"1":0},"fnMap":{"1":{"name":"(anonymous_1)","line":17,"loc":{"start":{"line":17,"column":21},"end":{"line":17,"column":38}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":70}},"2":{"start":{"line":18,"column":2},"end":{"line":18,"column":25}},"3":{"start":{"line":20,"column":2},"end":{"line":20,"column":23}},"4":{"start":{"line":22,"column":2},"end":{"line":26,"column":3}},"5":{"start":{"line":23,"column":3},"end":{"line":23,"column":67}},"6":{"start":{"line":25,"column":3},"end":{"line":25,"column":25}},"7":{"start":{"line":28,"column":2},"end":{"line":28,"column":47}},"8":{"start":{"line":30,"column":2},"end":{"line":37,"column":3}},"9":{"start":{"line":31,"column":3},"end":{"line":34,"column":7}},"10":{"start":{"line":33,"column":5},"end":{"line":33,"column":58}},"11":{"start":{"line":39,"column":2},"end":{"line":71,"column":6}},"12":{"start":{"line":42,"column":4},"end":{"line":45,"column":5}},"13":{"start":{"line":43,"column":5},"end":{"line":43,"column":47}},"14":{"start":{"line":44,"column":5},"end":{"line":44,"column":12}},"15":{"start":{"line":48,"column":4},"end":{"line":63,"column":5}},"16":{"start":{"line":51,"column":5},"end":{"line":51,"column":59}},"17":{"start":{"line":53,"column":5},"end":{"line":55,"column":6}},"18":{"start":{"line":54,"column":6},"end":{"line":54,"column":35}},"19":{"start":{"line":57,"column":5},"end":{"line":59,"column":6}},"20":{"start":{"line":58,"column":6},"end":{"line":58,"column":33}},"21":{"start":{"line":61,"column":5},"end":{"line":61,"column":34}},"22":{"start":{"line":62,"column":5},"end":{"line":62,"column":12}},"23":{"start":{"line":66,"column":4},"end":{"line":70,"column":5}},"24":{"start":{"line":69,"column":5},"end":{"line":69,"column":29}},"25":{"start":{"line":73,"column":2},"end":{"line":73,"column":21}},"26":{"start":{"line":77,"column":0},"end":{"line":77,"column":31}}},"branchMap":{"1":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":4},"end":{"line":42,"column":4}},{"start":{"line":42,"column":4},"end":{"line":42,"column":4}}]},"2":{"line":48,"type":"if","locations":[{"start":{"line":48,"column":4},"end":{"line":48,"column":4}},{"start":{"line":48,"column":4},"end":{"line":48,"column":4}}]},"3":{"line":48,"type":"binary-expr","locations":[{"start":{"line":48,"column":8},"end":{"line":48,"column":35}},{"start":{"line":49,"column":6},"end":{"line":49,"column":44}}]},"4":{"line":53,"type":"if","locations":[{"start":{"line":53,"column":5},"end":{"line":53,"column":5}},{"start":{"line":53,"column":5},"end":{"line":53,"column":5}}]},"5":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":5},"end":{"line":57,"column":5}},{"start":{"line":57,"column":5},"end":{"line":57,"column":5}}]},"6":{"line":66,"type":"if","locations":[{"start":{"line":66,"column":4},"end":{"line":66,"column":4}},{"start":{"line":66,"column":4},"end":{"line":66,"column":4}}]},"7":{"line":66,"type":"binary-expr","locations":[{"start":{"line":66,"column":8},"end":{"line":66,"column":35}},{"start":{"line":67,"column":6},"end":{"line":67,"column":40}},{"start":{"line":68,"column":6},"end":{"line":68,"column":35}}]}},"code":["'use strict';","","const StateProviderBase = require('../../lib/base/StateProviderBase');","","/**"," * Implements the state provider for the server environment."," */","class StateProvider extends StateProviderBase {","","\t/**","\t * Gets a list of route descriptors.","\t * @param {ServiceLocator} serviceLocator The Service locator","\t * for getting route definitions.","\t * @returns {Array} The list of URI mappers.","\t * @private","\t */","\t_getRouteDescriptors(serviceLocator) {","\t\tconst descriptors = [];","","\t\tlet routeDefinitions;","","\t\ttry {","\t\t\trouteDefinitions = serviceLocator.resolveAll('routeDefinition');","\t\t} catch (e) {","\t\t\trouteDefinitions = [];","\t\t}","","\t\tconst routeDescriptors = Object.create(null);","","\t\ttry {","\t\t\tserviceLocator.resolveAll('routeDescriptor')","\t\t\t\t.forEach(descriptor => {","\t\t\t\t\trouteDescriptors[descriptor.expression] = descriptor;","\t\t\t\t});","\t\t} catch (e) {","\t\t\t// nothing to do","\t\t}","","\t\trouteDefinitions","\t\t\t.forEach(route => {","\t\t\t\t// just colon-parametrized string","\t\t\t\tif (typeof (route) === 'string') {","\t\t\t\t\tdescriptors.push(routeDescriptors[route]);","\t\t\t\t\treturn;","\t\t\t\t}","","\t\t\t\t// extended colon-parametrized mapper","\t\t\t\tif (typeof (route) === 'object' &&","\t\t\t\t\t\ttypeof (route.expression) === 'string') {","","\t\t\t\t\tconst descriptor = routeDescriptors[route.expression];","","\t\t\t\t\tif (typeof (route.name) === 'string') {","\t\t\t\t\t\tdescriptor.name = route.name;","\t\t\t\t\t}","","\t\t\t\t\tif (route.map instanceof Function) {","\t\t\t\t\t\tdescriptor.map = route.map;","\t\t\t\t\t}","","\t\t\t\t\tdescriptors.push(descriptor);","\t\t\t\t\treturn;","\t\t\t\t}","","\t\t\t\t// regular expression mapper","\t\t\t\tif (typeof (route) === 'object' &&","\t\t\t\t\t(route.expression instanceof RegExp) &&","\t\t\t\t\t(route.map instanceof Function)) {","\t\t\t\t\tdescriptors.push(route);","\t\t\t\t}","\t\t\t});","","\t\treturn descriptors;","\t}","}","","module.exports = StateProvider;",""],"l":{"3":1,"18":0,"20":0,"22":0,"23":0,"25":0,"28":0,"30":0,"31":0,"33":0,"39":0,"42":0,"43":0,"44":0,"48":0,"51":0,"53":0,"54":0,"57":0,"58":0,"61":0,"62":0,"66":0,"69":0,"73":0,"77":1}}}